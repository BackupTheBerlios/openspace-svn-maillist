<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openspace-svn] r231 - in branches/mloskot-style-refactoring: . src src/plugins/filelist
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openspace-svn/2005-November/index.html" >
   <LINK REL="made" HREF="mailto:openspace-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenspace-svn%5D%20r231%20-%20in%20branches/mloskot-style-refactoring%3A%20.%20src%20src/plugins/filelist&In-Reply-To=%3C200511112157.jABLvtQi004257%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000011.html">
   <LINK REL="Next"  HREF="000013.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openspace-svn] r231 - in branches/mloskot-style-refactoring: . src src/plugins/filelist</H1>
    <B>mloskot at berlios.de</B> 
    <A HREF="mailto:openspace-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenspace-svn%5D%20r231%20-%20in%20branches/mloskot-style-refactoring%3A%20.%20src%20src/plugins/filelist&In-Reply-To=%3C200511112157.jABLvtQi004257%40sheep.berlios.de%3E"
       TITLE="[Openspace-svn] r231 - in branches/mloskot-style-refactoring: . src src/plugins/filelist">mloskot at berlios.de
       </A><BR>
    <I>Fri Nov 11 22:57:55 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000011.html">[Openspace-svn] r230 - tags
</A></li>
        <LI>Next message: <A HREF="000013.html">[Openspace-svn] r232 - in branches/mloskot-style-refactoring/src: . plugins plugins/cmddialog plugins/filelist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12">[ date ]</a>
              <a href="thread.html#12">[ thread ]</a>
              <a href="subject.html#12">[ subject ]</a>
              <a href="author.html#12">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mloskot
Date: 2005-11-11 22:57:36 +0100 (Fri, 11 Nov 2005)
New Revision: 231

Modified:
   branches/mloskot-style-refactoring/aclocal.m4
   branches/mloskot-style-refactoring/config.guess
   branches/mloskot-style-refactoring/config.sub
   branches/mloskot-style-refactoring/configure
   branches/mloskot-style-refactoring/ltmain.sh
   branches/mloskot-style-refactoring/src/Makefile
   branches/mloskot-style-refactoring/src/OSVirtualFileSystemBase.h
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_scp.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h
   branches/mloskot-style-refactoring/src/plugins/filelist/pftp.h
Log:
filelist plugin renaming continuation - STILL DOES NOT COMPILE

Modified: branches/mloskot-style-refactoring/aclocal.m4
===================================================================
--- branches/mloskot-style-refactoring/aclocal.m4	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/aclocal.m4	2005-11-11 21:57:36 UTC (rev 231)
@@ -14,6 +14,7 @@
 # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-
 
 # serial 47 AC_PROG_LIBTOOL
+# Debian $Rev: 214 $
 
 
 # AC_PROVIDE_IFELSE(MACRO-NAME, IF-PROVIDED, IF-NOT-PROVIDED)
@@ -123,7 +124,7 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e 1s/^X//'
+Xsed='sed -e s/^X//'
 [sed_quote_subst='s/\([\\&quot;\\`$\\\\]\)/\\\1/g']
 
 # Same as above, but do not quote variable references.
@@ -191,8 +192,6 @@
   old_archive_cmds=&quot;$old_archive_cmds~\$RANLIB \$oldlib&quot;
 fi
 
-_LT_CC_BASENAME([$compiler])
-
 # Only perform the check for file, if the check method requires it
 case $deplibs_check_method in
 file_magic*)
@@ -218,14 +217,6 @@
     [pic_mode=default])
 test -z &quot;$pic_mode&quot; &amp;&amp; pic_mode=default
 
-# Check if we have a version mismatch between libtool.m4 and ltmain.sh.
-#
-# Note:  This should be in AC_LIBTOOL_SETUP, _after_ $ltmain have been defined.
-#        We also should do it _before_ AC_LIBTOOL_LANG_C_CONFIG that actually
-#        calls AC_LIBTOOL_CONFIG and creates libtool.
-#
-_LT_VERSION_CHECK
-
 # Use C for the default configuration in the libtool script
 tagname=
 AC_LIBTOOL_LANG_C_CONFIG
@@ -233,41 +224,6 @@
 ])# AC_LIBTOOL_SETUP
 
 
-# _LT_VERSION_CHECK
-# -----------------
-AC_DEFUN([_LT_VERSION_CHECK],
-[AC_MSG_CHECKING([for correct ltmain.sh version])
-if test -z &quot;$ltmain&quot;; then
-  AC_MSG_RESULT(no)
-  echo
-  echo &quot;*** [Gentoo] sanity check failed! ***&quot;
-  echo &quot;*** \$ltmain is not defined, please check the patch for consistency! ***&quot;
-  echo
-  exit 1
-fi
-gentoo_lt_version=&quot;1.5.18&quot;
-gentoo_ltmain_version=`grep '^[[:space:]]*VERSION=' $ltmain | sed -e 's|^[[:space:]]*VERSION=||'`
-if test &quot;$gentoo_lt_version&quot; != &quot;$gentoo_ltmain_version&quot;; then
-  AC_MSG_RESULT(no)
-  echo
-  echo &quot;*** [Gentoo] sanity check failed! ***&quot;
-  echo &quot;*** libtool.m4 and ltmain.sh have a version mismatch! ***&quot;
-  echo &quot;*** (libtool.m4 = $gentoo_lt_version, ltmain.sh = $gentoo_ltmain_version) ***&quot;
-  echo
-  echo &quot;Please run:&quot;
-  echo
-  echo &quot;  libtoolize --copy --force&quot;
-  echo
-  echo &quot;if appropriate, please contact the maintainer of this&quot;
-  echo &quot;package (or your distribution) for help.&quot;
-  echo
-  exit 1
-else
-  AC_MSG_RESULT(yes)
-fi
-])# _LT_VERSION_CHECK
-
-
 # _LT_AC_SYS_COMPILER
 # -------------------
 AC_DEFUN([_LT_AC_SYS_COMPILER],
@@ -281,48 +237,6 @@
 ])# _LT_AC_SYS_COMPILER
 
 
-# _LT_CC_BASENAME(CC)
-# -------------------
-# Calculate cc_basename.  Skip known compiler wrappers and cross-prefix.
-AC_DEFUN([_LT_CC_BASENAME],
-[for cc_temp in $1&quot;&quot;; do
-  case $cc_temp in
-    compile | *[[\\/]]compile | ccache | *[[\\/]]ccache ) ;;
-    distcc | *[[\\/]]distcc | purify | *[[\\/]]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
-])
-
-
-# _LT_COMPILER_BOILERPLATE
-# ------------------------
-# Check for compiler boilerplate output or warnings with
-# the simple compiler test code.
-AC_DEFUN([_LT_COMPILER_BOILERPLATE],
-[ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-])# _LT_COMPILER_BOILERPLATE
-
-
-# _LT_LINKER_BOILERPLATE
-# ----------------------
-# Check for linker boilerplate output or warnings with
-# the simple link test code.
-AC_DEFUN([_LT_LINKER_BOILERPLATE],
-[ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-])# _LT_LINKER_BOILERPLATE
-
-
 # _LT_AC_SYS_LIBPATH_AIX
 # ----------------------
 # Links a minimal program and checks the executable
@@ -395,7 +309,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-(unset CDPATH) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; unset CDPATH
+if test &quot;X${CDPATH+set}&quot; = Xset; then CDPATH=:; export CDPATH; fi
 
 if test -z &quot;$ECHO&quot;; then
 if test &quot;X${echo_test_string+set}&quot; != Xset; then
@@ -610,20 +524,6 @@
   rm -rf conftest*
   ;;
 
-*-*-linux*)
-  # Test if the compiler is 64bit
-  echo 'int i;' &gt; conftest.$ac_ext
-  lt_cv_cc_64bit_output=no
-  if AC_TRY_EVAL(ac_compile); then
-    case `/usr/bin/file conftest.$ac_objext` in
-    *&quot;ELF 64&quot;*)
-      lt_cv_cc_64bit_output=yes
-      ;;
-    esac
-  fi
-  rm -rf conftest*
-  ;;
-  
 *-*-sco3.2v5*)
   # On SCO OpenServer 5, we need -belf to get full-featured binaries.
   SAVE_CFLAGS=&quot;$CFLAGS&quot;
@@ -678,10 +578,8 @@
    echo &quot;$as_me:__oline__: \$? = $ac_status&quot; &gt;&amp;AS_MESSAGE_LOG_FD
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        $2=yes
      fi
    fi
@@ -712,11 +610,6 @@
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1&gt;&amp;AS_MESSAGE_LOG_FD
-       $echo &quot;X$_lt_linker_boilerplate&quot; | $Xsed &gt; conftest.exp
-       $SED '/^$/d' conftest.err &gt;conftest.er2
-       if diff conftest.exp conftest.er2 &gt;/dev/null; then
-         $2=yes
-       fi
      else
        $2=yes
      fi
@@ -775,38 +668,11 @@
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
-  netbsd* | freebsd* | openbsd* | darwin* | dragonfly*)
-    # This has been around since 386BSD, at least.  Likely further.
-    if test -x /sbin/sysctl; then
-      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
-    elif test -x /usr/sbin/sysctl; then
-      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
-    else
-      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
-    fi
-    # And add a safety zone
-    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    ;;
-  osf*)
-    # Dr. Hans Ekkehard Plesser reports seeing a kernel panic running configure
-    # due to this test when exec_disable_arg_limit is 1 on Tru64. It is not
-    # nice to cause kernel panics so lets avoid the loop below.
-    # First set a reasonable default.
-    lt_cv_sys_max_cmd_len=16384
-    # 
-    if test -x /sbin/sysconfig; then
-      case `/sbin/sysconfig -q proc exec_disable_arg_limit` in
-        *1*) lt_cv_sys_max_cmd_len=-1 ;;
-      esac
-    fi
-    ;;
-  *)
+ *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
     # we can't tell.
-    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-    while (test &quot;X&quot;`$SHELL [$]0 --fallback-echo &quot;X$teststring&quot; 2&gt;/dev/null` \
+    while (test &quot;X&quot;`$CONFIG_SHELL [$]0 --fallback-echo &quot;X$teststring&quot; 2&gt;/dev/null` \
 	       = &quot;XX$teststring&quot;) &gt;/dev/null 2&gt;&amp;1 &amp;&amp;
 	    new_result=`expr &quot;X$teststring&quot; : &quot;.*&quot; 2&gt;&amp;1` &amp;&amp;
 	    lt_cv_sys_max_cmd_len=$new_result &amp;&amp;
@@ -1072,9 +938,7 @@
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt; out/conftest.exp
-     $SED '/^$/d' out/conftest.err &gt;out/conftest.er2
-     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 &gt;/dev/null; then
+     if test ! -s out/conftest.err; then
        _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes
      fi
    fi
@@ -1142,8 +1006,8 @@
 [AC_MSG_CHECKING([how to hardcode library paths into programs])
 _LT_AC_TAGVAR(hardcode_action, $1)=
 if test -n &quot;$_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)&quot; || \
-   test -n &quot;$_LT_AC_TAGVAR(runpath_var, $1)&quot; || \
-   test &quot;X$_LT_AC_TAGVAR(hardcode_automatic, $1)&quot; = &quot;Xyes&quot; ; then
+   test -n &quot;$_LT_AC_TAGVAR(runpath_var $1)&quot; || \
+   test &quot;X$_LT_AC_TAGVAR(hardcode_automatic, $1)&quot;=&quot;Xyes&quot; ; then
 
   # We can hardcode non-existant directories.
   if test &quot;$_LT_AC_TAGVAR(hardcode_direct, $1)&quot; != no &amp;&amp;
@@ -1310,7 +1174,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi[[45]]*)
+bsdi4*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -1368,35 +1232,11 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
-  linux*)
-    if $LD --help 2&gt;&amp;1 | egrep ': supported targets:.* elf' &gt; /dev/null; then
-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      supports_anon_versioning=no
-      case `$LD -v 2&gt;/dev/null` in
-        *\ [01].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        $archive_expsym_cmds=&quot;$archive_cmds&quot;
-      fi
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -1450,9 +1290,7 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd* | dragonfly*)
-  # DragonFly does not have aout.  When/if they implement a new
-  # versioning mechanism, adjust this.
+freebsd*)
   objformat=`test -x /usr/bin/objformat &amp;&amp; /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -1471,7 +1309,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[[01]]* | freebsdelf3.[[01]]*)
+  freebsd3.[01]* | freebsdelf3.[01]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -1597,17 +1435,10 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf(&quot;cd /etc; cat %s&quot;, \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' &lt; /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`$SED -e 's/[:,\t]/ /g;s/=[^=]*$//;s/=[^= ]* / /g' /etc/ld.so.conf | tr '\n' ' '`
     sys_lib_dlsearch_path_spec=&quot;/lib /usr/lib $lt_ld_extra&quot;
   fi
 
-  case $host_cpu:$lt_cv_cc_64bit_output in
-  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
-    sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64 /usr/X11R6/lib64&quot;
-    sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64&quot;
-    ;;
-  esac
-
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -1615,26 +1446,18 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
+  ;;
 
-  # Find out which ABI we are using (multilib Linux x86_64 hack).
-  libsuff=
-  case &quot;$host_cpu&quot; in
-  x86_64*)
-    echo '[#]line __oline__ &quot;configure&quot;' &gt; conftest.$ac_ext
-    if AC_TRY_EVAL(ac_compile); then
-      case `/usr/bin/file conftest.$ac_objext` in
-      *64-bit*)
-        libsuff=64
-        ;;
-      esac
-    fi
-    rm -rf conftest*
-    ;;
-  *)
-    ;;
-  esac
-  sys_lib_dlsearch_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff}&quot;
-  sys_lib_search_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}&quot;
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
   ;;
 
 knetbsd*-gnu)
@@ -1687,11 +1510,7 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
-  case $host_os in
-    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
-    *)                         need_version=no  ;;
-  esac
+  need_version=yes
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH=&quot;\$PATH:/sbin&quot; ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -1857,9 +1676,7 @@
 
       case $tagname in
       CXX)
-	if test -n &quot;$CXX&quot; &amp;&amp; ( test &quot;X$CXX&quot; != &quot;Xno&quot; &amp;&amp;
-	    ( (test &quot;X$CXX&quot; = &quot;Xg++&quot; &amp;&amp; `g++ -v &gt;/dev/null 2&gt;&amp;1` ) ||
-	    (test &quot;X$CXX&quot; != &quot;Xg++&quot;))) ; then
+	if test -n &quot;$CXX&quot; &amp;&amp; test &quot;X$CXX&quot; != &quot;Xno&quot;; then
 	  AC_LIBTOOL_LANG_CXX_CONFIG
 	else
 	  tagname=&quot;&quot;
@@ -2264,15 +2081,6 @@
 *) reload_flag=&quot; $reload_flag&quot; ;;
 esac
 reload_cmds='$LD$reload_flag -o $output$reload_objs'
-case $host_os in
-  darwin*)
-    if test &quot;$GCC&quot; = yes; then
-      reload_cmds='$CC -nostdlib ${wl}-r -o $output$reload_objs'
-    else
-      reload_cmds='$LD$reload_flag -o $output$reload_objs'
-    fi
-    ;;
-esac
 ])# AC_PROG_LD_RELOAD_FLAG
 
 
@@ -2306,7 +2114,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-bsdi[[45]]*)
+bsdi4*)
   lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (shared object|dynamic lib)'
   lt_cv_file_magic_cmd='/usr/bin/file -L'
   lt_cv_file_magic_test_file=/shlib/libc.so
@@ -2329,13 +2137,13 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-freebsd* | kfreebsd*-gnu | dragonfly*)
+freebsd* | kfreebsd*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ &gt; /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
       # Let's accept both of them until this is cleared up.
-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD|DragonFly)/i[[3-9]]86 (compact )?demand paged shared library'
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[[3-9]]86 (compact )?demand paged shared library'
       lt_cv_file_magic_cmd=/usr/bin/file
       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
       ;;
@@ -2382,7 +2190,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd*)
+netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ &gt; /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
@@ -2401,10 +2209,12 @@
   ;;
 
 openbsd*)
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
   if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
-    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|\.so|_pic\.a)$'
+    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB shared object'
   else
-    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
+    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
   fi
   ;;
 
@@ -2594,21 +2404,10 @@
 # ---------------
 AC_DEFUN([_LT_AC_LANG_CXX],
 [AC_REQUIRE([AC_PROG_CXX])
-AC_REQUIRE([_LT_AC_PROG_CXXCPP])
+AC_REQUIRE([AC_PROG_CXXCPP])
 _LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}CXX])
 ])# _LT_AC_LANG_CXX
 
-# _LT_AC_PROG_CXXCPP
-# ---------------
-AC_DEFUN([_LT_AC_PROG_CXXCPP],
-[
-AC_REQUIRE([AC_PROG_CXX])
-if test -n &quot;$CXX&quot; &amp;&amp; ( test &quot;X$CXX&quot; != &quot;Xno&quot; &amp;&amp;
-    ( (test &quot;X$CXX&quot; = &quot;Xg++&quot; &amp;&amp; `g++ -v &gt;/dev/null 2&gt;&amp;1` ) ||
-    (test &quot;X$CXX&quot; != &quot;Xg++&quot;))) ; then
-  AC_PROG_CXXCPP
-fi
-])# _LT_AC_PROG_CXXCPP
 
 # AC_LIBTOOL_F77
 # --------------
@@ -2681,10 +2480,6 @@
 
 _LT_AC_SYS_COMPILER
 
-# save warnings/boilerplate of simple test code
-_LT_COMPILER_BOILERPLATE
-_LT_LINKER_BOILERPLATE
-
 #
 # Check for any special shared library compilation flags.
 #
@@ -2748,6 +2543,43 @@
   if test &quot;$host_cpu&quot; != ia64 &amp;&amp; test &quot;$aix_use_runtimelinking&quot; = no ; then
     test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
   fi
+  ;;
+  darwin* | rhapsody*)
+  if test &quot;$GCC&quot; = yes; then
+    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+    case &quot;$host_os&quot; in
+    rhapsody* | darwin1.[[012]])
+      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[[012]])
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+      ;;
+    esac
+    output_verbose_link_cmd='echo'
+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'
+    _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+    _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    _LT_AC_TAGVAR(hardcode_direct, $1)=no
+    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
+    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
+    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
+  else
+    _LT_AC_TAGVAR(ld_shlibs, $1)=no
+  fi
     ;;
 esac
 AC_MSG_RESULT([$enable_shared])
@@ -2773,7 +2605,7 @@
 AC_DEFUN([_LT_AC_LANG_CXX_CONFIG],
 [AC_LANG_PUSH(C++)
 AC_REQUIRE([AC_PROG_CXX])
-AC_REQUIRE([_LT_AC_PROG_CXXCPP])
+AC_REQUIRE([AC_PROG_CXXCPP])
 
 _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
 _LT_AC_TAGVAR(allow_undefined_flag, $1)=
@@ -2817,10 +2649,6 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
-# save warnings/boilerplate of simple test code
-_LT_COMPILER_BOILERPLATE
-_LT_LINKER_BOILERPLATE
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=$CC
 lt_save_LD=$LD
@@ -2842,7 +2670,7 @@
 CC=${CXX-&quot;c++&quot;}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-_LT_CC_BASENAME([$compiler])
+cc_basename=`$echo X&quot;$compiler&quot; | $Xsed -e 's%^.*/%%'`
 
 # We don't want -fno-exception wen compiling C++ code, so set the
 # no_builtin_flag separately
@@ -2949,7 +2777,7 @@
     _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
     if test &quot;$GXX&quot; = yes; then
-      case $host_os in aix4.[[012]]|aix4.[[012]].*)
+      case $host_os in aix4.[012]|aix4.[012].*)
       # We only want to do this on AIX 4.2 and lower, the check
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
@@ -2970,9 +2798,6 @@
 	fi
       esac
       shared_flag='-shared'
-      if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-      fi
     else
       # not using gcc
       if test &quot;$host_cpu&quot; = ia64; then
@@ -3032,7 +2857,6 @@
     esac
     ;;
 
-
   cygwin* | mingw* | pw32*)
     # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1) is actually meaningless,
     # as there is no search path for DLLs.
@@ -3056,76 +2880,65 @@
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
     fi
   ;;
-      darwin* | rhapsody*)
-        case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[[012]])
-         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[[012]])
-               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
-        esac
-      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
-      _LT_AC_TAGVAR(hardcode_direct, $1)=no
-      _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
-      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''
-      _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
-    if test &quot;$GXX&quot; = yes ; then
-      lt_int_apple_cc_single_mod=no
-      output_verbose_link_cmd='echo'
-      if $CC -dumpspecs 2&gt;&amp;1 | $EGREP 'single_module' &gt;/dev/null ; then
-       lt_int_apple_cc_single_mod=yes
-      fi
-      if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
-       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+  darwin* | rhapsody*)
+  if test &quot;$GXX&quot; = yes; then
+    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+    case &quot;$host_os&quot; in
+    rhapsody* | darwin1.[[012]])
+      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
       else
-          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-        fi
-        _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-        # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-          if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
-            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          else
-            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          fi
-            _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-          _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         _LT_AC_TAGVAR(ld_shlibs, $1)=no
-          ;;
-      esac
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[[012]])
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
+            ;;
+        esac
       fi
-        ;;
+      ;;
+    esac
+    lt_int_apple_cc_single_mod=no
+    output_verbose_link_cmd='echo'
+    if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+      lt_int_apple_cc_single_mod=yes
+    fi
+    if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    else
+      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    fi
+    _LT_AC_TAGVAR(module_cmds, $1)='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
 
+    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+    if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    else
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    fi
+    _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    _LT_AC_TAGVAR(hardcode_direct, $1)=no
+    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
+    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
+    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
+  else
+    _LT_AC_TAGVAR(ld_shlibs, $1)=no
+  fi
+    ;;
+
   dgux*)
     case $cc_basename in
-      ec++*)
+      ec++)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      ghcx*)
+      ghcx)
 	# Green Hills C++ Compiler
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -3136,14 +2949,14 @@
 	;;
     esac
     ;;
-  freebsd[[12]]*)
+  freebsd[12]*)
     # C++ shared libraries reported to be fairly broken before switch to ELF
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
   freebsd-elf*)
     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
     ;;
-  freebsd* | kfreebsd*-gnu | dragonfly*)
+  freebsd* | kfreebsd*-gnu)
     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
     # conventions
     _LT_AC_TAGVAR(ld_shlibs, $1)=yes
@@ -3160,11 +2973,11 @@
 				# location of the library.
 
     case $cc_basename in
-    CC*)
+    CC)
       # FIXME: insert proper C++ library support
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
       ;;
-    aCC*)
+    aCC)
       _LT_AC_TAGVAR(archive_cmds, $1)='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
       # Commands to make compiler produce verbose output that lists
       # what &quot;hidden&quot; libraries, object files and flags are used when
@@ -3174,7 +2987,7 @@
       # explicitly linking system object files so we need to strip them
       # from the output so that they don't get included in the library
       # dependencies.
-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2&gt;&amp;1) | grep &quot;[[-]]L&quot;`; list=&quot;&quot;; for z in $templist; do case $z in conftest.$objext) list=&quot;$list $z&quot;;; *.$objext);; *) list=&quot;$list $z&quot;;;esac; done; echo $list'
+      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2&gt;&amp;1) | grep &quot;[-]L&quot;`; list=&quot;&quot;; for z in $templist; do case $z in conftest.$objext) list=&quot;$list $z&quot;;; *.$objext);; *) list=&quot;$list $z&quot;;;esac; done; echo $list'
       ;;
     *)
       if test &quot;$GXX&quot; = yes; then
@@ -3225,11 +3038,11 @@
     esac
 
     case $cc_basename in
-      CC*)
+      CC)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      aCC*)
+      aCC)
 	case &quot;$host_cpu&quot; in
 	hppa*64*|ia64*)
 	  _LT_AC_TAGVAR(archive_cmds, $1)='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
@@ -3269,9 +3082,9 @@
     ;;
   irix5* | irix6*)
     case $cc_basename in
-      CC*)
+      CC)
 	# SGI C++
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 
 	# Archives containing C++ object files must be created using
 	# &quot;CC -ar&quot;, where &quot;CC&quot; is the IRIX C++ compiler.  This is
@@ -3282,7 +3095,7 @@
       *)
 	if test &quot;$GXX&quot; = yes; then
 	  if test &quot;$with_gnu_ld&quot; = no; then
-	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 	  else
 	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` -o $lib'
 	  fi
@@ -3295,7 +3108,7 @@
     ;;
   linux*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3320,41 +3133,17 @@
 	# &quot;CC -Bstatic&quot;, where &quot;CC&quot; is the KAI C++ compiler.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'
 	;;
-      icpc*)
+      icpc)
 	# Intel C++
 	with_gnu_ld=yes
-	# version 8.0 and above of icpc choke on multiply defined symbols
-	# if we add $predep_objects and $postdep_objects, however 7.1 and
-	# earlier do not add the objects themselves.
-	case `$CC -V 2&gt;&amp;1` in
-	*&quot;Version 7.&quot;*)
-  	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-  	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-	  ;;
-	*)  # Version 8.0 or newer
-	  tmp_idyn=
-	  case $host_cpu in
-	    ia64*) tmp_idyn=' -i_dynamic';;
-	  esac
-  	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'&quot;$tmp_idyn&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared'&quot;$tmp_idyn&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-	  ;;
-	esac
 	_LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
 	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive$convenience ${wl}--no-whole-archive'
 	;;
-      pgCC*)
-        # Portland Group C++ compiler
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname -o $lib'
-  	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname ${wl}-retain-symbols-file ${wl}$export_symbols -o $lib'
-
-	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
-	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
-	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-        ;;
-      cxx*)
+      cxx)
 	# Compaq C++
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'
@@ -3385,7 +3174,7 @@
     ;;
   mvs*)
     case $cc_basename in
-      cxx*)
+      cxx)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
@@ -3395,7 +3184,7 @@
 	;;
     esac
     ;;
-  netbsd*)
+  netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
     if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
       _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -3406,25 +3195,9 @@
     # Workaround some broken pre-1.5 toolchains
     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2&gt;&amp;1 | grep conftest.$objext | $SED -e &quot;s:-lgcc -lc -lgcc::&quot;'
     ;;
-  openbsd2*)
-    # C++ shared libraries are fairly broken
-    _LT_AC_TAGVAR(ld_shlibs, $1)=no
-    ;;
-  openbsd*)
-    _LT_AC_TAGVAR(hardcode_direct, $1)=yes
-    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
-    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-    if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
-      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-    fi
-    output_verbose_link_cmd='echo'
-    ;;
   osf3*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3440,14 +3213,14 @@
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'
 
 	;;
-      RCC*)
+      RCC)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      cxx*)
+      cxx)
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	_LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3465,7 +3238,7 @@
       *)
 	if test &quot;$GXX&quot; = yes &amp;&amp; test &quot;$with_gnu_ld&quot; = no; then
 	  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3484,7 +3257,7 @@
     ;;
   osf4* | osf5*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3499,17 +3272,17 @@
 	# the KAI C++ compiler.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -o $oldlib $oldobjs'
 	;;
-      RCC*)
+      RCC)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      cxx*)
+      cxx)
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \*'
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done~
 	  echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version	$verstring` -update_registry ${output_objdir}/so_locations -o $lib~
+	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version	$verstring` -update_registry $objdir/so_locations -o $lib~
 	  $rm $lib.exp'
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'
@@ -3528,7 +3301,7 @@
       *)
 	if test &quot;$GXX&quot; = yes &amp;&amp; test &quot;$with_gnu_ld&quot; = no; then
 	  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	 _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	 _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3552,7 +3325,7 @@
   sco*)
     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
     case $cc_basename in
-      CC*)
+      CC)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
@@ -3564,12 +3337,12 @@
     ;;
   sunos4*)
     case $cc_basename in
-      CC*)
+      CC)
 	# Sun C++ 4.x
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      lcc*)
+      lcc)
 	# Lucid
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -3582,7 +3355,7 @@
     ;;
   solaris*)
     case $cc_basename in
-      CC*)
+      CC)
 	# Sun C++ 4.2, 5.x and Centerline C++
 	_LT_AC_TAGVAR(no_undefined_flag, $1)=' -zdefs'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
@@ -3592,17 +3365,13 @@
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
 	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
 	case $host_os in
-	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
+	  solaris2.[0-5] | solaris2.[0-5].*) ;;
 	  *)
 	    # The C++ compiler is used as linker so we must use $wl
 	    # flag to pass the commands to the underlying system
-	    # linker. We must also pass each convience library through
-	    # to the system linker between allextract/defaultextract.
-	    # The C++ compiler will combine linker options so we
-	    # cannot just pass the convience library names through
-	    # without $wl.
+	    # linker.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract'
+	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=yes
@@ -3623,7 +3392,7 @@
 	# in the archive.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -xar -o $oldlib $oldobjs'
 	;;
-      gcx*)
+      gcx)
 	# Green Hills C++ Compiler
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 
@@ -3666,7 +3435,7 @@
     ;;
   tandem*)
     case $cc_basename in
-      NCC*)
+      NCC)
 	# NonStop-UX NCC 3.20
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -3898,16 +3667,12 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
-# save warnings/boilerplate of simple test code
-_LT_COMPILER_BOILERPLATE
-_LT_LINKER_BOILERPLATE
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${F77-&quot;f77&quot;}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-_LT_CC_BASENAME([$compiler])
+cc_basename=`$echo X&quot;$compiler&quot; | $Xsed -e 's%^.*/%%'`
 
 AC_MSG_CHECKING([if libtool supports shared libraries])
 AC_MSG_RESULT([$can_build_shared])
@@ -3926,9 +3691,7 @@
   fi
   ;;
 aix4* | aix5*)
-  if test &quot;$host_cpu&quot; != ia64 &amp;&amp; test &quot;$aix_use_runtimelinking&quot; = no ; then
-    test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
-  fi
+  test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
   ;;
 esac
 AC_MSG_RESULT([$enable_shared])
@@ -3979,27 +3742,20 @@
 lt_simple_compile_test_code=&quot;class foo {}\n&quot;
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }\n'
+lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
-# save warnings/boilerplate of simple test code
-_LT_COMPILER_BOILERPLATE
-_LT_LINKER_BOILERPLATE
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${GCJ-&quot;gcj&quot;}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-_LT_CC_BASENAME([$compiler])
 
 # GCJ did not exist at the time GCC didn't implicitly link libc in.
 _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
 
-_LT_AC_TAGVAR(old_archive_cmds, $1)=$old_archive_cmds
-
 AC_LIBTOOL_PROG_COMPILER_NO_RTTI($1)
 AC_LIBTOOL_PROG_COMPILER_PIC($1)
 AC_LIBTOOL_PROG_CC_C_O($1)
@@ -4042,16 +3798,11 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
-# save warnings/boilerplate of simple test code
-_LT_COMPILER_BOILERPLATE
-_LT_LINKER_BOILERPLATE
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${RC-&quot;windres&quot;}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-_LT_CC_BASENAME([$compiler])
 _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes
 
 AC_LIBTOOL_CONFIG($1)
@@ -4187,7 +3938,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -4198,11 +3949,11 @@
 SED=$lt_SED
 
 # Sed that helps us avoid accidentally triggering echo(1) options like -n.
-Xsed=&quot;$SED -e 1s/^X//&quot;
+Xsed=&quot;$SED -e s/^X//&quot;
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-(unset CDPATH) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; unset CDPATH
+if test &quot;X\${CDPATH+set}&quot; = Xset; then CDPATH=:; export CDPATH; fi
 
 # The names of the tagged configurations supported by this script.
 available_tags=
@@ -4233,13 +3984,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -4315,7 +4060,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_[]_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -4589,6 +4334,9 @@
 # Regexp to match symbols that can be accessed directly from C.
 sympat='\([[_A-Za-z]][[_A-Za-z0-9]]*\)'
 
+# Transform the above into a raw symbol and a C symbol.
+symxfrm='\1 \2\3 \3'
+
 # Transform an extracted symbol line into a proper C declaration
 lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^. .* \(.*\)$/extern int \1;/p'&quot;
 
@@ -4610,13 +4358,6 @@
   lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'&quot;
   lt_cv_sys_global_symbol_to_c_name_address=&quot;sed -n -e 's/^: \([[^ ]]*\) $/  {\\\&quot;\1\\\&quot;, (lt_ptr) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\&quot;\2\&quot;, (lt_ptr) \&amp;\2},/p'&quot;
   ;;
-linux*)
-  if test &quot;$host_cpu&quot; = ia64; then
-    symcode='[[ABCDGIRSTW]]'
-    lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'&quot;
-    lt_cv_sys_global_symbol_to_c_name_address=&quot;sed -n -e 's/^: \([[^ ]]*\) $/  {\\\&quot;\1\\\&quot;, (lt_ptr) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\&quot;\2\&quot;, (lt_ptr) \&amp;\2},/p'&quot;
-  fi
-  ;;
 irix* | nonstopux*)
   symcode='[[BCDEGRST]]'
   ;;
@@ -4648,11 +4389,8 @@
 # Try without a prefix undercore, then with it.
 for ac_symprfx in &quot;&quot; &quot;_&quot;; do
 
-  # Transform symcode, sympat, and symprfx into a raw symbol and a C symbol.
-  symxfrm=&quot;\\1 $ac_symprfx\\2 \\2&quot;
-
   # Write the raw and C identifiers.
-  lt_cv_sys_global_symbol_pipe=&quot;sed -n -e 's/^.*[[ 	]]\($symcode$symcode*\)[[ 	]][[ 	]]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'&quot;
+  lt_cv_sys_global_symbol_pipe=&quot;sed -n -e 's/^.*[[ 	]]\($symcode$symcode*\)[[ 	]][[ 	]]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'&quot;
 
   # Check to see that the pipe works correctly.
   pipe_works=no
@@ -4841,28 +4579,18 @@
 	;;
       chorus*)
 	case $cc_basename in
-	cxch68*)
+	cxch68)
 	  # Green Hills C++ Compiler
 	  # _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=&quot;--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a&quot;
 	  ;;
 	esac
 	;;
-       darwin*)
-         # PIC is the default on this platform
-         # Common symbols not allowed in MH_DYLIB files
-         case $cc_basename in
-           xlc*)
-           _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
-           _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-           ;;
-         esac
-       ;;
       dgux*)
 	case $cc_basename in
-	  ec++*)
+	  ec++)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    ;;
-	  ghcx*)
+	  ghcx)
 	    # Green Hills C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
@@ -4870,19 +4598,19 @@
 	    ;;
 	esac
 	;;
-      freebsd* | kfreebsd*-gnu | dragonfly*)
+      freebsd* | kfreebsd*-gnu)
 	# FreeBSD uses GNU C++
 	;;
       hpux9* | hpux10* | hpux11*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=&quot;${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive&quot;
 	    if test &quot;$host_cpu&quot; != ia64; then
 	      _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='+Z'
 	    fi
 	    ;;
-	  aCC*)
+	  aCC)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=&quot;${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive&quot;
 	    case &quot;$host_cpu&quot; in
@@ -4900,7 +4628,7 @@
 	;;
       irix5* | irix6* | nonstopux*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
 	    # CC pic flag -KPIC is the default.
@@ -4911,24 +4639,18 @@
 	;;
       linux*)
 	case $cc_basename in
-	  KCC*)
+	  KCC)
 	    # KAI C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'
 	    ;;
-	  icpc* | ecpc*)
+	  icpc)
 	    # Intel C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
 	    ;;
-	  pgCC*)
-	    # Portland Group C++ compiler.
-	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'
-	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
-	    ;;
-	  cxx*)
+	  cxx)
 	    # Compaq C++
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
@@ -4945,25 +4667,25 @@
 	;;
       mvs*)
 	case $cc_basename in
-	  cxx*)
+	  cxx)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-W c,exportall'
 	    ;;
 	  *)
 	    ;;
 	esac
 	;;
-      netbsd*)
+      netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
-	  KCC*)
+	  KCC)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'
 	    ;;
-	  RCC*)
+	  RCC)
 	    # Rational C++ 2.4.1
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
-	  cxx*)
+	  cxx)
 	    # Digital/Compaq C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
@@ -4979,7 +4701,7 @@
 	;;
       sco*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'
 	    ;;
 	  *)
@@ -4988,13 +4710,13 @@
 	;;
       solaris*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    # Sun C++ 4.2, 5.x and Centerline C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld '
 	    ;;
-	  gcx*)
+	  gcx)
 	    # Green Hills C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-PIC'
 	    ;;
@@ -5004,12 +4726,12 @@
 	;;
       sunos4*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    # Sun C++ 4.x
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
 	    ;;
-	  lcc*)
+	  lcc)
 	    # Lucid
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
@@ -5019,7 +4741,7 @@
 	;;
       tandem*)
 	case $cc_basename in
-	  NCC*)
+	  NCC)
 	    # NonStop-UX NCC 3.20
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    ;;
@@ -5116,16 +4838,6 @@
 	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
-      darwin*)
-        # PIC is the default on this platform
-        # Common symbols not allowed in MH_DYLIB files
-       case $cc_basename in
-         xlc*)
-         _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
-         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-         ;;
-       esac
-       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -5161,19 +4873,12 @@
       ;;
 
     linux*)
-      case $cc_basename in
+      case $CC in
       icc* | ecc*)
 	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
         ;;
-      pgcc* | pgf77* | pgf90*)
-        # Portland Group compilers (*not* the Pentium gcc compiler,
-	# which looks to be a dead project)
-	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'
-	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
-        ;;
       ccc*)
         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
         # All Alpha code is PIC.
@@ -5194,14 +4899,9 @@
       ;;
 
     solaris*)
+      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-      case $cc_basename in
-      f77* | f90* | f95*)
-	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld ';;
-      *)
-	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,';;
-      esac
       ;;
 
     sunos4*)
@@ -5223,11 +4923,6 @@
       fi
       ;;
 
-    unicos*)
-      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-      _LT_AC_TAGVAR(lt_prog_compiler_can_build_shared, $1)=no
-      ;;
-
     uts4*)
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
@@ -5288,8 +4983,11 @@
     _LT_AC_TAGVAR(export_symbols_cmds, $1)=&quot;$ltdll_cmds&quot;
   ;;
   cygwin* | mingw*)
-    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([[^ ]]*\) [[^ ]]*/\1 DATA/;/^I /d;/^[[AITW]] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
   ;;
+  linux*)
+    _LT_AC_TAGVAR(link_all_deplibs, $1)=no
+  ;;
   *)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq &gt; $export_symbols'
   ;;
@@ -5331,8 +5029,7 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
-  # Just being paranoid about ensuring that cc_basename is set.
-  _LT_CC_BASENAME([$compiler])
+
   case $host_os in
   cygwin* | mingw* | pw32*)
     # FIXME: the MSVC++ port hasn't been tested in a loooong time
@@ -5351,28 +5048,7 @@
   if test &quot;$with_gnu_ld&quot; = yes; then
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
-    
-    # Set some defaults for GNU ld with shared library support. These
-    # are reset later if shared libraries are not supported. Putting them
-    # here allows them to be overridden if necessary.
-    runpath_var=LD_RUN_PATH
-    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
-    _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
-    # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
-	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-      else
-  	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
-    fi
-    supports_anon_versioning=no
-    case `$LD -v 2&gt;/dev/null` in
-      *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-      *\ 2.11.*) ;; # other 2.11 versions
-      *) supports_anon_versioning=yes ;;
-    esac
-    
+
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -5423,7 +5099,7 @@
       _LT_AC_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_AC_TAGVAR(always_export_symbols, $1)=no
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
 
       if $LD --help 2&gt;&amp;1 | grep 'auto-import' &gt; /dev/null; then
         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -5437,42 +5113,11 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	_LT_AC_TAGVAR(ld_shlibs, $1)=no
+	ld_shlibs=no
       fi
       ;;
 
-    linux*)
-      if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
-	tmp_addflag=
-	case $cc_basename,$host_cpu in
-	pgcc*)				# Portland Group C compiler
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag'
-	  ;;
-	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag -Mnomain' ;;
-	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
-	  tmp_addflag=' -i_dynamic' ;;
-	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
-	  tmp_addflag=' -i_dynamic -nofor_main' ;;
-	ifc* | ifort*)			# Intel Fortran compiler
-	  tmp_addflag=' -nofor_main' ;;
-	esac
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-
-	if test $supports_anon_versioning = yes; then
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-  cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-  $echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-	  $CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-	fi
-      else
-	_LT_AC_TAGVAR(ld_shlibs, $1)=no
-      fi
-      ;;
-
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -5510,6 +5155,32 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       ;;
 
+  linux*)
+    if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
+        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)=&quot;$tmp_archive_cmds&quot;
+      supports_anon_versioning=no
+      case `$LD -v 2&gt;/dev/null` in
+        *\ [01].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
+cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
+$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        _LT_AC_TAGVAR(archive_expsym_cmds, $1)=&quot;$tmp_archive_cmds&quot;
+      fi
+      _LT_AC_TAGVAR(link_all_deplibs, $1)=no
+    else
+      _LT_AC_TAGVAR(ld_shlibs, $1)=no
+    fi
+    ;;
+
     *)
       if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -5520,11 +5191,16 @@
       ;;
     esac
 
-    if test &quot;$_LT_AC_TAGVAR(ld_shlibs, $1)&quot; = no; then
-      runpath_var=
-      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)=
-      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=
-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
+    if test &quot;$_LT_AC_TAGVAR(ld_shlibs, $1)&quot; = yes; then
+      runpath_var=LD_RUN_PATH
+      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
+ 	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
+      else
+  	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
+      fi
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -5588,7 +5264,7 @@
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
       if test &quot;$GCC&quot; = yes; then
-	case $host_os in aix4.[[012]]|aix4.[[012]].*)
+	case $host_os in aix4.[012]|aix4.[012].*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -5609,9 +5285,6 @@
 	  fi
 	esac
 	shared_flag='-shared'
-	if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	  shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-	fi
       else
 	# not using gcc
 	if test &quot;$host_cpu&quot; = ia64; then
@@ -5670,7 +5343,7 @@
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
       ;;
 
-    bsdi[[45]]*)
+    bsdi4*)
       _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=-rdynamic
       ;;
 
@@ -5691,57 +5364,57 @@
       _LT_AC_TAGVAR(old_archive_From_new_cmds, $1)='true'
       # FIXME: Should let the user specify the lib program.
       _LT_AC_TAGVAR(old_archive_cmds, $1)='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      _LT_AC_TAGVAR(fix_srcfile_path, $1)='`cygpath -w &quot;$srcfile&quot;`'
+      fix_srcfile_path='`cygpath -w &quot;$srcfile&quot;`'
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
       ;;
 
     darwin* | rhapsody*)
+    if test &quot;$GXX&quot; = yes ; then
+      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
       case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[[012]])
-         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[[012]])
-               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
+      rhapsody* | darwin1.[[012]])
+	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
+	;;
+      *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[[012]])
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+	;;
       esac
-      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+    	lt_int_apple_cc_single_mod=no
+    	output_verbose_link_cmd='echo'
+    	if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+    	  lt_int_apple_cc_single_mod=yes
+    	fi
+    	if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+    	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    	else
+        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      fi
+      _LT_AC_TAGVAR(module_cmds, $1)='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+        if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        else
+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        fi
+          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       _LT_AC_TAGVAR(hardcode_direct, $1)=no
       _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
-    if test &quot;$GCC&quot; = yes ; then
-    	output_verbose_link_cmd='echo'
-        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-         _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         _LT_AC_TAGVAR(ld_shlibs, $1)=no
-          ;;
-      esac
+      _LT_AC_TAGVAR(ld_shlibs, $1)=no
     fi
       ;;
 
@@ -5775,7 +5448,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu | dragonfly*)
+    freebsd* | kfreebsd*-gnu)
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
       _LT_AC_TAGVAR(hardcode_direct, $1)=yes
@@ -5862,7 +5535,7 @@
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -5886,7 +5559,6 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       else
@@ -5932,7 +5604,7 @@
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \*'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done; echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'
@@ -5951,12 +5623,10 @@
     solaris*)
       _LT_AC_TAGVAR(no_undefined_flag, $1)=' -z text'
       if test &quot;$GCC&quot; = yes; then
-	wlarc='${wl}'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
-	wlarc=''
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -5965,18 +5635,8 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       case $host_os in
       solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
-      *)
- 	# The compiler driver will combine linker options so we
- 	# cannot just pass the convience library names through
- 	# without $wl, iff we do not link with $LD.
- 	# Luckily, gcc supports the same syntax we need for Sun Studio.
- 	# Supported since Solaris 2.6 (maybe 2.5.1?)
- 	case $wlarc in
- 	'')
- 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
- 	*)
- 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract' ;;
- 	esac ;;
+      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
       esac
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
@@ -6237,7 +5897,7 @@
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
-  test ! -f $lt_ac_sed &amp;&amp; continue
+  test ! -f $lt_ac_sed &amp;&amp; break
   cat /dev/null &gt; conftest.in
   lt_ac_count=0
   echo $ECHO_N &quot;0123456789$ECHO_C&quot; &gt;conftest.in
@@ -6262,8 +5922,8 @@
     fi
   done
 done
-])
 SED=$lt_cv_path_SED
+])
 AC_MSG_RESULT([$SED])
 ])
 

Modified: branches/mloskot-style-refactoring/config.guess
===================================================================
--- branches/mloskot-style-refactoring/config.guess	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/config.guess	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
 
-timestamp='2004-03-12'
+timestamp='2005-04-22'
 
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
@@ -53,7 +53,7 @@
 GNU config.guess ($timestamp)
 
 Originally written by Per Bothner.
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005
 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
@@ -203,15 +203,15 @@
     amiga:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
-    arc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     cats:OpenBSD:*:*)
 	echo arm-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
     hp300:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
+    luna88k:OpenBSD:*:*)
+    	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
     mac68k:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
@@ -227,21 +227,12 @@
     mvmeppc:OpenBSD:*:*)
 	echo powerpc-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
-    pegasos:OpenBSD:*:*)
-	echo powerpc-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    pmax:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     sgi:OpenBSD:*:*)
-	echo mipseb-unknown-openbsd${UNAME_RELEASE}
+	echo mips64-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
     sun3:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
-    wgrisc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     *:OpenBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
@@ -307,9 +298,6 @@
 	# 1.2 uses &quot;1.2&quot; for uname -r.
 	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[PVTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
 	exit 0 ;;
-    Alpha*:OpenVMS:*:*)
-	echo alpha-hp-vms
-	exit 0 ;;
     Alpha\ *:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# Should we change UNAME_MACHINE based on the output of uname instead
@@ -331,6 +319,9 @@
     *:OS/390:*:*)
 	echo i370-ibm-openedition
 	exit 0 ;;
+    *:z/VM:*:*)
+	echo s390-ibm-zvmoe
+	exit 0 ;;
     *:OS400:*:*)
         echo powerpc-ibm-os400
 	exit 0 ;;
@@ -354,7 +345,7 @@
     DRS?6000:unix:4.0:6*)
 	echo sparc-icl-nx6
 	exit 0 ;;
-    DRS?6000:UNIX_SV:4.2*:7*)
+    DRS?6000:UNIX_SV:4.2*:7* | DRS?6000:isis:4.2*:7*)
 	case `/usr/bin/uname -p` in
 	    sparc) echo sparc-icl-nx7 &amp;&amp; exit 0 ;;
 	esac ;;
@@ -764,7 +755,7 @@
 	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     *:UNICOS/mp:*:*)
-	echo nv1-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	echo craynv-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
 	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
@@ -787,21 +778,7 @@
 	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
 	exit 0 ;;
     *:FreeBSD:*:*)
-	# Determine whether the default compiler uses glibc.
-	eval $set_cc_for_build
-	sed 's/^	//' &lt;&lt; EOF &gt;$dummy.c
-	#include &lt;features.h&gt;
-	#if __GLIBC__ &gt;= 2
-	LIBC=gnu
-	#else
-	LIBC=
-	#endif
-EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2&gt;/dev/null | grep ^LIBC=`
-	# GNU/KFreeBSD systems have a &quot;k&quot; prefix to indicate we are using
-	# FreeBSD's kernel, but not the complete OS.
-	case ${LIBC} in gnu) kernel_only='k' ;; esac
-	echo ${UNAME_MACHINE}-unknown-${kernel_only}freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
+	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
 	exit 0 ;;
     i*:CYGWIN*:*)
 	echo ${UNAME_MACHINE}-pc-cygwin
@@ -827,6 +804,9 @@
     i*:UWIN*:*)
 	echo ${UNAME_MACHINE}-pc-uwin
 	exit 0 ;;
+    amd64:CYGWIN*:*:*)
+	echo x86_64-unknown-cygwin
+	exit 0 ;;
     p*:CYGWIN*:*)
 	echo powerpcle-unknown-cygwin
 	exit 0 ;;
@@ -850,6 +830,12 @@
     cris:Linux:*:*)
 	echo cris-axis-linux-gnu
 	exit 0 ;;
+    crisv32:Linux:*:*)
+	echo crisv32-axis-linux-gnu
+	exit 0 ;;
+    frv:Linux:*:*)
+    	echo frv-unknown-linux-gnu
+	exit 0 ;;
     ia64:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
 	exit 0 ;;
@@ -1096,9 +1082,9 @@
     M680?0:D-NIX:5.3:*)
 	echo m68k-diab-dnix
 	exit 0 ;;
-    M68*:*:R3V[567]*:*)
+    M68*:*:R3V[5678]*:*)
 	test -r /sysV68 &amp;&amp; echo 'm68k-motorola-sysv' &amp;&amp; exit 0 ;;
-    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0)
+    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0 | S7501*:*:4.0:3.0)
 	OS_REL=''
 	test -r /etc/.relid \
 	&amp;&amp; OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' &lt; /etc/.relid`
@@ -1154,6 +1140,10 @@
 	# From <A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">seanf at swdc.stratus.com.</A>
 	echo i860-stratus-sysv4
 	exit 0 ;;
+    i*86:VOS:*:*)
+	# From <A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">Paul.Green at stratus.com.</A>
+	echo ${UNAME_MACHINE}-stratus-vos
+	exit 0 ;;
     *:VOS:*:*)
 	# From <A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">Paul.Green at stratus.com.</A>
 	echo hppa1.1-stratus-vos
@@ -1196,9 +1186,10 @@
 	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
 	exit 0 ;;
     *:Darwin:*:*)
-	case `uname -p` in
+	UNAME_PROCESSOR=`uname -p` || UNAME_PROCESSOR=unknown
+	case $UNAME_PROCESSOR in
 	    *86) UNAME_PROCESSOR=i686 ;;
-	    powerpc) UNAME_PROCESSOR=powerpc ;;
+	    unknown) UNAME_PROCESSOR=powerpc ;;
 	esac
 	echo ${UNAME_PROCESSOR}-apple-darwin${UNAME_RELEASE}
 	exit 0 ;;
@@ -1213,6 +1204,9 @@
     *:QNX:*:4*)
 	echo i386-pc-qnx
 	exit 0 ;;
+    NSE-?:NONSTOP_KERNEL:*:*)
+	echo nse-tandem-nsk${UNAME_RELEASE}
+	exit 0 ;;
     NSR-?:NONSTOP_KERNEL:*:*)
 	echo nsr-tandem-nsk${UNAME_RELEASE}
 	exit 0 ;;
@@ -1260,6 +1254,16 @@
     *:DragonFly:*:*)
 	echo ${UNAME_MACHINE}-unknown-dragonfly`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
 	exit 0 ;;
+    *:*VMS:*:*)
+    	UNAME_MACHINE=`(uname -p) 2&gt;/dev/null`
+	case &quot;${UNAME_MACHINE}&quot; in
+	    A*) echo alpha-dec-vms &amp;&amp; exit 0 ;;
+	    I*) echo ia64-dec-vms &amp;&amp; exit 0 ;;
+	    V*) echo vax-dec-vms &amp;&amp; exit 0 ;;
+	esac ;;
+    *:XENIX:*:SysV)
+	echo i386-pc-xenix
+	exit 0 ;;
 esac
 
 #echo '(No uname command or uname output not recognized.)' 1&gt;&amp;2
@@ -1419,7 +1423,9 @@
 the operating system you are using. It is advised that you
 download the most up to date version of the config scripts from
 
-    <A HREF="ftp://ftp.gnu.org/pub/gnu/config/">ftp://ftp.gnu.org/pub/gnu/config/</A>
+  <A HREF="http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.guess">http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.guess</A>
+and
+  <A HREF="http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.sub">http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.sub</A>
 
 If the version you run ($0) is already up to date, please
 send the following data and any information you think might be

Modified: branches/mloskot-style-refactoring/config.sub
===================================================================
--- branches/mloskot-style-refactoring/config.sub	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/config.sub	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
 
-timestamp='2004-03-12'
+timestamp='2005-04-22'
 
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
@@ -70,7 +70,7 @@
 version=&quot;\
 GNU config.sub ($timestamp)
 
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005
 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
@@ -145,7 +145,7 @@
 	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
 	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
 	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
-	-apple | -axis)
+	-apple | -axis | -knuth | -cray)
 		os=
 		basic_machine=$1
 		;;
@@ -231,13 +231,14 @@
 	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
 	| am33_2.0 \
 	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
+	| bfin \
 	| c4x | clipper \
 	| d10v | d30v | dlx | dsp16xx \
 	| fr30 | frv \
 	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
 	| i370 | i860 | i960 | ia64 \
 	| ip2k | iq2000 \
-	| m32r | m32rle | m68000 | m68k | m88k | mcore \
+	| m32r | m32rle | m68000 | m68k | m88k | maxq | mcore \
 	| mips | mipsbe | mipseb | mipsel | mipsle \
 	| mips16 \
 	| mips64 | mips64el \
@@ -262,12 +263,13 @@
 	| pyramid \
 	| sh | sh[1234] | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
 	| sh64 | sh64le \
-	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv8 | sparcv9 | sparcv9b \
+	| sparc | sparc64 | sparc64b | sparc86x | sparclet | sparclite \
+	| sparcv8 | sparcv9 | sparcv9b \
 	| strongarm \
 	| tahoe | thumb | tic4x | tic80 | tron \
 	| v850 | v850e \
 	| we32k \
-	| x86 | xscale | xstormy16 | xtensa \
+	| x86 | xscale | xscalee[bl] | xstormy16 | xtensa \
 	| z8k)
 		basic_machine=$basic_machine-unknown
 		;;
@@ -298,9 +300,9 @@
 	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
 	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
 	| avr-* \
-	| bs2000-* \
+	| bfin-* | bs2000-* \
 	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
-	| clipper-* | cydra-* \
+	| clipper-* | craynv-* | cydra-* \
 	| d10v-* | d30v-* | dlx-* \
 	| elxsi-* \
 	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
@@ -310,7 +312,7 @@
 	| ip2k-* | iq2000-* \
 	| m32r-* | m32rle-* \
 	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
-	| m88110-* | m88k-* | mcore-* \
+	| m88110-* | m88k-* | maxq-* | mcore-* \
 	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
 	| mips16-* \
 	| mips64-* | mips64el-* \
@@ -326,8 +328,9 @@
 	| mipsisa64sb1-* | mipsisa64sb1el-* \
 	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
 	| mipstx39-* | mipstx39el-* \
+	| mmix-* \
 	| msp430-* \
-	| none-* | np1-* | nv1-* | ns16k-* | ns32k-* \
+	| none-* | np1-* | ns16k-* | ns32k-* \
 	| orion-* \
 	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
 	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
@@ -335,15 +338,16 @@
 	| romp-* | rs6000-* \
 	| sh-* | sh[1234]-* | sh[23]e-* | sh[34]eb-* | shbe-* \
 	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
-	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
+	| sparc-* | sparc64-* | sparc64b-* | sparc86x-* | sparclet-* \
+	| sparclite-* \
 	| sparcv8-* | sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
 	| tahoe-* | thumb-* \
 	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
 	| tron-* \
 	| v850-* | v850e-* | vax-* \
 	| we32k-* \
-	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
-	| xtensa-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xscalee[bl]-* \
+	| xstormy16-* | xtensa-* \
 	| ymp-* \
 	| z8k-*)
 		;;
@@ -445,6 +449,10 @@
 		basic_machine=j90-cray
 		os=-unicos
 		;;
+	craynv)
+		basic_machine=craynv-cray
+		os=-unicosmp
+		;;
 	cr16c)
 		basic_machine=cr16c-unknown
 		os=-elf
@@ -452,6 +460,9 @@
 	crds | unos)
 		basic_machine=m68k-crds
 		;;
+	crisv32 | crisv32-* | etraxfs*)
+		basic_machine=crisv32-axis
+		;;
 	cris | cris-* | etrax*)
 		basic_machine=cris-axis
 		;;
@@ -481,6 +492,10 @@
 		basic_machine=m88k-motorola
 		os=-sysv3
 		;;
+	djgpp)
+		basic_machine=i586-pc
+		os=-msdosdjgpp
+		;;
 	dpx20 | dpx20-*)
 		basic_machine=rs6000-bull
 		os=-bosx
@@ -659,10 +674,6 @@
 	mips3*)
 		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
 		;;
-	mmix*)
-		basic_machine=mmix-knuth
-		os=-mmixware
-		;;
 	monitor)
 		basic_machine=m68k-rom68k
 		os=-coff
@@ -743,10 +754,6 @@
 	np1)
 		basic_machine=np1-gould
 		;;
-	nv1)
-		basic_machine=nv1-cray
-		os=-unicosmp
-		;;
 	nsr-tandem)
 		basic_machine=nsr-tandem
 		;;
@@ -1029,6 +1036,10 @@
 		basic_machine=hppa1.1-winbond
 		os=-proelf
 		;;
+	xbox)
+		basic_machine=i686-pc
+		os=-mingw32
+		;;
 	xps | xps100)
 		basic_machine=xps100-honeywell
 		;;
@@ -1059,6 +1070,9 @@
 	romp)
 		basic_machine=romp-ibm
 		;;
+	mmix)
+		basic_machine=mmix-knuth
+		;;
 	rs6000)
 		basic_machine=rs6000-ibm
 		;;
@@ -1294,6 +1308,9 @@
 	-kaos*)
 		os=-kaos
 		;;
+	-zvmoe)
+		os=-zvmoe
+		;;
 	-none)
 		;;
 	*)
@@ -1374,6 +1391,9 @@
 	*-ibm)
 		os=-aix
 		;;
+    	*-knuth)
+		os=-mmixware
+		;;
 	*-wec)
 		os=-proelf
 		;;

Modified: branches/mloskot-style-refactoring/configure
===================================================================
--- branches/mloskot-style-refactoring/configure	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/configure	2005-11-11 21:57:36 UTC (rev 231)
@@ -280,7 +280,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-(unset CDPATH) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; unset CDPATH
+if test &quot;X${CDPATH+set}&quot; = Xset; then CDPATH=:; export CDPATH; fi
 
 if test -z &quot;$ECHO&quot;; then
 if test &quot;X${echo_test_string+set}&quot; != Xset; then
@@ -1152,7 +1152,7 @@
     else
       echo &quot;$as_me: WARNING: no configuration information is in $ac_dir&quot; &gt;&amp;2
     fi
-    cd $ac_popdir
+    cd &quot;$ac_popdir&quot;
   done
 fi
 
@@ -2284,8 +2284,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -2343,8 +2342,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -2415,8 +2413,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -2460,8 +2457,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3035,8 +3031,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3094,8 +3089,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3211,8 +3205,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3266,8 +3259,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3312,8 +3304,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3357,8 +3348,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -3893,7 +3883,7 @@
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
-  test ! -f $lt_ac_sed &amp;&amp; continue
+  test ! -f $lt_ac_sed &amp;&amp; break
   cat /dev/null &gt; conftest.in
   lt_ac_count=0
   echo $ECHO_N &quot;0123456789$ECHO_C&quot; &gt;conftest.in
@@ -3918,10 +3908,10 @@
     fi
   done
 done
+SED=$lt_cv_path_SED
 
 fi
 
-SED=$lt_cv_path_SED
 echo &quot;$as_me:$LINENO: result: $SED&quot; &gt;&amp;5
 echo &quot;${ECHO_T}$SED&quot; &gt;&amp;6
 
@@ -4062,15 +4052,6 @@
 *) reload_flag=&quot; $reload_flag&quot; ;;
 esac
 reload_cmds='$LD$reload_flag -o $output$reload_objs'
-case $host_os in
-  darwin*)
-    if test &quot;$GCC&quot; = yes; then
-      reload_cmds='$CC -nostdlib ${wl}-r -o $output$reload_objs'
-    else
-      reload_cmds='$LD$reload_flag -o $output$reload_objs'
-    fi
-    ;;
-esac
 
 echo &quot;$as_me:$LINENO: checking for BSD-compatible nm&quot; &gt;&amp;5
 echo $ECHO_N &quot;checking for BSD-compatible nm... $ECHO_C&quot; &gt;&amp;6
@@ -4157,7 +4138,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-bsdi[45]*)
+bsdi4*)
   lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)'
   lt_cv_file_magic_cmd='/usr/bin/file -L'
   lt_cv_file_magic_test_file=/shlib/libc.so
@@ -4180,13 +4161,13 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-freebsd* | kfreebsd*-gnu | dragonfly*)
+freebsd* | kfreebsd*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ &gt; /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
       # Let's accept both of them until this is cleared up.
-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD|DragonFly)/i[3-9]86 (compact )?demand paged shared library'
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'
       lt_cv_file_magic_cmd=/usr/bin/file
       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
       ;;
@@ -4233,7 +4214,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd*)
+netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ &gt; /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
@@ -4252,10 +4233,12 @@
   ;;
 
 openbsd*)
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
   if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
-    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
+    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'
   else
-    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
+    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
   fi
   ;;
 
@@ -4348,7 +4331,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 4351 &quot;configure&quot;' &gt; conftest.$ac_ext
+  echo '#line 4334 &quot;configure&quot;' &gt; conftest.$ac_ext
   if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
   (eval $ac_compile) 2&gt;&amp;5
   ac_status=$?
@@ -4429,24 +4412,6 @@
   rm -rf conftest*
   ;;
 
-*-*-linux*)
-  # Test if the compiler is 64bit
-  echo 'int i;' &gt; conftest.$ac_ext
-  lt_cv_cc_64bit_output=no
-  if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
-  (eval $ac_compile) 2&gt;&amp;5
-  ac_status=$?
-  echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); }; then
-    case `/usr/bin/file conftest.$ac_objext` in
-    *&quot;ELF 64&quot;*)
-      lt_cv_cc_64bit_output=yes
-      ;;
-    esac
-  fi
-  rm -rf conftest*
-  ;;
-
 *-*-sco3.2v5*)
   # On SCO OpenServer 5, we need -belf to get full-featured binaries.
   SAVE_CFLAGS=&quot;$CFLAGS&quot;
@@ -4486,8 +4451,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -4562,8 +4526,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -4733,8 +4696,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -4801,8 +4763,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -4917,12 +4878,7 @@
 
 done
 
-
-
-if test -n &quot;$CXX&quot; &amp;&amp; ( test &quot;X$CXX&quot; != &quot;Xno&quot; &amp;&amp;
-    ( (test &quot;X$CXX&quot; = &quot;Xg++&quot; &amp;&amp; `g++ -v &gt;/dev/null 2&gt;&amp;1` ) ||
-    (test &quot;X$CXX&quot; != &quot;Xg++&quot;))) ; then
-  ac_ext=cc
+ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext &gt;&amp;5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS &gt;&amp;5'
@@ -5152,9 +5108,7 @@
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS &gt;&amp;5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
-fi
 
-
 ac_ext=f
 ac_compile='$F77 -c $FFLAGS conftest.$ac_ext &gt;&amp;5'
 ac_link='$F77 -o conftest$ac_exeext $FFLAGS $LDFLAGS conftest.$ac_ext $LIBS &gt;&amp;5'
@@ -5247,7 +5201,7 @@
 
 
 # Provide some information about the compiler.
-echo &quot;$as_me:5250:&quot; \
+echo &quot;$as_me:5204:&quot; \
      &quot;checking for Fortran 77 compiler version&quot; &gt;&amp;5
 ac_compiler=`set X $ac_compile; echo $2`
 { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compiler --version &lt;/dev/null &gt;&amp;5\&quot;&quot;) &gt;&amp;5
@@ -5293,8 +5247,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -5343,8 +5296,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -5437,38 +5389,11 @@
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
-  netbsd* | freebsd* | openbsd* | darwin* | dragonfly*)
-    # This has been around since 386BSD, at least.  Likely further.
-    if test -x /sbin/sysctl; then
-      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
-    elif test -x /usr/sbin/sysctl; then
-      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
-    else
-      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
-    fi
-    # And add a safety zone
-    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    ;;
-  osf*)
-    # Dr. Hans Ekkehard Plesser reports seeing a kernel panic running configure
-    # due to this test when exec_disable_arg_limit is 1 on Tru64. It is not
-    # nice to cause kernel panics so lets avoid the loop below.
-    # First set a reasonable default.
-    lt_cv_sys_max_cmd_len=16384
-    #
-    if test -x /sbin/sysconfig; then
-      case `/sbin/sysconfig -q proc exec_disable_arg_limit` in
-        *1*) lt_cv_sys_max_cmd_len=-1 ;;
-      esac
-    fi
-    ;;
-  *)
+ *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
     # we can't tell.
-    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-    while (test &quot;X&quot;`$SHELL $0 --fallback-echo &quot;X$teststring&quot; 2&gt;/dev/null` \
+    while (test &quot;X&quot;`$CONFIG_SHELL $0 --fallback-echo &quot;X$teststring&quot; 2&gt;/dev/null` \
 	       = &quot;XX$teststring&quot;) &gt;/dev/null 2&gt;&amp;1 &amp;&amp;
 	    new_result=`expr &quot;X$teststring&quot; : &quot;.*&quot; 2&gt;&amp;1` &amp;&amp;
 	    lt_cv_sys_max_cmd_len=$new_result &amp;&amp;
@@ -5514,6 +5439,9 @@
 # Regexp to match symbols that can be accessed directly from C.
 sympat='\([_A-Za-z][_A-Za-z0-9]*\)'
 
+# Transform the above into a raw symbol and a C symbol.
+symxfrm='\1 \2\3 \3'
+
 # Transform an extracted symbol line into a proper C declaration
 lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^. .* \(.*\)$/extern int \1;/p'&quot;
 
@@ -5535,13 +5463,6 @@
   lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'&quot;
   lt_cv_sys_global_symbol_to_c_name_address=&quot;sed -n -e 's/^: \([^ ]*\) $/  {\\\&quot;\1\\\&quot;, (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\&quot;\2\&quot;, (lt_ptr) \&amp;\2},/p'&quot;
   ;;
-linux*)
-  if test &quot;$host_cpu&quot; = ia64; then
-    symcode='[ABCDGIRSTW]'
-    lt_cv_sys_global_symbol_to_cdecl=&quot;sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'&quot;
-    lt_cv_sys_global_symbol_to_c_name_address=&quot;sed -n -e 's/^: \([^ ]*\) $/  {\\\&quot;\1\\\&quot;, (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\&quot;\2\&quot;, (lt_ptr) \&amp;\2},/p'&quot;
-  fi
-  ;;
 irix* | nonstopux*)
   symcode='[BCDEGRST]'
   ;;
@@ -5573,11 +5494,8 @@
 # Try without a prefix undercore, then with it.
 for ac_symprfx in &quot;&quot; &quot;_&quot;; do
 
-  # Transform symcode, sympat, and symprfx into a raw symbol and a C symbol.
-  symxfrm=&quot;\\1 $ac_symprfx\\2 \\2&quot;
-
   # Write the raw and C identifiers.
-  lt_cv_sys_global_symbol_pipe=&quot;sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'&quot;
+  lt_cv_sys_global_symbol_pipe=&quot;sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'&quot;
 
   # Check to see that the pipe works correctly.
   pipe_works=no
@@ -5739,7 +5657,7 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e 1s/^X//'
+Xsed='sed -e s/^X//'
 sed_quote_subst='s/\([\\&quot;\\`$\\\\]\)/\\\1/g'
 
 # Same as above, but do not quote variable references.
@@ -6044,17 +5962,6 @@
   old_archive_cmds=&quot;$old_archive_cmds~\$RANLIB \$oldlib&quot;
 fi
 
-for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
-
-
 # Only perform the check for file, if the check method requires it
 case $deplibs_check_method in
 file_magic*)
@@ -6210,47 +6117,6 @@
 fi;
 test -z &quot;$pic_mode&quot; &amp;&amp; pic_mode=default
 
-# Check if we have a version mismatch between libtool.m4 and ltmain.sh.
-#
-# Note:  This should be in AC_LIBTOOL_SETUP, _after_ $ltmain have been defined.
-#        We also should do it _before_ AC_LIBTOOL_LANG_C_CONFIG that actually
-#        calls AC_LIBTOOL_CONFIG and creates libtool.
-#
-echo &quot;$as_me:$LINENO: checking for correct ltmain.sh version&quot; &gt;&amp;5
-echo $ECHO_N &quot;checking for correct ltmain.sh version... $ECHO_C&quot; &gt;&amp;6
-if test -z &quot;$ltmain&quot;; then
-  echo &quot;$as_me:$LINENO: result: no&quot; &gt;&amp;5
-echo &quot;${ECHO_T}no&quot; &gt;&amp;6
-  echo
-  echo &quot;*** Gentoo sanity check failed! ***&quot;
-  echo &quot;*** \$ltmain is not defined, please check the patch for consistency! ***&quot;
-  echo
-  exit 1
-fi
-gentoo_lt_version=&quot;1.5.18&quot;
-gentoo_ltmain_version=`grep '^[:space:]*VERSION=' $ltmain | sed -e 's|^[:space:]*VERSION=||'`
-if test &quot;$gentoo_lt_version&quot; != &quot;$gentoo_ltmain_version&quot;; then
-  echo &quot;$as_me:$LINENO: result: no&quot; &gt;&amp;5
-echo &quot;${ECHO_T}no&quot; &gt;&amp;6
-  echo
-  echo &quot;*** Gentoo sanity check failed! ***&quot;
-  echo &quot;*** libtool.m4 and ltmain.sh have a version mismatch! ***&quot;
-  echo &quot;*** (libtool.m4 = $gentoo_lt_version, ltmain.sh = $gentoo_ltmain_version) ***&quot;
-  echo
-  echo &quot;Please run:&quot;
-  echo
-  echo &quot;  libtoolize --copy --force&quot;
-  echo
-  echo &quot;if appropriate, please contact the maintainer of this&quot;
-  echo &quot;package (or your distribution) for help.&quot;
-  echo
-  exit 1
-else
-  echo &quot;$as_me:$LINENO: result: yes&quot; &gt;&amp;5
-echo &quot;${ECHO_T}yes&quot; &gt;&amp;6
-fi
-
-
 # Use C for the default configuration in the libtool script
 tagname=
 lt_save_CC=&quot;$CC&quot;
@@ -6282,20 +6148,6 @@
 compiler=$CC
 
 
-# save warnings/boilerplate of simple test code
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-
-
 #
 # Check for any special shared library compilation flags.
 #
@@ -6337,11 +6189,6 @@
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1&gt;&amp;5
-       $echo &quot;X$_lt_linker_boilerplate&quot; | $Xsed &gt; conftest.exp
-       $SED '/^$/d' conftest.err &gt;conftest.er2
-       if diff conftest.exp conftest.er2 &gt;/dev/null; then
-         lt_prog_compiler_static_works=yes
-       fi
      else
        lt_prog_compiler_static_works=yes
      fi
@@ -6386,17 +6233,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:6389: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:6236: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:6393: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:6240: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
@@ -6499,16 +6344,6 @@
 	lt_prog_compiler_static='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
-      darwin*)
-        # PIC is the default on this platform
-        # Common symbols not allowed in MH_DYLIB files
-       case $cc_basename in
-         xlc*)
-         lt_prog_compiler_pic='-qnocommon'
-         lt_prog_compiler_wl='-Wl,'
-         ;;
-       esac
-       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -6544,19 +6379,12 @@
       ;;
 
     linux*)
-      case $cc_basename in
+      case $CC in
       icc* | ecc*)
 	lt_prog_compiler_wl='-Wl,'
 	lt_prog_compiler_pic='-KPIC'
 	lt_prog_compiler_static='-static'
         ;;
-      pgcc* | pgf77* | pgf90*)
-        # Portland Group compilers (*not* the Pentium gcc compiler,
-	# which looks to be a dead project)
-	lt_prog_compiler_wl='-Wl,'
-	lt_prog_compiler_pic='-fpic'
-	lt_prog_compiler_static='-static'
-        ;;
       ccc*)
         lt_prog_compiler_wl='-Wl,'
         # All Alpha code is PIC.
@@ -6577,14 +6405,9 @@
       ;;
 
     solaris*)
+      lt_prog_compiler_wl='-Wl,'
       lt_prog_compiler_pic='-KPIC'
       lt_prog_compiler_static='-Bstatic'
-      case $cc_basename in
-      f77* | f90* | f95*)
-	lt_prog_compiler_wl='-Qoption ld ';;
-      *)
-	lt_prog_compiler_wl='-Wl,';;
-      esac
       ;;
 
     sunos4*)
@@ -6606,11 +6429,6 @@
       fi
       ;;
 
-    unicos*)
-      lt_prog_compiler_wl='-Wl,'
-      lt_prog_compiler_can_build_shared=no
-      ;;
-
     uts4*)
       lt_prog_compiler_pic='-pic'
       lt_prog_compiler_static='-Bstatic'
@@ -6648,17 +6466,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:6651: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:6469: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:6655: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:6473: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_prog_compiler_pic_works=yes
      fi
    fi
@@ -6710,18 +6526,16 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:6713: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:6529: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;out/conftest.err)
    ac_status=$?
    cat out/conftest.err &gt;&amp;5
-   echo &quot;$as_me:6717: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:6533: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt; out/conftest.exp
-     $SED '/^$/d' out/conftest.err &gt;out/conftest.er2
-     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 &gt;/dev/null; then
+     if test ! -s out/conftest.err; then
        lt_cv_prog_compiler_c_o=yes
      fi
    fi
@@ -6801,16 +6615,6 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
-  # Just being paranoid about ensuring that cc_basename is set.
-  for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -6831,27 +6635,6 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
-    # Set some defaults for GNU ld with shared library support. These
-    # are reset later if shared libraries are not supported. Putting them
-    # here allows them to be overridden if necessary.
-    runpath_var=LD_RUN_PATH
-    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
-    export_dynamic_flag_spec='${wl}--export-dynamic'
-    # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
-	whole_archive_flag_spec=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-      else
-  	whole_archive_flag_spec=
-    fi
-    supports_anon_versioning=no
-    case `$LD -v 2&gt;/dev/null` in
-      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-      *\ 2.11.*) ;; # other 2.11 versions
-      *) supports_anon_versioning=yes ;;
-    esac
-
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -6902,7 +6685,7 @@
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
 
       if $LD --help 2&gt;&amp;1 | grep 'auto-import' &gt; /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -6920,38 +6703,7 @@
       fi
       ;;
 
-    linux*)
-      if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
-	tmp_addflag=
-	case $cc_basename,$host_cpu in
-	pgcc*)				# Portland Group C compiler
-	  whole_archive_flag_spec='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag'
-	  ;;
-	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
-	  whole_archive_flag_spec='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag -Mnomain' ;;
-	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
-	  tmp_addflag=' -i_dynamic' ;;
-	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
-	  tmp_addflag=' -i_dynamic -nofor_main' ;;
-	ifc* | ifort*)			# Intel Fortran compiler
-	  tmp_addflag=' -nofor_main' ;;
-	esac
-	archive_cmds='$CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-
-	if test $supports_anon_versioning = yes; then
-	  archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-  cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-  $echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-	  $CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-	fi
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -6989,6 +6741,32 @@
       hardcode_shlibpath_var=no
       ;;
 
+  linux*)
+    if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
+        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds=&quot;$tmp_archive_cmds&quot;
+      supports_anon_versioning=no
+      case `$LD -v 2&gt;/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
+cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
+$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        archive_expsym_cmds=&quot;$tmp_archive_cmds&quot;
+      fi
+      link_all_deplibs=no
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
     *)
       if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -6999,11 +6777,16 @@
       ;;
     esac
 
-    if test &quot;$ld_shlibs&quot; = no; then
-      runpath_var=
-      hardcode_libdir_flag_spec=
-      export_dynamic_flag_spec=
-      whole_archive_flag_spec=
+    if test &quot;$ld_shlibs&quot; = yes; then
+      runpath_var=LD_RUN_PATH
+      hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
+      export_dynamic_flag_spec='${wl}--export-dynamic'
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
+ 	whole_archive_flag_spec=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
+      else
+  	whole_archive_flag_spec=
+      fi
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -7067,7 +6850,7 @@
       link_all_deplibs=yes
 
       if test &quot;$GCC&quot; = yes; then
-	case $host_os in aix4.[012]|aix4.[012].*)
+	case $host_os in aix4.012|aix4.012.*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -7088,9 +6871,6 @@
 	  fi
 	esac
 	shared_flag='-shared'
-	if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	  shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-	fi
       else
 	# not using gcc
 	if test &quot;$host_cpu&quot; = ia64; then
@@ -7138,8 +6918,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -7199,8 +6978,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -7251,7 +7029,7 @@
       ld_shlibs=no
       ;;
 
-    bsdi[45]*)
+    bsdi4*)
       export_dynamic_flag_spec=-rdynamic
       ;;
 
@@ -7277,52 +7055,52 @@
       ;;
 
     darwin* | rhapsody*)
+    if test &quot;$GXX&quot; = yes ; then
+      archive_cmds_need_lc=no
       case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[012])
-         allow_undefined_flag='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           allow_undefined_flag='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[012])
-               allow_undefined_flag='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               allow_undefined_flag='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
+      rhapsody* | darwin1.[012])
+	allow_undefined_flag='-undefined suppress'
+	;;
+      *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	allow_undefined_flag='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[012])
+            allow_undefined_flag='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            allow_undefined_flag='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+	;;
       esac
-      archive_cmds_need_lc=no
+    	lt_int_apple_cc_single_mod=no
+    	output_verbose_link_cmd='echo'
+    	if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+    	  lt_int_apple_cc_single_mod=yes
+    	fi
+    	if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+    	  archive_cmds='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    	else
+        archive_cmds='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      fi
+      module_cmds='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+        if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+          archive_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        else
+          archive_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        fi
+          module_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       hardcode_direct=no
       hardcode_automatic=yes
       hardcode_shlibpath_var=unsupported
-      whole_archive_flag_spec=''
+      whole_archive_flag_spec='-all_load $convenience'
       link_all_deplibs=yes
-    if test &quot;$GCC&quot; = yes ; then
-    	output_verbose_link_cmd='echo'
-        archive_cmds='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-      archive_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      module_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-         module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-         archive_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          module_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         ld_shlibs=no
-          ;;
-      esac
+      ld_shlibs=no
     fi
       ;;
 
@@ -7356,7 +7134,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu | dragonfly*)
+    freebsd* | kfreebsd*-gnu)
       archive_cmds='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec='-R$libdir'
       hardcode_direct=yes
@@ -7443,7 +7221,7 @@
       link_all_deplibs=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -7467,7 +7245,6 @@
       hardcode_shlibpath_var=no
       if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
 	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec='${wl}-E'
       else
@@ -7513,7 +7290,7 @@
 	allow_undefined_flag=' -expect_unresolved \*'
 	archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done; echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec='-rpath $libdir'
@@ -7532,12 +7309,10 @@
     solaris*)
       no_undefined_flag=' -z text'
       if test &quot;$GCC&quot; = yes; then
-	wlarc='${wl}'
 	archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
-	wlarc=''
 	archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -7546,18 +7321,8 @@
       hardcode_shlibpath_var=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *)
- 	# The compiler driver will combine linker options so we
- 	# cannot just pass the convience library names through
- 	# without $wl, iff we do not link with $LD.
- 	# Luckily, gcc supports the same syntax we need for Sun Studio.
- 	# Supported since Solaris 2.6 (maybe 2.5.1?)
- 	case $wlarc in
- 	'')
- 	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
- 	*)
- 	  whole_archive_flag_spec='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract' ;;
- 	esac ;;
+      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+	whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
       esac
       link_all_deplibs=yes
       ;;
@@ -7831,7 +7596,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi[45]*)
+bsdi4*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -7889,35 +7654,11 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
-  linux*)
-    if $LD --help 2&gt;&amp;1 | egrep ': supported targets:.* elf' &gt; /dev/null; then
-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      supports_anon_versioning=no
-      case `$LD -v 2&gt;/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        $archive_expsym_cmds=&quot;$archive_cmds&quot;
-      fi
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -7971,9 +7712,7 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd* | dragonfly*)
-  # DragonFly does not have aout.  When/if they implement a new
-  # versioning mechanism, adjust this.
+freebsd*)
   objformat=`test -x /usr/bin/objformat &amp;&amp; /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -7992,7 +7731,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[01]* | freebsdelf3.[01]*)
+  freebsd3.01* | freebsdelf3.01*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -8118,17 +7857,10 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf(&quot;cd /etc; cat %s&quot;, \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' &lt; /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
     sys_lib_dlsearch_path_spec=&quot;/lib /usr/lib $lt_ld_extra&quot;
   fi
 
-  case $host_cpu:$lt_cv_cc_64bit_output in
-  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
-    sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64 /usr/X11R6/lib64&quot;
-    sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64&quot;
-    ;;
-  esac
-
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -8136,30 +7868,18 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
+  ;;
 
-  # Find out which ABI we are using (multilib Linux x86_64 hack).
-  libsuff=
-  case &quot;$host_cpu&quot; in
-  x86_64*)
-    echo '#line 8144 &quot;configure&quot;' &gt; conftest.$ac_ext
-    if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
-  (eval $ac_compile) 2&gt;&amp;5
-  ac_status=$?
-  echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); }; then
-      case `/usr/bin/file conftest.$ac_objext` in
-      *64-bit*)
-        libsuff=64
-        ;;
-      esac
-    fi
-    rm -rf conftest*
-    ;;
-  *)
-    ;;
-  esac
-  sys_lib_dlsearch_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff}&quot;
-  sys_lib_search_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}&quot;
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
   ;;
 
 knetbsd*-gnu)
@@ -8212,11 +7932,7 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
-  case $host_os in
-    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
-    *)                         need_version=no  ;;
-  esac
+  need_version=yes
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH=&quot;\$PATH:/sbin&quot; ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -8338,8 +8054,8 @@
 echo $ECHO_N &quot;checking how to hardcode library paths into programs... $ECHO_C&quot; &gt;&amp;6
 hardcode_action=
 if test -n &quot;$hardcode_libdir_flag_spec&quot; || \
-   test -n &quot;$runpath_var&quot; || \
-   test &quot;X$hardcode_automatic&quot; = &quot;Xyes&quot; ; then
+   test -n &quot;$runpath_var &quot; || \
+   test &quot;X$hardcode_automatic&quot;=&quot;Xyes&quot; ; then
 
   # We can hardcode non-existant directories.
   if test &quot;$hardcode_direct&quot; != no &amp;&amp;
@@ -8465,8 +8181,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8569,8 +8284,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8635,8 +8349,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8729,8 +8442,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8795,8 +8507,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8862,8 +8573,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -8929,8 +8639,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -9005,7 +8714,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 9008 &quot;configure&quot;
+#line 8717 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -9103,7 +8812,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 9106 &quot;configure&quot;
+#line 8815 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -9232,6 +8941,43 @@
   if test &quot;$host_cpu&quot; != ia64 &amp;&amp; test &quot;$aix_use_runtimelinking&quot; = no ; then
     test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
   fi
+  ;;
+  darwin* | rhapsody*)
+  if test &quot;$GCC&quot; = yes; then
+    archive_cmds_need_lc=no
+    case &quot;$host_os&quot; in
+    rhapsody* | darwin1.[012])
+      allow_undefined_flag='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	allow_undefined_flag='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[012])
+            allow_undefined_flag='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            allow_undefined_flag='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+      ;;
+    esac
+    output_verbose_link_cmd='echo'
+    archive_cmds='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'
+    module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+    archive_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    module_expsym_cmds='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    hardcode_direct=no
+    hardcode_automatic=yes
+    hardcode_shlibpath_var=unsupported
+    whole_archive_flag_spec='-all_load $convenience'
+    link_all_deplibs=yes
+  else
+    ld_shlibs=no
+  fi
     ;;
 esac
 echo &quot;$as_me:$LINENO: result: $enable_shared&quot; &gt;&amp;5
@@ -9361,7 +9107,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -9372,11 +9118,11 @@
 SED=$lt_SED
 
 # Sed that helps us avoid accidentally triggering echo(1) options like -n.
-Xsed=&quot;$SED -e 1s/^X//&quot;
+Xsed=&quot;$SED -e s/^X//&quot;
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-(unset CDPATH) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; unset CDPATH
+if test &quot;X\${CDPATH+set}&quot; = Xset; then CDPATH=:; export CDPATH; fi
 
 # The names of the tagged configurations supported by this script.
 available_tags=
@@ -9406,13 +9152,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -9488,7 +9228,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -9783,9 +9523,7 @@
 
       case $tagname in
       CXX)
-	if test -n &quot;$CXX&quot; &amp;&amp; ( test &quot;X$CXX&quot; != &quot;Xno&quot; &amp;&amp;
-	    ( (test &quot;X$CXX&quot; = &quot;Xg++&quot; &amp;&amp; `g++ -v &gt;/dev/null 2&gt;&amp;1` ) ||
-	    (test &quot;X$CXX&quot; != &quot;Xg++&quot;))) ; then
+	if test -n &quot;$CXX&quot; &amp;&amp; test &quot;X$CXX&quot; != &quot;Xno&quot;; then
 	  ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext &gt;&amp;5'
@@ -9843,20 +9581,6 @@
 compiler=$CC
 
 
-# save warnings/boilerplate of simple test code
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=$CC
 lt_save_LD=$LD
@@ -9878,17 +9602,8 @@
 CC=${CXX-&quot;c++&quot;}
 compiler=$CC
 compiler_CXX=$CC
-for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
+cc_basename=`$echo X&quot;$compiler&quot; | $Xsed -e 's%^.*/%%'`
 
-
 # We don't want -fno-exception wen compiling C++ code, so set the
 # no_builtin_flag separately
 if test &quot;$GXX&quot; = yes; then
@@ -10101,7 +9816,7 @@
     link_all_deplibs_CXX=yes
 
     if test &quot;$GXX&quot; = yes; then
-      case $host_os in aix4.[012]|aix4.[012].*)
+      case $host_os in aix4.012|aix4.012.*)
       # We only want to do this on AIX 4.2 and lower, the check
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
@@ -10122,9 +9837,6 @@
 	fi
       esac
       shared_flag='-shared'
-      if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-      fi
     else
       # not using gcc
       if test &quot;$host_cpu&quot; = ia64; then
@@ -10172,8 +9884,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -10234,8 +9945,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -10286,7 +9996,6 @@
     esac
     ;;
 
-
   cygwin* | mingw* | pw32*)
     # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, CXX) is actually meaningless,
     # as there is no search path for DLLs.
@@ -10310,76 +10019,65 @@
       ld_shlibs_CXX=no
     fi
   ;;
-      darwin* | rhapsody*)
-        case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[012])
-         allow_undefined_flag_CXX='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           allow_undefined_flag_CXX='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[012])
-               allow_undefined_flag_CXX='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               allow_undefined_flag_CXX='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
-        esac
-      archive_cmds_need_lc_CXX=no
-      hardcode_direct_CXX=no
-      hardcode_automatic_CXX=yes
-      hardcode_shlibpath_var_CXX=unsupported
-      whole_archive_flag_spec_CXX=''
-      link_all_deplibs_CXX=yes
 
-    if test &quot;$GXX&quot; = yes ; then
-      lt_int_apple_cc_single_mod=no
-      output_verbose_link_cmd='echo'
-      if $CC -dumpspecs 2&gt;&amp;1 | $EGREP 'single_module' &gt;/dev/null ; then
-       lt_int_apple_cc_single_mod=yes
-      fi
-      if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
-       archive_cmds_CXX='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+  darwin* | rhapsody*)
+  if test &quot;$GXX&quot; = yes; then
+    archive_cmds_need_lc_CXX=no
+    case &quot;$host_os&quot; in
+    rhapsody* | darwin1.[012])
+      allow_undefined_flag_CXX='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
       else
-          archive_cmds_CXX='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-        fi
-        module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-        # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-          if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
-            archive_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          else
-            archive_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          fi
-            module_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-          module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-          archive_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          module_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         ld_shlibs_CXX=no
-          ;;
-      esac
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[012])
+            allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            allow_undefined_flag_CXX='-undefined dynamic_lookup'
+            ;;
+        esac
       fi
-        ;;
+      ;;
+    esac
+    lt_int_apple_cc_single_mod=no
+    output_verbose_link_cmd='echo'
+    if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+      lt_int_apple_cc_single_mod=yes
+    fi
+    if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+      archive_cmds_CXX='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    else
+      archive_cmds_CXX='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    fi
+    module_cmds_CXX='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
 
+    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+    if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+      archive_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    else
+      archive_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    fi
+    module_expsym_cmds_CXX='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+    hardcode_direct_CXX=no
+    hardcode_automatic_CXX=yes
+    hardcode_shlibpath_var_CXX=unsupported
+    whole_archive_flag_spec_CXX='-all_load $convenience'
+    link_all_deplibs_CXX=yes
+  else
+    ld_shlibs_CXX=no
+  fi
+    ;;
+
   dgux*)
     case $cc_basename in
-      ec++*)
+      ec++)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      ghcx*)
+      ghcx)
 	# Green Hills C++ Compiler
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -10390,14 +10088,14 @@
 	;;
     esac
     ;;
-  freebsd[12]*)
+  freebsd12*)
     # C++ shared libraries reported to be fairly broken before switch to ELF
     ld_shlibs_CXX=no
     ;;
   freebsd-elf*)
     archive_cmds_need_lc_CXX=no
     ;;
-  freebsd* | kfreebsd*-gnu | dragonfly*)
+  freebsd* | kfreebsd*-gnu)
     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
     # conventions
     ld_shlibs_CXX=yes
@@ -10414,11 +10112,11 @@
 				# location of the library.
 
     case $cc_basename in
-    CC*)
+    CC)
       # FIXME: insert proper C++ library support
       ld_shlibs_CXX=no
       ;;
-    aCC*)
+    aCC)
       archive_cmds_CXX='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
       # Commands to make compiler produce verbose output that lists
       # what &quot;hidden&quot; libraries, object files and flags are used when
@@ -10428,7 +10126,7 @@
       # explicitly linking system object files so we need to strip them
       # from the output so that they don't get included in the library
       # dependencies.
-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2&gt;&amp;1) | grep &quot;[-]L&quot;`; list=&quot;&quot;; for z in $templist; do case $z in conftest.$objext) list=&quot;$list $z&quot;;; *.$objext);; *) list=&quot;$list $z&quot;;;esac; done; echo $list'
+      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2&gt;&amp;1) | grep &quot;-L&quot;`; list=&quot;&quot;; for z in $templist; do case $z in conftest.$objext) list=&quot;$list $z&quot;;; *.$objext);; *) list=&quot;$list $z&quot;;;esac; done; echo $list'
       ;;
     *)
       if test &quot;$GXX&quot; = yes; then
@@ -10479,11 +10177,11 @@
     esac
 
     case $cc_basename in
-      CC*)
+      CC)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      aCC*)
+      aCC)
 	case &quot;$host_cpu&quot; in
 	hppa*64*|ia64*)
 	  archive_cmds_CXX='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
@@ -10523,9 +10221,9 @@
     ;;
   irix5* | irix6*)
     case $cc_basename in
-      CC*)
+      CC)
 	# SGI C++
-	archive_cmds_CXX='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 
 	# Archives containing C++ object files must be created using
 	# &quot;CC -ar&quot;, where &quot;CC&quot; is the IRIX C++ compiler.  This is
@@ -10536,7 +10234,7 @@
       *)
 	if test &quot;$GXX&quot; = yes; then
 	  if test &quot;$with_gnu_ld&quot; = no; then
-	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 	  else
 	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` -o $lib'
 	  fi
@@ -10549,7 +10247,7 @@
     ;;
   linux*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10574,41 +10272,17 @@
 	# &quot;CC -Bstatic&quot;, where &quot;CC&quot; is the KAI C++ compiler.
 	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
 	;;
-      icpc*)
+      icpc)
 	# Intel C++
 	with_gnu_ld=yes
-	# version 8.0 and above of icpc choke on multiply defined symbols
-	# if we add $predep_objects and $postdep_objects, however 7.1 and
-	# earlier do not add the objects themselves.
-	case `$CC -V 2&gt;&amp;1` in
-	*&quot;Version 7.&quot;*)
-  	  archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-  	  archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-	  ;;
-	*)  # Version 8.0 or newer
-	  tmp_idyn=
-	  case $host_cpu in
-	    ia64*) tmp_idyn=' -i_dynamic';;
-	  esac
-  	  archive_cmds_CXX='$CC -shared'&quot;$tmp_idyn&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	  archive_expsym_cmds_CXX='$CC -shared'&quot;$tmp_idyn&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-	  ;;
-	esac
 	archive_cmds_need_lc_CXX=no
+	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
 	hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
 	whole_archive_flag_spec_CXX='${wl}--whole-archive$convenience ${wl}--no-whole-archive'
 	;;
-      pgCC*)
-        # Portland Group C++ compiler
-	archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname -o $lib'
-  	archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname ${wl}-retain-symbols-file ${wl}$export_symbols -o $lib'
-
-	hardcode_libdir_flag_spec_CXX='${wl}--rpath ${wl}$libdir'
-	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
-	whole_archive_flag_spec_CXX='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-        ;;
-      cxx*)
+      cxx)
 	# Compaq C++
 	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'
@@ -10639,7 +10313,7 @@
     ;;
   mvs*)
     case $cc_basename in
-      cxx*)
+      cxx)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
@@ -10649,7 +10323,7 @@
 	;;
     esac
     ;;
-  netbsd*)
+  netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
     if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
       archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -10660,25 +10334,9 @@
     # Workaround some broken pre-1.5 toolchains
     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2&gt;&amp;1 | grep conftest.$objext | $SED -e &quot;s:-lgcc -lc -lgcc::&quot;'
     ;;
-  openbsd2*)
-    # C++ shared libraries are fairly broken
-    ld_shlibs_CXX=no
-    ;;
-  openbsd*)
-    hardcode_direct_CXX=yes
-    hardcode_shlibpath_var_CXX=no
-    archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-    if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
-      archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-      export_dynamic_flag_spec_CXX='${wl}-E'
-      whole_archive_flag_spec_CXX=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-    fi
-    output_verbose_link_cmd='echo'
-    ;;
   osf3*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10694,14 +10352,14 @@
 	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
 
 	;;
-      RCC*)
+      RCC)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      cxx*)
+      cxx)
 	allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 
 	hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	hardcode_libdir_separator_CXX=:
@@ -10719,7 +10377,7 @@
       *)
 	if test &quot;$GXX&quot; = yes &amp;&amp; test &quot;$with_gnu_ld&quot; = no; then
 	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	  archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	  archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	  hardcode_libdir_separator_CXX=:
@@ -10738,7 +10396,7 @@
     ;;
   osf4* | osf5*)
     case $cc_basename in
-      KCC*)
+      KCC)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10753,17 +10411,17 @@
 	# the KAI C++ compiler.
 	old_archive_cmds_CXX='$CC -o $oldlib $oldobjs'
 	;;
-      RCC*)
+      RCC)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      cxx*)
+      cxx)
 	allow_undefined_flag_CXX=' -expect_unresolved \*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
 	archive_expsym_cmds_CXX='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done~
 	  echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version	$verstring` -update_registry ${output_objdir}/so_locations -o $lib~
+	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version	$verstring` -update_registry $objdir/so_locations -o $lib~
 	  $rm $lib.exp'
 
 	hardcode_libdir_flag_spec_CXX='-rpath $libdir'
@@ -10782,7 +10440,7 @@
       *)
 	if test &quot;$GXX&quot; = yes &amp;&amp; test &quot;$with_gnu_ld&quot; = no; then
 	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	 archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+	 archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n &quot;$verstring&quot; &amp;&amp; echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	  hardcode_libdir_separator_CXX=:
@@ -10806,7 +10464,7 @@
   sco*)
     archive_cmds_need_lc_CXX=no
     case $cc_basename in
-      CC*)
+      CC)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
@@ -10818,12 +10476,12 @@
     ;;
   sunos4*)
     case $cc_basename in
-      CC*)
+      CC)
 	# Sun C++ 4.x
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      lcc*)
+      lcc)
 	# Lucid
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -10836,7 +10494,7 @@
     ;;
   solaris*)
     case $cc_basename in
-      CC*)
+      CC)
 	# Sun C++ 4.2, 5.x and Centerline C++
 	no_undefined_flag_CXX=' -zdefs'
 	archive_cmds_CXX='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
@@ -10846,17 +10504,13 @@
 	hardcode_libdir_flag_spec_CXX='-R$libdir'
 	hardcode_shlibpath_var_CXX=no
 	case $host_os in
-	  solaris2.[0-5] | solaris2.[0-5].*) ;;
+	  solaris2.0-5 | solaris2.0-5.*) ;;
 	  *)
 	    # The C++ compiler is used as linker so we must use $wl
 	    # flag to pass the commands to the underlying system
-	    # linker. We must also pass each convience library through
-	    # to the system linker between allextract/defaultextract.
-	    # The C++ compiler will combine linker options so we
-	    # cannot just pass the convience library names through
-	    # without $wl.
+	    # linker.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract'
+	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	link_all_deplibs_CXX=yes
@@ -10877,7 +10531,7 @@
 	# in the archive.
 	old_archive_cmds_CXX='$CC -xar -o $oldlib $oldobjs'
 	;;
-      gcx*)
+      gcx)
 	# Green Hills C++ Compiler
 	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 
@@ -10920,7 +10574,7 @@
     ;;
   tandem*)
     case $cc_basename in
-      NCC*)
+      NCC)
 	# NonStop-UX NCC 3.20
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -11129,28 +10783,18 @@
 	;;
       chorus*)
 	case $cc_basename in
-	cxch68*)
+	cxch68)
 	  # Green Hills C++ Compiler
 	  # _LT_AC_TAGVAR(lt_prog_compiler_static, CXX)=&quot;--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a&quot;
 	  ;;
 	esac
 	;;
-       darwin*)
-         # PIC is the default on this platform
-         # Common symbols not allowed in MH_DYLIB files
-         case $cc_basename in
-           xlc*)
-           lt_prog_compiler_pic_CXX='-qnocommon'
-           lt_prog_compiler_wl_CXX='-Wl,'
-           ;;
-         esac
-       ;;
       dgux*)
 	case $cc_basename in
-	  ec++*)
+	  ec++)
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    ;;
-	  ghcx*)
+	  ghcx)
 	    # Green Hills C++ Compiler
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
@@ -11158,19 +10802,19 @@
 	    ;;
 	esac
 	;;
-      freebsd* | kfreebsd*-gnu | dragonfly*)
+      freebsd* | kfreebsd*-gnu)
 	# FreeBSD uses GNU C++
 	;;
       hpux9* | hpux10* | hpux11*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX=&quot;${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive&quot;
 	    if test &quot;$host_cpu&quot; != ia64; then
 	      lt_prog_compiler_pic_CXX='+Z'
 	    fi
 	    ;;
-	  aCC*)
+	  aCC)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX=&quot;${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive&quot;
 	    case &quot;$host_cpu&quot; in
@@ -11188,7 +10832,7 @@
 	;;
       irix5* | irix6* | nonstopux*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX='-non_shared'
 	    # CC pic flag -KPIC is the default.
@@ -11199,24 +10843,18 @@
 	;;
       linux*)
 	case $cc_basename in
-	  KCC*)
+	  KCC)
 	    # KAI C++ Compiler
 	    lt_prog_compiler_wl_CXX='--backend -Wl,'
 	    lt_prog_compiler_pic_CXX='-fPIC'
 	    ;;
-	  icpc* | ecpc*)
+	  icpc)
 	    # Intel C++
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    lt_prog_compiler_static_CXX='-static'
 	    ;;
-	  pgCC*)
-	    # Portland Group C++ compiler.
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    lt_prog_compiler_pic_CXX='-fpic'
-	    lt_prog_compiler_static_CXX='-static'
-	    ;;
-	  cxx*)
+	  cxx)
 	    # Compaq C++
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
@@ -11233,25 +10871,25 @@
 	;;
       mvs*)
 	case $cc_basename in
-	  cxx*)
+	  cxx)
 	    lt_prog_compiler_pic_CXX='-W c,exportall'
 	    ;;
 	  *)
 	    ;;
 	esac
 	;;
-      netbsd*)
+      netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
-	  KCC*)
+	  KCC)
 	    lt_prog_compiler_wl_CXX='--backend -Wl,'
 	    ;;
-	  RCC*)
+	  RCC)
 	    # Rational C++ 2.4.1
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
-	  cxx*)
+	  cxx)
 	    # Digital/Compaq C++
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
@@ -11267,7 +10905,7 @@
 	;;
       sco*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    lt_prog_compiler_pic_CXX='-fPIC'
 	    ;;
 	  *)
@@ -11276,13 +10914,13 @@
 	;;
       solaris*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    # Sun C++ 4.2, 5.x and Centerline C++
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    lt_prog_compiler_static_CXX='-Bstatic'
 	    lt_prog_compiler_wl_CXX='-Qoption ld '
 	    ;;
-	  gcx*)
+	  gcx)
 	    # Green Hills C++ Compiler
 	    lt_prog_compiler_pic_CXX='-PIC'
 	    ;;
@@ -11292,12 +10930,12 @@
 	;;
       sunos4*)
 	case $cc_basename in
-	  CC*)
+	  CC)
 	    # Sun C++ 4.x
 	    lt_prog_compiler_pic_CXX='-pic'
 	    lt_prog_compiler_static_CXX='-Bstatic'
 	    ;;
-	  lcc*)
+	  lcc)
 	    # Lucid
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
@@ -11307,7 +10945,7 @@
 	;;
       tandem*)
 	case $cc_basename in
-	  NCC*)
+	  NCC)
 	    # NonStop-UX NCC 3.20
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    ;;
@@ -11351,17 +10989,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:11354: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:10992: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:11358: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:10996: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_prog_compiler_pic_works_CXX=yes
      fi
    fi
@@ -11413,18 +11049,16 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:11416: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:11052: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;out/conftest.err)
    ac_status=$?
    cat out/conftest.err &gt;&amp;5
-   echo &quot;$as_me:11420: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:11056: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt; out/conftest.exp
-     $SED '/^$/d' out/conftest.err &gt;out/conftest.er2
-     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 &gt;/dev/null; then
+     if test ! -s out/conftest.err; then
        lt_cv_prog_compiler_c_o_CXX=yes
      fi
    fi
@@ -11483,8 +11117,11 @@
     export_symbols_cmds_CXX=&quot;$ltdll_cmds&quot;
   ;;
   cygwin* | mingw*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([^ ]*\) [^ ]*/\1 DATA/;/^I /d;/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
   ;;
+  linux*)
+    link_all_deplibs_CXX=no
+  ;;
   *)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq &gt; $export_symbols'
   ;;
@@ -11663,7 +11300,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi[45]*)
+bsdi4*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -11721,35 +11358,11 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
-  linux*)
-    if $LD --help 2&gt;&amp;1 | egrep ': supported targets:.* elf' &gt; /dev/null; then
-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      supports_anon_versioning=no
-      case `$LD -v 2&gt;/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        $archive_expsym_cmds=&quot;$archive_cmds&quot;
-      fi
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -11803,9 +11416,7 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd* | dragonfly*)
-  # DragonFly does not have aout.  When/if they implement a new
-  # versioning mechanism, adjust this.
+freebsd*)
   objformat=`test -x /usr/bin/objformat &amp;&amp; /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -11824,7 +11435,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[01]* | freebsdelf3.[01]*)
+  freebsd3.01* | freebsdelf3.01*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -11950,17 +11561,10 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf(&quot;cd /etc; cat %s&quot;, \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' &lt; /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
     sys_lib_dlsearch_path_spec=&quot;/lib /usr/lib $lt_ld_extra&quot;
   fi
 
-  case $host_cpu:$lt_cv_cc_64bit_output in
-  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
-    sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64 /usr/X11R6/lib64&quot;
-    sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64&quot;
-    ;;
-  esac
-
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -11968,30 +11572,18 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
+  ;;
 
-  # Find out which ABI we are using (multilib Linux x86_64 hack).
-  libsuff=
-  case &quot;$host_cpu&quot; in
-  x86_64*)
-    echo '#line 11976 &quot;configure&quot;' &gt; conftest.$ac_ext
-    if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
-  (eval $ac_compile) 2&gt;&amp;5
-  ac_status=$?
-  echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); }; then
-      case `/usr/bin/file conftest.$ac_objext` in
-      *64-bit*)
-        libsuff=64
-        ;;
-      esac
-    fi
-    rm -rf conftest*
-    ;;
-  *)
-    ;;
-  esac
-  sys_lib_dlsearch_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff}&quot;
-  sys_lib_search_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}&quot;
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
   ;;
 
 knetbsd*-gnu)
@@ -12044,11 +11636,7 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
-  case $host_os in
-    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
-    *)                         need_version=no  ;;
-  esac
+  need_version=yes
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH=&quot;\$PATH:/sbin&quot; ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -12170,8 +11758,8 @@
 echo $ECHO_N &quot;checking how to hardcode library paths into programs... $ECHO_C&quot; &gt;&amp;6
 hardcode_action_CXX=
 if test -n &quot;$hardcode_libdir_flag_spec_CXX&quot; || \
-   test -n &quot;$runpath_var_CXX&quot; || \
-   test &quot;X$hardcode_automatic_CXX&quot; = &quot;Xyes&quot; ; then
+   test -n &quot;$runpath_var CXX&quot; || \
+   test &quot;X$hardcode_automatic_CXX&quot;=&quot;Xyes&quot; ; then
 
   # We can hardcode non-existant directories.
   if test &quot;$hardcode_direct_CXX&quot; != no &amp;&amp;
@@ -12297,8 +11885,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12401,8 +11988,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12467,8 +12053,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12561,8 +12146,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12627,8 +12211,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12694,8 +12277,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12761,8 +12343,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -12837,7 +12418,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 12840 &quot;configure&quot;
+#line 12421 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -12935,7 +12516,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 12938 &quot;configure&quot;
+#line 12519 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -13153,13 +12734,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -13235,7 +12810,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_CXX
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -13516,36 +13091,13 @@
 compiler=$CC
 
 
-# save warnings/boilerplate of simple test code
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${F77-&quot;f77&quot;}
 compiler=$CC
 compiler_F77=$CC
-for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
+cc_basename=`$echo X&quot;$compiler&quot; | $Xsed -e 's%^.*/%%'`
 
-
 echo &quot;$as_me:$LINENO: checking if libtool supports shared libraries&quot; &gt;&amp;5
 echo $ECHO_N &quot;checking if libtool supports shared libraries... $ECHO_C&quot; &gt;&amp;6
 echo &quot;$as_me:$LINENO: result: $can_build_shared&quot; &gt;&amp;5
@@ -13566,9 +13118,7 @@
   fi
   ;;
 aix4* | aix5*)
-  if test &quot;$host_cpu&quot; != ia64 &amp;&amp; test &quot;$aix_use_runtimelinking&quot; = no ; then
-    test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
-  fi
+  test &quot;$enable_shared&quot; = yes &amp;&amp; enable_static=no
   ;;
 esac
 echo &quot;$as_me:$LINENO: result: $enable_shared&quot; &gt;&amp;5
@@ -13671,16 +13221,6 @@
 	lt_prog_compiler_static_F77='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
-      darwin*)
-        # PIC is the default on this platform
-        # Common symbols not allowed in MH_DYLIB files
-       case $cc_basename in
-         xlc*)
-         lt_prog_compiler_pic_F77='-qnocommon'
-         lt_prog_compiler_wl_F77='-Wl,'
-         ;;
-       esac
-       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -13716,19 +13256,12 @@
       ;;
 
     linux*)
-      case $cc_basename in
+      case $CC in
       icc* | ecc*)
 	lt_prog_compiler_wl_F77='-Wl,'
 	lt_prog_compiler_pic_F77='-KPIC'
 	lt_prog_compiler_static_F77='-static'
         ;;
-      pgcc* | pgf77* | pgf90*)
-        # Portland Group compilers (*not* the Pentium gcc compiler,
-	# which looks to be a dead project)
-	lt_prog_compiler_wl_F77='-Wl,'
-	lt_prog_compiler_pic_F77='-fpic'
-	lt_prog_compiler_static_F77='-static'
-        ;;
       ccc*)
         lt_prog_compiler_wl_F77='-Wl,'
         # All Alpha code is PIC.
@@ -13749,14 +13282,9 @@
       ;;
 
     solaris*)
+      lt_prog_compiler_wl_F77='-Wl,'
       lt_prog_compiler_pic_F77='-KPIC'
       lt_prog_compiler_static_F77='-Bstatic'
-      case $cc_basename in
-      f77* | f90* | f95*)
-	lt_prog_compiler_wl_F77='-Qoption ld ';;
-      *)
-	lt_prog_compiler_wl_F77='-Wl,';;
-      esac
       ;;
 
     sunos4*)
@@ -13778,11 +13306,6 @@
       fi
       ;;
 
-    unicos*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      lt_prog_compiler_can_build_shared_F77=no
-      ;;
-
     uts4*)
       lt_prog_compiler_pic_F77='-pic'
       lt_prog_compiler_static_F77='-Bstatic'
@@ -13820,17 +13343,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:13823: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:13346: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:13827: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:13350: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_prog_compiler_pic_works_F77=yes
      fi
    fi
@@ -13882,18 +13403,16 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:13885: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:13406: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;out/conftest.err)
    ac_status=$?
    cat out/conftest.err &gt;&amp;5
-   echo &quot;$as_me:13889: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:13410: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt; out/conftest.exp
-     $SED '/^$/d' out/conftest.err &gt;out/conftest.er2
-     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 &gt;/dev/null; then
+     if test ! -s out/conftest.err; then
        lt_cv_prog_compiler_c_o_F77=yes
      fi
    fi
@@ -13973,16 +13492,6 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
-  # Just being paranoid about ensuring that cc_basename is set.
-  for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -14003,27 +13512,6 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
-    # Set some defaults for GNU ld with shared library support. These
-    # are reset later if shared libraries are not supported. Putting them
-    # here allows them to be overridden if necessary.
-    runpath_var=LD_RUN_PATH
-    hardcode_libdir_flag_spec_F77='${wl}--rpath ${wl}$libdir'
-    export_dynamic_flag_spec_F77='${wl}--export-dynamic'
-    # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
-	whole_archive_flag_spec_F77=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_F77=
-    fi
-    supports_anon_versioning=no
-    case `$LD -v 2&gt;/dev/null` in
-      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-      *\ 2.11.*) ;; # other 2.11 versions
-      *) supports_anon_versioning=yes ;;
-    esac
-
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -14074,7 +13562,7 @@
       allow_undefined_flag_F77=unsupported
       always_export_symbols_F77=no
       enable_shared_with_static_runtimes_F77=yes
-      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
 
       if $LD --help 2&gt;&amp;1 | grep 'auto-import' &gt; /dev/null; then
         archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -14088,42 +13576,11 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	ld_shlibs_F77=no
+	ld_shlibs=no
       fi
       ;;
 
-    linux*)
-      if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
-	tmp_addflag=
-	case $cc_basename,$host_cpu in
-	pgcc*)				# Portland Group C compiler
-	  whole_archive_flag_spec_F77='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag'
-	  ;;
-	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
-	  whole_archive_flag_spec_F77='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag -Mnomain' ;;
-	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
-	  tmp_addflag=' -i_dynamic' ;;
-	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
-	  tmp_addflag=' -i_dynamic -nofor_main' ;;
-	ifc* | ifort*)			# Intel Fortran compiler
-	  tmp_addflag=' -nofor_main' ;;
-	esac
-	archive_cmds_F77='$CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-
-	if test $supports_anon_versioning = yes; then
-	  archive_expsym_cmds_F77='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-  cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-  $echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-	  $CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-	fi
-      else
-	ld_shlibs_F77=no
-      fi
-      ;;
-
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds_F77='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -14161,6 +13618,32 @@
       hardcode_shlibpath_var_F77=no
       ;;
 
+  linux*)
+    if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
+        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_F77=&quot;$tmp_archive_cmds&quot;
+      supports_anon_versioning=no
+      case `$LD -v 2&gt;/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds_F77='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
+cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
+$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        archive_expsym_cmds_F77=&quot;$tmp_archive_cmds&quot;
+      fi
+      link_all_deplibs_F77=no
+    else
+      ld_shlibs_F77=no
+    fi
+    ;;
+
     *)
       if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
 	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -14171,11 +13654,16 @@
       ;;
     esac
 
-    if test &quot;$ld_shlibs_F77&quot; = no; then
-      runpath_var=
-      hardcode_libdir_flag_spec_F77=
-      export_dynamic_flag_spec_F77=
-      whole_archive_flag_spec_F77=
+    if test &quot;$ld_shlibs_F77&quot; = yes; then
+      runpath_var=LD_RUN_PATH
+      hardcode_libdir_flag_spec_F77='${wl}--rpath ${wl}$libdir'
+      export_dynamic_flag_spec_F77='${wl}--export-dynamic'
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
+ 	whole_archive_flag_spec_F77=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
+      else
+  	whole_archive_flag_spec_F77=
+      fi
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -14239,7 +13727,7 @@
       link_all_deplibs_F77=yes
 
       if test &quot;$GCC&quot; = yes; then
-	case $host_os in aix4.[012]|aix4.[012].*)
+	case $host_os in aix4.012|aix4.012.*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -14260,9 +13748,6 @@
 	  fi
 	esac
 	shared_flag='-shared'
-	if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	  shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-	fi
       else
 	# not using gcc
 	if test &quot;$host_cpu&quot; = ia64; then
@@ -14300,8 +13785,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -14351,8 +13835,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_f77_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -14403,7 +13886,7 @@
       ld_shlibs_F77=no
       ;;
 
-    bsdi[45]*)
+    bsdi4*)
       export_dynamic_flag_spec_F77=-rdynamic
       ;;
 
@@ -14424,57 +13907,57 @@
       old_archive_From_new_cmds_F77='true'
       # FIXME: Should let the user specify the lib program.
       old_archive_cmds_F77='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path_F77='`cygpath -w &quot;$srcfile&quot;`'
+      fix_srcfile_path='`cygpath -w &quot;$srcfile&quot;`'
       enable_shared_with_static_runtimes_F77=yes
       ;;
 
     darwin* | rhapsody*)
+    if test &quot;$GXX&quot; = yes ; then
+      archive_cmds_need_lc_F77=no
       case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[012])
-         allow_undefined_flag_F77='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           allow_undefined_flag_F77='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[012])
-               allow_undefined_flag_F77='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               allow_undefined_flag_F77='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
+      rhapsody* | darwin1.[012])
+	allow_undefined_flag_F77='-undefined suppress'
+	;;
+      *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	allow_undefined_flag_F77='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[012])
+            allow_undefined_flag_F77='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            allow_undefined_flag_F77='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+	;;
       esac
-      archive_cmds_need_lc_F77=no
+    	lt_int_apple_cc_single_mod=no
+    	output_verbose_link_cmd='echo'
+    	if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+    	  lt_int_apple_cc_single_mod=yes
+    	fi
+    	if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+    	  archive_cmds_F77='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    	else
+        archive_cmds_F77='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      fi
+      module_cmds_F77='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+        if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+          archive_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        else
+          archive_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        fi
+          module_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       hardcode_direct_F77=no
       hardcode_automatic_F77=yes
       hardcode_shlibpath_var_F77=unsupported
-      whole_archive_flag_spec_F77=''
+      whole_archive_flag_spec_F77='-all_load $convenience'
       link_all_deplibs_F77=yes
-    if test &quot;$GCC&quot; = yes ; then
-    	output_verbose_link_cmd='echo'
-        archive_cmds_F77='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-      archive_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      module_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-         module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-         archive_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          module_expsym_cmds_F77='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         ld_shlibs_F77=no
-          ;;
-      esac
+      ld_shlibs_F77=no
     fi
       ;;
 
@@ -14508,7 +13991,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu | dragonfly*)
+    freebsd* | kfreebsd*-gnu)
       archive_cmds_F77='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec_F77='-R$libdir'
       hardcode_direct_F77=yes
@@ -14595,7 +14078,7 @@
       link_all_deplibs_F77=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -14619,7 +14102,6 @@
       hardcode_shlibpath_var_F77=no
       if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
 	archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_F77='${wl}-E'
       else
@@ -14665,7 +14147,7 @@
 	allow_undefined_flag_F77=' -expect_unresolved \*'
 	archive_cmds_F77='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds_F77='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done; echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec_F77='-rpath $libdir'
@@ -14684,12 +14166,10 @@
     solaris*)
       no_undefined_flag_F77=' -z text'
       if test &quot;$GCC&quot; = yes; then
-	wlarc='${wl}'
 	archive_cmds_F77='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds_F77='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
-	wlarc=''
 	archive_cmds_F77='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds_F77='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -14698,18 +14178,8 @@
       hardcode_shlibpath_var_F77=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *)
- 	# The compiler driver will combine linker options so we
- 	# cannot just pass the convience library names through
- 	# without $wl, iff we do not link with $LD.
- 	# Luckily, gcc supports the same syntax we need for Sun Studio.
- 	# Supported since Solaris 2.6 (maybe 2.5.1?)
- 	case $wlarc in
- 	'')
- 	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
- 	*)
- 	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract' ;;
- 	esac ;;
+      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+	whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
       esac
       link_all_deplibs_F77=yes
       ;;
@@ -14983,7 +14453,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi[45]*)
+bsdi4*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -15041,35 +14511,11 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
-  linux*)
-    if $LD --help 2&gt;&amp;1 | egrep ': supported targets:.* elf' &gt; /dev/null; then
-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      supports_anon_versioning=no
-      case `$LD -v 2&gt;/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        $archive_expsym_cmds=&quot;$archive_cmds&quot;
-      fi
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -15123,9 +14569,7 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd* | dragonfly*)
-  # DragonFly does not have aout.  When/if they implement a new
-  # versioning mechanism, adjust this.
+freebsd*)
   objformat=`test -x /usr/bin/objformat &amp;&amp; /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -15144,7 +14588,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[01]* | freebsdelf3.[01]*)
+  freebsd3.01* | freebsdelf3.01*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -15270,17 +14714,10 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf(&quot;cd /etc; cat %s&quot;, \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' &lt; /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
     sys_lib_dlsearch_path_spec=&quot;/lib /usr/lib $lt_ld_extra&quot;
   fi
 
-  case $host_cpu:$lt_cv_cc_64bit_output in
-  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
-    sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64 /usr/X11R6/lib64&quot;
-    sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64&quot;
-    ;;
-  esac
-
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -15288,30 +14725,18 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
+  ;;
 
-  # Find out which ABI we are using (multilib Linux x86_64 hack).
-  libsuff=
-  case &quot;$host_cpu&quot; in
-  x86_64*)
-    echo '#line 15296 &quot;configure&quot;' &gt; conftest.$ac_ext
-    if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
-  (eval $ac_compile) 2&gt;&amp;5
-  ac_status=$?
-  echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); }; then
-      case `/usr/bin/file conftest.$ac_objext` in
-      *64-bit*)
-        libsuff=64
-        ;;
-      esac
-    fi
-    rm -rf conftest*
-    ;;
-  *)
-    ;;
-  esac
-  sys_lib_dlsearch_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff}&quot;
-  sys_lib_search_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}&quot;
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
   ;;
 
 knetbsd*-gnu)
@@ -15364,11 +14789,7 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
-  case $host_os in
-    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
-    *)                         need_version=no  ;;
-  esac
+  need_version=yes
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH=&quot;\$PATH:/sbin&quot; ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -15490,8 +14911,8 @@
 echo $ECHO_N &quot;checking how to hardcode library paths into programs... $ECHO_C&quot; &gt;&amp;6
 hardcode_action_F77=
 if test -n &quot;$hardcode_libdir_flag_spec_F77&quot; || \
-   test -n &quot;$runpath_var_F77&quot; || \
-   test &quot;X$hardcode_automatic_F77&quot; = &quot;Xyes&quot; ; then
+   test -n &quot;$runpath_var F77&quot; || \
+   test &quot;X$hardcode_automatic_F77&quot;=&quot;Xyes&quot; ; then
 
   # We can hardcode non-existant directories.
   if test &quot;$hardcode_direct_F77&quot; != no &amp;&amp;
@@ -15668,13 +15089,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -15750,7 +15165,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_F77
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -15988,7 +15403,7 @@
 lt_simple_compile_test_code=&quot;class foo {}\n&quot;
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
+lt_simple_link_test_code='public class conftest { public static void main(String argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
@@ -15999,42 +15414,16 @@
 compiler=$CC
 
 
-# save warnings/boilerplate of simple test code
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${GCJ-&quot;gcj&quot;}
 compiler=$CC
 compiler_GCJ=$CC
-for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
 
-
 # GCJ did not exist at the time GCC didn't implicitly link libc in.
 archive_cmds_need_lc_GCJ=no
 
-old_archive_cmds_GCJ=$old_archive_cmds
 
-
 lt_prog_compiler_no_builtin_flag_GCJ=
 
 if test &quot;$GCC&quot; = yes; then
@@ -16059,17 +15448,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:16062: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:15451: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:16066: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:15455: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
@@ -16172,16 +15559,6 @@
 	lt_prog_compiler_static_GCJ='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
-      darwin*)
-        # PIC is the default on this platform
-        # Common symbols not allowed in MH_DYLIB files
-       case $cc_basename in
-         xlc*)
-         lt_prog_compiler_pic_GCJ='-qnocommon'
-         lt_prog_compiler_wl_GCJ='-Wl,'
-         ;;
-       esac
-       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -16217,19 +15594,12 @@
       ;;
 
     linux*)
-      case $cc_basename in
+      case $CC in
       icc* | ecc*)
 	lt_prog_compiler_wl_GCJ='-Wl,'
 	lt_prog_compiler_pic_GCJ='-KPIC'
 	lt_prog_compiler_static_GCJ='-static'
         ;;
-      pgcc* | pgf77* | pgf90*)
-        # Portland Group compilers (*not* the Pentium gcc compiler,
-	# which looks to be a dead project)
-	lt_prog_compiler_wl_GCJ='-Wl,'
-	lt_prog_compiler_pic_GCJ='-fpic'
-	lt_prog_compiler_static_GCJ='-static'
-        ;;
       ccc*)
         lt_prog_compiler_wl_GCJ='-Wl,'
         # All Alpha code is PIC.
@@ -16250,14 +15620,9 @@
       ;;
 
     solaris*)
+      lt_prog_compiler_wl_GCJ='-Wl,'
       lt_prog_compiler_pic_GCJ='-KPIC'
       lt_prog_compiler_static_GCJ='-Bstatic'
-      case $cc_basename in
-      f77* | f90* | f95*)
-	lt_prog_compiler_wl_GCJ='-Qoption ld ';;
-      *)
-	lt_prog_compiler_wl_GCJ='-Wl,';;
-      esac
       ;;
 
     sunos4*)
@@ -16279,11 +15644,6 @@
       fi
       ;;
 
-    unicos*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      lt_prog_compiler_can_build_shared_GCJ=no
-      ;;
-
     uts4*)
       lt_prog_compiler_pic_GCJ='-pic'
       lt_prog_compiler_static_GCJ='-Bstatic'
@@ -16321,17 +15681,15 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:16324: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:15684: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;conftest.err)
    ac_status=$?
    cat conftest.err &gt;&amp;5
-   echo &quot;$as_me:16328: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:15688: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s &quot;$ac_outfile&quot;; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings other than the usual output.
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt;conftest.exp
-     $SED '/^$/d' conftest.err &gt;conftest.er2
-     if test ! -s conftest.err || diff conftest.exp conftest.er2 &gt;/dev/null; then
+     # So say no if there are warnings
+     if test ! -s conftest.err; then
        lt_prog_compiler_pic_works_GCJ=yes
      fi
    fi
@@ -16383,18 +15741,16 @@
    -e 's:.*FLAGS}? :&amp;$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&amp;:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo &quot;\&quot;\$as_me:16386: $lt_compile\&quot;&quot; &gt;&amp;5)
+   (eval echo &quot;\&quot;\$as_me:15744: $lt_compile\&quot;&quot; &gt;&amp;5)
    (eval &quot;$lt_compile&quot; 2&gt;out/conftest.err)
    ac_status=$?
    cat out/conftest.err &gt;&amp;5
-   echo &quot;$as_me:16390: \$? = $ac_status&quot; &gt;&amp;5
+   echo &quot;$as_me:15748: \$? = $ac_status&quot; &gt;&amp;5
    if (exit $ac_status) &amp;&amp; test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     $echo &quot;X$_lt_compiler_boilerplate&quot; | $Xsed &gt; out/conftest.exp
-     $SED '/^$/d' out/conftest.err &gt;out/conftest.er2
-     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 &gt;/dev/null; then
+     if test ! -s out/conftest.err; then
        lt_cv_prog_compiler_c_o_GCJ=yes
      fi
    fi
@@ -16474,16 +15830,6 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
-  # Just being paranoid about ensuring that cc_basename is set.
-  for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -16504,27 +15850,6 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
-    # Set some defaults for GNU ld with shared library support. These
-    # are reset later if shared libraries are not supported. Putting them
-    # here allows them to be overridden if necessary.
-    runpath_var=LD_RUN_PATH
-    hardcode_libdir_flag_spec_GCJ='${wl}--rpath ${wl}$libdir'
-    export_dynamic_flag_spec_GCJ='${wl}--export-dynamic'
-    # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
-	whole_archive_flag_spec_GCJ=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_GCJ=
-    fi
-    supports_anon_versioning=no
-    case `$LD -v 2&gt;/dev/null` in
-      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-      *\ 2.11.*) ;; # other 2.11 versions
-      *) supports_anon_versioning=yes ;;
-    esac
-
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -16575,7 +15900,7 @@
       allow_undefined_flag_GCJ=unsupported
       always_export_symbols_GCJ=no
       enable_shared_with_static_runtimes_GCJ=yes
-      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
+      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq &gt; $export_symbols'
 
       if $LD --help 2&gt;&amp;1 | grep 'auto-import' &gt; /dev/null; then
         archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -16589,42 +15914,11 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	ld_shlibs_GCJ=no
+	ld_shlibs=no
       fi
       ;;
 
-    linux*)
-      if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
-	tmp_addflag=
-	case $cc_basename,$host_cpu in
-	pgcc*)				# Portland Group C compiler
-	  whole_archive_flag_spec_GCJ='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag'
-	  ;;
-	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
-	  whole_archive_flag_spec_GCJ='${wl}--whole-archive,`for conv in $convenience\&quot;\&quot;; do test  -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}--no-whole-archive'
-	  tmp_addflag=' $pic_flag -Mnomain' ;;
-	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
-	  tmp_addflag=' -i_dynamic' ;;
-	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
-	  tmp_addflag=' -i_dynamic -nofor_main' ;;
-	ifc* | ifort*)			# Intel Fortran compiler
-	  tmp_addflag=' -nofor_main' ;;
-	esac
-	archive_cmds_GCJ='$CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-
-	if test $supports_anon_versioning = yes; then
-	  archive_expsym_cmds_GCJ='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-  cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-  $echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-	  $CC -shared'&quot;$tmp_addflag&quot;' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-	fi
-      else
-	ld_shlibs_GCJ=no
-      fi
-      ;;
-
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -16662,6 +15956,32 @@
       hardcode_shlibpath_var_GCJ=no
       ;;
 
+  linux*)
+    if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
+        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_GCJ=&quot;$tmp_archive_cmds&quot;
+      supports_anon_versioning=no
+      case `$LD -v 2&gt;/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds_GCJ='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
+cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
+$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        archive_expsym_cmds_GCJ=&quot;$tmp_archive_cmds&quot;
+      fi
+      link_all_deplibs_GCJ=no
+    else
+      ld_shlibs_GCJ=no
+    fi
+    ;;
+
     *)
       if $LD --help 2&gt;&amp;1 | grep ': supported targets:.* elf' &gt; /dev/null; then
 	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -16672,11 +15992,16 @@
       ;;
     esac
 
-    if test &quot;$ld_shlibs_GCJ&quot; = no; then
-      runpath_var=
-      hardcode_libdir_flag_spec_GCJ=
-      export_dynamic_flag_spec_GCJ=
-      whole_archive_flag_spec_GCJ=
+    if test &quot;$ld_shlibs_GCJ&quot; = yes; then
+      runpath_var=LD_RUN_PATH
+      hardcode_libdir_flag_spec_GCJ='${wl}--rpath ${wl}$libdir'
+      export_dynamic_flag_spec_GCJ='${wl}--export-dynamic'
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2&gt;&amp;1 | grep 'no-whole-archive' &gt; /dev/null; then
+ 	whole_archive_flag_spec_GCJ=&quot;$wlarc&quot;'--whole-archive$convenience '&quot;$wlarc&quot;'--no-whole-archive'
+      else
+  	whole_archive_flag_spec_GCJ=
+      fi
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -16740,7 +16065,7 @@
       link_all_deplibs_GCJ=yes
 
       if test &quot;$GCC&quot; = yes; then
-	case $host_os in aix4.[012]|aix4.[012].*)
+	case $host_os in aix4.012|aix4.012.*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -16761,9 +16086,6 @@
 	  fi
 	esac
 	shared_flag='-shared'
-	if test &quot;$aix_use_runtimelinking&quot; = yes; then
-	  shared_flag=&quot;$shared_flag &quot;'${wl}-G'
-	fi
       else
 	# not using gcc
 	if test &quot;$host_cpu&quot; = ia64; then
@@ -16811,8 +16133,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -16872,8 +16193,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -16924,7 +16244,7 @@
       ld_shlibs_GCJ=no
       ;;
 
-    bsdi[45]*)
+    bsdi4*)
       export_dynamic_flag_spec_GCJ=-rdynamic
       ;;
 
@@ -16945,57 +16265,57 @@
       old_archive_From_new_cmds_GCJ='true'
       # FIXME: Should let the user specify the lib program.
       old_archive_cmds_GCJ='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path_GCJ='`cygpath -w &quot;$srcfile&quot;`'
+      fix_srcfile_path='`cygpath -w &quot;$srcfile&quot;`'
       enable_shared_with_static_runtimes_GCJ=yes
       ;;
 
     darwin* | rhapsody*)
+    if test &quot;$GXX&quot; = yes ; then
+      archive_cmds_need_lc_GCJ=no
       case &quot;$host_os&quot; in
-        rhapsody* | darwin1.[012])
-         allow_undefined_flag_GCJ='${wl}-undefined ${wl}suppress'
-         ;;
-       *) # Darwin 1.3 on
-         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-           allow_undefined_flag_GCJ='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-         else
-           case ${MACOSX_DEPLOYMENT_TARGET} in
-             10.[012])
-               allow_undefined_flag_GCJ='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
-               ;;
-             10.*)
-               allow_undefined_flag_GCJ='${wl}-undefined ${wl}dynamic_lookup'
-               ;;
-           esac
-         fi
-         ;;
+      rhapsody* | darwin1.[012])
+	allow_undefined_flag_GCJ='-undefined suppress'
+	;;
+      *) # Darwin 1.3 on
+      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+      	allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
+      else
+        case ${MACOSX_DEPLOYMENT_TARGET} in
+          10.[012])
+            allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
+            ;;
+          10.*)
+            allow_undefined_flag_GCJ='-undefined dynamic_lookup'
+            ;;
+        esac
+      fi
+	;;
       esac
-      archive_cmds_need_lc_GCJ=no
+    	lt_int_apple_cc_single_mod=no
+    	output_verbose_link_cmd='echo'
+    	if $CC -dumpspecs 2&gt;&amp;1 | grep 'single_module' &gt;/dev/null ; then
+    	  lt_int_apple_cc_single_mod=yes
+    	fi
+    	if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+    	  archive_cmds_GCJ='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+    	else
+        archive_cmds_GCJ='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      fi
+      module_cmds_GCJ='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+        if test &quot;X$lt_int_apple_cc_single_mod&quot; = Xyes ; then
+          archive_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        else
+          archive_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+        fi
+          module_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       hardcode_direct_GCJ=no
       hardcode_automatic_GCJ=yes
       hardcode_shlibpath_var_GCJ=unsupported
-      whole_archive_flag_spec_GCJ=''
+      whole_archive_flag_spec_GCJ='-all_load $convenience'
       link_all_deplibs_GCJ=yes
-    if test &quot;$GCC&quot; = yes ; then
-    	output_verbose_link_cmd='echo'
-        archive_cmds_GCJ='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-      archive_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      module_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      case $cc_basename in
-        xlc*)
-         output_verbose_link_cmd='echo'
-         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
-         module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-         archive_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          module_expsym_cmds_GCJ='sed -e &quot;s,#.*,,&quot; -e &quot;s,^[    ]*,,&quot; -e &quot;s,^\(..*\),_&amp;,&quot; &lt; $export_symbols &gt; $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-          ;;
-       *)
-         ld_shlibs_GCJ=no
-          ;;
-      esac
+      ld_shlibs_GCJ=no
     fi
       ;;
 
@@ -17029,7 +16349,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu | dragonfly*)
+    freebsd* | kfreebsd*-gnu)
       archive_cmds_GCJ='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec_GCJ='-R$libdir'
       hardcode_direct_GCJ=yes
@@ -17116,7 +16436,7 @@
       link_all_deplibs_GCJ=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ &gt;/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -17140,7 +16460,6 @@
       hardcode_shlibpath_var_GCJ=no
       if test -z &quot;`echo __ELF__ | $CC -E - | grep __ELF__`&quot; || test &quot;$host_os-$host_cpu&quot; = &quot;openbsd2.8-powerpc&quot;; then
 	archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_GCJ='${wl}-E'
       else
@@ -17186,7 +16505,7 @@
 	allow_undefined_flag_GCJ=' -expect_unresolved \*'
 	archive_cmds_GCJ='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds_GCJ='for i in `cat $export_symbols`; do printf &quot;%s %s\\n&quot; -exported_symbol &quot;\$i&quot; &gt;&gt; $lib.exp; done; echo &quot;-hidden&quot;&gt;&gt; $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n &quot;$verstring&quot; &amp;&amp; echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec_GCJ='-rpath $libdir'
@@ -17205,12 +16524,10 @@
     solaris*)
       no_undefined_flag_GCJ=' -z text'
       if test &quot;$GCC&quot; = yes; then
-	wlarc='${wl}'
 	archive_cmds_GCJ='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds_GCJ='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
-	wlarc=''
 	archive_cmds_GCJ='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds_GCJ='$echo &quot;{ global:&quot; &gt; $lib.exp~cat $export_symbols | $SED -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $lib.exp~$echo &quot;local: *; };&quot; &gt;&gt; $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -17219,18 +16536,8 @@
       hardcode_shlibpath_var_GCJ=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *)
- 	# The compiler driver will combine linker options so we
- 	# cannot just pass the convience library names through
- 	# without $wl, iff we do not link with $LD.
- 	# Luckily, gcc supports the same syntax we need for Sun Studio.
- 	# Supported since Solaris 2.6 (maybe 2.5.1?)
- 	case $wlarc in
- 	'')
- 	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
- 	*)
- 	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract`for conv in $convenience\&quot;\&quot;; do test -n \&quot;$conv\&quot; &amp;&amp; new_convenience=\&quot;$new_convenience,$conv\&quot;; done; $echo \&quot;$new_convenience\&quot;` ${wl}-z ${wl}defaultextract' ;;
- 	esac ;;
+      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+	whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
       esac
       link_all_deplibs_GCJ=yes
       ;;
@@ -17504,7 +16811,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi[45]*)
+bsdi4*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -17562,35 +16869,11 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
-  linux*)
-    if $LD --help 2&gt;&amp;1 | egrep ': supported targets:.* elf' &gt; /dev/null; then
-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      supports_anon_versioning=no
-      case `$LD -v 2&gt;/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions &lt; 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo &quot;{ global:&quot; &gt; $output_objdir/$libname.ver~
-cat $export_symbols | sed -e &quot;s/\(.*\)/\1;/&quot; &gt;&gt; $output_objdir/$libname.ver~
-$echo &quot;local: *; };&quot; &gt;&gt; $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        $archive_expsym_cmds=&quot;$archive_cmds&quot;
-      fi
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -17644,9 +16927,7 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd* | dragonfly*)
-  # DragonFly does not have aout.  When/if they implement a new
-  # versioning mechanism, adjust this.
+freebsd*)
   objformat=`test -x /usr/bin/objformat &amp;&amp; /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -17665,7 +16946,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[01]* | freebsdelf3.[01]*)
+  freebsd3.01* | freebsdelf3.01*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -17791,17 +17072,10 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf(&quot;cd /etc; cat %s&quot;, \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' &lt; /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
     sys_lib_dlsearch_path_spec=&quot;/lib /usr/lib $lt_ld_extra&quot;
   fi
 
-  case $host_cpu:$lt_cv_cc_64bit_output in
-  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
-    sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64 /usr/X11R6/lib64&quot;
-    sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64&quot;
-    ;;
-  esac
-
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -17809,30 +17083,18 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
+  ;;
 
-  # Find out which ABI we are using (multilib Linux x86_64 hack).
-  libsuff=
-  case &quot;$host_cpu&quot; in
-  x86_64*)
-    echo '#line 17817 &quot;configure&quot;' &gt; conftest.$ac_ext
-    if { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compile\&quot;&quot;) &gt;&amp;5
-  (eval $ac_compile) 2&gt;&amp;5
-  ac_status=$?
-  echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); }; then
-      case `/usr/bin/file conftest.$ac_objext` in
-      *64-bit*)
-        libsuff=64
-        ;;
-      esac
-    fi
-    rm -rf conftest*
-    ;;
-  *)
-    ;;
-  esac
-  sys_lib_dlsearch_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff}&quot;
-  sys_lib_search_path_spec=&quot;/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}&quot;
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
   ;;
 
 knetbsd*-gnu)
@@ -17885,11 +17147,7 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
-  case $host_os in
-    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
-    *)                         need_version=no  ;;
-  esac
+  need_version=yes
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH=&quot;\$PATH:/sbin&quot; ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -18011,8 +17269,8 @@
 echo $ECHO_N &quot;checking how to hardcode library paths into programs... $ECHO_C&quot; &gt;&amp;6
 hardcode_action_GCJ=
 if test -n &quot;$hardcode_libdir_flag_spec_GCJ&quot; || \
-   test -n &quot;$runpath_var_GCJ&quot; || \
-   test &quot;X$hardcode_automatic_GCJ&quot; = &quot;Xyes&quot; ; then
+   test -n &quot;$runpath_var GCJ&quot; || \
+   test &quot;X$hardcode_automatic_GCJ&quot;=&quot;Xyes&quot; ; then
 
   # We can hardcode non-existant directories.
   if test &quot;$hardcode_direct_GCJ&quot; != no &amp;&amp;
@@ -18138,8 +17396,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18242,8 +17499,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18308,8 +17564,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18402,8 +17657,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18468,8 +17722,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18535,8 +17788,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18602,8 +17854,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -18678,7 +17929,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 18681 &quot;configure&quot;
+#line 17932 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -18776,7 +18027,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat &gt; conftest.$ac_ext &lt;&lt;EOF
-#line 18779 &quot;configure&quot;
+#line 18030 &quot;configure&quot;
 #include &quot;confdefs.h&quot;
 
 #if HAVE_DLFCN_H
@@ -18994,13 +18245,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -19076,7 +18321,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_GCJ
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -19324,35 +18569,11 @@
 compiler=$CC
 
 
-# save warnings/boilerplate of simple test code
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_compile_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_compile&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_compiler_boilerplate=`cat conftest.err`
-$rm conftest*
-
-ac_outfile=conftest.$ac_objext
-printf &quot;$lt_simple_link_test_code&quot; &gt;conftest.$ac_ext
-eval &quot;$ac_link&quot; 2&gt;&amp;1 &gt;/dev/null | $SED '/^$/d' &gt;conftest.err
-_lt_linker_boilerplate=`cat conftest.err`
-$rm conftest*
-
-
 # Allow CC to be a program name with arguments.
 lt_save_CC=&quot;$CC&quot;
 CC=${RC-&quot;windres&quot;}
 compiler=$CC
 compiler_RC=$CC
-for cc_temp in $compiler&quot;&quot;; do
-  case $cc_temp in
-    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
-    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
-    \-*) ;;
-    *) break;;
-  esac
-done
-cc_basename=`$echo &quot;X$cc_temp&quot; | $Xsed -e 's%.*/%%' -e &quot;s%^$host_alias-%%&quot;`
-
 lt_cv_prog_compiler_c_o_RC=yes
 
 # The else clause should only fire when bootstrapping the
@@ -19469,13 +18690,7 @@
 # The host system.
 host_alias=$host_alias
 host=$host
-host_os=$host_os
 
-# The build system.
-build_alias=$build_alias
-build=$build
-build_os=$build_os
-
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -19551,7 +18766,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_RC
 
-# Must we lock files when doing compilation?
+# Must we lock files when doing compilation ?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -19869,8 +19084,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -19942,8 +19156,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -19997,8 +19210,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20069,8 +19281,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20124,8 +19335,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20192,8 +19402,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20364,8 +19573,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20434,8 +19642,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20613,8 +19820,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20669,8 +19875,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20785,8 +19990,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20848,8 +20052,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -20892,8 +20095,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -21022,8 +20224,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -21091,8 +20292,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -21277,8 +20477,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -21958,8 +21157,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -22032,8 +21230,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -22105,8 +21302,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_c_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -22279,8 +21475,7 @@
   cat conftest.err &gt;&amp;5
   echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
   (exit $ac_status); } &amp;&amp;
-	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;
-			 || test ! -s conftest.err'
+	 { ac_try='test -z &quot;$ac_cxx_werror_flag&quot;			 || test ! -s conftest.err'
   { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_try\&quot;&quot;) &gt;&amp;5
   (eval $ac_try) 2&gt;&amp;5
   ac_status=$?
@@ -23372,11 +22567,6 @@
   *) ac_INSTALL=$ac_top_builddir$INSTALL ;;
   esac
 
-  if test x&quot;$ac_file&quot; != x-; then
-    { echo &quot;$as_me:$LINENO: creating $ac_file&quot; &gt;&amp;5
-echo &quot;$as_me: creating $ac_file&quot; &gt;&amp;6;}
-    rm -f &quot;$ac_file&quot;
-  fi
   # Let's still pretend it is `configure' which instantiates (i.e., don't
   # use $as_me), people would be surprised to read:
   #    /* config.h.  Generated by config.status.  */
@@ -23415,6 +22605,12 @@
 	 fi;;
       esac
     done` || { (exit 1); exit 1; }
+
+  if test x&quot;$ac_file&quot; != x-; then
+    { echo &quot;$as_me:$LINENO: creating $ac_file&quot; &gt;&amp;5
+echo &quot;$as_me: creating $ac_file&quot; &gt;&amp;6;}
+    rm -f &quot;$ac_file&quot;
+  fi
 _ACEOF
 cat &gt;&gt;$CONFIG_STATUS &lt;&lt;_ACEOF
   sed &quot;$ac_vpsub

Modified: branches/mloskot-style-refactoring/ltmain.sh
===================================================================
--- branches/mloskot-style-refactoring/ltmain.sh	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/ltmain.sh	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,7 +1,7 @@
 # ltmain.sh - Provide generalized library-building support services.
 # NOTE: Changing this file will not affect anything until you rerun configure.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004
 # Free Software Foundation, Inc.
 # Originally by Gordon Matzigkeit &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">gord at gnu.ai.mit.edu</A>&gt;, 1996
 #
@@ -17,7 +17,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -33,9 +33,6 @@
 # function.
 progpath=&quot;$0&quot;
 
-# define SED for historic ltconfig's generated by Libtool 1.3
-test -z &quot;$SED&quot; &amp;&amp; SED=sed
-
 # The name of this program:
 progname=`echo &quot;$progpath&quot; | $SED $basename`
 modename=&quot;$progname&quot;
@@ -46,21 +43,9 @@
 
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION=1.5.18
-TIMESTAMP=&quot; (1.1220.2.246 2005/05/16 10:00:18)&quot;
+VERSION=1.5.6
+TIMESTAMP=&quot; (1.1220.2.95 2004/04/11 05:50:42) Debian$Rev: 224 $&quot;
 
-# See if we are running on zsh, and set the options which allow our
-# commands through without removal of \ escapes.
-if test -n &quot;${ZSH_VERSION+set}&quot; ; then
-  setopt NO_GLOB_SUBST
-fi
-# Same for EGREP, and just to be sure, do LTCC as well
-if test &quot;X$EGREP&quot; = X ; then
-    EGREP=egrep
-fi
-if test &quot;X$LTCC&quot; = X ; then
-    LTCC=${CC-gcc}
-fi
 
 # Check that we have a working $echo.
 if test &quot;X$1&quot; = X--no-reexec; then
@@ -122,9 +107,8 @@
 fi
 
 # Make sure IFS has a sensible default
-lt_nl='
-'
-IFS=&quot; 	$lt_nl&quot;
+: ${IFS=&quot; 	
+&quot;}
 
 if test &quot;$build_libtool_libs&quot; != yes &amp;&amp; test &quot;$build_old_libs&quot; != yes; then
   $echo &quot;$modename: not configured to build any kind of library&quot; 1&gt;&amp;2
@@ -143,32 +127,7 @@
 execute_dlfiles=
 lo2o=&quot;s/\\.lo\$/.${objext}/&quot;
 o2lo=&quot;s/\\.${objext}\$/.lo/&quot;
-quote_scanset='[[~#^*{};&lt;&gt;?'&quot;'&quot;' 	]'
 
-if test -z &quot;$max_cmd_len&quot;; then
-  i=0
-  testring=&quot;ABCD&quot;
-  new_result=
-  
-  # If test is not a shell built-in, we'll probably end up computing a
-  # maximum length that is only half of the actual maximum length, but
-  # we can't tell.
-  while (test &quot;X&quot;`$SHELL $0 --fallback-echo &quot;X$testring&quot; 2&gt;/dev/null` \
-             = &quot;XX$testring&quot;) &gt;/dev/null 2&gt;&amp;1 &amp;&amp;
-          new_result=`expr &quot;X$testring&quot; : &quot;.*&quot; 2&gt;&amp;1` &amp;&amp;
-          max_cmd_len=&quot;$new_result&quot; &amp;&amp;
-          test &quot;$i&quot; != 17 # 1/2 MB should be enough
-  do
-    i=`expr $i + 1`
-    testring=&quot;$testring$testring&quot;
-  done
-  testring=
-  # Add a significant safety factor because C++ compilers can tack on massive
-  # amounts of additional arguments before passing them to the linker.
-  # It appears as though 1/2 is a usable value.
-  max_cmd_len=`expr $max_cmd_len \/ 2`
-fi
-
 #####################################
 # Shell function definitions:
 # This seems to be the best place for them
@@ -179,8 +138,7 @@
 # Need a lot of goo to handle *both* DLLs and import libs
 # Has to be a shell function in order to 'eat' the argument
 # that is supplied when $file_magic_command is called.
-func_win32_libid ()
-{
+func_win32_libid () {
   win32_libid_type=&quot;unknown&quot;
   win32_fileres=`file -L $1 2&gt;/dev/null`
   case $win32_fileres in
@@ -220,13 +178,12 @@
 # Only attempt this if the compiler in the base compile
 # command doesn't match the default compiler.
 # arg is usually of the form 'gcc ...'
-func_infer_tag ()
-{
+func_infer_tag () {
     if test -n &quot;$available_tags&quot; &amp;&amp; test -z &quot;$tagname&quot;; then
       CC_quoted=
       for arg in $CC; do
 	case $arg in
-	  *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	  *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	  arg=&quot;\&quot;$arg\&quot;&quot;
 	  ;;
 	esac
@@ -247,23 +204,13 @@
 	    for arg in $CC; do
 	    # Double-quote args containing other shell metacharacters.
 	    case $arg in
-	      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	      arg=&quot;\&quot;$arg\&quot;&quot;
 	      ;;
 	    esac
 	    CC_quoted=&quot;$CC_quoted $arg&quot;
 	  done
-	    # user sometimes does CC=&lt;HOST&gt;-gcc so we need to match that to 'gcc'
-	    trimedcc=`echo ${CC} | $SED -e &quot;s/${host}-//g&quot;`
-	    # and sometimes libtool has CC=&lt;HOST&gt;-gcc but user does CC=gcc
-	    extendcc=${host}-${CC}
 	    case &quot;$@ &quot; in
-	      &quot;cc &quot;* | &quot; cc &quot;* | &quot;${host}-cc &quot;* | &quot; ${host}-cc &quot;*|\
-	      &quot;gcc &quot;* | &quot; gcc &quot;* | &quot;${host}-gcc &quot;* | &quot; ${host}-gcc &quot;*)
-	      tagname=CC
-	      break ;;
-	      &quot;$trimedcc &quot;* | &quot; $trimedcc &quot;* | &quot;`$echo $trimedcc` &quot;* | &quot; `$echo $trimedcc` &quot;*|\
-	      &quot;$extendcc &quot;* | &quot; $extendcc &quot;* | &quot;`$echo $extendcc` &quot;* | &quot; `$echo $extendcc` &quot;*|\
 	      &quot; $CC &quot;* | &quot;$CC &quot;* | &quot; `$echo $CC` &quot;* | &quot;`$echo $CC` &quot;* | &quot; $CC_quoted&quot;* | &quot;$CC_quoted &quot;* | &quot; `$echo $CC_quoted` &quot;* | &quot;`$echo $CC_quoted` &quot;*)
 	      # The compiler in the base compile command matches
 	      # the one in the tagged configuration.
@@ -288,108 +235,6 @@
       esac
     fi
 }
-
-
-# func_extract_an_archive dir oldlib
-func_extract_an_archive ()
-{
-    f_ex_an_ar_dir=&quot;$1&quot;; shift
-    f_ex_an_ar_oldlib=&quot;$1&quot;
-
-    $show &quot;(cd $f_ex_an_ar_dir &amp;&amp; $AR x $f_ex_an_ar_oldlib)&quot;
-    $run eval &quot;(cd \$f_ex_an_ar_dir &amp;&amp; $AR x \$f_ex_an_ar_oldlib)&quot; || exit $?
-    if ($AR t &quot;$f_ex_an_ar_oldlib&quot; | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
-     :
-    else
-      $echo &quot;$modename: ERROR: object name conflicts: $f_ex_an_ar_dir/$f_ex_an_ar_oldlib&quot; 1&gt;&amp;2
-      exit $EXIT_FAILURE
-    fi
-}
-
-# func_extract_archives gentop oldlib ...
-func_extract_archives ()
-{
-    my_gentop=&quot;$1&quot;; shift
-    my_oldlibs=${1+&quot;$@&quot;}
-    my_oldobjs=&quot;&quot;
-    my_xlib=&quot;&quot;
-    my_xabs=&quot;&quot;
-    my_xdir=&quot;&quot;
-    my_status=&quot;&quot;
-
-    $show &quot;${rm}r $my_gentop&quot;
-    $run ${rm}r &quot;$my_gentop&quot;
-    $show &quot;$mkdir $my_gentop&quot;
-    $run $mkdir &quot;$my_gentop&quot;
-    my_status=$?
-    if test &quot;$my_status&quot; -ne 0 &amp;&amp; test ! -d &quot;$my_gentop&quot;; then
-      exit $my_status
-    fi
-
-    for my_xlib in $my_oldlibs; do
-      # Extract the objects.
-      case $my_xlib in
-	[\\/]* | [A-Za-z]:[\\/]*) my_xabs=&quot;$my_xlib&quot; ;;
-	*) my_xabs=`pwd`&quot;/$my_xlib&quot; ;;
-      esac
-      my_xlib=`$echo &quot;X$my_xlib&quot; | $Xsed -e 's%^.*/%%'`
-      my_xdir=&quot;$my_gentop/$my_xlib&quot;
-
-      $show &quot;${rm}r $my_xdir&quot;
-      $run ${rm}r &quot;$my_xdir&quot;
-      $show &quot;$mkdir $my_xdir&quot;
-      $run $mkdir &quot;$my_xdir&quot;
-      status=$?
-      if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$my_xdir&quot;; then
-	exit $status
-      fi
-      case $host in
-      *-darwin*)
-	$show &quot;Extracting $my_xabs&quot;
-	# Do not bother doing anything if just a dry run
-	if test -z &quot;$run&quot;; then
-	  darwin_orig_dir=`pwd`
-	  cd $my_xdir || exit $?
-	  darwin_archive=$my_xabs
-	  darwin_curdir=`pwd`
-	  darwin_base_archive=`$echo &quot;X$darwin_archive&quot; | $Xsed -e 's%^.*/%%'`
-	  darwin_arches=`lipo -info &quot;$darwin_archive&quot; 2&gt;/dev/null | $EGREP Architectures 2&gt;/dev/null`
-	  if test -n &quot;$darwin_arches&quot;; then 
-	    darwin_arches=`echo &quot;$darwin_arches&quot; | $SED -e 's/.*<A HREF="are://">are://</A>'`
-	    darwin_arch=
-	    $show &quot;$darwin_base_archive has multiple architectures $darwin_arches&quot;
-	    for darwin_arch in  $darwin_arches ; do
-	      mkdir -p &quot;unfat-$$/${darwin_base_archive}-${darwin_arch}&quot;
-	      lipo -thin $darwin_arch -output &quot;unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}&quot; &quot;${darwin_archive}&quot;
-	      cd &quot;unfat-$$/${darwin_base_archive}-${darwin_arch}&quot;
-	      func_extract_an_archive &quot;`pwd`&quot; &quot;${darwin_base_archive}&quot;
-	      cd &quot;$darwin_curdir&quot;
-	      $rm &quot;unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}&quot;
-	    done # $darwin_arches
-      ## Okay now we have a bunch of thin objects, gotta fatten them up :)
-	    darwin_filelist=`find unfat-$$ -type f -name \*.o -print -o -name \*.lo -print| xargs basename | sort -u | $NL2SP`
-	    darwin_file=
-	    darwin_files=
-	    for darwin_file in $darwin_filelist; do
-	      darwin_files=`find unfat-$$ -name $darwin_file -print | $NL2SP`
-	      lipo -create -output &quot;$darwin_file&quot; $darwin_files
-	    done # $darwin_filelist
-	    ${rm}r unfat-$$
-	    cd &quot;$darwin_orig_dir&quot;
-	  else
-	    cd &quot;$darwin_orig_dir&quot;
- 	    func_extract_an_archive &quot;$my_xdir&quot; &quot;$my_xabs&quot;
-	  fi # $darwin_arches
-	fi # $run
-      ;;
-      *)
-        func_extract_an_archive &quot;$my_xdir&quot; &quot;$my_xabs&quot;
-        ;;
-      esac
-      my_oldobjs=&quot;$my_oldobjs &quot;`find $my_xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
-    done
-    func_extract_archives_result=&quot;$my_oldobjs&quot;
-}
 # End of Shell function definitions
 #####################################
 
@@ -460,10 +305,10 @@
   --version)
     $echo &quot;$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP&quot;
     $echo
-    $echo &quot;Copyright (C) 2005  Free Software Foundation, Inc.&quot;
+    $echo &quot;Copyright (C) 2003  Free Software Foundation, Inc.&quot;
     $echo &quot;This is free software; see the source for copying conditions.  There is NO&quot;
     $echo &quot;warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&quot;
-    exit $?
+    exit $EXIT_SUCCESS
     ;;
 
   --config)
@@ -472,7 +317,7 @@
     for tagname in $taglist; do
       ${SED} -n -e &quot;/^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$/,/^# ### END LIBTOOL TAG CONFIG: $tagname$/p&quot; &lt; &quot;$progpath&quot;
     done
-    exit $?
+    exit $EXIT_SUCCESS
     ;;
 
   --debug)
@@ -497,7 +342,7 @@
     else
       $echo &quot;disable static libraries&quot;
     fi
-    exit $?
+    exit $EXIT_SUCCESS
     ;;
 
   --finish) mode=&quot;finish&quot; ;;
@@ -554,7 +399,7 @@
   # Infer the operation mode.
   if test -z &quot;$mode&quot;; then
     $echo &quot;*** Warning: inferring the mode of operation is deprecated.&quot; 1&gt;&amp;2
-    $echo &quot;*** Future versions of Libtool will require --mode=MODE be specified.&quot; 1&gt;&amp;2
+    $echo &quot;*** Future versions of Libtool will require -mode=MODE be specified.&quot; 1&gt;&amp;2
     case $nonopt in
     *cc | cc* | *++ | gcc* | *-gcc* | g++* | xlc*)
       mode=link
@@ -671,7 +516,7 @@
 	    # Many Bourne shells cannot handle close brackets correctly
 	    # in scan sets, so we specify it separately.
 	    case $arg in
-	      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	      arg=&quot;\&quot;$arg\&quot;&quot;
 	      ;;
 	    esac
@@ -702,11 +547,8 @@
       case $lastarg in
       # Double-quote args containing other shell metacharacters.
       # Many Bourne shells cannot handle close brackets correctly
-      # in scan sets, and some SunOS ksh mistreat backslash-escaping
-      # in scan sets (worked around with variable expansion),
-      # and furthermore cannot handle '|' '&amp;' '(' ')' in scan sets 
-      # at all, so we specify them separately.
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+      # in scan sets, so we specify it separately.
+      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	lastarg=&quot;\&quot;$lastarg\&quot;&quot;
 	;;
       esac
@@ -779,15 +621,6 @@
       esac
     done
 
-    qlibobj=`$echo &quot;X$libobj&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
-    case $qlibobj in
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
-	qlibobj=&quot;\&quot;$qlibobj\&quot;&quot; ;;
-    esac
-    if test &quot;X$libobj&quot; != &quot;X$qlibobj&quot;; then
-	$echo &quot;$modename: libobj name \`$libobj' may not contain shell special characters.&quot;
-	exit $EXIT_FAILURE
-    fi
     objname=`$echo &quot;X$obj&quot; | $Xsed -e 's%^.*/%%'`
     xdir=`$echo &quot;X$obj&quot; | $Xsed -e 's%/[^/]*$%%'`
     if test &quot;X$xdir&quot; = &quot;X$obj&quot;; then
@@ -840,7 +673,7 @@
     # Lock this critical section if it is needed
     # We use this script file to make the link, it avoids creating a new file
     if test &quot;$need_locks&quot; = yes; then
-      until $run ln &quot;$srcfile&quot; &quot;$lockfile&quot; 2&gt;/dev/null; do
+      until $run ln &quot;$progpath&quot; &quot;$lockfile&quot; 2&gt;/dev/null; do
 	$show &quot;Waiting for $lockfile to be removed&quot;
 	sleep 2
       done
@@ -860,17 +693,12 @@
 	$run $rm $removelist
 	exit $EXIT_FAILURE
       fi
-      $echo &quot;$srcfile&quot; &gt; &quot;$lockfile&quot;
+      $echo $srcfile &gt; &quot;$lockfile&quot;
     fi
 
     if test -n &quot;$fix_srcfile_path&quot;; then
       eval srcfile=\&quot;$fix_srcfile_path\&quot;
     fi
-    qsrcfile=`$echo &quot;X$srcfile&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
-    case $qsrcfile in
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
-      qsrcfile=&quot;\&quot;$qsrcfile\&quot;&quot; ;;
-    esac
 
     $run $rm &quot;$libobj&quot; &quot;${libobj}T&quot;
 
@@ -892,10 +720,10 @@
       fbsd_hideous_sh_bug=$base_compile
 
       if test &quot;$pic_mode&quot; != no; then
-	command=&quot;$base_compile $qsrcfile $pic_flag&quot;
+	command=&quot;$base_compile $srcfile $pic_flag&quot;
       else
 	# Don't build PIC code
-	command=&quot;$base_compile $qsrcfile&quot;
+	command=&quot;$base_compile $srcfile&quot;
       fi
 
       if test ! -d &quot;${xdir}$objdir&quot;; then
@@ -975,9 +803,9 @@
     if test &quot;$build_old_libs&quot; = yes; then
       if test &quot;$pic_mode&quot; != yes; then
 	# Don't build PIC code
-	command=&quot;$base_compile $qsrcfile&quot;
+	command=&quot;$base_compile $srcfile&quot;
       else
-	command=&quot;$base_compile $qsrcfile $pic_flag&quot;
+	command=&quot;$base_compile $srcfile $pic_flag&quot;
       fi
       if test &quot;$compiler_c_o&quot; = yes; then
 	command=&quot;$command -o $obj&quot;
@@ -1155,7 +983,7 @@
       arg=&quot;$1&quot;
       shift
       case $arg in
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	qarg=\&quot;`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`\&quot; ### testsuite: skip nested quoting test
 	;;
       *) qarg=$arg ;;
@@ -1399,13 +1227,6 @@
 	  prev=
 	  continue
 	  ;;
-        darwin_framework)
-	  compiler_flags=&quot;$compiler_flags $arg&quot;
-	  compile_command=&quot;$compile_command $arg&quot;
-	  finalize_command=&quot;$finalize_command $arg&quot;
-	  prev=
-	  continue
-	  ;;
 	*)
 	  eval &quot;$prev=\&quot;\$arg\&quot;&quot;
 	  prev=
@@ -1464,14 +1285,6 @@
 	continue
 	;;
 
-      -framework)
-        prev=darwin_framework
-        compiler_flags=&quot;$compiler_flags $arg&quot;
-	compile_command=&quot;$compile_command $arg&quot;
-	finalize_command=&quot;$finalize_command $arg&quot;
-        continue
-        ;;
-
       -inst-prefix-dir)
 	prev=inst_prefix
 	continue
@@ -1532,7 +1345,7 @@
 	    # These systems don't actually have a C library (as such)
 	    test &quot;X$arg&quot; = &quot;X-lc&quot; &amp;&amp; continue
 	    ;;
-	  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
+	  *-*-openbsd* | *-*-freebsd*)
 	    # Do not include libc due to us having libc/libc_r.
 	    test &quot;X$arg&quot; = &quot;X-lc&quot; &amp;&amp; continue
 	    ;;
@@ -1543,7 +1356,7 @@
 	  esac
 	elif test &quot;X$arg&quot; = &quot;X-lc_r&quot;; then
 	 case $host in
-	 *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
+	 *-*-openbsd* | *-*-freebsd*)
 	   # Do not include libc_r directly, use -pthread flag.
 	   continue
 	   ;;
@@ -1553,20 +1366,8 @@
 	continue
 	;;
 
-      # Tru64 UNIX uses -model [arg] to determine the layout of C++
-      # classes, name mangling, and exception handling.
-      -model)
-	compile_command=&quot;$compile_command $arg&quot;
-	compiler_flags=&quot;$compiler_flags $arg&quot;
-	finalize_command=&quot;$finalize_command $arg&quot;
-	prev=xcompiler
-	continue
-	;;
-
      -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
-	compiler_flags=&quot;$compiler_flags $arg&quot;
-	compile_command=&quot;$compile_command $arg&quot;
-	finalize_command=&quot;$finalize_command $arg&quot;
+	deplibs=&quot;$deplibs $arg&quot;
 	continue
 	;;
 
@@ -1575,19 +1376,18 @@
 	continue
 	;;
 
-      # -64, -mips[0-9] enable 64-bit mode on the SGI compiler
-      # -r[0-9][0-9]* specifies the processor on the SGI compiler
-      # -xarch=*, -xtarget=* enable 64-bit mode on the Sun compiler
-      # +DA*, +DD* enable 64-bit mode on the HP compiler
-      # -q* pass through compiler args for the IBM compiler
-      # -m* pass through architecture-specific compiler args for GCC
-      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*)
-
+      # gcc -m* arguments should be passed to the linker via $compiler_flags
+      # in order to pass architecture information to the linker
+      # (e.g. 32 vs 64-bit).  This may also be accomplished via -Wl,-mfoo
+      # but this is not reliable with gcc because gcc may use -mfoo to
+      # select a different linker, different libraries, etc, while
+      # -Wl,-mfoo simply passes -mfoo to the linker.
+      -m*)
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
 	case $arg in
-	*$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	*[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	  arg=&quot;\&quot;$arg\&quot;&quot;
 	  ;;
 	esac
@@ -1703,7 +1503,7 @@
 	for flag in $args; do
 	  IFS=&quot;$save_ifs&quot;
 	  case $flag in
-	    *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	    *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	    flag=&quot;\&quot;$flag\&quot;&quot;
 	    ;;
 	  esac
@@ -1721,7 +1521,7 @@
 	for flag in $args; do
 	  IFS=&quot;$save_ifs&quot;
 	  case $flag in
-	    *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	    *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	    flag=&quot;\&quot;$flag\&quot;&quot;
 	    ;;
 	  esac
@@ -1748,18 +1548,13 @@
 	continue
 	;;
 
-      -Kthread | -mthreads | -mt | -pthread | -pthreads | -threads | -qthreaded | -kthread )
-        compiler_flags=&quot;$compiler_flags $arg&quot;
-        continue
-        ;;
-
       # Some other compiler flag.
       -* | +*)
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
 	case $arg in
-	*$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	*[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	  arg=&quot;\&quot;$arg\&quot;&quot;
 	  ;;
 	esac
@@ -1893,7 +1688,7 @@
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
 	case $arg in
-	*$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+	*[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*|&quot;&quot;)
 	  arg=&quot;\&quot;$arg\&quot;&quot;
 	  ;;
 	esac
@@ -2043,7 +1838,10 @@
 	case $pass in
 	dlopen) libs=&quot;$dlfiles&quot; ;;
 	dlpreopen) libs=&quot;$dlprefiles&quot; ;;
-	link) libs=&quot;$deplibs %DEPLIBS% $dependency_libs&quot; ;;
+	link)
+	  libs=&quot;$deplibs %DEPLIBS%&quot;
+	  test &quot;X$link_all_deplibs&quot; != Xno &amp;&amp; libs=&quot;$libs $dependency_libs&quot;
+	  ;;
 	esac
       fi
       if test &quot;$pass&quot; = dlopen; then
@@ -2060,7 +1858,7 @@
 	    compile_deplibs=&quot;$deplib $compile_deplibs&quot;
 	    finalize_deplibs=&quot;$deplib $finalize_deplibs&quot;
 	  else
-	    compiler_flags=&quot;$compiler_flags $deplib&quot;
+	    deplibs=&quot;$deplib $deplibs&quot;
 	  fi
 	  continue
 	  ;;
@@ -2179,22 +1977,7 @@
 	  fi
 	  case $linkmode in
 	  lib)
-	    valid_a_lib=no
-	    case $deplibs_check_method in
-	      match_pattern*)
-		set dummy $deplibs_check_method
-	        match_pattern_regex=`expr &quot;$deplibs_check_method&quot; : &quot;$2 \(.*\)&quot;`
-		if eval $echo \&quot;$deplib\&quot; 2&gt;/dev/null \
-		    | $SED 10q \
-		    | $EGREP &quot;$match_pattern_regex&quot; &gt; /dev/null; then
-		  valid_a_lib=yes
-		fi
-		;;
-	      pass_all)
-		valid_a_lib=yes
-		;;
-            esac
-	    if test &quot;$valid_a_lib&quot; != yes; then
+	    if test &quot;$deplibs_check_method&quot; != pass_all; then
 	      $echo
 	      $echo &quot;*** Warning: Trying to link with static lib archive $deplib.&quot;
 	      $echo &quot;*** I have the capability to make that library automatically link in when&quot;
@@ -2268,9 +2051,7 @@
 	# it will not redefine variables installed, or shouldnotlink
 	installed=yes
 	shouldnotlink=no
-	avoidtemprpath=
 
-
 	# Read the .la file
 	case $lib in
 	*/* | *\\*) . $lib ;;
@@ -2368,19 +2149,11 @@
 	    dir=&quot;$libdir&quot;
 	    absdir=&quot;$libdir&quot;
 	  fi
-	  test &quot;X$hardcode_automatic&quot; = Xyes &amp;&amp; avoidtemprpath=yes
 	else
-	  if test ! -f &quot;$ladir/$objdir/$linklib&quot; &amp;&amp; test -f &quot;$abs_ladir/$linklib&quot;; then
-	    dir=&quot;$ladir&quot;
-	    absdir=&quot;$abs_ladir&quot;
-	    # Remove this search path later
-	    notinst_path=&quot;$notinst_path $abs_ladir&quot;
-	  else
-	    dir=&quot;$ladir/$objdir&quot;
-	    absdir=&quot;$abs_ladir/$objdir&quot;
-	    # Remove this search path later
-	    notinst_path=&quot;$notinst_path $abs_ladir&quot;
-	  fi
+	  dir=&quot;$ladir/$objdir&quot;
+	  absdir=&quot;$abs_ladir/$objdir&quot;
+	  # Remove this search path later
+	  notinst_path=&quot;$notinst_path $abs_ladir&quot;
 	fi # $installed = yes
 	name=`$echo &quot;X$laname&quot; | $Xsed -e 's/\.la$//' -e 's/^lib//'`
 
@@ -2453,7 +2226,7 @@
 	  if test -n &quot;$library_names&quot; &amp;&amp;
 	     { test &quot;$prefer_static_libs&quot; = no || test -z &quot;$old_library&quot;; }; then
 	    # We need to hardcode the library path
-	    if test -n &quot;$shlibpath_var&quot; &amp;&amp; test -z &quot;$avoidtemprpath&quot; ; then
+	    if test -n &quot;$shlibpath_var&quot;; then
 	      # Make sure the rpath contains only unique directories.
 	      case &quot;$temp_rpath &quot; in
 	      *&quot; $dir &quot;*) ;;
@@ -2897,13 +2670,13 @@
 	      *) continue ;;
 	      esac
 	      case &quot; $deplibs &quot; in
-	      *&quot; $path &quot;*) ;;
-	      *) deplibs=&quot;$path $deplibs&quot; ;;
-	      esac
-	      case &quot; $deplibs &quot; in
 	      *&quot; $depdepl &quot;*) ;;
 	      *) deplibs=&quot;$depdepl $deplibs&quot; ;;
 	      esac
+	      case &quot; $deplibs &quot; in
+	      *&quot; $path &quot;*) ;;
+	      *) deplibs=&quot;$deplibs $path&quot; ;;
+	      esac
 	    done
 	  fi # link_all_deplibs != no
 	fi # linkmode = lib
@@ -3156,6 +2929,11 @@
 	    age=&quot;$number_minor&quot;
 	    revision=&quot;$number_minor&quot;
 	    ;;
+	  *)
+	    $echo &quot;$modename: unknown library version type \`$version_type'&quot; 1&gt;&amp;2
+	    $echo &quot;Fatal configuration error.  See the $PACKAGE docs for more information.&quot; 1&gt;&amp;2
+	    exit $EXIT_FAILURE
+	    ;;
 	  esac
 	  ;;
 	no)
@@ -3169,7 +2947,7 @@
 	case $current in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo &quot;$modename: CURRENT \`$current' must be a nonnegative integer&quot; 1&gt;&amp;2
+	  $echo &quot;$modename: CURRENT \`$current' is not a nonnegative integer&quot; 1&gt;&amp;2
 	  $echo &quot;$modename: \`$vinfo' is not valid version information&quot; 1&gt;&amp;2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -3178,7 +2956,7 @@
 	case $revision in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo &quot;$modename: REVISION \`$revision' must be a nonnegative integer&quot; 1&gt;&amp;2
+	  $echo &quot;$modename: REVISION \`$revision' is not a nonnegative integer&quot; 1&gt;&amp;2
 	  $echo &quot;$modename: \`$vinfo' is not valid version information&quot; 1&gt;&amp;2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -3187,7 +2965,7 @@
 	case $age in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo &quot;$modename: AGE \`$age' must be a nonnegative integer&quot; 1&gt;&amp;2
+	  $echo &quot;$modename: AGE \`$age' is not a nonnegative integer&quot; 1&gt;&amp;2
 	  $echo &quot;$modename: \`$vinfo' is not valid version information&quot; 1&gt;&amp;2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -3213,7 +2991,7 @@
 	  versuffix=&quot;$major.$age.$revision&quot;
 	  # Darwin ld doesn't like 0 for these options...
 	  minor_current=`expr $current + 1`
-	  verstring=&quot;${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision&quot;
+	  verstring=&quot;-compatibility_version $minor_current -current_version $minor_current.$revision&quot;
 	  ;;
 
 	freebsd-aout)
@@ -3419,7 +3197,7 @@
 	  *-*-netbsd*)
 	    # Don't link with libc until the a.out ld.so is fixed.
 	    ;;
-	  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
+	  *-*-openbsd* | *-*-freebsd*)
 	    # Do not include libc due to us having libc/libc_r.
 	    test &quot;X$arg&quot; = &quot;X-lc&quot; &amp;&amp; continue
 	    ;;
@@ -3592,13 +3370,6 @@
 			*) potlib=`$echo &quot;X$potlib&quot; | $Xsed -e 's,[^/]*$,,'`&quot;$potliblink&quot;;;
 			esac
 		      done
-		      # It is ok to link against an archive when
-		      # building a shared library.
-		      if $AR -t $potlib &gt; /dev/null 2&gt;&amp;1; then
-		        newdeplibs=&quot;$newdeplibs $a_deplib&quot;
-		        a_deplib=&quot;&quot;
-		        break 2
-		      fi
 		      if eval $file_magic_cmd \&quot;\$potlib\&quot; 2&gt;/dev/null \
 			 | ${SED} 10q \
 			 | $EGREP &quot;$file_magic_regex&quot; &gt; /dev/null; then
@@ -3908,13 +3679,67 @@
 	    eval libobjs=\&quot;\$libobjs $whole_archive_flag_spec\&quot;
 	  else
 	    gentop=&quot;$output_objdir/${outputname}x&quot;
+	    $show &quot;${rm}r $gentop&quot;
+	    $run ${rm}r &quot;$gentop&quot;
+	    $show &quot;$mkdir $gentop&quot;
+	    $run $mkdir &quot;$gentop&quot;
+	    status=$?
+	    if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$gentop&quot;; then
+	      exit $status
+	    fi
 	    generated=&quot;$generated $gentop&quot;
 
-	    func_extract_archives $gentop $convenience
-	    libobjs=&quot;$libobjs $func_extract_archives_result&quot;
+	    for xlib in $convenience; do
+	      # Extract the objects.
+	      case $xlib in
+	      [\\/]* | [A-Za-z]:[\\/]*) xabs=&quot;$xlib&quot; ;;
+	      *) xabs=`pwd`&quot;/$xlib&quot; ;;
+	      esac
+	      xlib=`$echo &quot;X$xlib&quot; | $Xsed -e 's%^.*/%%'`
+	      xdir=&quot;$gentop/$xlib&quot;
+
+	      $show &quot;${rm}r $xdir&quot;
+	      $run ${rm}r &quot;$xdir&quot;
+	      $show &quot;$mkdir $xdir&quot;
+	      $run $mkdir &quot;$xdir&quot;
+	      status=$?
+	      if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$xdir&quot;; then
+		exit $status
+	      fi
+	      # We will extract separately just the conflicting names and we will no
+	      # longer touch any unique names. It is faster to leave these extract
+	      # automatically by $AR in one run.
+	      $show &quot;(cd $xdir &amp;&amp; $AR x $xabs)&quot;
+	      $run eval &quot;(cd \$xdir &amp;&amp; $AR x \$xabs)&quot; || exit $?
+	      if ($AR t &quot;$xabs&quot; | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
+		:
+	      else
+		$echo &quot;$modename: warning: object name conflicts; renaming object files&quot; 1&gt;&amp;2
+		$echo &quot;$modename: warning: to ensure that they will not overwrite&quot; 1&gt;&amp;2
+		$AR t &quot;$xabs&quot; | sort | uniq -cd | while read -r count name
+		do
+		  i=1
+		  while test &quot;$i&quot; -le &quot;$count&quot;
+		  do
+		   # Put our $i before any first dot (extension)
+		   # Never overwrite any file
+		   name_to=&quot;$name&quot;
+		   while test &quot;X$name_to&quot; = &quot;X$name&quot; || test -f &quot;$xdir/$name_to&quot;
+		   do
+		     name_to=`$echo &quot;X$name_to&quot; | $Xsed -e &quot;s/\([^.]*\)/\1-$i/&quot;`
+		   done
+		   $show &quot;(cd $xdir &amp;&amp; $AR xN $i $xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot;
+		   $run eval &quot;(cd \$xdir &amp;&amp; $AR xN $i \$xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot; || exit $?
+		   i=`expr $i + 1`
+		  done
+		done
+	      fi
+
+	      libobjs=&quot;$libobjs &quot;`find $xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
+	    done
 	  fi
 	fi
-	
+
 	if test &quot;$thread_safe&quot; = yes &amp;&amp; test -n &quot;$thread_safe_flag_spec&quot;; then
 	  eval flag=\&quot;$thread_safe_flag_spec\&quot;
 	  linker_flags=&quot;$linker_flags $flag&quot;
@@ -3963,7 +3788,6 @@
 	    save_libobjs=$libobjs
 	  fi
 	  save_output=$output
-	  output_la=`$echo &quot;X$output&quot; | $Xsed -e &quot;$basename&quot;`
 
 	  # Clear the reloadable object creation command queue and
 	  # initialize k to one.
@@ -3973,7 +3797,7 @@
 	  delfiles=
 	  last_robj=
 	  k=1
-	  output=$output_objdir/$output_la-${k}.$objext
+	  output=$output_objdir/$save_output-${k}.$objext
 	  # Loop over the list of objects to be linked.
 	  for obj in $save_libobjs
 	  do
@@ -3993,9 +3817,9 @@
 		# the last one created.
 		eval concat_cmds=\&quot;\$concat_cmds~$reload_cmds $objlist $last_robj\&quot;
 	      fi
-	      last_robj=$output_objdir/$output_la-${k}.$objext
+	      last_robj=$output_objdir/$save_output-${k}.$objext
 	      k=`expr $k + 1`
-	      output=$output_objdir/$output_la-${k}.$objext
+	      output=$output_objdir/$save_output-${k}.$objext
 	      objlist=$obj
 	      len=1
 	    fi
@@ -4015,13 +3839,13 @@
 	    eval concat_cmds=\&quot;\$concat_cmds~$export_symbols_cmds\&quot;
           fi
 
-	  # Set up a command to remove the reloadable object files
+	  # Set up a command to remove the reloadale object files
 	  # after they are used.
 	  i=0
 	  while test &quot;$i&quot; -lt &quot;$k&quot;
 	  do
 	    i=`expr $i + 1`
-	    delfiles=&quot;$delfiles $output_objdir/$output_la-${i}.$objext&quot;
+	    delfiles=&quot;$delfiles $output_objdir/$save_output-${i}.$objext&quot;
 	  done
 
 	  $echo &quot;creating a temporary reloadable object file: $output&quot;
@@ -4153,10 +3977,64 @@
 	  eval reload_conv_objs=\&quot;\$reload_objs $whole_archive_flag_spec\&quot;
 	else
 	  gentop=&quot;$output_objdir/${obj}x&quot;
+	  $show &quot;${rm}r $gentop&quot;
+	  $run ${rm}r &quot;$gentop&quot;
+	  $show &quot;$mkdir $gentop&quot;
+	  $run $mkdir &quot;$gentop&quot;
+	  status=$?
+	  if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$gentop&quot;; then
+	    exit $status
+	  fi
 	  generated=&quot;$generated $gentop&quot;
 
-	  func_extract_archives $gentop $convenience
-	  reload_conv_objs=&quot;$reload_objs $func_extract_archives_result&quot;
+	  for xlib in $convenience; do
+	    # Extract the objects.
+	    case $xlib in
+	    [\\/]* | [A-Za-z]:[\\/]*) xabs=&quot;$xlib&quot; ;;
+	    *) xabs=`pwd`&quot;/$xlib&quot; ;;
+	    esac
+	    xlib=`$echo &quot;X$xlib&quot; | $Xsed -e 's%^.*/%%'`
+	    xdir=&quot;$gentop/$xlib&quot;
+
+	    $show &quot;${rm}r $xdir&quot;
+	    $run ${rm}r &quot;$xdir&quot;
+	    $show &quot;$mkdir $xdir&quot;
+	    $run $mkdir &quot;$xdir&quot;
+	    status=$?
+	    if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$xdir&quot;; then
+	      exit $status
+	    fi
+	    # We will extract separately just the conflicting names and we will no
+	    # longer touch any unique names. It is faster to leave these extract
+	    # automatically by $AR in one run.
+	    $show &quot;(cd $xdir &amp;&amp; $AR x $xabs)&quot;
+	    $run eval &quot;(cd \$xdir &amp;&amp; $AR x \$xabs)&quot; || exit $?
+	    if ($AR t &quot;$xabs&quot; | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
+	      :
+	    else
+	      $echo &quot;$modename: warning: object name conflicts; renaming object files&quot; 1&gt;&amp;2
+	      $echo &quot;$modename: warning: to ensure that they will not overwrite&quot; 1&gt;&amp;2
+	      $AR t &quot;$xabs&quot; | sort | uniq -cd | while read -r count name
+	      do
+		i=1
+		while test &quot;$i&quot; -le &quot;$count&quot;
+		do
+		 # Put our $i before any first dot (extension)
+		 # Never overwrite any file
+		 name_to=&quot;$name&quot;
+		 while test &quot;X$name_to&quot; = &quot;X$name&quot; || test -f &quot;$xdir/$name_to&quot;
+		 do
+		   name_to=`$echo &quot;X$name_to&quot; | $Xsed -e &quot;s/\([^.]*\)/\1-$i/&quot;`
+		 done
+		 $show &quot;(cd $xdir &amp;&amp; $AR xN $i $xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot;
+		 $run eval &quot;(cd \$xdir &amp;&amp; $AR xN $i \$xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot; || exit $?
+		 i=`expr $i + 1`
+		done
+	      done
+	    fi
+
+	    reload_conv_objs=&quot;$reload_objs &quot;`find $xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
+	  done
 	fi
       fi
 
@@ -4418,12 +4296,12 @@
 
 	    # Prepare the list of exported symbols
 	    if test -z &quot;$export_symbols&quot;; then
-	      export_symbols=&quot;$output_objdir/$outputname.exp&quot;
+	      export_symbols=&quot;$output_objdir/$output.exp&quot;
 	      $run $rm $export_symbols
 	      $run eval &quot;${SED} -n -e '/^: @PROGRAM@$/d' -e 's/^.* \(.*\)$/\1/p' &quot;'&lt; &quot;$nlist&quot; &gt; &quot;$export_symbols&quot;'
 	    else
-	      $run eval &quot;${SED} -e 's/\([ ][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'&quot;' &lt; &quot;$export_symbols&quot; &gt; &quot;$output_objdir/$outputname.exp&quot;'
-	      $run eval 'grep -f &quot;$output_objdir/$outputname.exp&quot; &lt; &quot;$nlist&quot; &gt; &quot;$nlist&quot;T'
+	      $run eval &quot;${SED} -e 's/\([][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'&quot;' &lt; &quot;$export_symbols&quot; &gt; &quot;$output_objdir/$output.exp&quot;'
+	      $run eval 'grep -f &quot;$output_objdir/$output.exp&quot; &lt; &quot;$nlist&quot; &gt; &quot;$nlist&quot;T'
 	      $run eval 'mv &quot;$nlist&quot;T &quot;$nlist&quot;'
 	    fi
 	  fi
@@ -4475,26 +4353,7 @@
 #endif
 
 /* The mapping between symbol names and symbols. */
-&quot;
-
-	    case $host in
-	    *cygwin* | *mingw* )
-	  $echo &gt;&gt; &quot;$output_objdir/$dlsyms&quot; &quot;\
-/* DATA imports from DLLs on WIN32 can't be const, because
-   runtime relocations are performed -- see ld's documentation
-   on pseudo-relocs */
-struct {
-&quot;
-	      ;;
-	    * )
-	  $echo &gt;&gt; &quot;$output_objdir/$dlsyms&quot; &quot;\
 const struct {
-&quot;
-	      ;;
-	    esac
-
-
-	  $echo &gt;&gt; &quot;$output_objdir/$dlsyms&quot; &quot;\
   const char *name;
   lt_ptr address;
 }
@@ -4723,7 +4582,7 @@
 	esac
 	case $host in
 	  *cygwin* | *mingw* )
-	    cwrappersource=`$echo ${objdir}/lt-${outputname}.c`
+	    cwrappersource=`$echo ${objdir}/lt-${output}.c`
 	    cwrapper=`$echo ${output}.exe`
 	    $rm $cwrappersource $cwrapper
 	    trap &quot;$rm $cwrappersource $cwrapper; exit $EXIT_FAILURE&quot; 1 2 15
@@ -4956,7 +4815,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-(unset CDPATH) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; unset CDPATH
+if test \&quot;\${CDPATH+set}\&quot; = set; then CDPATH=:; export CDPATH; fi
 
 relink_command=\&quot;$relink_command\&quot;
 
@@ -5133,73 +4992,71 @@
 
       if test -n &quot;$addlibs&quot;; then
 	gentop=&quot;$output_objdir/${outputname}x&quot;
+	$show &quot;${rm}r $gentop&quot;
+	$run ${rm}r &quot;$gentop&quot;
+	$show &quot;$mkdir $gentop&quot;
+	$run $mkdir &quot;$gentop&quot;
+	status=$?
+	if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$gentop&quot;; then
+	  exit $status
+	fi
 	generated=&quot;$generated $gentop&quot;
 
-	func_extract_archives $gentop $addlibs
-	oldobjs=&quot;$oldobjs $func_extract_archives_result&quot;
+	# Add in members from convenience archives.
+	for xlib in $addlibs; do
+	  # Extract the objects.
+	  case $xlib in
+	  [\\/]* | [A-Za-z]:[\\/]*) xabs=&quot;$xlib&quot; ;;
+	  *) xabs=`pwd`&quot;/$xlib&quot; ;;
+	  esac
+	  xlib=`$echo &quot;X$xlib&quot; | $Xsed -e 's%^.*/%%'`
+	  xdir=&quot;$gentop/$xlib&quot;
+
+	  $show &quot;${rm}r $xdir&quot;
+	  $run ${rm}r &quot;$xdir&quot;
+	  $show &quot;$mkdir $xdir&quot;
+	  $run $mkdir &quot;$xdir&quot;
+	  status=$?
+	  if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$xdir&quot;; then
+	    exit $status
+	  fi
+	  # We will extract separately just the conflicting names and we will no
+	  # longer touch any unique names. It is faster to leave these extract
+	  # automatically by $AR in one run.
+	  $show &quot;(cd $xdir &amp;&amp; $AR x $xabs)&quot;
+	  $run eval &quot;(cd \$xdir &amp;&amp; $AR x \$xabs)&quot; || exit $?
+	  if ($AR t &quot;$xabs&quot; | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
+	    :
+	  else
+	    $echo &quot;$modename: warning: object name conflicts; renaming object files&quot; 1&gt;&amp;2
+	    $echo &quot;$modename: warning: to ensure that they will not overwrite&quot; 1&gt;&amp;2
+	    $AR t &quot;$xabs&quot; | sort | uniq -cd | while read -r count name
+	    do
+	      i=1
+	      while test &quot;$i&quot; -le &quot;$count&quot;
+	      do
+	       # Put our $i before any first dot (extension)
+	       # Never overwrite any file
+	       name_to=&quot;$name&quot;
+	       while test &quot;X$name_to&quot; = &quot;X$name&quot; || test -f &quot;$xdir/$name_to&quot;
+	       do
+		 name_to=`$echo &quot;X$name_to&quot; | $Xsed -e &quot;s/\([^.]*\)/\1-$i/&quot;`
+	       done
+	       $show &quot;(cd $xdir &amp;&amp; $AR xN $i $xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot;
+	       $run eval &quot;(cd \$xdir &amp;&amp; $AR xN $i \$xabs '$name' &amp;&amp; $mv '$name' '$name_to')&quot; || exit $?
+	       i=`expr $i + 1`
+	      done
+	    done
+	  fi
+
+	  oldobjs=&quot;$oldobjs &quot;`find $xdir -name \*.${objext} -print -o -name \*.lo -print | $NL2SP`
+	done
       fi
 
       # Do each command in the archive commands.
       if test -n &quot;$old_archive_from_new_cmds&quot; &amp;&amp; test &quot;$build_libtool_libs&quot; = yes; then
        cmds=$old_archive_from_new_cmds
       else
-	# POSIX demands no paths to be encoded in archives.  We have
-	# to avoid creating archives with duplicate basenames if we
-	# might have to extract them afterwards, e.g., when creating a
-	# static archive out of a convenience library, or when linking
-	# the entirety of a libtool archive into another (currently
-	# not supported by libtool).
-	if (for obj in $oldobjs
-	    do
-	      $echo &quot;X$obj&quot; | $Xsed -e 's%^.*/%%'
-	    done | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
-	  :
-	else
-	  $echo &quot;copying selected object files to avoid basename conflicts...&quot;
-
-	  if test -z &quot;$gentop&quot;; then
-	    gentop=&quot;$output_objdir/${outputname}x&quot;
-	    generated=&quot;$generated $gentop&quot;
-
-	    $show &quot;${rm}r $gentop&quot;
-	    $run ${rm}r &quot;$gentop&quot;
-	    $show &quot;$mkdir $gentop&quot;
-	    $run $mkdir &quot;$gentop&quot;
-	    status=$?
-	    if test &quot;$status&quot; -ne 0 &amp;&amp; test ! -d &quot;$gentop&quot;; then
-	      exit $status
-	    fi
-	  fi
-
-	  save_oldobjs=$oldobjs
-	  oldobjs=
-	  counter=1
-	  for obj in $save_oldobjs
-	  do
-	    objbase=`$echo &quot;X$obj&quot; | $Xsed -e 's%^.*/%%'`
-	    case &quot; $oldobjs &quot; in
-	    &quot; &quot;) oldobjs=$obj ;;
-	    *[\ /]&quot;$objbase &quot;*)
-	      while :; do
-		# Make sure we don't pick an alternate name that also
-		# overlaps.
-		newobj=lt$counter-$objbase
-		counter=`expr $counter + 1`
-		case &quot; $oldobjs &quot; in
-		*[\ /]&quot;$newobj &quot;*) ;;
-		*) if test ! -f &quot;$gentop/$newobj&quot;; then break; fi ;;
-		esac
-	      done
-	      $show &quot;ln $obj $gentop/$newobj || cp $obj $gentop/$newobj&quot;
-	      $run ln &quot;$obj&quot; &quot;$gentop/$newobj&quot; ||
-	      $run cp &quot;$obj&quot; &quot;$gentop/$newobj&quot;
-	      oldobjs=&quot;$oldobjs $gentop/$newobj&quot;
-	      ;;
-	    *) oldobjs=&quot;$oldobjs $obj&quot; ;;
-	    esac
-	  done
-	fi
-
 	eval cmds=\&quot;$old_archive_cmds\&quot;
 
 	if len=`expr &quot;X$cmds&quot; : &quot;.*&quot;` &amp;&amp;
@@ -5213,7 +5070,20 @@
 	  objlist=
 	  concat_cmds=
 	  save_oldobjs=$oldobjs
-
+	  # GNU ar 2.10+ was changed to match POSIX; thus no paths are
+	  # encoded into archives.  This makes 'ar r' malfunction in
+	  # this piecewise linking case whenever conflicting object
+	  # names appear in distinct ar calls; check, warn and compensate.
+	    if (for obj in $save_oldobjs
+	    do
+	      $echo &quot;X$obj&quot; | $Xsed -e 's%^.*/%%'
+	    done | sort | sort -uc &gt;/dev/null 2&gt;&amp;1); then
+	    :
+	  else
+	    $echo &quot;$modename: warning: object name conflicts; overriding AR_FLAGS to 'cq'&quot; 1&gt;&amp;2
+	    $echo &quot;$modename: warning: to ensure that POSIX-compatible ar will work&quot; 1&gt;&amp;2
+	    AR_FLAGS=cq
+	  fi
 	  # Is there a better way of finding the last object in the list?
 	  for obj in $save_oldobjs
 	  do
@@ -5307,53 +5177,9 @@
 		  $echo &quot;$modename: \`$deplib' is not a valid libtool archive&quot; 1&gt;&amp;2
 		  exit $EXIT_FAILURE
 		fi
-		if test &quot;X$EGREP&quot; = X ; then
-			EGREP=egrep
-		fi
-		# We do not want portage's install root ($D) present.  Check only for
-		# this if the .la is being installed.
-		if test &quot;$installed&quot; = yes &amp;&amp; test &quot;$D&quot;; then
-		  eval mynewdependency_lib=`echo &quot;$libdir/$name&quot; |sed -e &quot;s:$D:/:g&quot; -e 's:/\+:/:g'`
-		else
-		  mynewdependency_lib=&quot;$libdir/$name&quot;
-		fi
-		# Do not add duplicates
-		if test &quot;$mynewdependency_lib&quot;; then
-		  my_little_ninja_foo_1=`echo $newdependency_libs |$EGREP -e &quot;$mynewdependency_lib&quot;`
-		  if test -z &quot;$my_little_ninja_foo_1&quot;; then
-		    newdependency_libs=&quot;$newdependency_libs $mynewdependency_lib&quot;
-		  fi
-		fi
+		newdependency_libs=&quot;$newdependency_libs $libdir/$name&quot;
 		;;
-		  *)
-		if test &quot;$installed&quot; = yes; then
-		  # Rather use S=WORKDIR if our version of portage supports it.
-		  # This is because some ebuild (gcc) do not use $S as buildroot.
-		  if test &quot;$PWORKDIR&quot;; then
-		    S=&quot;$PWORKDIR&quot;
-		  fi
-		  # We do not want portage's build root ($S) present.
-		  my_little_ninja_foo_2=`echo $deplib |$EGREP -e &quot;$S&quot;`
-		  if test -n &quot;$my_little_ninja_foo_2&quot; &amp;&amp; test &quot;$S&quot;; then
-		    mynewdependency_lib=&quot;&quot;
-		  # We do not want portage's install root ($D) present.
-		  my_little_ninja_foo_3=`echo $deplib |$EGREP -e &quot;$D&quot;`
-		  elif test -n &quot;$my_little_ninja_foo_3&quot; &amp;&amp; test &quot;$D&quot;; then
-		    eval mynewdependency_lib=`echo &quot;$deplib&quot; |sed -e &quot;s:$D:/:g&quot; -e 's:/\+:/:g'`
-		  else
-		    mynewdependency_lib=&quot;$deplib&quot;
-		  fi
-		else
-		  mynewdependency_lib=&quot;$deplib&quot;
-		fi
-		# Do not add duplicates
-		if test &quot;$mynewdependency_lib&quot;; then
-		  my_little_ninja_foo_4=`echo $newdependency_libs |$EGREP -e &quot;$mynewdependency_lib&quot;`
-		  if test -z &quot;$my_little_ninja_foo_4&quot;; then
-			newdependency_libs=&quot;$newdependency_libs $mynewdependency_lib&quot;
-		  fi
-		fi
-		;;
+	      *) newdependency_libs=&quot;$newdependency_libs $deplib&quot; ;;
 	      esac
 	    done
 	    dependency_libs=&quot;$newdependency_libs&quot;
@@ -5405,10 +5231,6 @@
 	  case $host,$output,$installed,$module,$dlname in
 	    *cygwin*,*lai,yes,no,*.dll | *mingw*,*lai,yes,no,*.dll) tdlname=../bin/$dlname ;;
 	  esac
-	  # Do not add duplicates
-	  if test &quot;$installed&quot; = yes &amp;&amp; test &quot;$D&quot;; then
-	    install_libdir=`echo &quot;$install_libdir&quot; |sed -e &quot;s:$D:/:g&quot; -e 's:/\+:/:g'`
-	  fi
 	  $echo &gt; $output &quot;\
 # $outputname - a libtool library file
 # Generated by $PROGRAM - GNU $PACKAGE $VERSION$TIMESTAMP
@@ -5473,7 +5295,7 @@
       # Aesthetically quote it.
       arg=`$echo &quot;X$nonopt&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
       case $arg in
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*)
 	arg=&quot;\&quot;$arg\&quot;&quot;
 	;;
       esac
@@ -5489,7 +5311,7 @@
     # Aesthetically quote it.
     arg=`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
     case $arg in
-    *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+    *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*)
       arg=&quot;\&quot;$arg\&quot;&quot;
       ;;
     esac
@@ -5537,7 +5359,7 @@
       # Aesthetically quote the argument.
       arg=`$echo &quot;X$arg&quot; | $Xsed -e &quot;$sed_quote_subst&quot;`
       case $arg in
-      *$quote_scanset* | *]* | *\|* | *\&amp;* | *\(* | *\)* | &quot;&quot;)
+      *[\[\~\#\^\&amp;\*\(\)\{\}\|\;\&lt;\&gt;\?\'\ \	]*|*]*)
 	arg=&quot;\&quot;$arg\&quot;&quot;
 	;;
       esac
@@ -6576,7 +6398,7 @@
 $echo
 $echo &quot;Try \`$modename --help' for more information about other modes.&quot;
 
-exit $?
+exit $EXIT_SUCCESS
 
 # The TAGs below are defined such that we never get into a situation
 # in which we disable both kinds of libraries.  Given conflicting

Modified: branches/mloskot-style-refactoring/src/Makefile
===================================================================
--- branches/mloskot-style-refactoring/src/Makefile	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/Makefile	2005-11-11 21:57:36 UTC (rev 231)
@@ -25,7 +25,7 @@
 pkgincludedir = $(includedir)/openspace
 top_builddir = ..
 am__cd = CDPATH=&quot;$${ZSH_VERSION+.}$(PATH_SEPARATOR)&quot; &amp;&amp; cd
-INSTALL = /bin/install -c
+INSTALL = /usr/bin/install -c
 install_sh_DATA = $(install_sh) -c -m 644
 install_sh_PROGRAM = $(install_sh) -c
 install_sh_SCRIPT = $(install_sh) -c
@@ -37,7 +37,7 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-host_triplet = i686-pc-linux-gnu
+host_triplet = x86_64-unknown-linux-gnu
 bin_PROGRAMS = openspace$(EXEEXT)
 subdir = src
 DIST_COMMON = $(noinst_HEADERS) $(srcdir)/Makefile.am \
@@ -112,14 +112,14 @@
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-ACLOCAL = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run aclocal-1.8
+ACLOCAL = ${SHELL} /home/mloskot/dev/openspace/work/missing --run aclocal-1.8
 AMDEP_FALSE = #
 AMDEP_TRUE = 
-AMTAR = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run tar
+AMTAR = ${SHELL} /home/mloskot/dev/openspace/work/missing --run tar
 AR = ar
-AUTOCONF = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run autoconf
-AUTOHEADER = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run autoheader
-AUTOMAKE = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run automake-1.8
+AUTOCONF = ${SHELL} /home/mloskot/dev/openspace/work/missing --run autoconf
+AUTOHEADER = ${SHELL} /home/mloskot/dev/openspace/work/missing --run autoheader
+AUTOMAKE = ${SHELL} /home/mloskot/dev/openspace/work/missing --run automake-1.8
 AWK = gawk
 CC = gcc
 CCDEPMODE = depmode=gcc3
@@ -152,7 +152,7 @@
 LIBTOOL = $(SHELL) $(top_builddir)/libtool
 LN_S = ln -s
 LTLIBOBJS = 
-MAKEINFO = ${SHELL} /root/openspace4/mloskot-style-refactoring/missing --run makeinfo
+MAKEINFO = ${SHELL} /home/mloskot/dev/openspace/work/missing --run makeinfo
 OBJEXT = o
 PACKAGE = openspace
 PACKAGE_BUGREPORT = <A HREF="http://openspace.linux.pl">http://openspace.linux.pl</A>
@@ -181,28 +181,28 @@
 am__leading_dot = .
 am__quote = 
 bindir = ${exec_prefix}/bin
-build = i686-pc-linux-gnu
+build = x86_64-unknown-linux-gnu
 build_alias = 
-build_cpu = i686
+build_cpu = x86_64
 build_os = linux-gnu
-build_vendor = pc
+build_vendor = unknown
 datadir = ${prefix}/share
 exec_prefix = ${prefix}
-host = i686-pc-linux-gnu
+host = x86_64-unknown-linux-gnu
 host_alias = 
-host_cpu = i686
+host_cpu = x86_64
 host_os = linux-gnu
-host_vendor = pc
+host_vendor = unknown
 includedir = ${prefix}/include
 infodir = ${prefix}/info
-install_sh = /root/openspace4/mloskot-style-refactoring/install-sh
+install_sh = /home/mloskot/dev/openspace/work/install-sh
 libdir = ${exec_prefix}/lib
 libexecdir = ${exec_prefix}/libexec
 localstatedir = ${prefix}/var
 mandir = ${prefix}/man
 mkdir_p = mkdir -p -- .
 oldincludedir = /usr/include
-prefix = /usr
+prefix = /home/mloskot/usr
 program_transform_name = s,x,x,
 sbindir = ${exec_prefix}/sbin
 sharedstatedir = ${prefix}/com

Modified: branches/mloskot-style-refactoring/src/OSVirtualFileSystemBase.h
===================================================================
--- branches/mloskot-style-refactoring/src/OSVirtualFileSystemBase.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/OSVirtualFileSystemBase.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -49,32 +49,32 @@
 class OSVirtualFileSystemBase
 {
 public:
-    virtual int osopendir ( std::string dir ) = 0;
-    virtual OSFile osreaddir ( void ) = 0;
-    virtual int mkdir ( std::string dir, int mode = 0 ) = 0;
-    virtual int copy ( OSThreadExec* te ) = 0;
-    virtual int move ( OSThreadExec* te ) = 0;
-    virtual int remove ( OSThreadExec* te ) = 0;
-    virtual int rename ( std::string orgname, std::string newname ) = 0;
-    virtual int init ( std::vector&lt;std::string&gt;* vector_name, OSPathType pt, OSConfigure * conf ) = 0;
-    virtual int mode ( std::string file ) = 0;
-    virtual std::string owner ( std::string file ) = 0;
-    virtual std::string group ( std::string file ) = 0;
-    virtual bool mode ( std::string file, unsigned int, bool recursive ) = 0;
-    virtual bool owner ( std::string file, std::string, bool recursive ) = 0;
-    virtual bool group ( std::string file, std::string, bool recursive ) = 0;
-    virtual std::string info ( void ) = 0;
-    virtual void totalsize ( std::string path, unsigned long &amp;size ) = 0;
-    virtual std::string symlink ( std::string path ) = 0;
-    virtual bool symlink ( std::string src, std::string dst ) = 0;
-    virtual bool hardlink ( std::string src, std::string dst ) = 0;
-    virtual int quit ( void ) = 0;
+    virtual int osopendir( std::string dir ) = 0;
+    virtual OSFile osreaddir( void ) = 0;
+    virtual int mkdir( std::string dir, int mode = 0 ) = 0;
+    virtual int copy( OSThreadExec* te ) = 0;
+    virtual int move( OSThreadExec* te ) = 0;
+    virtual int remove( OSThreadExec* te ) = 0;
+    virtual int rename( std::string orgname, std::string newname ) = 0;
+    virtual int init( std::vector&lt;std::string&gt;* vector_name, OSPathType pt, OSConfigure* conf ) = 0;
+    virtual int mode( std::string file ) = 0;
+    virtual std::string owner( std::string file ) = 0;
+    virtual std::string group( std::string file ) = 0;
+    virtual bool mode( std::string file, unsigned int, bool recursive ) = 0;
+    virtual bool owner( std::string file, std::string, bool recursive ) = 0;
+    virtual bool group( std::string file, std::string, bool recursive ) = 0;
+    virtual std::string info( void ) = 0;
+    virtual void totalsize(std::string path, unsigned long &amp;size ) = 0;
+    virtual std::string symlink( std::string path ) = 0;
+    virtual bool symlink( std::string src, std::string dst ) = 0;
+    virtual bool hardlink( std::string src, std::string dst ) = 0;
+    virtual int quit( void ) = 0;
     virtual std::string getinitialdir( void )
     {
         return &quot;/&quot;;
     }
 
-    virtual OSVirtualFileSystemInfo setup ( void ) = 0;
+    virtual OSVirtualFileSystemInfo setup( void ) = 0;
 };
 
 #endif// #ifndef __OSVIRTUALFILESYSTEMBASE_H__

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,15 +1,14 @@
-pkglib_LTLIBRARIES= libfilelistlocal.la  
-#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES= libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 pkglibdir=$(libdir)/openspace/plugins/filelist
 INCLUDES = `WANT_FOX=&quot;1.4&quot; fox-config --cflags` `xml2-config  --cflags` 
 
 libfilelistlocal_la_LDFLAGS = `WANT_FOX=&quot;1.4&quot; fox-config --libs` `xml2-config  --libs`  
 libfilelistlocal_la_SOURCES =filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
-#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
+libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2005-11-11 21:57:36 UTC (rev 231)
@@ -14,7 +14,7 @@
 
 @SET_MAKE@
 
-SOURCES = $(libfilelistlocal_la_SOURCES)
+SOURCES = $(libfilelistarchive_la_SOURCES) $(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) $(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -48,17 +48,34 @@
 am__installdirs = &quot;$(DESTDIR)$(pkglibdir)&quot;
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
+libfilelistarchive_la_LIBADD =
+am_libfilelistarchive_la_OBJECTS = filelist_archive.lo OSThreadExec.lo
+libfilelistarchive_la_OBJECTS = $(am_libfilelistarchive_la_OBJECTS)
+libfilelistftp_la_LIBADD =
+am_libfilelistftp_la_OBJECTS = filelist_ftp.lo pftp.lo OSThreadExec.lo
+libfilelistftp_la_OBJECTS = $(am_libfilelistftp_la_OBJECTS)
 libfilelistlocal_la_LIBADD =
 am_libfilelistlocal_la_OBJECTS = filelist_local.lo OSFXFile.lo \
 	OSThreadExec.lo OSUtils.lo
 libfilelistlocal_la_OBJECTS = $(am_libfilelistlocal_la_OBJECTS)
+libfilelistsearch_la_LIBADD =
+am_libfilelistsearch_la_OBJECTS = filelist_search.lo OSFXFile.lo \
+	OSThreadExec.lo
+libfilelistsearch_la_OBJECTS = $(am_libfilelistsearch_la_OBJECTS)
+libfilelistsftp_la_LIBADD =
+am_libfilelistsftp_la_OBJECTS = filelist_sftp.lo OSThreadExec.lo
+libfilelistsftp_la_OBJECTS = $(am_libfilelistsftp_la_OBJECTS)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">AMDEP_TRUE at DEP_FILES</A> = ./$(DEPDIR)/OSFXFile.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSUtils.Plo \
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">- at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_local.Plo
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_archive.Plo \
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_ftp.Plo \
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_local.Plo \
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_search.Plo \
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@	./$(DEPDIR)/filelist_sftp.Plo ./$(DEPDIR)/pftp.Plo
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
 LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
@@ -75,12 +92,15 @@
 CCLD = $(CC)
 LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libfilelistlocal_la_SOURCES)
-DIST_SOURCES = $(libfilelistlocal_la_SOURCES)
+SOURCES = $(libfilelistarchive_la_SOURCES) \
+	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
+	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
+DIST_SOURCES = $(libfilelistarchive_la_SOURCES) \
+	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
+	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 pkglibdir = $(libdir)/openspace/plugins/filelist
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
@@ -178,10 +198,18 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-pkglib_LTLIBRARIES = libfilelistlocal.la  
+pkglib_LTLIBRARIES = libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 INCLUDES = `WANT_FOX=&quot;1.4&quot; fox-config --cflags` `xml2-config  --cflags` 
 libfilelistlocal_la_LDFLAGS = `WANT_FOX=&quot;1.4&quot; fox-config --libs` `xml2-config  --libs`  
 libfilelistlocal_la_SOURCES = filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistsearch_la_SOURCES = filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistarchive_la_SOURCES = filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistsftp_la_SOURCES = filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libfilelistftp_la_SOURCES = filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 all: all-am
 
 .SUFFIXES:
@@ -242,8 +270,16 @@
 	  echo &quot;rm -f \&quot;$${dir}/so_locations\&quot;&quot;; \
 	  rm -f &quot;$${dir}/so_locations&quot;; \
 	done
+libfilelistarchive.la: $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistarchive_la_LDFLAGS) $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_LIBADD) $(LIBS)
+libfilelistftp.la: $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistftp_la_LDFLAGS) $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_LIBADD) $(LIBS)
 libfilelistlocal.la: $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_DEPENDENCIES) 
 	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistlocal_la_LDFLAGS) $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_LIBADD) $(LIBS)
+libfilelistsearch.la: $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsearch_la_LDFLAGS) $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_LIBADD) $(LIBS)
+libfilelistsftp.la: $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsftp_la_LDFLAGS) $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
@@ -254,7 +290,12 @@
 @AMDEP_TRUE@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">OSFXFile.Plo at am__quote</A>@
 @AMDEP_TRUE@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">OSThreadExec.Plo at am__quote</A>@
 @AMDEP_TRUE@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">OSUtils.Plo at am__quote</A>@
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">filelist_archive.Plo at am__quote</A>@
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">filelist_ftp.Plo at am__quote</A>@
 @AMDEP_TRUE@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">filelist_local.Plo at am__quote</A>@
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">filelist_search.Plo at am__quote</A>@
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">filelist_sftp.Plo at am__quote</A>@
<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">+ at AMDEP_TRUE</A>@@am__include@ @<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">am__quote at .</A>/$(DEPDIR)/<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">pftp.Plo at am__quote</A>@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF &quot;$(DEPDIR)/$*.Tpo&quot; -c -o $@ $&lt;; \
@@ -508,14 +549,6 @@
 	tags uninstall uninstall-am uninstall-info-am \
 	uninstall-pkglibLTLIBRARIES
 
-#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,6 +1,8 @@
 #ifndef FILELIST_archive
 #define FILELIST_archive
+
 #include &quot;../../OSVirtualFileSystemBase.h&quot;
+
 class filelist_archive:public filelist_base
 {
  

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,3 +1,32 @@
+// $Id$
+/////////////////////////////////////////////////////////////////////////////
+// This file is part of OpenSpace project.
+//
+// OpenSpace is free software; you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation; either version 2 of the License, or
+// (at your option) any later version.
+//
+// OpenSpace is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with OpenSpace; if not, write to the Free Software
+// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+/////////////////////////////////////////////////////////////////////////////
+//
+// C++ Implementation: $MODULE$
+//
+// Author: Mateusz Dworak &lt;<A HREF="http://openspace.linux.pl">http://openspace.linux.pl</A>&gt;, (C) 2005
+//
+// Description:
+//  FTP plugin derived from OpenSpace file list VFS plugin.
+//
+/////////////////////////////////////////////////////////////////////////////
+
+
 #ifdef WIN32
 #define EXPORTFUNCTION extern &quot;C&quot; __declspec(dllexport)
 #else
@@ -3,5 +32,7 @@
 #define EXPORTFUNCTION extern &quot;C&quot;
 #endif
+
 #include &quot;filelist_ftp.h&quot;
+#include &quot;../../OSVirtualFileSystemBase.h&quot;
 
 #include &lt;sstream&gt;
@@ -12,263 +43,262 @@
 #include &lt;sys/types.h&gt;
 #include &lt;dirent.h&gt;
 
-    SimpleLogger::SimpleLogger()
+#include &lt;string&gt;
+#include &lt;vector&gt;
+#include &lt;map&gt;
+
+SimpleLogger::SimpleLogger()
+{
+    te = NULL;
+}
+
+void SimpleLogger::start( uint32_t bytes, const FXString &amp; name, uint32_t size )
+{
+    if ( te != NULL &amp;&amp; name != &quot;&quot; )
     {
-    te=NULL;
+        te-&gt;act_file_size = 0;
+        te-&gt;act_file_name = name.text ();
+        if ( size != 0 )
+            te-&gt;file_size = size;
     }
-    
-    void SimpleLogger::start(uint32_t bytes, const FXString &amp; name,uint32_t size)
+}
+bool SimpleLogger::update( uint32_t bytes, const FXString &amp; s )
+{
+    if ( te != NULL )
     {
-    	if(te!=NULL &amp;&amp; name!=&quot;&quot;)
-   	{
-		te-&gt;act_file_size=0;
-		te-&gt;act_file_name = name.text ();
-		if(size!=0)
-		te-&gt;file_size = size;
-	}
+        te-&gt;act_file_size += bytes;
+        te-&gt;act_total_size += bytes;
+
+        if ( te-&gt;cancel == true )
+            return false;
     }
-    bool SimpleLogger::update(uint32_t bytes, const FXString &amp; s)
-    {
-     if(te!=NULL)
-     {
-	te-&gt;act_file_size+=bytes;	
-	te-&gt;act_total_size+=bytes;
-	
-	if(te-&gt;cancel==true)
-	return false;
-     }	
     return true;
-    }
-    void SimpleLogger::end(uint32_t bytes, const FXString &amp; )
-    {
+}
+void SimpleLogger::end( uint32_t bytes, const FXString &amp; )
+{}
 
-    }
+void SimpleLogger::choke()
+{}
 
-    void SimpleLogger::choke()
-    {
+void SimpleLogger::error( int error )
+{}
 
-    }
+void SimpleLogger::logLine( FXString &amp; line )
+{
+    fxmessage( &quot;LOG=%s\n&quot;, line.text() );
+}
+void SimpleLogger::error( FXString &amp; error )
+{
+    fxmessage( &quot;ERROR=%s\n&quot;, error.text() );
+}
 
-    void SimpleLogger::error(int error)
-    {
+vfs filelist_ftp::setup ( void )
+{
+    OSVirtualFileSystemBase v;
 
-    }
+    v.vfsheaders.push_back( vfsheader_container( &quot;name&quot; ) );
+    v.vfsheaders.push_back( vfsheader_container( &quot;size&quot;, &quot;size&quot; ) );
+    v.vfsheaders.push_back( vfsheader_container( &quot;owner&quot; ) );
+    v.vfsheaders.push_back( vfsheader_container( &quot;group&quot; ) );
+    v.information = &quot;FTP - default plugin&quot;;
+    v.version = &quot;1&quot;;
+    v.type = &quot;network&quot;;
+    return v;
 
-    void SimpleLogger::logLine(FXString &amp; line)
-    {
-     fxmessage(&quot;LOG=%s\n&quot;,line.text());
-    }
-    void SimpleLogger::error(FXString &amp; error)
-    {
-     fxmessage(&quot;ERROR=%s\n&quot;,error.text());
-    }
-
-vfs filelist_ftp::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container(&quot;name&quot;));
-	v.vfsheaders.push_back(vfsheader_container(&quot;size&quot;,&quot;size&quot;));
-	v.vfsheaders.push_back(vfsheader_container(&quot;owner&quot;));
-	v.vfsheaders.push_back(vfsheader_container(&quot;group&quot;));
-	v.information=&quot;FTP - default plugin&quot;;
-	v.version=&quot;1&quot;;
-	v.type=&quot;network&quot;;
-return v;	
-	
 }
 
 
-int filelist_ftp::priv_osopendir (string dir,string prefix,map &lt;string,osfile&gt; &amp; filesMap,map &lt;string,osfile&gt;::iterator &amp; iter)
+int filelist_ftp::priv_osopendir ( std::string dir, std::string prefix, std::map &lt;std::string, osfile&gt; &amp; filesMap, std::map &lt;std::string, osfile&gt;::iterator &amp; iter )
 {
 
-filesMap.clear();
+    filesMap.clear();
 
 
-	FXString di=dir.c_str();	
-	pftp-&gt;setDir(di);
-	FXString di2;
-	pftp-&gt;pwd(di2);
+    FXString di = dir.c_str();
+    pftp-&gt;setDir( di );
+    FXString di2;
+    pftp-&gt;pwd( di2 );
 
-	if(FXFile::name(di)!=FXFile::name(di2) || di2==&quot;&quot;)
-	return -1;
+    if ( FXFile::name( di ) != FXFile::name( di2 ) || di2 == &quot;&quot; )
+        return -1;
 
 
-	
+
     FXMemoryStream str;
-    str.open(FXStreamSave, NULL);
+    str.open( FXStreamSave, NULL );
 
 
-    pftp-&gt;list(str);
+    pftp-&gt;list( str );
 
     // nil terminate the buffer
     FXuchar nil = 0;
-    str.save(&amp;nil, 1);
+    str.save( &amp;nil, 1 );
 
     // and get it
     FXuchar* buffer;
     unsigned long sp;
-    str.takeBuffer(buffer, sp);
+    str.takeBuffer( buffer, sp );
 
-    char * ptr = reinterpret_cast&lt;char *&gt;(buffer);
-    char * next = strchr(ptr, '\n');
+    char * ptr = reinterpret_cast&lt;char *&gt;( buffer );
+    char * next = strchr( ptr, '\n' );
     char * start = ptr;
 
 
     //get attributes # user group size date =(3 or 4? fields) name
-    while(next &amp;&amp; (ptr-start &lt; (int)sp))
+    while ( next &amp;&amp; ( ptr - start &lt; ( int ) sp ) )
     {
 
-        next[0] = 0;
-        if(next[-1] == '\r')
-            next[-1] = 0;
+        next[ 0 ] = 0;
+        if ( next[ -1 ] == '\r' )
+            next[ -1 ] = 0;
 
         // Some FTP servers send other lines than raw directory
-        if(ptr[0] != 'd' &amp;&amp; ptr[0] != '-')
+        if ( ptr[ 0 ] != 'd' &amp;&amp; ptr[ 0 ] != '-' )
         {
-            ptr = next+1;
-            next = strchr(ptr, '\n');
+            ptr = next + 1;
+            next = strchr( ptr, '\n' );
             continue;
         }
 
 
 
-       osfile os_file;
-       os_file.type=0;
-       if(ptr[0]=='d')
-           os_file.type = os_file.type | FOLDER; 
-       else	   
-           os_file.type=0;
+        osfile os_file;
+        os_file.type = 0;
+        if ( ptr[ 0 ] == 'd' )
+            os_file.type = os_file.type | FOLDER;
+        else
+            os_file.type = 0;
 
-std::stringstream parser (ptr);
-std::string field;
+        std::stringstream parser ( ptr );
+        std::std::string field;
 
-   string user;
-   string group;
-   string size;
-   string date;
-   string attrib;
-   string name;
-   
-parser&gt;&gt;attrib; 
+        std::string user;
+        std::string group;
+        std::string size;
+        std::string date;
+        std::string attrib;
+        std::string name;
 
-attrib=attrib.substr(1,attrib.length()-1);
+        parser &gt;&gt; attrib;
 
-parser&gt;&gt;field;
-parser&gt;&gt;user;
-parser&gt;&gt;group;
-parser&gt;&gt;size;
-os_file.size=atoi(size.c_str());
+        attrib = attrib.substr( 1, attrib.length() - 1 );
 
+        parser &gt;&gt; field;
+        parser &gt;&gt; user;
+        parser &gt;&gt; group;
+        parser &gt;&gt; size;
+        os_file.size = atoi( size.c_str() );
 
-parser&gt;&gt;date;
-parser&gt;&gt;date;
-parser&gt;&gt;date;
 
+        parser &gt;&gt; date;
+        parser &gt;&gt; date;
+        parser &gt;&gt; date;
 
-os_file.user=user;
-os_file.group=group;
-os_file.mode=attrib;
 
+        os_file.user = user;
+        os_file.group = group;
+        os_file.mode = attrib;
 
 
-string n;
-while(parser&gt;&gt;n)
-{
-if(name!=&quot;&quot;)
-name=name+&quot; &quot;+n;
-else
-name=n;
-}
- 
-        os_file.name = prefix+name;
-	
 
-if(prefix==&quot;&quot;)
-{	
-	
-	
-    for (int i = 0; i &lt; fieldsnum - 1; i++)
-    {
+        std::string n;
+        while ( parser &gt;&gt; n )
+        {
+            if ( name != &quot;&quot; )
+                name = name + &quot; &quot; + n;
+            else
+                name = n;
+        }
 
-	if (fields[i + 1] == &quot;size&quot;)
-	    os_file.attrib.push_back(size);
-	else if (fields[i + 1] == &quot;owner&quot;)
-	   os_file.attrib.push_back(user);
-	else if (fields[i + 1] == &quot;group&quot;)
-	   os_file.attrib.push_back(group);
-        else if (fields[i + 1] == &quot;mode&quot;)
-        os_file.attrib.push_back(attrib);
+        os_file.name = prefix + name;
 
 
+        if ( prefix == &quot;&quot; )
+        {
+
+
+            for ( int i = 0; i &lt; fieldsnum - 1; i++ )
+            {
+
+                if ( fields[ i + 1 ] == &quot;size&quot; )
+                    os_file.attrib.push_back( size );
+                else if ( fields[ i + 1 ] == &quot;owner&quot; )
+                    os_file.attrib.push_back( user );
+                else if ( fields[ i + 1 ] == &quot;group&quot; )
+                    os_file.attrib.push_back( group );
+                else if ( fields[ i + 1 ] == &quot;mode&quot; )
+                    os_file.attrib.push_back( attrib );
+
+
+            }
+
+        }
+        filesMap[ os_file.name ] = os_file;
+
+
+
+        if ( prefix != &quot;&quot; )
+        {
+            filesMapGlobal[ os_file.name ] = os_file;
+        }
+        ptr = next + 1;
+        next = strchr( ptr, '\n' );
     }
-	
-}	
-filesMap[os_file.name]=os_file;	
-	
-	
-	
-	if(prefix!=&quot;&quot;)
-	{
-	filesMapGlobal[os_file.name]=os_file;
-	}
-        ptr = next+1;
-        next = strchr(ptr, '\n');
-    }
- FXFREE(&amp;buffer);
+    FXFREE( &amp;buffer );
 
-iter=filesMap.begin();
+    iter = filesMap.begin();
 
 }
 
 
 
-int filelist_ftp::osopendir (string dir)
+int filelist_ftp::osopendir ( std::string dir )
 {
 
 
-this-&gt;dir=dir;
+    this-&gt;dir = dir;
 
-return priv_osopendir(dir,&quot;&quot;,filesMap,iter);
- 
+    return priv_osopendir( dir, &quot;&quot;, filesMap, iter );
 
 
+
 }
 
-osfile filelist_ftp::priv_osreaddir (map &lt;string,osfile&gt; &amp; filesMap,map &lt;string,osfile&gt;::iterator &amp; iter)
+osfile filelist_ftp::priv_osreaddir ( std::map &lt;std::string, osfile&gt; &amp; filesMap, std::map &lt;std::string, osfile&gt;::iterator &amp; iter )
 {
-osfile os_file;
+    osfile os_file;
 
-if(iter!=filesMap.end())
-{
-	  os_file=iter-&gt;second;
-	   
-	    iter++;
-	    return os_file;
-}		    
+    if ( iter != filesMap.end() )
+    {
+        os_file = iter-&gt;second;
 
+        iter++;
+        return os_file;
+    }
 
-    
+
+
     os_file.name = &quot;&quot;;
     return os_file;
 
 }
 
 
-osfile filelist_ftp::osreaddir (void)
+osfile filelist_ftp::osreaddir ( void )
 {
 
-  return priv_osreaddir(filesMap,iter);  
+    return priv_osreaddir( filesMap, iter );
 }
-int filelist_ftp::mkdir (string dir, int mode)
+int filelist_ftp::mkdir ( std::string dir, int mode )
 {
-	pftp-&gt;mkDir(dir.c_str());
+    pftp-&gt;mkDir( dir.c_str() );
 }
 
 
 static const int BUCKETSIZE = 128;
-struct Bucket {
-    uint8_t bucket[BUCKETSIZE];
+struct Bucket
+{
+    uint8_t bucket[ BUCKETSIZE ];
 };
 
 
@@ -278,49 +308,49 @@
 
 
 
-void filelist_ftp::local_totalsize (string path, unsigned long &amp;size)
+void filelist_ftp::local_totalsize ( std::string path, unsigned long &amp;size )
 {
 
-    if (FXFile::isDirectory (path.c_str ()))
+    if ( FXFile::isDirectory ( path.c_str () ) )
     {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
+        struct stat status;
+        struct dirent *dp;
+        DIR *dirp;
 
 
-	dirp = opendir (path.c_str ());
+        dirp = opendir ( path.c_str () );
 
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp-&gt;d_name[0] != '.' || (dp-&gt;d_name[1] != '\0' &amp;&amp; (dp-&gt;d_name[1] != '.' || dp-&gt;d_name[2] != '\0')))
-	    {
+        while ( ( dp = readdir ( dirp ) ) != NULL )
+        {
+            if ( dp-&gt;d_name[ 0 ] != '.' || ( dp-&gt;d_name[ 1 ] != '\0' &amp;&amp; ( dp-&gt;d_name[ 1 ] != '.' || dp-&gt;d_name[ 2 ] != '\0' ) ) )
+            {
 
-		string file = path;
-		file.append (dp-&gt;d_name);
+                std::string file = path;
+                file.append ( dp-&gt;d_name );
 #ifndef WIN32
-		lstat (file.c_str (), &amp;status);
+                lstat ( file.c_str (), &amp;status );
 #else
-		stat (file.c_str (), &amp;status);
+                stat ( file.c_str (), &amp;status );
 #endif
-		if (S_ISDIR (status.st_mode))
-		{
-		    size = size + (unsigned int) status.st_size;
-		    file.append (&quot;/&quot;);
-		    totalsize (file, size);
+                if ( S_ISDIR ( status.st_mode ) )
+                {
+                    size = size + ( unsigned int ) status.st_size;
+                    file.append ( &quot;/&quot; );
+                    totalsize ( file, size );
 
-		}
-		else
-		{
-		    size = size + status.st_size;
-		}
-	    }
-	}
+                }
+                else
+                {
+                    size = size + status.st_size;
+                }
+            }
+        }
 
-	closedir (dirp);
+        closedir ( dirp );
     }
     else
     {
-	size += FXFile::size (path.c_str ());
+        size += FXFile::size ( path.c_str () );
 
     }
 
@@ -332,132 +362,132 @@
 
 
 
-int filelist_ftp::copy (thread_elem * te)
+int filelist_ftp::copy ( thread_elem * te )
 {
- log-&gt;te=te;
-  unsigned long size = 0;
-    
-    string::size_type pos = te-&gt;options.find (&quot;upload&quot;);
-	if (pos == string::npos)
-	{
-	
-	string dir_copy=this-&gt;dir;
-	
-	 vector &lt; string &gt;::iterator iter;
-	 
-	 for (iter = te-&gt;src.begin (); iter != te-&gt;src.end(); iter++)
-   	 {
-	 string sr = (*iter);
-	 if (FXFile::isDirectory (sr.c_str ()))
-	    sr.append (&quot;/&quot;);
-	 local_totalsize (sr, size);
-	 }
+    log-&gt;te = te;
+    unsigned long size = 0;
 
-	te-&gt;total_size = size; 
-	 
-    for (iter = te-&gt;src.begin (); iter != te-&gt;src.end(); iter++)
+    std::string::size_type pos = te-&gt;options.find ( &quot;upload&quot; );
+    if ( pos == std::string::npos )
     {
-	
-        FXString file=iter-&gt;c_str();	
-	goLocalRecursive(file.text(),&quot;&quot;,te);
-	pftp-&gt;setDir(dir_copy.c_str());
-	
-    }
-	this-&gt;dir=dir_copy;
-	
-	}
-	else 
-	{
 
+        std::string dir_copy = this-&gt;dir;
 
+        std::vector &lt; std::string &gt;::iterator iter;
 
-getRecursiveFiles(te-&gt;src,size);
+        for ( iter = te-&gt;src.begin (); iter != te-&gt;src.end(); iter++ )
+        {
+            std::string sr = ( *iter );
+            if ( FXFile::isDirectory ( sr.c_str () ) )
+                sr.append ( &quot;/&quot; );
+            local_totalsize ( sr, size );
+        }
 
-te-&gt;total_size = size; 
-for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-    {   
-    if(te-&gt;cancel==true)
-    break;  
-   	
-	if(iterGlobal-&gt;second.type&amp;FOLDER)
-	{
-	
-	string filename=te-&gt;dst+&quot;/&quot;+iterGlobal-&gt;first;
-	FXFile::createDirectory(filename.c_str(),str_mode_int(iterGlobal-&gt;second.mode));
-	
-	}
-	else
-	{
-	string filename=te-&gt;dst+&quot;/&quot;+iterGlobal-&gt;first;
-	FXFile::createDirectory(FXFile::directory(filename.c_str()),str_mode_int(iterGlobal-&gt;second.mode));
-	te-&gt;file_size = iterGlobal-&gt;second.size;
-	
-	pftp-&gt;download(iterGlobal-&gt;first.c_str(),filename.c_str(),false);
-	
-	FXFile::mode(filename.c_str(),str_mode_int(iterGlobal-&gt;second.mode));
-	}
-	te-&gt;act_file_name=iterGlobal-&gt;first;
-	if( iterGlobal == filesMapGlobal.begin())break;
-	
+        te-&gt;total_size = size;
+
+        for ( iter = te-&gt;src.begin (); iter != te-&gt;src.end(); iter++ )
+        {
+
+            FXString file = iter-&gt;c_str();
+            goLocalRecursive( file.text(), &quot;&quot;, te );
+            pftp-&gt;setDir( dir_copy.c_str() );
+
+        }
+        this-&gt;dir = dir_copy;
+
     }
+    else
+    {
 
 
-	
 
-   
-	}		
- log-&gt;te=NULL;   
+        getRecursiveFiles( te-&gt;src, size );
+
+        te-&gt;total_size = size;
+        for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
+        {
+            if ( te-&gt;cancel == true )
+                break;
+
+            if ( iterGlobal-&gt;second.type &amp; FOLDER )
+            {
+
+                std::string filename = te-&gt;dst + &quot;/&quot; + iterGlobal-&gt;first;
+                FXFile::createDirectory( filename.c_str(), str_mode_int( iterGlobal-&gt;second.mode ) );
+
+            }
+            else
+            {
+                std::string filename = te-&gt;dst + &quot;/&quot; + iterGlobal-&gt;first;
+                FXFile::createDirectory( FXFile::directory( filename.c_str() ), str_mode_int( iterGlobal-&gt;second.mode ) );
+                te-&gt;file_size = iterGlobal-&gt;second.size;
+
+                pftp-&gt;download( iterGlobal-&gt;first.c_str(), filename.c_str(), false );
+
+                FXFile::mode( filename.c_str(), str_mode_int( iterGlobal-&gt;second.mode ) );
+            }
+            te-&gt;act_file_name = iterGlobal-&gt;first;
+            if ( iterGlobal == filesMapGlobal.begin() ) break;
+
+        }
+
+
+
+
+
+    }
+    log-&gt;te = NULL;
 }
 
 
-void filelist_ftp::goLocalRecursive (string path,string prefix,thread_elem *te)
+void filelist_ftp::goLocalRecursive ( std::string path, std::string prefix, thread_elem *te )
 {
 
-    if(te-&gt;cancel==true)
-    return; 
+    if ( te-&gt;cancel == true )
+        return ;
 
-    if (FXFile::isDirectory (path.c_str ()))
+    if ( FXFile::isDirectory ( path.c_str () ) )
     {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
+        struct stat status;
+        struct dirent *dp;
+        DIR *dirp;
 
-     prefix=prefix+ FXFile::name(path.c_str()).text();
-     string fulldir=this-&gt;dir+&quot;/&quot;+prefix;
-     
-     pftp-&gt;mkDir(fulldir.c_str());
-     this-&gt;mode (fulldir,FXFile::mode(path.c_str()),false);
-     pftp-&gt;setDir(fulldir.c_str()); 
+        prefix = prefix + FXFile::name( path.c_str() ).text();
+        std::string fulldir = this-&gt;dir + &quot;/&quot; + prefix;
 
-	dirp = opendir (path.c_str ());
+        pftp-&gt;mkDir( fulldir.c_str() );
+        this-&gt;mode ( fulldir, FXFile::mode( path.c_str() ), false );
+        pftp-&gt;setDir( fulldir.c_str() );
 
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp-&gt;d_name[0] != '.' || (dp-&gt;d_name[1] != '\0' &amp;&amp; (dp-&gt;d_name[1] != '.' || dp-&gt;d_name[2] != '\0')))
-	    {
+        dirp = opendir ( path.c_str () );
 
-		string file = path+&quot;/&quot;;
-		file.append (dp-&gt;d_name);
-		goLocalRecursive(file,prefix+&quot;/&quot;,te);
-	    }
-	}
+        while ( ( dp = readdir ( dirp ) ) != NULL )
+        {
+            if ( dp-&gt;d_name[ 0 ] != '.' || ( dp-&gt;d_name[ 1 ] != '\0' &amp;&amp; ( dp-&gt;d_name[ 1 ] != '.' || dp-&gt;d_name[ 2 ] != '\0' ) ) )
+            {
 
-	closedir (dirp);
+                std::string file = path + &quot;/&quot;;
+                file.append ( dp-&gt;d_name );
+                goLocalRecursive( file, prefix + &quot;/&quot;, te );
+            }
+        }
+
+        closedir ( dirp );
     }
     else
     {
-    string pre=this-&gt;dir+&quot;/&quot;+prefix.substr(0,prefix.length()-1);
-    if(this-&gt;dir!=pre)
-    {
-     pftp-&gt;setDir(pre.c_str()); 
-     this-&gt;dir=pre;
-    }
-  
-		FXString fil=path.c_str();
-		pftp-&gt;upload(fil,0,false);
-		this-&gt;mode (path,FXFile::mode(fil),false);   
-		 
+        std::string pre = this-&gt;dir + &quot;/&quot; + prefix.substr( 0, prefix.length() - 1 );
+        if ( this-&gt;dir != pre )
+        {
+            pftp-&gt;setDir( pre.c_str() );
+            this-&gt;dir = pre;
+        }
 
+        FXString fil = path.c_str();
+        pftp-&gt;upload( fil, 0, false );
+        this-&gt;mode ( path, FXFile::mode( fil ), false );
+
+
     }
 
 }
@@ -469,271 +499,264 @@
 
 
 
-int filelist_ftp::move (thread_elem * te)
-{
-}
+int filelist_ftp::move ( thread_elem * te )
+{}
 
 
-void filelist_ftp::gorecursive(string file,unsigned long &amp;size)
+void filelist_ftp::gorecursive( std::string file, unsigned long &amp;size )
 {
 
 
-		map &lt;string,osfile&gt; filesMap;
-		map &lt;string,osfile&gt;::iterator iter;
-		
-	   	if(priv_osopendir(file,file+&quot;/&quot;,filesMap,iter)!=-1)
-		{
-		
-		 while (1)
-   		 {	
-		 osfile os_file = priv_osreaddir (filesMap,iter);
-		 	if (os_file.name == &quot;&quot;)
-	   		break;
-			
-			if(os_file.type&amp;FOLDER)
-			{
-			gorecursive(os_file.name,size);
-			}
-			else
-			size = size + os_file.size;
-		 }
+    std::map &lt;std::string, osfile&gt; filesMap;
+    std::map &lt;std::string, osfile&gt;::iterator iter;
 
-	    }
+    if ( priv_osopendir( file, file + &quot;/&quot;, filesMap, iter ) != -1 )
+    {
 
+        while ( 1 )
+        {
+            osfile os_file = priv_osreaddir ( filesMap, iter );
+            if ( os_file.name == &quot;&quot; )
+                break;
 
+            if ( os_file.type &amp; FOLDER )
+            {
+                gorecursive( os_file.name, size );
+            }
+            else
+                size = size + os_file.size;
+        }
+
+    }
+
+
 }
 
-void filelist_ftp::getRecursiveFiles(vector &lt; string &gt;src,unsigned long &amp;size)
+void filelist_ftp::getRecursiveFiles( std::vector &lt; std::string &gt;src, unsigned long &amp;size )
 {
 
-filesMapGlobal.clear();
+    filesMapGlobal.clear();
 
 
-    vector &lt; string &gt;::iterator iter_files;
+    std::vector &lt; std::string &gt;::iterator iter_files;
 
-    for (iter_files = src.begin (); iter_files != src.end(); iter_files++)
-    {     
+    for ( iter_files = src.begin (); iter_files != src.end(); iter_files++ )
+    {
 
-    string name=FXFile::name(iter_files-&gt;c_str()).text();
-    	osfile os_file;
-	os_file.name=name;
-	os_file.type=filesMap[name].type;
-	os_file.size=filesMap[name].size;
-	os_file.mode=filesMap[name].mode;
-	os_file.group=filesMap[name].user;
-	os_file.user=filesMap[name].group;
-	filesMapGlobal[name]=os_file;
+        std::string name = FXFile::name( iter_files-&gt;c_str() ).text();
+        osfile os_file;
+        os_file.name = name;
+        os_file.type = filesMap[ name ].type;
+        os_file.size = filesMap[ name ].size;
+        os_file.mode = filesMap[ name ].mode;
+        os_file.group = filesMap[ name ].user;
+        os_file.user = filesMap[ name ].group;
+        filesMapGlobal[ name ] = os_file;
 
     }
 
 
-   for (iterGlobal=filesMapGlobal.begin();iterGlobal!=filesMapGlobal.end(); iterGlobal++)
-   {
+    for ( iterGlobal = filesMapGlobal.begin();iterGlobal != filesMapGlobal.end(); iterGlobal++ )
+    {
 
-   
-        if(iterGlobal-&gt;second.type&amp;FOLDER)
-	{
- 	gorecursive(iterGlobal-&gt;first,size);
-	FXString di=this-&gt;dir.c_str();
-	pftp-&gt;setDir(di);
-	}
-	else
-	size = size + iterGlobal-&gt;second.size;
 
-   }
+        if ( iterGlobal-&gt;second.type &amp; FOLDER )
+        {
+            gorecursive( iterGlobal-&gt;first, size );
+            FXString di = this-&gt;dir.c_str();
+            pftp-&gt;setDir( di );
+        }
+        else
+            size = size + iterGlobal-&gt;second.size;
+
+    }
 }
 
-int filelist_ftp::remove (thread_elem * te)
+int filelist_ftp::remove ( thread_elem * te )
 {
-unsigned long size;
-getRecursiveFiles(te-&gt;src,size);
+    unsigned long size;
+    getRecursiveFiles( te-&gt;src, size );
 
-for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-    {     
-  
-	
-	if(iterGlobal-&gt;second.type&amp;FOLDER)
-	pftp-&gt;rmDir(iterGlobal-&gt;first.c_str());
-	else
-	pftp-&gt;del(iterGlobal-&gt;first.c_str());
-	
-	te-&gt;act_file_name=iterGlobal-&gt;first;
-	if( iterGlobal == filesMapGlobal.begin())break;
-	
+    for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
+    {
+
+
+        if ( iterGlobal-&gt;second.type &amp; FOLDER )
+            pftp-&gt;rmDir( iterGlobal-&gt;first.c_str() );
+        else
+            pftp-&gt;del( iterGlobal-&gt;first.c_str() );
+
+        te-&gt;act_file_name = iterGlobal-&gt;first;
+        if ( iterGlobal == filesMapGlobal.begin() ) break;
+
     }
 
 
 
 }
-int filelist_ftp::rename (string orgname, string newname)
+int filelist_ftp::rename ( std::string orgname, std::string newname )
 {
 
-FXString tmp;
-pftp-&gt;sendCmd(&quot;RNFR &quot;, FXFile::name(orgname.c_str()), tmp);
-pftp-&gt;sendCmd(&quot;RNTO &quot;, FXFile::name(newname.c_str()), tmp);
+    FXString tmp;
+    pftp-&gt;sendCmd( &quot;RNFR &quot;, FXFile::name( orgname.c_str() ), tmp );
+    pftp-&gt;sendCmd( &quot;RNTO &quot;, FXFile::name( newname.c_str() ), tmp );
 
 }
-int filelist_ftp::init (vector &lt; string &gt; *vector_name, pathtype pt, configure * conf)
+int filelist_ftp::init ( std::vector &lt; std::string &gt; *vector_name, pathtype pt, configure * conf )
 {
 
     fieldsnum = vector_name-&gt;size ();
-    fields = (*vector_name);
+    fields = ( *vector_name );
 
-log=new SimpleLogger;
-pftp=new PFTP(pt.server.c_str(),pt.user.c_str(),pt.password.c_str(),&quot;&quot;,log);
+    log = new SimpleLogger;
+    pftp = new PFTP( pt.server.c_str(), pt.user.c_str(), pt.password.c_str(), &quot;&quot;, log );
 
-	if(pftp-&gt;isConnected() &amp;&amp; getinitialdir()!=&quot;&quot;)
-        {	
-
-	}
-	else return -1;
+    if ( pftp-&gt;isConnected() &amp;&amp; getinitialdir() != &quot;&quot; )
+    {}
+    else return -1;
 }
 
-int filelist_ftp::str_mode_int(string per)
+int filelist_ftp::str_mode_int( std::string per )
 {
-unsigned int mode = 0;
-	if (per[0]=='r')
-	    mode = mode | S_IRUSR;
-	if (per[1]=='w')
-	    mode = mode | S_IWUSR;
-	if (per[2]=='x')
-	    mode = mode | S_IXUSR;
-	if (per[3]=='r')
-	    mode = mode | S_IRGRP;
-	if (per[4]=='w')
-	    mode = mode | S_IWGRP;
-	if (per[5]=='x')
-	    mode = mode | S_IXGRP;
-	if (per[6]=='r')
-	    mode = mode | S_IROTH;
-	if (per[7]=='w')
-	    mode = mode | S_IWOTH;
-	if (per[8]=='x')
-	    mode = mode | S_IXOTH;
-return mode;
+    unsigned int mode = 0;
+    if ( per[ 0 ] == 'r' )
+        mode = mode | S_IRUSR;
+    if ( per[ 1 ] == 'w' )
+        mode = mode | S_IWUSR;
+    if ( per[ 2 ] == 'x' )
+        mode = mode | S_IXUSR;
+    if ( per[ 3 ] == 'r' )
+        mode = mode | S_IRGRP;
+    if ( per[ 4 ] == 'w' )
+        mode = mode | S_IWGRP;
+    if ( per[ 5 ] == 'x' )
+        mode = mode | S_IXGRP;
+    if ( per[ 6 ] == 'r' )
+        mode = mode | S_IROTH;
+    if ( per[ 7 ] == 'w' )
+        mode = mode | S_IWOTH;
+    if ( per[ 8 ] == 'x' )
+        mode = mode | S_IXOTH;
+    return mode;
 }
 
-int filelist_ftp::mode (string file)
+int filelist_ftp::mode ( std::string file )
 {
 
-string per=filesMap[FXFile::name(file.c_str()).text()].mode;
+    std::string per = filesMap[ FXFile::name( file.c_str() ).text() ].mode;
 
-return str_mode_int(per);
+    return str_mode_int( per );
 
 }
-string filelist_ftp::owner (string file)
+std::string filelist_ftp::owner ( std::string file )
 {
-return filesMap[FXFile::name(file.c_str()).text()].user; 
+    return filesMap[ FXFile::name( file.c_str() ).text() ].user;
 }
-string filelist_ftp::group (string file)
+std::string filelist_ftp::group ( std::string file )
 {
-return filesMap[FXFile::name(file.c_str()).text()].group;
+    return filesMap[ FXFile::name( file.c_str() ).text() ].group;
 }
-bool filelist_ftp::mode (string file, unsigned int per, bool recursive)
+bool filelist_ftp::mode ( std::string file, unsigned int per, bool recursive )
 {
 
-unsigned int mode=per;
+    unsigned int mode = per;
 
-int x=((mode &amp; S_IRUSR) | (mode &amp; S_IWUSR) | (mode &amp; S_IXUSR))/64;
-int y=((mode &amp; S_IRGRP) | (mode &amp; S_IWGRP) | (mode &amp; S_IXGRP))/8;
-int z=((mode &amp; S_IROTH) | (mode &amp; S_IWOTH) | (mode &amp; S_IXOTH));	
+    int x = ( ( mode &amp; S_IRUSR ) | ( mode &amp; S_IWUSR ) | ( mode &amp; S_IXUSR ) ) / 64;
+    int y = ( ( mode &amp; S_IRGRP ) | ( mode &amp; S_IWGRP ) | ( mode &amp; S_IXGRP ) ) / 8;
+    int z = ( ( mode &amp; S_IROTH ) | ( mode &amp; S_IWOTH ) | ( mode &amp; S_IXOTH ) );
 
-file=FXFile::name(file.c_str()).text();
+    file = FXFile::name( file.c_str() ).text();
 
-FXString tmp;
-char chstr[20];
-sprintf (chstr, &quot;%d%d%d&quot;, x,y,z);
+    FXString tmp;
+    char chstr[ 20 ];
+    sprintf ( chstr, &quot;%d%d%d&quot;, x, y, z );
 
-	if(recursive==false)
-	{
-	string cmd=&quot;CHMOD &quot;+string(chstr)+&quot; &quot;+ file;
-	pftp-&gt;sendCmd(&quot;SITE &quot;,cmd.c_str(),tmp );
-	}
-	else
-	{
-	unsigned long size;
-	vector &lt; string &gt;src;
-	src.push_back(file);
-	getRecursiveFiles(src,size);
+    if ( recursive == false )
+    {
+        std::string cmd = &quot;CHMOD &quot; + std::string( chstr ) + &quot; &quot; + file;
+        pftp-&gt;sendCmd( &quot;SITE &quot;, cmd.c_str(), tmp );
+    }
+    else
+    {
+        unsigned long size;
+        std::vector &lt; std::string &gt;src;
+        src.push_back( file );
+        getRecursiveFiles( src, size );
 
-		for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-  		  {     
-   			
-			
-			string cmd=&quot;CHMOD &quot;+string(chstr)+&quot; &quot;+ iterGlobal-&gt;first;
-			pftp-&gt;sendCmd(&quot;SITE &quot;,cmd.c_str(),tmp );
-			
-			
-			if( iterGlobal == filesMapGlobal.begin())break;
-	
-   		  }
+        for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
+        {
 
-	
-	}
 
+            std::string cmd = &quot;CHMOD &quot; + std::string( chstr ) + &quot; &quot; + iterGlobal-&gt;first;
+            pftp-&gt;sendCmd( &quot;SITE &quot;, cmd.c_str(), tmp );
 
 
+            if ( iterGlobal == filesMapGlobal.begin() ) break;
+
+        }
+
+
+    }
+
+
+
 }
-bool filelist_ftp::owner (string file, string, bool recursive)
+bool filelist_ftp::owner ( std::string file, std::string, bool recursive )
+{}
+bool filelist_ftp::group ( std::string file, std::string, bool recursive )
+{}
+std::string filelist_ftp::info ( void )
 {
+    return &quot;&quot;;
 }
-bool filelist_ftp::group (string file, string, bool recursive)
+void filelist_ftp::totalsize ( std::string path, unsigned long &amp;size )
 {
-}
-string filelist_ftp::info (void)
-{
-return &quot;&quot;;
-}
-void filelist_ftp::totalsize (string path, unsigned long &amp;size)
-{
-size=0;
-	
-	string file=FXFile::name(path.c_str()).text();
-	if(file==&quot;&quot;)
-	file=FXFile::name(path.substr(0,path.length()-1).c_str()).text();
-	
-	
+    size = 0;
 
-	if(filesMap[file].type&amp;FOLDER)
-	{
-	vector &lt; string &gt;src;
-	src.push_back(file);
-	getRecursiveFiles(src,size);
-	}
-	else
-	size=filesMap[file].size;
+    std::string file = FXFile::name( path.c_str() ).text();
+    if ( file == &quot;&quot; )
+        file = FXFile::name( path.substr( 0, path.length() - 1 ).c_str() ).text();
 
 
-	
+
+    if ( filesMap[ file ].type &amp; FOLDER )
+    {
+        std::vector &lt; std::string &gt;src;
+        src.push_back( file );
+        getRecursiveFiles( src, size );
+    }
+    else
+        size = filesMap[ file ].size;
+
+
+
 }
-string filelist_ftp::symlink (string path)
+std::string filelist_ftp::symlink ( std::string path )
 {
-return &quot;&quot;;
+    return &quot;&quot;;
 }
-bool filelist_ftp::symlink (string src, string dst)
-{
-}
-bool filelist_ftp::hardlink (string src, string dst)
-{
-}
+bool filelist_ftp::symlink ( std::string src, std::string dst )
+{}
+bool filelist_ftp::hardlink ( std::string src, std::string dst )
+{}
 
-int filelist_ftp::quit (void)
+int filelist_ftp::quit ( void )
 {
-pftp-&gt;logout();
+    pftp-&gt;logout();
 }
 
-string filelist_ftp::getinitialdir(void)
+std::string filelist_ftp::getinitialdir( void )
 {
-	FXString base;
-	pftp-&gt;pwd(base);
+    FXString base;
+    pftp-&gt;pwd( base );
 
-return base.text();
+    return base.text();
 }
 
 
 
-EXPORTFUNCTION filelist_base *get_filelist (void)
+EXPORTFUNCTION filelist_base *get_filelist ( void )
 {
-    FXTRACE ((5, &quot;PLUGIN LOAD\n&quot;));
+    FXTRACE ( ( 5, &quot;PLUGIN LOAD\n&quot; ) );
     return new filelist_ftp ();
 }

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,79 +1,128 @@
+// $Id$
+/////////////////////////////////////////////////////////////////////////////
+// This file is part of OpenSpace project.
+//
+// OpenSpace is free software; you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation; either version 2 of the License, or
+// (at your option) any later version.
+//
+// OpenSpace is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with OpenSpace; if not, write to the Free Software
+// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+/////////////////////////////////////////////////////////////////////////////
+//
+// C++ Interface: $MODULE$
+//
+// Author: Mateusz Dworak &lt;<A HREF="http://openspace.linux.pl">http://openspace.linux.pl</A>&gt;, (C) 2005
+//
+// Description:
+//  FTP plugin derived from OpenSpace file list VFS plugin.
+//
+/////////////////////////////////////////////////////////////////////////////
 #ifndef FILELIST_ftp
 #define FILELIST_ftp
+
 #include &quot;../../OSVirtualFileSystemBase.h&quot;
+#include &quot;../../OSPathType.h&quot;
+#include &quot;../../OSFile.h&quot;
 #include &quot;pftp.h&quot;
+
 #include &lt;map&gt;
+#include &lt;string&gt;
+#include &lt;vector&gt;
 
+// Forward declarations
+class OSThreadExec;
+class OSConfigure;
 
-
-class SimpleLogger : public Logger 
+/**
+ * Events logger class.
+ * 
+ * @todo Encapsulate public data members.
+ */
+class SimpleLogger : public Logger
 {
 public:
-    thread_elem *te;
-    
-    SimpleLogger::SimpleLogger();
-    void SimpleLogger::start(uint32_t bytes, const FXString &amp; name,uint32_t size);
-    bool SimpleLogger::update(uint32_t bytes, const FXString &amp; s);
-    void SimpleLogger::end(uint32_t bytes, const FXString &amp; );
-    void SimpleLogger::choke();
-    void SimpleLogger::error(int error);
-    void SimpleLogger::logLine(FXString &amp; line);
-    void SimpleLogger::error(FXString &amp; error);
 
-};
+    OSThreadExec* te;
 
+    /**
+     * Default constructor.
+     */
+    SimpleLogger( void );
 
-class filelist_ftp:public filelist_base
+    void start( uint32_t bytes, const FXString &amp; name, uint32_t size );
+    bool update( uint32_t bytes, const FXString &amp; s );
+    void end( uint32_t bytes, const FXString &amp; );
+    void choke( void );
+    void error( int error );
+    void logLine( FXString &amp; line );
+    void error( FXString &amp; error );
+
+}; // SimpleLogger
+
+
+/**
+ * FTP plugin main class.
+ * 
+ * @todo Pass &quot;big&quot; vectors through by-reference not by-value!
+ */
+class filelist_ftp : public OSVirtualFileSystemBase
 {
 
 private:
 
-PFTP *pftp;
-SimpleLogger *log;
-string dir;
+    PFTP *pftp;
+    SimpleLogger *log;
+    std::string dir;
 
+    std::map&lt;std::string, OSFile&gt; filesMap;
+    std::map&lt;std::string, OSFile&gt;::iterator iter;
+    std::map&lt;std::string, OSFile&gt; filesMapGlobal;
+    std::map&lt;std::string, OSFile&gt;::iterator iterGlobal;
 
-map &lt;string,osfile&gt; filesMap;
-map &lt;string,osfile&gt;::iterator iter;
+    int fieldsnum;
+    std::vector&lt;std::string&gt; fields;
 
-map &lt;string,osfile&gt; filesMapGlobal;
-map &lt;string,osfile&gt;::iterator iterGlobal;
+    int priv_osopendir( std::string dir, std::string prefix, std::map &lt;std::string, osfile&gt; &amp; filesMap, std::map &lt;std::string, osfile&gt;::iterator &amp; iter );
+    void gorecursive( std::string file, unsigned long &amp;size );
+    OSFile priv_osreaddir( std::map &lt;std::string, osfile&gt; &amp; filesMap, std::map &lt;std::string, OSFile&gt;::iterator &amp; iter2 );
+    void getRecursiveFiles( std::vector&lt;std::string&gt; src, unsigned long &amp;size );
+    void goLocalRecursive( std::string path, std::string prefix, OSThreadExec* te );
+    void local_totalsize( std::string path, unsigned long &amp;size );
+    int str_mode_int( std::string per );
 
-    int fieldsnum;
-    vector &lt; string &gt; fields;
+public:
+    
+    int osopendir( std::string dir );
+    OSFile osreaddir( void );
+    int mkdir( std::string dir, int mode = 0 );
+    int copy( OSThreadExec * te );
+    int move( OSThreadExec * te );
+    int remove( OSThreadExec * te );
+    int rename( std::string orgname, std::string newname );
+    int init( std::vector&lt;std::string&gt;* vector_name, OSPathType pt, OSConfigure * conf );
+    int mode( std::string file );
+    std::string owner( std::string file );
+    std::string group( std::string file );
+    bool mode( std::string file, unsigned int, bool recursive );
+    bool owner( std::string file, std::string, bool recursive );
+    bool group( std::string file, std::string, bool recursive );
+    std::string info( void );
+    void totalsize( std::string path, unsigned long &amp;size );
+    std::string symlink( std::string path );
+    bool symlink( std::string src, std::string dst );
+    bool hardlink( std::string src, std::string dst );
+    OSVirtualFileSystemInfo setup( void );
+    int quit( void );
+    std::string getinitialdir( void );
 
-    int filelist_ftp::priv_osopendir (string dir,string prefix,map &lt;string,osfile&gt; &amp; filesMap,map &lt;string,osfile&gt;::iterator &amp; iter);
-    void filelist_ftp::gorecursive(string file,unsigned long &amp;size);
-    osfile filelist_ftp::priv_osreaddir (map &lt;string,osfile&gt; &amp; filesMap,map &lt;string,osfile&gt;::iterator &amp; iter2);
-    void filelist_ftp::getRecursiveFiles(vector &lt; string &gt;src,unsigned long &amp;size);
-    void filelist_ftp::goLocalRecursive (string path,string prefix,thread_elem *te);
-    void filelist_ftp::local_totalsize (string path, unsigned long &amp;size);
-    int filelist_ftp::str_mode_int(string per);
 
-  public:
-    int filelist_ftp::osopendir (string dir);
-    osfile filelist_ftp::osreaddir (void);
-    int filelist_ftp::mkdir (string dir, int mode = 0);
-    int filelist_ftp::copy (thread_elem * te);
-    int filelist_ftp::move (thread_elem * te);
-    int filelist_ftp::remove (thread_elem * te);
-    int filelist_ftp::rename (string orgname, string newname);
-    int filelist_ftp::init (vector &lt; string &gt; *vector_name, pathtype pt, configure * conf);
-    int filelist_ftp::mode (string file);
-    string filelist_ftp::owner (string file);
-    string filelist_ftp::group (string file);
-    bool filelist_ftp::mode (string file, unsigned int, bool recursive);
-    bool filelist_ftp::owner (string file, string, bool recursive);
-    bool filelist_ftp::group (string file, string, bool recursive);
-    string filelist_ftp::info (void);
-    void filelist_ftp::totalsize (string path, unsigned long &amp;size);
-    string filelist_ftp::symlink (string path);
-    bool filelist_ftp::symlink (string src, string dst);
-    bool filelist_ftp::hardlink (string src, string dst);
-    vfs filelist_ftp::setup (void);
-    int filelist_ftp::quit (void);
-    string filelist_ftp::getinitialdir(void);
-    
-    
 };
 #endif

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_scp.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_scp.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_scp.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -12,49 +12,44 @@
 #include &lt;iostream&gt;
 
 
-
-
 class filelist_scp:public filelist_base
 {
-    string dir;
-    string display_size;
-    int fieldsnum;
-    string *fields;
+  string dir;
+  string display_size;
+  int fieldsnum;
+  string *fields;
 
+  int p[2];
+  int o[2];
 
-    int p[2];
-    int o[2];
+  char readbuffer[20];
 
-    char readbuffer[20];
+  int nbytes;
+  int end;
+  string prompt;
 
-    int nbytes;
+public:
 
-    int end;
+  int osopendir (string dir);
+  osfile osreaddir (void);
+  int mkdir (string dir, int mode);
+  int copy (thread_elem * te);
+  int move (thread_elem * te);
+  int remove (thread_elem * te);
+  int rename (string orgname, string newname);
+  int init (string ** name, unsigned int **type, unsigned int **width,
+	    pathtype pt, configure * conf);
+  unsigned int mode (string file);
+  bool mode (string file, unsigned int, bool recursive = false);
+  string info (void);
+  int quit (void);
 
-    string prompt;
+  void totalsize (string path, unsigned long &amp;size);
+  int copymove (thread_elem * te, bool copy = true);
 
+  bool getprompt (void);
 
-  public:
 
-    int osopendir (string dir);
-    osfile osreaddir (void);
-    int mkdir (string dir, int mode);
-    int copy (thread_elem * te);
-    int move (thread_elem * te);
-    int remove (thread_elem * te);
-    int rename (string orgname, string newname);
-    int init (string ** name, unsigned int **type, unsigned int **width, pathtype pt, configure * conf);
-    unsigned int mode (string file);
-    bool mode (string file, unsigned int, bool recursive = false);
-    string info (void);
-    int quit (void);
-
-    void totalsize (string path, unsigned long &amp;size);
-    int copymove (thread_elem * te, bool copy = true);
-
-    bool getprompt (void);
-
-
 };
 
 

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp	2005-11-11 21:57:36 UTC (rev 231)
@@ -3,13 +3,24 @@
 #else
 #define EXPORTFUNCTION extern &quot;C&quot;
 #endif
+
 #include &quot;filelist_search.h&quot;
 
-vfs filelist_search::setup (void)
+#include &quot;../../OSVirtualFileSystemBase.h&quot;
+#include &quot;../../OSVirtualFileSystemInfo.h&quot;
+#include &quot;../../OSFile.h&quot;
+#include &quot;../../OSPathType.h&quot;
+#include &quot;../../OSConfigure.h&quot;
+#include &quot;../../OSThreadExec.h&quot;
+
+#include &lt;string&gt;
+#include &lt;vector&gt;
+
+OSVirtualFileSystemInfo filelist_search::setup (void)
 {
-	vfs v;
+	OSVirtualFileSystemInfo v;
 	
-	v.vfsheaders.push_back(vfsheader_container(&quot;name&quot;));
+	v.vfsheaders.push_back(OSVirtualFileSystemHeader(&quot;name&quot;));
 	v.information=&quot;search vfs - default plugin&quot;;
 	v.version=&quot;1&quot;;
 	v.type=&quot;search&quot;;
@@ -18,15 +29,15 @@
 }
 
 
-int filelist_search::osopendir (string dir)
+int filelist_search::osopendir (std::string dir)
 {
 
   iter=files.begin(); 
 
 }
-osfile filelist_search::osreaddir (void)
+OSFile filelist_search::osreaddir (void)
 {
-    osfile os_file;
+    OSFile os_file;
 
 if(iter!=files.end())
 {
@@ -48,14 +59,14 @@
 
 
 }
-int filelist_search::mkdir (string dir, int mode)
+int filelist_search::mkdir (std::string dir, int mode)
 {
 }
-int filelist_search::copy (thread_elem * te)
+int filelist_search::copy (OSThreadExec * te)
 {
 
-	string::size_type pos = te-&gt;options.find (&quot;download&quot;);
-	if (pos == string::npos) //upload only supported
+	std::string::size_type pos = te-&gt;options.find (&quot;download&quot;);
+	if (pos == std::string::npos) //upload only supported
 	{
 	return fil_local-&gt;copy(te);
 	}
@@ -66,11 +77,11 @@
 	}
 
 }
-int filelist_search::move (thread_elem * te)
+int filelist_search::move (OSThreadExec * te)
 {
 
-	string::size_type pos = te-&gt;options.find (&quot;download&quot;);
-	if (pos == string::npos) //upload only supported
+	std::string::size_type pos = te-&gt;options.find (&quot;download&quot;);
+	if (pos == std::string::npos) //upload only supported
 	{
 	return fil_local-&gt;move(te);
 	}
@@ -81,17 +92,17 @@
 	}
 
 }
-int filelist_search::remove (thread_elem * te)
+int filelist_search::remove (OSThreadExec * te)
 {
 return fil_local-&gt;remove(te);
 }
-int filelist_search::rename (string orgname, string newname)
+int filelist_search::rename (std::string orgname, std::string newname)
 {
 
 	int ret=fil_local-&gt;rename(orgname,newname);
 	if(ret)
 	{
-		vector &lt; string &gt;::iterator iter = find(files.begin(), files.end(), orgname.substr(1,orgname.length()-1)); // Search the list.
+		std::vector &lt; std::string &gt;::iterator iter = find(files.begin(), files.end(), orgname.substr(1,orgname.length()-1)); // Search the list.
 		if (iter != files.end())
 		{
   		(*iter)=newname.substr(1,newname.length()-1);
@@ -100,23 +111,20 @@
 
 	return ret;
 }
-int filelist_search::init (vector &lt; string &gt; *vector_name, pathtype pt, configure * conf)
+int filelist_search::init(std::vector&lt;std::string&gt;* vector_name, OSPathType pt, OSConfigure* conf)
 {
+    fil_local=new filelist_local();
 
-
-fil_local=new filelist_local();
-
-
     pipe = popen (pt.server.c_str(), &quot;r&quot;);
 
     if (pipe != NULL)
     {
-	string line;
+	std::string line;
 	while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
 	{
 
 
-	    string path = readbuf;
+	    std::string path = readbuf;
 	    path = path.substr (1, path.length () - 2);
 	    files.push_back(path);
 	   
@@ -129,51 +137,52 @@
     
 
 }
-int filelist_search::mode (string file)
+int filelist_search::mode (std::string file)
 {
 return fil_local-&gt;mode(file);
 }
-string filelist_search::owner (string file)
+std::string filelist_search::owner (std::string file)
 {
 return fil_local-&gt;owner(file);
 }
-string filelist_search::group (string file)
+std::string filelist_search::group (std::string file)
 {
 return fil_local-&gt;group(file);
 }
-bool filelist_search::mode (string file, unsigned int mod, bool recursive)
+bool filelist_search::mode (std::string file, unsigned int mod, bool recursive)
 {
 return fil_local-&gt;mode(file,mod,recursive);
 }
-bool filelist_search::owner (string file, string ow, bool recursive)
+bool filelist_search::owner (std::string file, std::string ow, bool recursive)
 {
 return fil_local-&gt;owner(file,ow,recursive);
 }
-bool filelist_search::group (string file, string gr, bool recursive)
+bool filelist_search::group (std::string file, std::string gr, bool recursive)
 {
 return fil_local-&gt;group(file,gr,recursive);
 }
-string filelist_search::info (void)
+std::string filelist_search::info (void)
 {
 return &quot;&quot;;
 }
-void filelist_search::totalsize (string path, unsigned long &amp;size)
+void filelist_search::totalsize (std::string path, unsigned long &amp;size)
 {
 }
-string filelist_search::symlink (string path)
+std::string filelist_search::symlink (std::string path)
 {
 }
-bool filelist_search::symlink (string src, string dst)
+bool filelist_search::symlink (std::string src, std::string dst)
 {
 }
-bool filelist_search::hardlink (string src, string dst)
+bool filelist_search::hardlink (std::string src, std::string dst)
 {
 }
 
 int filelist_search::quit (void)
 {
 }
-EXPORTFUNCTION filelist_base *get_filelist (void)
+
+EXPORTFUNCTION OSVirtualFileSystemBase *get_filelist(void)
 {
     FXTRACE ((5, &quot;PLUGIN SEARCH LOAD\n&quot;));
     return new filelist_search ();

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,42 +1,56 @@
 #ifndef FILELIST_search
 #define FILELIST_search
+
 #include &quot;../../OSVirtualFileSystemBase.h&quot;
+#include &quot;../../OSPathType.h&quot;
 #include &quot;filelist_local.h&quot;
 
-class filelist_search:public filelist_base
+#include &lt;string&gt;
+#include &lt;vector&gt;
+
+// Forward declarations
+class OSThreadClass;
+class OSConfigure;
+
+/**
+ * Search plugin class
+ *
+ * @todo To rename.
+ */
+class filelist_search : public OSVirtualFileSystemBase
 {
   
 private:
   
   FILE *pipe;
   char readbuf[1024];
-  vector &lt; string &gt; files;
-  vector &lt; string &gt;::iterator iter;
+  std::vector&lt;std::string&gt; files;
+  std::vector&lt;std::string&gt;::iterator iter;
 
   filelist_local *fil_local;
   
 public:
   
-    int filelist_search::osopendir (string dir);
-    osfile filelist_search::osreaddir (void);
-    int filelist_search::mkdir (string dir, int mode = 0);
-    int filelist_search::copy (thread_elem * te);
-    int filelist_search::move (thread_elem * te);
-    int filelist_search::remove (thread_elem * te);
-    int filelist_search::rename (string orgname, string newname);
-    int filelist_search::init (vector &lt; string &gt; *vector_name, pathtype pt, configure * conf);
-    int filelist_search::mode (string file);
-    string filelist_search::owner (string file);
-    string filelist_search::group (string file);
-    bool filelist_search::mode (string file, unsigned int, bool recursive);
-    bool filelist_search::owner (string file, string, bool recursive);
-    bool filelist_search::group (string file, string, bool recursive);
-    string filelist_search::info (void);
-    void filelist_search::totalsize (string path, unsigned long &amp;size);
-    string filelist_search::symlink (string path);
-    bool filelist_search::symlink (string src, string dst);
-    bool filelist_search::hardlink (string src, string dst);
-    vfs filelist_search::setup (void);
-    int filelist_search::quit (void);
+    int osopendir (std::string dir);
+    OSFile osreaddir (void);
+    int mkdir (std::string dir, int mode = 0);
+    int copy (OSThreadExec * te);
+    int move (OSThreadExec * te);
+    int remove (OSThreadExec * te);
+    int rename (std::string orgname, std::string newname);
+    int init (std::vector&lt;std::string&gt;* vector_name, OSPathType pt, OSConfigure * conf);
+    int mode (std::string file);
+    std::string owner (std::string file);
+    std::string group (std::string file);
+    bool mode (std::string file, unsigned int, bool recursive);
+    bool owner (std::string file, std::string, bool recursive);
+    bool group (std::string file, std::string, bool recursive);
+    std::string info (void);
+    void totalsize (std::string path, unsigned long &amp;size);
+    std::string symlink (std::string path);
+    bool symlink (std::string src, std::string dst);
+    bool hardlink (std::string src, std::string dst);
+    OSVirtualFileSystemInfo setup(void);
+    int quit (void);
 };
 #endif

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/pftp.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/pftp.h	2005-11-11 21:45:22 UTC (rev 230)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/pftp.h	2005-11-11 21:57:36 UTC (rev 231)
@@ -1,5 +1,5 @@
 /* pftp.h : passive-capable FTP class.
-   Copyright 2002 Mr. Tines &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">Tines at RavnaAndTines.com</A>&gt;
+  Copyright 2002 Mr. Tines &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openspace-svn">Tines at RavnaAndTines.com</A>&gt;
 
 This program is free software; you can redistribute it and/or modify it
 under the terms of the GNU Library General Public License as published by the
@@ -27,7 +27,8 @@
 #endif
 
 
-namespace FX {
+namespace FX
+{
     class FXString;
     class FXMemoryStream;
 }
@@ -55,45 +56,61 @@
 
 #define PASSIVE_FTP_PRODUCT_VERSION &quot;1.7.1955.38236&quot;
 
-class Logger {
+/**
+ * Logger class.
+ * 
+ * @todo Add virtual destructor - this class is a base class!
+ */
+class Logger
+{
 public:
-    virtual void start(uint32_t bytes, const FXString &amp; name,uint32_t size=0) = 0;
-    virtual bool update(uint32_t bytes, const FXString &amp; name) = 0;
-    virtual void end(uint32_t bytes, const FXString &amp; name) = 0;
-    virtual void error(int error) = 0;
-    virtual void error(FXString &amp; error) = 0;
+    virtual void start( uint32_t bytes, const FXString &amp; name, uint32_t size = 0 ) = 0;
+    virtual bool update( uint32_t bytes, const FXString &amp; name ) = 0;
+    virtual void end( uint32_t bytes, const FXString &amp; name ) = 0;
+    virtual void error( int error ) = 0;
+    virtual void error( FXString &amp; error ) = 0;
     virtual void choke() = 0;
-    virtual void logLine(FXString &amp; line) = 0;
+    virtual void logLine( FXString &amp; line ) = 0;
 };
 
-class PFTP 
+/**
+ * FTP class.
+ */
+class PFTP
 {
 public:
-    PFTP(const FXString &amp; server, const FXString &amp; user, const FXString &amp; pass, const FXString &amp; proxy, Logger * feedback);
+    
+    /**
+     * Constructor.
+     */
+    PFTP( const FXString&amp; server, const FXString&amp; user, const FXString&amp; pass, const FXString&amp; proxy, Logger* feedback );
 
+    /**
+     * Destructor.
+     */
+    ~PFTP( void );
+    
     // need to provide a feedback callback
-    void download(const FXString &amp; file,FXString dst, bool asc=false);
-    void upload(const FXString &amp; file, int throttle, bool asc=false);
+    void download( const FXString &amp; file, FXString dst, bool asc = false );
+    void upload( const FXString &amp; file, int throttle, bool asc = false );
 
-    void setDir(const FXString &amp; dir);
-    void mkDir(const FXString &amp; dir);
-    void del(const FXString &amp; file);
-    void rmDir(const FXString &amp; dir);
-    void pwd(FXString &amp; dir);
-    void list(FXMemoryStream &amp; stream);
-    void nlist(FXMemoryStream &amp; stream);
-    void logout(void);
+    void setDir( const FXString &amp; dir );
+    void mkDir( const FXString &amp; dir );
+    void del( const FXString &amp; file );
+    void rmDir( const FXString &amp; dir );
+    void pwd( FXString &amp; dir );
+    void list( FXMemoryStream &amp; stream );
+    void nlist( FXMemoryStream &amp; stream );
+    void logout( void );
 
     bool isConnected() const;
 
-    ~PFTP();
+    void sendCmd( const FXString cmd, const FXString &amp; value, FXString &amp; response );
 
-void sendCmd(const FXString cmd, const FXString &amp; value, FXString &amp; response);
-
-
 private:
 
-    enum {
+    enum
+    {
         CNTRL_PORT = 21,
         BUCKET = 4096
     };
@@ -103,32 +120,30 @@
     SOCKET dsock;
 
     bool pauser;  // it's a hack. We're going to
-          // stall (refuse further requests) till we get a reply back
-          // from server for the current request.
+    // stall (refuse further requests) till we get a reply back
+    // from server for the current request.
 
-    char lineBuffer[BUCKET];
+    char lineBuffer[ BUCKET ];
     int buffered;
-	char * proxyServer;
-	int proxyPort;
+    char * proxyServer;
+    int proxyPort;
 
 
-    int connect(const FXString &amp; server);
-    void getAsBytes(const FXString &amp; file, SOCKET sock, FXMemoryStream &amp; buffer);
-    void login(const FXString &amp; user, const FXString &amp; pass);
-    void setTransferType(bool asc);
+    int connect( const FXString &amp; server );
+    void getAsBytes( const FXString &amp; file, SOCKET sock, FXMemoryStream &amp; buffer );
+    void login( const FXString &amp; user, const FXString &amp; pass );
+    void setTransferType( bool asc );
 
-    void getDataSock(void);
-    
-    void responseHandler(const FXString &amp; cmd, FXString &amp; result);
+    void getDataSock( void );
 
+    void responseHandler( const FXString &amp; cmd, FXString &amp; result );
+
     // responseParser: check first digit of first line of response
     // and take action based on it; set up to read an extra line
     // if the response starts with &quot;1&quot;
-    bool responseParser(const FXString &amp; resp);
-    void readLine(FXString &amp; line, bool pureFTP=true);
+    bool responseParser( const FXString &amp; resp );
+    void readLine( FXString &amp; line, bool pureFTP = true );
 
-
 };
 
 #endif
-


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000011.html">[Openspace-svn] r230 - tags
</A></li>
	<LI>Next message: <A HREF="000013.html">[Openspace-svn] r232 - in branches/mloskot-style-refactoring/src: . plugins plugins/cmddialog plugins/filelist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12">[ date ]</a>
              <a href="thread.html#12">[ thread ]</a>
              <a href="subject.html#12">[ subject ]</a>
              <a href="author.html#12">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openspace-svn">More information about the Openspace-svn
mailing list</a><br>
</body></html>
