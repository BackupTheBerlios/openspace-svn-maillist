From compbatant at berlios.de  Sat Feb 11 22:33:18 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sat, 11 Feb 2006 22:33:18 +0100
Subject: [Openspace-svn] r240 - in branches/mloskot-style-refactoring: . src src/plugins/cmddialog src/plugins/filelist
Message-ID: <200602112133.k1BLXIo0018111@sheep.berlios.de>

Author: compbatant
Date: 2006-02-11 22:32:58 +0100 (Sat, 11 Feb 2006)
New Revision: 240

Added:
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSAccess.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSCompress.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMkdir.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSRename.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSSymlink.cpp
Removed:
   branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp
Modified:
   branches/mloskot-style-refactoring/aclocal.m4
   branches/mloskot-style-refactoring/config.guess
   branches/mloskot-style-refactoring/config.sub
   branches/mloskot-style-refactoring/configure
   branches/mloskot-style-refactoring/configure.ac
   branches/mloskot-style-refactoring/ltmain.sh
   branches/mloskot-style-refactoring/openspacerc.in
   branches/mloskot-style-refactoring/src/Makefile
   branches/mloskot-style-refactoring/src/OSCMDDialogBox.h
   branches/mloskot-style-refactoring/src/config.h
   branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.am
   branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.in
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
Log:
cmddialog plugins should work now


Modified: branches/mloskot-style-refactoring/aclocal.m4
===================================================================
--- branches/mloskot-style-refactoring/aclocal.m4	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/aclocal.m4	2006-02-11 21:32:58 UTC (rev 240)
@@ -14,7 +14,6 @@
 # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-
 
 # serial 47 AC_PROG_LIBTOOL
-# Debian $Rev: 214 $
 
 
 # AC_PROVIDE_IFELSE(MACRO-NAME, IF-PROVIDED, IF-NOT-PROVIDED)
@@ -124,7 +123,7 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e s/^X//'
+Xsed='sed -e 1s/^X//'
 [sed_quote_subst='s/\([\\"\\`$\\\\]\)/\\\1/g']
 
 # Same as above, but do not quote variable references.
@@ -192,6 +191,8 @@
   old_archive_cmds="$old_archive_cmds~\$RANLIB \$oldlib"
 fi
 
+_LT_CC_BASENAME([$compiler])
+
 # Only perform the check for file, if the check method requires it
 case $deplibs_check_method in
 file_magic*)
@@ -217,6 +218,14 @@
     [pic_mode=default])
 test -z "$pic_mode" && pic_mode=default
 
+# Check if we have a version mismatch between libtool.m4 and ltmain.sh.
+#
+# Note:  This should be in AC_LIBTOOL_SETUP, _after_ $ltmain have been defined.
+#        We also should do it _before_ AC_LIBTOOL_LANG_C_CONFIG that actually
+#        calls AC_LIBTOOL_CONFIG and creates libtool.
+#
+_LT_VERSION_CHECK
+
 # Use C for the default configuration in the libtool script
 tagname=
 AC_LIBTOOL_LANG_C_CONFIG
@@ -224,6 +233,41 @@
 ])# AC_LIBTOOL_SETUP
 
 
+# _LT_VERSION_CHECK
+# -----------------
+AC_DEFUN([_LT_VERSION_CHECK],
+[AC_MSG_CHECKING([for correct ltmain.sh version])
+if test -z "$ltmain"; then
+  AC_MSG_RESULT(no)
+  echo
+  echo "*** [Gentoo] sanity check failed! ***"
+  echo "*** \$ltmain is not defined, please check the patch for consistency! ***"
+  echo
+  exit 1
+fi
+gentoo_lt_version="1.5.18"
+gentoo_ltmain_version=`grep '^[[:space:]]*VERSION=' $ltmain | sed -e 's|^[[:space:]]*VERSION=||'`
+if test "$gentoo_lt_version" != "$gentoo_ltmain_version"; then
+  AC_MSG_RESULT(no)
+  echo
+  echo "*** [Gentoo] sanity check failed! ***"
+  echo "*** libtool.m4 and ltmain.sh have a version mismatch! ***"
+  echo "*** (libtool.m4 = $gentoo_lt_version, ltmain.sh = $gentoo_ltmain_version) ***"
+  echo
+  echo "Please run:"
+  echo
+  echo "  libtoolize --copy --force"
+  echo
+  echo "if appropriate, please contact the maintainer of this"
+  echo "package (or your distribution) for help."
+  echo
+  exit 1
+else
+  AC_MSG_RESULT(yes)
+fi
+])# _LT_VERSION_CHECK
+
+
 # _LT_AC_SYS_COMPILER
 # -------------------
 AC_DEFUN([_LT_AC_SYS_COMPILER],
@@ -237,6 +281,48 @@
 ])# _LT_AC_SYS_COMPILER
 
 
+# _LT_CC_BASENAME(CC)
+# -------------------
+# Calculate cc_basename.  Skip known compiler wrappers and cross-prefix.
+AC_DEFUN([_LT_CC_BASENAME],
+[for cc_temp in $1""; do
+  case $cc_temp in
+    compile | *[[\\/]]compile | ccache | *[[\\/]]ccache ) ;;
+    distcc | *[[\\/]]distcc | purify | *[[\\/]]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
+])
+
+
+# _LT_COMPILER_BOILERPLATE
+# ------------------------
+# Check for compiler boilerplate output or warnings with
+# the simple compiler test code.
+AC_DEFUN([_LT_COMPILER_BOILERPLATE],
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+])# _LT_COMPILER_BOILERPLATE
+
+
+# _LT_LINKER_BOILERPLATE
+# ----------------------
+# Check for linker boilerplate output or warnings with
+# the simple link test code.
+AC_DEFUN([_LT_LINKER_BOILERPLATE],
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+])# _LT_LINKER_BOILERPLATE
+
+
 # _LT_AC_SYS_LIBPATH_AIX
 # ----------------------
 # Links a minimal program and checks the executable
@@ -309,7 +395,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-if test "X${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 if test -z "$ECHO"; then
 if test "X${echo_test_string+set}" != Xset; then
@@ -524,6 +610,20 @@
   rm -rf conftest*
   ;;
 
+*-*-linux*)
+  # Test if the compiler is 64bit
+  echo 'int i;' > conftest.$ac_ext
+  lt_cv_cc_64bit_output=no
+  if AC_TRY_EVAL(ac_compile); then
+    case `/usr/bin/file conftest.$ac_objext` in
+    *"ELF 64"*)
+      lt_cv_cc_64bit_output=yes
+      ;;
+    esac
+  fi
+  rm -rf conftest*
+  ;;
+  
 *-*-sco3.2v5*)
   # On SCO OpenServer 5, we need -belf to get full-featured binaries.
   SAVE_CFLAGS="$CFLAGS"
@@ -578,8 +678,10 @@
    echo "$as_me:__oline__: \$? = $ac_status" >&AS_MESSAGE_LOG_FD
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        $2=yes
      fi
    fi
@@ -610,6 +712,11 @@
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&AS_MESSAGE_LOG_FD
+       $echo "X$_lt_linker_boilerplate" | $Xsed > conftest.exp
+       $SED '/^$/d' conftest.err >conftest.er2
+       if diff conftest.exp conftest.er2 >/dev/null; then
+         $2=yes
+       fi
      else
        $2=yes
      fi
@@ -668,11 +775,38 @@
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
- *)
+  netbsd* | freebsd* | openbsd* | darwin* | dragonfly*)
+    # This has been around since 386BSD, at least.  Likely further.
+    if test -x /sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
+    elif test -x /usr/sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
+    else
+      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
+    fi
+    # And add a safety zone
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
+    ;;
+  osf*)
+    # Dr. Hans Ekkehard Plesser reports seeing a kernel panic running configure
+    # due to this test when exec_disable_arg_limit is 1 on Tru64. It is not
+    # nice to cause kernel panics so lets avoid the loop below.
+    # First set a reasonable default.
+    lt_cv_sys_max_cmd_len=16384
+    # 
+    if test -x /sbin/sysconfig; then
+      case `/sbin/sysconfig -q proc exec_disable_arg_limit` in
+        *1*) lt_cv_sys_max_cmd_len=-1 ;;
+      esac
+    fi
+    ;;
+  *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
     # we can't tell.
-    while (test "X"`$CONFIG_SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
 	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
 	    lt_cv_sys_max_cmd_len=$new_result &&
@@ -938,7 +1072,9 @@
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     if test ! -s out/conftest.err; then
+     $echo "X$_lt_compiler_boilerplate" | $Xsed > out/conftest.exp
+     $SED '/^$/d' out/conftest.err >out/conftest.er2
+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes
      fi
    fi
@@ -1006,8 +1142,8 @@
 [AC_MSG_CHECKING([how to hardcode library paths into programs])
 _LT_AC_TAGVAR(hardcode_action, $1)=
 if test -n "$_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)" || \
-   test -n "$_LT_AC_TAGVAR(runpath_var $1)" || \
-   test "X$_LT_AC_TAGVAR(hardcode_automatic, $1)"="Xyes" ; then
+   test -n "$_LT_AC_TAGVAR(runpath_var, $1)" || \
+   test "X$_LT_AC_TAGVAR(hardcode_automatic, $1)" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
   if test "$_LT_AC_TAGVAR(hardcode_direct, $1)" != no &&
@@ -1174,7 +1310,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi4*)
+bsdi[[45]]*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -1232,11 +1368,35 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
+  linux*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      supports_anon_versioning=no
+      case `$LD -v 2>/dev/null` in
+        *\ [01].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+$echo "local: *; };" >> $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        $archive_expsym_cmds="$archive_cmds"
+      fi
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -1290,7 +1450,9 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd*)
+freebsd* | dragonfly*)
+  # DragonFly does not have aout.  When/if they implement a new
+  # versioning mechanism, adjust this.
   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -1309,7 +1471,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.[01]* | freebsdelf3.[01]*)
+  freebsd3.[[01]]* | freebsdelf3.[[01]]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -1435,10 +1597,17 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/[:,\t]/ /g;s/=[^=]*$//;s/=[^= ]* / /g' /etc/ld.so.conf | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
+  case $host_cpu:$lt_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+    sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /usr/X11R6/lib64"
+    sys_lib_search_path_spec="/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64"
+    ;;
+  esac
+
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -1446,18 +1615,26 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
-  ;;
 
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
+  # Find out which ABI we are using (multilib Linux x86_64 hack).
+  libsuff=
+  case "$host_cpu" in
+  x86_64*)
+    echo '[#]line __oline__ "configure"' > conftest.$ac_ext
+    if AC_TRY_EVAL(ac_compile); then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *64-bit*)
+        libsuff=64
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+    ;;
+  *)
+    ;;
+  esac
+  sys_lib_dlsearch_path_spec="/lib${libsuff} /usr/lib${libsuff}"
+  sys_lib_search_path_spec="/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}"
   ;;
 
 knetbsd*-gnu)
@@ -1510,7 +1687,11 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
+  case $host_os in
+    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
+    *)                         need_version=no  ;;
+  esac
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -1676,7 +1857,9 @@
 
       case $tagname in
       CXX)
-	if test -n "$CXX" && test "X$CXX" != "Xno"; then
+	if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
+	    ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
+	    (test "X$CXX" != "Xg++"))) ; then
 	  AC_LIBTOOL_LANG_CXX_CONFIG
 	else
 	  tagname=""
@@ -2081,6 +2264,15 @@
 *) reload_flag=" $reload_flag" ;;
 esac
 reload_cmds='$LD$reload_flag -o $output$reload_objs'
+case $host_os in
+  darwin*)
+    if test "$GCC" = yes; then
+      reload_cmds='$CC -nostdlib ${wl}-r -o $output$reload_objs'
+    else
+      reload_cmds='$LD$reload_flag -o $output$reload_objs'
+    fi
+    ;;
+esac
 ])# AC_PROG_LD_RELOAD_FLAG
 
 
@@ -2114,7 +2306,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-bsdi4*)
+bsdi[[45]]*)
   lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (shared object|dynamic lib)'
   lt_cv_file_magic_cmd='/usr/bin/file -L'
   lt_cv_file_magic_test_file=/shlib/libc.so
@@ -2137,13 +2329,13 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-freebsd* | kfreebsd*-gnu)
+freebsd* | kfreebsd*-gnu | dragonfly*)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
       # Let's accept both of them until this is cleared up.
-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[[3-9]]86 (compact )?demand paged shared library'
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD|DragonFly)/i[[3-9]]86 (compact )?demand paged shared library'
       lt_cv_file_magic_cmd=/usr/bin/file
       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
       ;;
@@ -2190,7 +2382,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+netbsd*)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
@@ -2209,12 +2401,10 @@
   ;;
 
 openbsd*)
-  lt_cv_file_magic_cmd=/usr/bin/file
-  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
   if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB shared object'
+    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|\.so|_pic\.a)$'
   else
-    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
+    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   fi
   ;;
 
@@ -2404,10 +2594,21 @@
 # ---------------
 AC_DEFUN([_LT_AC_LANG_CXX],
 [AC_REQUIRE([AC_PROG_CXX])
-AC_REQUIRE([AC_PROG_CXXCPP])
+AC_REQUIRE([_LT_AC_PROG_CXXCPP])
 _LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}CXX])
 ])# _LT_AC_LANG_CXX
 
+# _LT_AC_PROG_CXXCPP
+# ---------------
+AC_DEFUN([_LT_AC_PROG_CXXCPP],
+[
+AC_REQUIRE([AC_PROG_CXX])
+if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
+    ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
+    (test "X$CXX" != "Xg++"))) ; then
+  AC_PROG_CXXCPP
+fi
+])# _LT_AC_PROG_CXXCPP
 
 # AC_LIBTOOL_F77
 # --------------
@@ -2480,6 +2681,10 @@
 
 _LT_AC_SYS_COMPILER
 
+# save warnings/boilerplate of simple test code
+_LT_COMPILER_BOILERPLATE
+_LT_LINKER_BOILERPLATE
+
 #
 # Check for any special shared library compilation flags.
 #
@@ -2543,43 +2748,6 @@
   if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
     test "$enable_shared" = yes && enable_static=no
   fi
-  ;;
-  darwin* | rhapsody*)
-  if test "$GCC" = yes; then
-    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
-    case "$host_os" in
-    rhapsody* | darwin1.[[012]])
-      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[[012]])
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-      ;;
-    esac
-    output_verbose_link_cmd='echo'
-    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'
-    _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    _LT_AC_TAGVAR(hardcode_direct, $1)=no
-    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
-    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
-    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
-    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
-  else
-    _LT_AC_TAGVAR(ld_shlibs, $1)=no
-  fi
     ;;
 esac
 AC_MSG_RESULT([$enable_shared])
@@ -2605,7 +2773,7 @@
 AC_DEFUN([_LT_AC_LANG_CXX_CONFIG],
 [AC_LANG_PUSH(C++)
 AC_REQUIRE([AC_PROG_CXX])
-AC_REQUIRE([AC_PROG_CXXCPP])
+AC_REQUIRE([_LT_AC_PROG_CXXCPP])
 
 _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
 _LT_AC_TAGVAR(allow_undefined_flag, $1)=
@@ -2649,6 +2817,10 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
+# save warnings/boilerplate of simple test code
+_LT_COMPILER_BOILERPLATE
+_LT_LINKER_BOILERPLATE
+
 # Allow CC to be a program name with arguments.
 lt_save_CC=$CC
 lt_save_LD=$LD
@@ -2670,7 +2842,7 @@
 CC=${CXX-"c++"}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
+_LT_CC_BASENAME([$compiler])
 
 # We don't want -fno-exception wen compiling C++ code, so set the
 # no_builtin_flag separately
@@ -2777,7 +2949,7 @@
     _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
     if test "$GXX" = yes; then
-      case $host_os in aix4.[012]|aix4.[012].*)
+      case $host_os in aix4.[[012]]|aix4.[[012]].*)
       # We only want to do this on AIX 4.2 and lower, the check
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
@@ -2798,6 +2970,9 @@
 	fi
       esac
       shared_flag='-shared'
+      if test "$aix_use_runtimelinking" = yes; then
+	shared_flag="$shared_flag "'${wl}-G'
+      fi
     else
       # not using gcc
       if test "$host_cpu" = ia64; then
@@ -2857,6 +3032,7 @@
     esac
     ;;
 
+
   cygwin* | mingw* | pw32*)
     # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1) is actually meaningless,
     # as there is no search path for DLLs.
@@ -2880,65 +3056,76 @@
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
     fi
   ;;
+      darwin* | rhapsody*)
+        case "$host_os" in
+        rhapsody* | darwin1.[[012]])
+         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[[012]])
+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
+        esac
+      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+      _LT_AC_TAGVAR(hardcode_direct, $1)=no
+      _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
+      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''
+      _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
-  darwin* | rhapsody*)
-  if test "$GXX" = yes; then
-    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
-    case "$host_os" in
-    rhapsody* | darwin1.[[012]])
-      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
+    if test "$GXX" = yes ; then
+      lt_int_apple_cc_single_mod=no
+      output_verbose_link_cmd='echo'
+      if $CC -dumpspecs 2>&1 | $EGREP 'single_module' >/dev/null ; then
+       lt_int_apple_cc_single_mod=yes
+      fi
+      if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
+       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
       else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[[012]])
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
-            ;;
-        esac
+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+        fi
+        _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+        # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+          if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
+            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          else
+            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          fi
+            _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      else
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+          _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         _LT_AC_TAGVAR(ld_shlibs, $1)=no
+          ;;
+      esac
       fi
-      ;;
-    esac
-    lt_int_apple_cc_single_mod=no
-    output_verbose_link_cmd='echo'
-    if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-      lt_int_apple_cc_single_mod=yes
-    fi
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    else
-      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    fi
-    _LT_AC_TAGVAR(module_cmds, $1)='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+        ;;
 
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    else
-      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    fi
-    _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    _LT_AC_TAGVAR(hardcode_direct, $1)=no
-    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
-    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
-    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
-    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
-  else
-    _LT_AC_TAGVAR(ld_shlibs, $1)=no
-  fi
-    ;;
-
   dgux*)
     case $cc_basename in
-      ec++)
+      ec++*)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      ghcx)
+      ghcx*)
 	# Green Hills C++ Compiler
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -2949,14 +3136,14 @@
 	;;
     esac
     ;;
-  freebsd[12]*)
+  freebsd[[12]]*)
     # C++ shared libraries reported to be fairly broken before switch to ELF
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
   freebsd-elf*)
     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
     ;;
-  freebsd* | kfreebsd*-gnu)
+  freebsd* | kfreebsd*-gnu | dragonfly*)
     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
     # conventions
     _LT_AC_TAGVAR(ld_shlibs, $1)=yes
@@ -2973,11 +3160,11 @@
 				# location of the library.
 
     case $cc_basename in
-    CC)
+    CC*)
       # FIXME: insert proper C++ library support
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
       ;;
-    aCC)
+    aCC*)
       _LT_AC_TAGVAR(archive_cmds, $1)='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
@@ -2987,7 +3174,7 @@
       # explicitly linking system object files so we need to strip them
       # from the output so that they don't get included in the library
       # dependencies.
-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "[-]L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
+      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "[[-]]L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
       ;;
     *)
       if test "$GXX" = yes; then
@@ -3038,11 +3225,11 @@
     esac
 
     case $cc_basename in
-      CC)
+      CC*)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      aCC)
+      aCC*)
 	case "$host_cpu" in
 	hppa*64*|ia64*)
 	  _LT_AC_TAGVAR(archive_cmds, $1)='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
@@ -3082,9 +3269,9 @@
     ;;
   irix5* | irix6*)
     case $cc_basename in
-      CC)
+      CC*)
 	# SGI C++
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 
 	# Archives containing C++ object files must be created using
 	# "CC -ar", where "CC" is the IRIX C++ compiler.  This is
@@ -3095,7 +3282,7 @@
       *)
 	if test "$GXX" = yes; then
 	  if test "$with_gnu_ld" = no; then
-	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 	  else
 	    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` -o $lib'
 	  fi
@@ -3108,7 +3295,7 @@
     ;;
   linux*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3133,17 +3320,41 @@
 	# "CC -Bstatic", where "CC" is the KAI C++ compiler.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'
 	;;
-      icpc)
+      icpc*)
 	# Intel C++
 	with_gnu_ld=yes
+	# version 8.0 and above of icpc choke on multiply defined symbols
+	# if we add $predep_objects and $postdep_objects, however 7.1 and
+	# earlier do not add the objects themselves.
+	case `$CC -V 2>&1` in
+	*"Version 7."*)
+  	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
+  	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+	  ;;
+	*)  # Version 8.0 or newer
+	  tmp_idyn=
+	  case $host_cpu in
+	    ia64*) tmp_idyn=' -i_dynamic';;
+	  esac
+  	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'"$tmp_idyn"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared'"$tmp_idyn"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+	  ;;
+	esac
 	_LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
 	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive$convenience ${wl}--no-whole-archive'
 	;;
-      cxx)
+      pgCC*)
+        # Portland Group C++ compiler
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname -o $lib'
+  	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname ${wl}-retain-symbols-file ${wl}$export_symbols -o $lib'
+
+	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
+	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
+	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+        ;;
+      cxx*)
 	# Compaq C++
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'
@@ -3174,7 +3385,7 @@
     ;;
   mvs*)
     case $cc_basename in
-      cxx)
+      cxx*)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
@@ -3184,7 +3395,7 @@
 	;;
     esac
     ;;
-  netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+  netbsd*)
     if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
       _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -3195,9 +3406,25 @@
     # Workaround some broken pre-1.5 toolchains
     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
     ;;
+  openbsd2*)
+    # C++ shared libraries are fairly broken
+    _LT_AC_TAGVAR(ld_shlibs, $1)=no
+    ;;
+  openbsd*)
+    _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+    fi
+    output_verbose_link_cmd='echo'
+    ;;
   osf3*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3213,14 +3440,14 @@
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'
 
 	;;
-      RCC)
+      RCC*)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      cxx)
+      cxx*)
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n "$verstring" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n "$verstring" && echo ${wl}-set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	_LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3238,7 +3465,7 @@
       *)
 	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3257,7 +3484,7 @@
     ;;
   osf4* | osf5*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -3272,17 +3499,17 @@
 	# the KAI C++ compiler.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -o $oldlib $oldobjs'
 	;;
-      RCC)
+      RCC*)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      cxx)
+      cxx*)
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \*'
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done~
 	  echo "-hidden">> $lib.exp~
-	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n "$verstring" && echo -set_version	$verstring` -update_registry $objdir/so_locations -o $lib~
+	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n "$verstring" && echo -set_version	$verstring` -update_registry ${output_objdir}/so_locations -o $lib~
 	  $rm $lib.exp'
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'
@@ -3301,7 +3528,7 @@
       *)
 	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\*'
-	 _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	 _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
@@ -3325,7 +3552,7 @@
   sco*)
     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
     case $cc_basename in
-      CC)
+      CC*)
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
@@ -3337,12 +3564,12 @@
     ;;
   sunos4*)
     case $cc_basename in
-      CC)
+      CC*)
 	# Sun C++ 4.x
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	;;
-      lcc)
+      lcc*)
 	# Lucid
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -3355,7 +3582,7 @@
     ;;
   solaris*)
     case $cc_basename in
-      CC)
+      CC*)
 	# Sun C++ 4.2, 5.x and Centerline C++
 	_LT_AC_TAGVAR(no_undefined_flag, $1)=' -zdefs'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
@@ -3365,13 +3592,17 @@
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
 	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
 	case $host_os in
-	  solaris2.[0-5] | solaris2.[0-5].*) ;;
+	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
 	  *)
 	    # The C++ compiler is used as linker so we must use $wl
 	    # flag to pass the commands to the underlying system
-	    # linker.
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
+	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=yes
@@ -3392,7 +3623,7 @@
 	# in the archive.
 	_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -xar -o $oldlib $oldobjs'
 	;;
-      gcx)
+      gcx*)
 	# Green Hills C++ Compiler
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 
@@ -3435,7 +3666,7 @@
     ;;
   tandem*)
     case $cc_basename in
-      NCC)
+      NCC*)
 	# NonStop-UX NCC 3.20
 	# FIXME: insert proper C++ library support
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
@@ -3667,12 +3898,16 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
+# save warnings/boilerplate of simple test code
+_LT_COMPILER_BOILERPLATE
+_LT_LINKER_BOILERPLATE
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${F77-"f77"}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
+_LT_CC_BASENAME([$compiler])
 
 AC_MSG_CHECKING([if libtool supports shared libraries])
 AC_MSG_RESULT([$can_build_shared])
@@ -3691,7 +3926,9 @@
   fi
   ;;
 aix4* | aix5*)
-  test "$enable_shared" = yes && enable_static=no
+  if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
+    test "$enable_shared" = yes && enable_static=no
+  fi
   ;;
 esac
 AC_MSG_RESULT([$enable_shared])
@@ -3742,20 +3979,27 @@
 lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
+lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
+# save warnings/boilerplate of simple test code
+_LT_COMPILER_BOILERPLATE
+_LT_LINKER_BOILERPLATE
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${GCJ-"gcj"}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
+_LT_CC_BASENAME([$compiler])
 
 # GCJ did not exist at the time GCC didn't implicitly link libc in.
 _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
 
+_LT_AC_TAGVAR(old_archive_cmds, $1)=$old_archive_cmds
+
 AC_LIBTOOL_PROG_COMPILER_NO_RTTI($1)
 AC_LIBTOOL_PROG_COMPILER_PIC($1)
 AC_LIBTOOL_PROG_CC_C_O($1)
@@ -3798,11 +4042,16 @@
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
+# save warnings/boilerplate of simple test code
+_LT_COMPILER_BOILERPLATE
+_LT_LINKER_BOILERPLATE
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${RC-"windres"}
 compiler=$CC
 _LT_AC_TAGVAR(compiler, $1)=$CC
+_LT_CC_BASENAME([$compiler])
 _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes
 
 AC_LIBTOOL_CONFIG($1)
@@ -3938,7 +4187,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -3949,11 +4198,11 @@
 SED=$lt_SED
 
 # Sed that helps us avoid accidentally triggering echo(1) options like -n.
-Xsed="$SED -e s/^X//"
+Xsed="$SED -e 1s/^X//"
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-if test "X\${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 # The names of the tagged configurations supported by this script.
 available_tags=
@@ -3984,7 +4233,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -4060,7 +4315,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_[]_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -4334,9 +4589,6 @@
 # Regexp to match symbols that can be accessed directly from C.
 sympat='\([[_A-Za-z]][[_A-Za-z0-9]]*\)'
 
-# Transform the above into a raw symbol and a C symbol.
-symxfrm='\1 \2\3 \3'
-
 # Transform an extracted symbol line into a proper C declaration
 lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^. .* \(.*\)$/extern int \1;/p'"
 
@@ -4358,6 +4610,13 @@
   lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
   lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
   ;;
+linux*)
+  if test "$host_cpu" = ia64; then
+    symcode='[[ABCDGIRSTW]]'
+    lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+    lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+  fi
+  ;;
 irix* | nonstopux*)
   symcode='[[BCDEGRST]]'
   ;;
@@ -4389,8 +4648,11 @@
 # Try without a prefix undercore, then with it.
 for ac_symprfx in "" "_"; do
 
+  # Transform symcode, sympat, and symprfx into a raw symbol and a C symbol.
+  symxfrm="\\1 $ac_symprfx\\2 \\2"
+
   # Write the raw and C identifiers.
-  lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[[ 	]]\($symcode$symcode*\)[[ 	]][[ 	]]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'"
+  lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[[ 	]]\($symcode$symcode*\)[[ 	]][[ 	]]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
 
   # Check to see that the pipe works correctly.
   pipe_works=no
@@ -4579,18 +4841,28 @@
 	;;
       chorus*)
 	case $cc_basename in
-	cxch68)
+	cxch68*)
 	  # Green Hills C++ Compiler
 	  # _LT_AC_TAGVAR(lt_prog_compiler_static, $1)="--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a"
 	  ;;
 	esac
 	;;
+       darwin*)
+         # PIC is the default on this platform
+         # Common symbols not allowed in MH_DYLIB files
+         case $cc_basename in
+           xlc*)
+           _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
+           _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
+           ;;
+         esac
+       ;;
       dgux*)
 	case $cc_basename in
-	  ec++)
+	  ec++*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    ;;
-	  ghcx)
+	  ghcx*)
 	    # Green Hills C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
@@ -4598,19 +4870,19 @@
 	    ;;
 	esac
 	;;
-      freebsd* | kfreebsd*-gnu)
+      freebsd* | kfreebsd*-gnu | dragonfly*)
 	# FreeBSD uses GNU C++
 	;;
       hpux9* | hpux10* | hpux11*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
 	    if test "$host_cpu" != ia64; then
 	      _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='+Z'
 	    fi
 	    ;;
-	  aCC)
+	  aCC*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
 	    case "$host_cpu" in
@@ -4628,7 +4900,7 @@
 	;;
       irix5* | irix6* | nonstopux*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
 	    # CC pic flag -KPIC is the default.
@@ -4639,18 +4911,24 @@
 	;;
       linux*)
 	case $cc_basename in
-	  KCC)
+	  KCC*)
 	    # KAI C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'
 	    ;;
-	  icpc)
+	  icpc* | ecpc*)
 	    # Intel C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
 	    ;;
-	  cxx)
+	  pgCC*)
+	    # Portland Group C++ compiler.
+	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
+	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'
+	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
+	    ;;
+	  cxx*)
 	    # Compaq C++
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
@@ -4667,25 +4945,25 @@
 	;;
       mvs*)
 	case $cc_basename in
-	  cxx)
+	  cxx*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-W c,exportall'
 	    ;;
 	  *)
 	    ;;
 	esac
 	;;
-      netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+      netbsd*)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
-	  KCC)
+	  KCC*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'
 	    ;;
-	  RCC)
+	  RCC*)
 	    # Rational C++ 2.4.1
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
-	  cxx)
+	  cxx*)
 	    # Digital/Compaq C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
@@ -4701,7 +4979,7 @@
 	;;
       sco*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'
 	    ;;
 	  *)
@@ -4710,13 +4988,13 @@
 	;;
       solaris*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    # Sun C++ 4.2, 5.x and Centerline C++
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
 	    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld '
 	    ;;
-	  gcx)
+	  gcx*)
 	    # Green Hills C++ Compiler
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-PIC'
 	    ;;
@@ -4726,12 +5004,12 @@
 	;;
       sunos4*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    # Sun C++ 4.x
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
 	    ;;
-	  lcc)
+	  lcc*)
 	    # Lucid
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
 	    ;;
@@ -4741,7 +5019,7 @@
 	;;
       tandem*)
 	case $cc_basename in
-	  NCC)
+	  NCC*)
 	    # NonStop-UX NCC 3.20
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	    ;;
@@ -4838,6 +5116,16 @@
 	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
+      darwin*)
+        # PIC is the default on this platform
+        # Common symbols not allowed in MH_DYLIB files
+       case $cc_basename in
+         xlc*)
+         _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
+         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
+         ;;
+       esac
+       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -4873,12 +5161,19 @@
       ;;
 
     linux*)
-      case $CC in
+      case $cc_basename in
       icc* | ecc*)
 	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
 	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
 	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
         ;;
+      pgcc* | pgf77* | pgf90*)
+        # Portland Group compilers (*not* the Pentium gcc compiler,
+	# which looks to be a dead project)
+	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
+	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'
+	_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'
+        ;;
       ccc*)
         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
         # All Alpha code is PIC.
@@ -4899,9 +5194,14 @@
       ;;
 
     solaris*)
-      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
+      case $cc_basename in
+      f77* | f90* | f95*)
+	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld ';;
+      *)
+	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,';;
+      esac
       ;;
 
     sunos4*)
@@ -4923,6 +5223,11 @@
       fi
       ;;
 
+    unicos*)
+      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
+      _LT_AC_TAGVAR(lt_prog_compiler_can_build_shared, $1)=no
+      ;;
+
     uts4*)
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
@@ -4983,11 +5288,8 @@
     _LT_AC_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([[^ ]]*\) [[^ ]]*/\1 DATA/;/^I /d;/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
-  linux*)
-    _LT_AC_TAGVAR(link_all_deplibs, $1)=no
-  ;;
   *)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
@@ -5029,7 +5331,8 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
-
+  # Just being paranoid about ensuring that cc_basename is set.
+  _LT_CC_BASENAME([$compiler])
   case $host_os in
   cygwin* | mingw* | pw32*)
     # FIXME: the MSVC++ port hasn't been tested in a loooong time
@@ -5048,7 +5351,28 @@
   if test "$with_gnu_ld" = yes; then
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
-
+    
+    # Set some defaults for GNU ld with shared library support. These
+    # are reset later if shared libraries are not supported. Putting them
+    # here allows them to be overridden if necessary.
+    runpath_var=LD_RUN_PATH
+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
+    _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
+    # ancient GNU ld didn't support --whole-archive et. al.
+    if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
+	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+  	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
+    fi
+    supports_anon_versioning=no
+    case `$LD -v 2>/dev/null` in
+      *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
+      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+      *\ 2.11.*) ;; # other 2.11 versions
+      *) supports_anon_versioning=yes ;;
+    esac
+    
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -5099,7 +5423,7 @@
       _LT_AC_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_AC_TAGVAR(always_export_symbols, $1)=no
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
+      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -5113,11 +5437,42 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	ld_shlibs=no
+	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    linux*)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+	tmp_addflag=
+	case $cc_basename,$host_cpu in
+	pgcc*)				# Portland Group C compiler
+	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag'
+	  ;;
+	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
+	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag -Mnomain' ;;
+	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
+	  tmp_addflag=' -i_dynamic' ;;
+	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
+	  tmp_addflag=' -i_dynamic -nofor_main' ;;
+	ifc* | ifort*)			# Intel Fortran compiler
+	  tmp_addflag=' -nofor_main' ;;
+	esac
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+
+	if test $supports_anon_versioning = yes; then
+	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $output_objdir/$libname.ver~
+  cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+  $echo "local: *; };" >> $output_objdir/$libname.ver~
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	fi
+      else
+	_LT_AC_TAGVAR(ld_shlibs, $1)=no
+      fi
+      ;;
+
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -5155,32 +5510,6 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       ;;
 
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	_LT_AC_TAGVAR(archive_cmds, $1)="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ [01].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        _LT_AC_TAGVAR(archive_expsym_cmds, $1)="$tmp_archive_cmds"
-      fi
-      _LT_AC_TAGVAR(link_all_deplibs, $1)=no
-    else
-      _LT_AC_TAGVAR(ld_shlibs, $1)=no
-    fi
-    ;;
-
     *)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -5191,16 +5520,11 @@
       ;;
     esac
 
-    if test "$_LT_AC_TAGVAR(ld_shlibs, $1)" = yes; then
-      runpath_var=LD_RUN_PATH
-      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'
-      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
-      fi
+    if test "$_LT_AC_TAGVAR(ld_shlibs, $1)" = no; then
+      runpath_var=
+      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)=
+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -5264,7 +5588,7 @@
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
       if test "$GCC" = yes; then
-	case $host_os in aix4.[012]|aix4.[012].*)
+	case $host_os in aix4.[[012]]|aix4.[[012]].*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -5285,6 +5609,9 @@
 	  fi
 	esac
 	shared_flag='-shared'
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag="$shared_flag "'${wl}-G'
+	fi
       else
 	# not using gcc
 	if test "$host_cpu" = ia64; then
@@ -5343,7 +5670,7 @@
       _LT_AC_TAGVAR(ld_shlibs, $1)=no
       ;;
 
-    bsdi4*)
+    bsdi[[45]]*)
       _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=-rdynamic
       ;;
 
@@ -5364,57 +5691,57 @@
       _LT_AC_TAGVAR(old_archive_From_new_cmds, $1)='true'
       # FIXME: Should let the user specify the lib program.
       _LT_AC_TAGVAR(old_archive_cmds, $1)='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
+      _LT_AC_TAGVAR(fix_srcfile_path, $1)='`cygpath -w "$srcfile"`'
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
       ;;
 
     darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
       case "$host_os" in
-      rhapsody* | darwin1.[[012]])
-	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	_LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[[012]])
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
+        rhapsody* | darwin1.[[012]])
+         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[[012]])
+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
       esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      _LT_AC_TAGVAR(module_cmds, $1)='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
       _LT_AC_TAGVAR(hardcode_direct, $1)=no
       _LT_AC_TAGVAR(hardcode_automatic, $1)=yes
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported
-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
+    if test "$GCC" = yes ; then
+    	output_verbose_link_cmd='echo'
+        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      _LT_AC_TAGVAR(ld_shlibs, $1)=no
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+         _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         _LT_AC_TAGVAR(ld_shlibs, $1)=no
+          ;;
+      esac
     fi
       ;;
 
@@ -5448,7 +5775,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
+    freebsd* | kfreebsd*-gnu | dragonfly*)
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
       _LT_AC_TAGVAR(hardcode_direct, $1)=yes
@@ -5535,7 +5862,7 @@
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -5559,6 +5886,7 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       else
@@ -5604,7 +5932,7 @@
 	_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \*'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'
@@ -5623,10 +5951,12 @@
     solaris*)
       _LT_AC_TAGVAR(no_undefined_flag, $1)=' -z text'
       if test "$GCC" = yes; then
+	wlarc='${wl}'
 	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
+	wlarc=''
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -5635,8 +5965,18 @@
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       case $host_os in
       solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
+      *)
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
+ 	# Supported since Solaris 2.6 (maybe 2.5.1?)
+ 	case $wlarc in
+ 	'')
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
@@ -5897,7 +6237,7 @@
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
-  test ! -f $lt_ac_sed && break
+  test ! -f $lt_ac_sed && continue
   cat /dev/null > conftest.in
   lt_ac_count=0
   echo $ECHO_N "0123456789$ECHO_C" >conftest.in
@@ -5922,8 +6262,8 @@
     fi
   done
 done
+])
 SED=$lt_cv_path_SED
-])
 AC_MSG_RESULT([$SED])
 ])
 

Modified: branches/mloskot-style-refactoring/config.guess
===================================================================
--- branches/mloskot-style-refactoring/config.guess	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/config.guess	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
 
-timestamp='2005-04-22'
+timestamp='2004-03-12'
 
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
@@ -53,7 +53,7 @@
 GNU config.guess ($timestamp)
 
 Originally written by Per Bothner.
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
@@ -203,15 +203,15 @@
     amiga:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
+    arc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
     cats:OpenBSD:*:*)
 	echo arm-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
     hp300:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
-    luna88k:OpenBSD:*:*)
-    	echo m88k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     mac68k:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
@@ -227,12 +227,21 @@
     mvmeppc:OpenBSD:*:*)
 	echo powerpc-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
+    pegasos:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    pmax:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
     sgi:OpenBSD:*:*)
-	echo mips64-unknown-openbsd${UNAME_RELEASE}
+	echo mipseb-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
     sun3:OpenBSD:*:*)
 	echo m68k-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
+    wgrisc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
     *:OpenBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
 	exit 0 ;;
@@ -298,6 +307,9 @@
 	# 1.2 uses "1.2" for uname -r.
 	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[PVTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
 	exit 0 ;;
+    Alpha*:OpenVMS:*:*)
+	echo alpha-hp-vms
+	exit 0 ;;
     Alpha\ *:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# Should we change UNAME_MACHINE based on the output of uname instead
@@ -319,9 +331,6 @@
     *:OS/390:*:*)
 	echo i370-ibm-openedition
 	exit 0 ;;
-    *:z/VM:*:*)
-	echo s390-ibm-zvmoe
-	exit 0 ;;
     *:OS400:*:*)
         echo powerpc-ibm-os400
 	exit 0 ;;
@@ -345,7 +354,7 @@
     DRS?6000:unix:4.0:6*)
 	echo sparc-icl-nx6
 	exit 0 ;;
-    DRS?6000:UNIX_SV:4.2*:7* | DRS?6000:isis:4.2*:7*)
+    DRS?6000:UNIX_SV:4.2*:7*)
 	case `/usr/bin/uname -p` in
 	    sparc) echo sparc-icl-nx7 && exit 0 ;;
 	esac ;;
@@ -755,7 +764,7 @@
 	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     *:UNICOS/mp:*:*)
-	echo craynv-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	echo nv1-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
 	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
@@ -778,7 +787,21 @@
 	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
 	exit 0 ;;
     *:FreeBSD:*:*)
-	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
+	# Determine whether the default compiler uses glibc.
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#if __GLIBC__ >= 2
+	LIBC=gnu
+	#else
+	LIBC=
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	# GNU/KFreeBSD systems have a "k" prefix to indicate we are using
+	# FreeBSD's kernel, but not the complete OS.
+	case ${LIBC} in gnu) kernel_only='k' ;; esac
+	echo ${UNAME_MACHINE}-unknown-${kernel_only}freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
 	exit 0 ;;
     i*:CYGWIN*:*)
 	echo ${UNAME_MACHINE}-pc-cygwin
@@ -804,9 +827,6 @@
     i*:UWIN*:*)
 	echo ${UNAME_MACHINE}-pc-uwin
 	exit 0 ;;
-    amd64:CYGWIN*:*:*)
-	echo x86_64-unknown-cygwin
-	exit 0 ;;
     p*:CYGWIN*:*)
 	echo powerpcle-unknown-cygwin
 	exit 0 ;;
@@ -830,12 +850,6 @@
     cris:Linux:*:*)
 	echo cris-axis-linux-gnu
 	exit 0 ;;
-    crisv32:Linux:*:*)
-	echo crisv32-axis-linux-gnu
-	exit 0 ;;
-    frv:Linux:*:*)
-    	echo frv-unknown-linux-gnu
-	exit 0 ;;
     ia64:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
 	exit 0 ;;
@@ -1082,9 +1096,9 @@
     M680?0:D-NIX:5.3:*)
 	echo m68k-diab-dnix
 	exit 0 ;;
-    M68*:*:R3V[5678]*:*)
+    M68*:*:R3V[567]*:*)
 	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
-    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0 | S7501*:*:4.0:3.0)
+    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0)
 	OS_REL=''
 	test -r /etc/.relid \
 	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
@@ -1140,10 +1154,6 @@
 	# From seanf at swdc.stratus.com.
 	echo i860-stratus-sysv4
 	exit 0 ;;
-    i*86:VOS:*:*)
-	# From Paul.Green at stratus.com.
-	echo ${UNAME_MACHINE}-stratus-vos
-	exit 0 ;;
     *:VOS:*:*)
 	# From Paul.Green at stratus.com.
 	echo hppa1.1-stratus-vos
@@ -1186,10 +1196,9 @@
 	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
 	exit 0 ;;
     *:Darwin:*:*)
-	UNAME_PROCESSOR=`uname -p` || UNAME_PROCESSOR=unknown
-	case $UNAME_PROCESSOR in
+	case `uname -p` in
 	    *86) UNAME_PROCESSOR=i686 ;;
-	    unknown) UNAME_PROCESSOR=powerpc ;;
+	    powerpc) UNAME_PROCESSOR=powerpc ;;
 	esac
 	echo ${UNAME_PROCESSOR}-apple-darwin${UNAME_RELEASE}
 	exit 0 ;;
@@ -1204,9 +1213,6 @@
     *:QNX:*:4*)
 	echo i386-pc-qnx
 	exit 0 ;;
-    NSE-?:NONSTOP_KERNEL:*:*)
-	echo nse-tandem-nsk${UNAME_RELEASE}
-	exit 0 ;;
     NSR-?:NONSTOP_KERNEL:*:*)
 	echo nsr-tandem-nsk${UNAME_RELEASE}
 	exit 0 ;;
@@ -1254,16 +1260,6 @@
     *:DragonFly:*:*)
 	echo ${UNAME_MACHINE}-unknown-dragonfly`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
 	exit 0 ;;
-    *:*VMS:*:*)
-    	UNAME_MACHINE=`(uname -p) 2>/dev/null`
-	case "${UNAME_MACHINE}" in
-	    A*) echo alpha-dec-vms && exit 0 ;;
-	    I*) echo ia64-dec-vms && exit 0 ;;
-	    V*) echo vax-dec-vms && exit 0 ;;
-	esac ;;
-    *:XENIX:*:SysV)
-	echo i386-pc-xenix
-	exit 0 ;;
 esac
 
 #echo '(No uname command or uname output not recognized.)' 1>&2
@@ -1423,9 +1419,7 @@
 the operating system you are using. It is advised that you
 download the most up to date version of the config scripts from
 
-  http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.guess
-and
-  http://savannah.gnu.org/cgi-bin/viewcvs/*checkout*/config/config/config.sub
+    ftp://ftp.gnu.org/pub/gnu/config/
 
 If the version you run ($0) is already up to date, please
 send the following data and any information you think might be

Modified: branches/mloskot-style-refactoring/config.sub
===================================================================
--- branches/mloskot-style-refactoring/config.sub	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/config.sub	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
 
-timestamp='2005-04-22'
+timestamp='2004-03-12'
 
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
@@ -70,7 +70,7 @@
 version="\
 GNU config.sub ($timestamp)
 
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
@@ -145,7 +145,7 @@
 	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
 	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
 	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
-	-apple | -axis | -knuth | -cray)
+	-apple | -axis)
 		os=
 		basic_machine=$1
 		;;
@@ -231,14 +231,13 @@
 	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
 	| am33_2.0 \
 	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
-	| bfin \
 	| c4x | clipper \
 	| d10v | d30v | dlx | dsp16xx \
 	| fr30 | frv \
 	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
 	| i370 | i860 | i960 | ia64 \
 	| ip2k | iq2000 \
-	| m32r | m32rle | m68000 | m68k | m88k | maxq | mcore \
+	| m32r | m32rle | m68000 | m68k | m88k | mcore \
 	| mips | mipsbe | mipseb | mipsel | mipsle \
 	| mips16 \
 	| mips64 | mips64el \
@@ -263,13 +262,12 @@
 	| pyramid \
 	| sh | sh[1234] | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
 	| sh64 | sh64le \
-	| sparc | sparc64 | sparc64b | sparc86x | sparclet | sparclite \
-	| sparcv8 | sparcv9 | sparcv9b \
+	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv8 | sparcv9 | sparcv9b \
 	| strongarm \
 	| tahoe | thumb | tic4x | tic80 | tron \
 	| v850 | v850e \
 	| we32k \
-	| x86 | xscale | xscalee[bl] | xstormy16 | xtensa \
+	| x86 | xscale | xstormy16 | xtensa \
 	| z8k)
 		basic_machine=$basic_machine-unknown
 		;;
@@ -300,9 +298,9 @@
 	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
 	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
 	| avr-* \
-	| bfin-* | bs2000-* \
+	| bs2000-* \
 	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
-	| clipper-* | craynv-* | cydra-* \
+	| clipper-* | cydra-* \
 	| d10v-* | d30v-* | dlx-* \
 	| elxsi-* \
 	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
@@ -312,7 +310,7 @@
 	| ip2k-* | iq2000-* \
 	| m32r-* | m32rle-* \
 	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
-	| m88110-* | m88k-* | maxq-* | mcore-* \
+	| m88110-* | m88k-* | mcore-* \
 	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
 	| mips16-* \
 	| mips64-* | mips64el-* \
@@ -328,9 +326,8 @@
 	| mipsisa64sb1-* | mipsisa64sb1el-* \
 	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
 	| mipstx39-* | mipstx39el-* \
-	| mmix-* \
 	| msp430-* \
-	| none-* | np1-* | ns16k-* | ns32k-* \
+	| none-* | np1-* | nv1-* | ns16k-* | ns32k-* \
 	| orion-* \
 	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
 	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
@@ -338,16 +335,15 @@
 	| romp-* | rs6000-* \
 	| sh-* | sh[1234]-* | sh[23]e-* | sh[34]eb-* | shbe-* \
 	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
-	| sparc-* | sparc64-* | sparc64b-* | sparc86x-* | sparclet-* \
-	| sparclite-* \
+	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
 	| sparcv8-* | sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
 	| tahoe-* | thumb-* \
 	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
 	| tron-* \
 	| v850-* | v850e-* | vax-* \
 	| we32k-* \
-	| x86-* | x86_64-* | xps100-* | xscale-* | xscalee[bl]-* \
-	| xstormy16-* | xtensa-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
+	| xtensa-* \
 	| ymp-* \
 	| z8k-*)
 		;;
@@ -449,10 +445,6 @@
 		basic_machine=j90-cray
 		os=-unicos
 		;;
-	craynv)
-		basic_machine=craynv-cray
-		os=-unicosmp
-		;;
 	cr16c)
 		basic_machine=cr16c-unknown
 		os=-elf
@@ -460,9 +452,6 @@
 	crds | unos)
 		basic_machine=m68k-crds
 		;;
-	crisv32 | crisv32-* | etraxfs*)
-		basic_machine=crisv32-axis
-		;;
 	cris | cris-* | etrax*)
 		basic_machine=cris-axis
 		;;
@@ -492,10 +481,6 @@
 		basic_machine=m88k-motorola
 		os=-sysv3
 		;;
-	djgpp)
-		basic_machine=i586-pc
-		os=-msdosdjgpp
-		;;
 	dpx20 | dpx20-*)
 		basic_machine=rs6000-bull
 		os=-bosx
@@ -674,6 +659,10 @@
 	mips3*)
 		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
 		;;
+	mmix*)
+		basic_machine=mmix-knuth
+		os=-mmixware
+		;;
 	monitor)
 		basic_machine=m68k-rom68k
 		os=-coff
@@ -754,6 +743,10 @@
 	np1)
 		basic_machine=np1-gould
 		;;
+	nv1)
+		basic_machine=nv1-cray
+		os=-unicosmp
+		;;
 	nsr-tandem)
 		basic_machine=nsr-tandem
 		;;
@@ -1036,10 +1029,6 @@
 		basic_machine=hppa1.1-winbond
 		os=-proelf
 		;;
-	xbox)
-		basic_machine=i686-pc
-		os=-mingw32
-		;;
 	xps | xps100)
 		basic_machine=xps100-honeywell
 		;;
@@ -1070,9 +1059,6 @@
 	romp)
 		basic_machine=romp-ibm
 		;;
-	mmix)
-		basic_machine=mmix-knuth
-		;;
 	rs6000)
 		basic_machine=rs6000-ibm
 		;;
@@ -1308,9 +1294,6 @@
 	-kaos*)
 		os=-kaos
 		;;
-	-zvmoe)
-		os=-zvmoe
-		;;
 	-none)
 		;;
 	*)
@@ -1391,9 +1374,6 @@
 	*-ibm)
 		os=-aix
 		;;
-    	*-knuth)
-		os=-mmixware
-		;;
 	*-wec)
 		os=-proelf
 		;;

Modified: branches/mloskot-style-refactoring/configure
===================================================================
--- branches/mloskot-style-refactoring/configure	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/configure	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.59 for openspace 0.1.1.
+# Generated by GNU Autoconf 2.59 for openspace 0.2.0.
 #
 # Report bugs to <http://openspace.linux.pl>.
 #
@@ -280,7 +280,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-if test "X${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 if test -z "$ECHO"; then
 if test "X${echo_test_string+set}" != Xset; then
@@ -423,8 +423,8 @@
 # Identity of this package.
 PACKAGE_NAME='openspace'
 PACKAGE_TARNAME='openspace'
-PACKAGE_VERSION='0.1.1'
-PACKAGE_STRING='openspace 0.1.1'
+PACKAGE_VERSION='0.2.0'
+PACKAGE_STRING='openspace 0.2.0'
 PACKAGE_BUGREPORT='http://openspace.linux.pl'
 
 ac_unique_file="src/main.cpp"
@@ -954,7 +954,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures openspace 0.1.1 to adapt to many kinds of systems.
+\`configure' configures openspace 0.2.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1020,7 +1020,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of openspace 0.1.1:";;
+     short | recursive ) echo "Configuration of openspace 0.2.0:";;
    esac
   cat <<\_ACEOF
 
@@ -1152,14 +1152,14 @@
     else
       echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
     fi
-    cd "$ac_popdir"
+    cd $ac_popdir
   done
 fi
 
 test -n "$ac_init_help" && exit 0
 if $ac_init_version; then
   cat <<\_ACEOF
-openspace configure 0.1.1
+openspace configure 0.2.0
 generated by GNU Autoconf 2.59
 
 Copyright (C) 2003 Free Software Foundation, Inc.
@@ -1173,7 +1173,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by openspace $as_me 0.1.1, which was
+It was created by openspace $as_me 0.2.0, which was
 generated by GNU Autoconf 2.59.  Invocation command line was
 
   $ $0 $@
@@ -1811,7 +1811,7 @@
 
 # Define the identity of the package.
  PACKAGE='openspace'
- VERSION='0.1.1'
+ VERSION='0.2.0'
 
 
 cat >>confdefs.h <<_ACEOF
@@ -2284,7 +2284,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -2342,7 +2343,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -2413,7 +2415,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -2457,7 +2460,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3031,7 +3035,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3089,7 +3094,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3205,7 +3211,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3259,7 +3266,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3304,7 +3312,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3348,7 +3357,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -3883,7 +3893,7 @@
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
-  test ! -f $lt_ac_sed && break
+  test ! -f $lt_ac_sed && continue
   cat /dev/null > conftest.in
   lt_ac_count=0
   echo $ECHO_N "0123456789$ECHO_C" >conftest.in
@@ -3908,10 +3918,10 @@
     fi
   done
 done
-SED=$lt_cv_path_SED
 
 fi
 
+SED=$lt_cv_path_SED
 echo "$as_me:$LINENO: result: $SED" >&5
 echo "${ECHO_T}$SED" >&6
 
@@ -4052,6 +4062,15 @@
 *) reload_flag=" $reload_flag" ;;
 esac
 reload_cmds='$LD$reload_flag -o $output$reload_objs'
+case $host_os in
+  darwin*)
+    if test "$GCC" = yes; then
+      reload_cmds='$CC -nostdlib ${wl}-r -o $output$reload_objs'
+    else
+      reload_cmds='$LD$reload_flag -o $output$reload_objs'
+    fi
+    ;;
+esac
 
 echo "$as_me:$LINENO: checking for BSD-compatible nm" >&5
 echo $ECHO_N "checking for BSD-compatible nm... $ECHO_C" >&6
@@ -4138,7 +4157,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-bsdi4*)
+bsdi[45]*)
   lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)'
   lt_cv_file_magic_cmd='/usr/bin/file -L'
   lt_cv_file_magic_test_file=/shlib/libc.so
@@ -4161,13 +4180,13 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-freebsd* | kfreebsd*-gnu)
+freebsd* | kfreebsd*-gnu | dragonfly*)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
       # Let's accept both of them until this is cleared up.
-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD|DragonFly)/i[3-9]86 (compact )?demand paged shared library'
       lt_cv_file_magic_cmd=/usr/bin/file
       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
       ;;
@@ -4214,7 +4233,7 @@
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+netbsd*)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
@@ -4233,12 +4252,10 @@
   ;;
 
 openbsd*)
-  lt_cv_file_magic_cmd=/usr/bin/file
-  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
   if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'
+    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
-    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
+    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   fi
   ;;
 
@@ -4331,7 +4348,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 4334 "configure"' > conftest.$ac_ext
+  echo '#line 4351 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -4412,6 +4429,24 @@
   rm -rf conftest*
   ;;
 
+*-*-linux*)
+  # Test if the compiler is 64bit
+  echo 'int i;' > conftest.$ac_ext
+  lt_cv_cc_64bit_output=no
+  if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+    case `/usr/bin/file conftest.$ac_objext` in
+    *"ELF 64"*)
+      lt_cv_cc_64bit_output=yes
+      ;;
+    esac
+  fi
+  rm -rf conftest*
+  ;;
+
 *-*-sco3.2v5*)
   # On SCO OpenServer 5, we need -belf to get full-featured binaries.
   SAVE_CFLAGS="$CFLAGS"
@@ -4451,7 +4486,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -4526,7 +4562,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -4696,7 +4733,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -4763,7 +4801,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -4878,7 +4917,12 @@
 
 done
 
-ac_ext=cc
+
+
+if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
+    ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
+    (test "X$CXX" != "Xg++"))) ; then
+  ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
@@ -5108,7 +5152,9 @@
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
+fi
 
+
 ac_ext=f
 ac_compile='$F77 -c $FFLAGS conftest.$ac_ext >&5'
 ac_link='$F77 -o conftest$ac_exeext $FFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
@@ -5201,7 +5247,7 @@
 
 
 # Provide some information about the compiler.
-echo "$as_me:5204:" \
+echo "$as_me:5250:" \
      "checking for Fortran 77 compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
 { (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
@@ -5247,7 +5293,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_f77_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -5296,7 +5343,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_f77_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -5389,11 +5437,38 @@
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
- *)
+  netbsd* | freebsd* | openbsd* | darwin* | dragonfly*)
+    # This has been around since 386BSD, at least.  Likely further.
+    if test -x /sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
+    elif test -x /usr/sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
+    else
+      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
+    fi
+    # And add a safety zone
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
+    ;;
+  osf*)
+    # Dr. Hans Ekkehard Plesser reports seeing a kernel panic running configure
+    # due to this test when exec_disable_arg_limit is 1 on Tru64. It is not
+    # nice to cause kernel panics so lets avoid the loop below.
+    # First set a reasonable default.
+    lt_cv_sys_max_cmd_len=16384
+    #
+    if test -x /sbin/sysconfig; then
+      case `/sbin/sysconfig -q proc exec_disable_arg_limit` in
+        *1*) lt_cv_sys_max_cmd_len=-1 ;;
+      esac
+    fi
+    ;;
+  *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
     # we can't tell.
-    while (test "X"`$CONFIG_SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
 	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
 	    lt_cv_sys_max_cmd_len=$new_result &&
@@ -5439,9 +5514,6 @@
 # Regexp to match symbols that can be accessed directly from C.
 sympat='\([_A-Za-z][_A-Za-z0-9]*\)'
 
-# Transform the above into a raw symbol and a C symbol.
-symxfrm='\1 \2\3 \3'
-
 # Transform an extracted symbol line into a proper C declaration
 lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^. .* \(.*\)$/extern int \1;/p'"
 
@@ -5463,6 +5535,13 @@
   lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
   lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
   ;;
+linux*)
+  if test "$host_cpu" = ia64; then
+    symcode='[ABCDGIRSTW]'
+    lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+    lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+  fi
+  ;;
 irix* | nonstopux*)
   symcode='[BCDEGRST]'
   ;;
@@ -5494,8 +5573,11 @@
 # Try without a prefix undercore, then with it.
 for ac_symprfx in "" "_"; do
 
+  # Transform symcode, sympat, and symprfx into a raw symbol and a C symbol.
+  symxfrm="\\1 $ac_symprfx\\2 \\2"
+
   # Write the raw and C identifiers.
-  lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'"
+  lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
 
   # Check to see that the pipe works correctly.
   pipe_works=no
@@ -5657,7 +5739,7 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e s/^X//'
+Xsed='sed -e 1s/^X//'
 sed_quote_subst='s/\([\\"\\`$\\\\]\)/\\\1/g'
 
 # Same as above, but do not quote variable references.
@@ -5962,6 +6044,17 @@
   old_archive_cmds="$old_archive_cmds~\$RANLIB \$oldlib"
 fi
 
+for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
+
+
 # Only perform the check for file, if the check method requires it
 case $deplibs_check_method in
 file_magic*)
@@ -6117,6 +6210,47 @@
 fi;
 test -z "$pic_mode" && pic_mode=default
 
+# Check if we have a version mismatch between libtool.m4 and ltmain.sh.
+#
+# Note:  This should be in AC_LIBTOOL_SETUP, _after_ $ltmain have been defined.
+#        We also should do it _before_ AC_LIBTOOL_LANG_C_CONFIG that actually
+#        calls AC_LIBTOOL_CONFIG and creates libtool.
+#
+echo "$as_me:$LINENO: checking for correct ltmain.sh version" >&5
+echo $ECHO_N "checking for correct ltmain.sh version... $ECHO_C" >&6
+if test -z "$ltmain"; then
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+  echo
+  echo "*** Gentoo sanity check failed! ***"
+  echo "*** \$ltmain is not defined, please check the patch for consistency! ***"
+  echo
+  exit 1
+fi
+gentoo_lt_version="1.5.18"
+gentoo_ltmain_version=`grep '^[:space:]*VERSION=' $ltmain | sed -e 's|^[:space:]*VERSION=||'`
+if test "$gentoo_lt_version" != "$gentoo_ltmain_version"; then
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+  echo
+  echo "*** Gentoo sanity check failed! ***"
+  echo "*** libtool.m4 and ltmain.sh have a version mismatch! ***"
+  echo "*** (libtool.m4 = $gentoo_lt_version, ltmain.sh = $gentoo_ltmain_version) ***"
+  echo
+  echo "Please run:"
+  echo
+  echo "  libtoolize --copy --force"
+  echo
+  echo "if appropriate, please contact the maintainer of this"
+  echo "package (or your distribution) for help."
+  echo
+  exit 1
+else
+  echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
+fi
+
+
 # Use C for the default configuration in the libtool script
 tagname=
 lt_save_CC="$CC"
@@ -6148,6 +6282,20 @@
 compiler=$CC
 
 
+# save warnings/boilerplate of simple test code
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+
+
 #
 # Check for any special shared library compilation flags.
 #
@@ -6189,6 +6337,11 @@
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
+       $echo "X$_lt_linker_boilerplate" | $Xsed > conftest.exp
+       $SED '/^$/d' conftest.err >conftest.er2
+       if diff conftest.exp conftest.er2 >/dev/null; then
+         lt_prog_compiler_static_works=yes
+       fi
      else
        lt_prog_compiler_static_works=yes
      fi
@@ -6233,15 +6386,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6236: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6389: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:6240: \$? = $ac_status" >&5
+   echo "$as_me:6393: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
@@ -6344,6 +6499,16 @@
 	lt_prog_compiler_static='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
+      darwin*)
+        # PIC is the default on this platform
+        # Common symbols not allowed in MH_DYLIB files
+       case $cc_basename in
+         xlc*)
+         lt_prog_compiler_pic='-qnocommon'
+         lt_prog_compiler_wl='-Wl,'
+         ;;
+       esac
+       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -6379,12 +6544,19 @@
       ;;
 
     linux*)
-      case $CC in
+      case $cc_basename in
       icc* | ecc*)
 	lt_prog_compiler_wl='-Wl,'
 	lt_prog_compiler_pic='-KPIC'
 	lt_prog_compiler_static='-static'
         ;;
+      pgcc* | pgf77* | pgf90*)
+        # Portland Group compilers (*not* the Pentium gcc compiler,
+	# which looks to be a dead project)
+	lt_prog_compiler_wl='-Wl,'
+	lt_prog_compiler_pic='-fpic'
+	lt_prog_compiler_static='-static'
+        ;;
       ccc*)
         lt_prog_compiler_wl='-Wl,'
         # All Alpha code is PIC.
@@ -6405,9 +6577,14 @@
       ;;
 
     solaris*)
-      lt_prog_compiler_wl='-Wl,'
       lt_prog_compiler_pic='-KPIC'
       lt_prog_compiler_static='-Bstatic'
+      case $cc_basename in
+      f77* | f90* | f95*)
+	lt_prog_compiler_wl='-Qoption ld ';;
+      *)
+	lt_prog_compiler_wl='-Wl,';;
+      esac
       ;;
 
     sunos4*)
@@ -6429,6 +6606,11 @@
       fi
       ;;
 
+    unicos*)
+      lt_prog_compiler_wl='-Wl,'
+      lt_prog_compiler_can_build_shared=no
+      ;;
+
     uts4*)
       lt_prog_compiler_pic='-pic'
       lt_prog_compiler_static='-Bstatic'
@@ -6466,15 +6648,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6469: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6651: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:6473: \$? = $ac_status" >&5
+   echo "$as_me:6655: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works=yes
      fi
    fi
@@ -6526,16 +6710,18 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6529: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6713: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:6533: \$? = $ac_status" >&5
+   echo "$as_me:6717: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     if test ! -s out/conftest.err; then
+     $echo "X$_lt_compiler_boilerplate" | $Xsed > out/conftest.exp
+     $SED '/^$/d' out/conftest.err >out/conftest.er2
+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
      fi
    fi
@@ -6615,6 +6801,16 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
+  # Just being paranoid about ensuring that cc_basename is set.
+  for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -6635,6 +6831,27 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
+    # Set some defaults for GNU ld with shared library support. These
+    # are reset later if shared libraries are not supported. Putting them
+    # here allows them to be overridden if necessary.
+    runpath_var=LD_RUN_PATH
+    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
+    export_dynamic_flag_spec='${wl}--export-dynamic'
+    # ancient GNU ld didn't support --whole-archive et. al.
+    if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
+	whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+  	whole_archive_flag_spec=
+    fi
+    supports_anon_versioning=no
+    case `$LD -v 2>/dev/null` in
+      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+      *\ 2.11.*) ;; # other 2.11 versions
+      *) supports_anon_versioning=yes ;;
+    esac
+
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -6685,7 +6902,7 @@
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -6703,7 +6920,38 @@
       fi
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    linux*)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+	tmp_addflag=
+	case $cc_basename,$host_cpu in
+	pgcc*)				# Portland Group C compiler
+	  whole_archive_flag_spec='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag'
+	  ;;
+	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
+	  whole_archive_flag_spec='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag -Mnomain' ;;
+	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
+	  tmp_addflag=' -i_dynamic' ;;
+	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
+	  tmp_addflag=' -i_dynamic -nofor_main' ;;
+	ifc* | ifort*)			# Intel Fortran compiler
+	  tmp_addflag=' -nofor_main' ;;
+	esac
+	archive_cmds='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+
+	if test $supports_anon_versioning = yes; then
+	  archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+  cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+  $echo "local: *; };" >> $output_objdir/$libname.ver~
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	fi
+      else
+	ld_shlibs=no
+      fi
+      ;;
+
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -6741,32 +6989,6 @@
       hardcode_shlibpath_var=no
       ;;
 
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds="$tmp_archive_cmds"
-      fi
-      link_all_deplibs=no
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
     *)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -6777,16 +6999,11 @@
       ;;
     esac
 
-    if test "$ld_shlibs" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec=
-      fi
+    if test "$ld_shlibs" = no; then
+      runpath_var=
+      hardcode_libdir_flag_spec=
+      export_dynamic_flag_spec=
+      whole_archive_flag_spec=
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -6850,7 +7067,7 @@
       link_all_deplibs=yes
 
       if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
+	case $host_os in aix4.[012]|aix4.[012].*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -6871,6 +7088,9 @@
 	  fi
 	esac
 	shared_flag='-shared'
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag="$shared_flag "'${wl}-G'
+	fi
       else
 	# not using gcc
 	if test "$host_cpu" = ia64; then
@@ -6918,7 +7138,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -6978,7 +7199,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -7029,7 +7251,7 @@
       ld_shlibs=no
       ;;
 
-    bsdi4*)
+    bsdi[45]*)
       export_dynamic_flag_spec=-rdynamic
       ;;
 
@@ -7055,52 +7277,52 @@
       ;;
 
     darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc=no
       case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
+        rhapsody* | darwin1.[012])
+         allow_undefined_flag='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           allow_undefined_flag='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[012])
+               allow_undefined_flag='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               allow_undefined_flag='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
       esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      archive_cmds_need_lc=no
       hardcode_direct=no
       hardcode_automatic=yes
       hardcode_shlibpath_var=unsupported
-      whole_archive_flag_spec='-all_load $convenience'
+      whole_archive_flag_spec=''
       link_all_deplibs=yes
+    if test "$GCC" = yes ; then
+    	output_verbose_link_cmd='echo'
+        archive_cmds='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+      archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      ld_shlibs=no
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+         module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+         archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         ld_shlibs=no
+          ;;
+      esac
     fi
       ;;
 
@@ -7134,7 +7356,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
+    freebsd* | kfreebsd*-gnu | dragonfly*)
       archive_cmds='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec='-R$libdir'
       hardcode_direct=yes
@@ -7221,7 +7443,7 @@
       link_all_deplibs=yes
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -7245,6 +7467,7 @@
       hardcode_shlibpath_var=no
       if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec='${wl}-E'
       else
@@ -7290,7 +7513,7 @@
 	allow_undefined_flag=' -expect_unresolved \*'
 	archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec='-rpath $libdir'
@@ -7309,10 +7532,12 @@
     solaris*)
       no_undefined_flag=' -z text'
       if test "$GCC" = yes; then
+	wlarc='${wl}'
 	archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
+	wlarc=''
 	archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -7321,8 +7546,18 @@
       hardcode_shlibpath_var=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+      *)
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
+ 	# Supported since Solaris 2.6 (maybe 2.5.1?)
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs=yes
       ;;
@@ -7596,7 +7831,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi4*)
+bsdi[45]*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -7654,11 +7889,35 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
+  linux*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      supports_anon_versioning=no
+      case `$LD -v 2>/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+$echo "local: *; };" >> $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        $archive_expsym_cmds="$archive_cmds"
+      fi
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -7712,7 +7971,9 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd*)
+freebsd* | dragonfly*)
+  # DragonFly does not have aout.  When/if they implement a new
+  # versioning mechanism, adjust this.
   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -7731,7 +7992,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.01* | freebsdelf3.01*)
+  freebsd3.[01]* | freebsdelf3.[01]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -7857,10 +8118,17 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
+  case $host_cpu:$lt_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+    sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /usr/X11R6/lib64"
+    sys_lib_search_path_spec="/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64"
+    ;;
+  esac
+
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -7868,18 +8136,30 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
-  ;;
 
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
+  # Find out which ABI we are using (multilib Linux x86_64 hack).
+  libsuff=
+  case "$host_cpu" in
+  x86_64*)
+    echo '#line 8144 "configure"' > conftest.$ac_ext
+    if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *64-bit*)
+        libsuff=64
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+    ;;
+  *)
+    ;;
+  esac
+  sys_lib_dlsearch_path_spec="/lib${libsuff} /usr/lib${libsuff}"
+  sys_lib_search_path_spec="/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}"
   ;;
 
 knetbsd*-gnu)
@@ -7932,7 +8212,11 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
+  case $host_os in
+    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
+    *)                         need_version=no  ;;
+  esac
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -8054,8 +8338,8 @@
 echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action=
 if test -n "$hardcode_libdir_flag_spec" || \
-   test -n "$runpath_var " || \
-   test "X$hardcode_automatic"="Xyes" ; then
+   test -n "$runpath_var" || \
+   test "X$hardcode_automatic" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
   if test "$hardcode_direct" != no &&
@@ -8181,7 +8465,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8284,7 +8569,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8349,7 +8635,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8442,7 +8729,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8507,7 +8795,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8573,7 +8862,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8639,7 +8929,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -8714,7 +9005,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 8717 "configure"
+#line 9008 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -8812,7 +9103,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 8815 "configure"
+#line 9106 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -8941,43 +9232,6 @@
   if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
     test "$enable_shared" = yes && enable_static=no
   fi
-  ;;
-  darwin* | rhapsody*)
-  if test "$GCC" = yes; then
-    archive_cmds_need_lc=no
-    case "$host_os" in
-    rhapsody* | darwin1.[012])
-      allow_undefined_flag='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-      ;;
-    esac
-    output_verbose_link_cmd='echo'
-    archive_cmds='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'
-    module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    hardcode_direct=no
-    hardcode_automatic=yes
-    hardcode_shlibpath_var=unsupported
-    whole_archive_flag_spec='-all_load $convenience'
-    link_all_deplibs=yes
-  else
-    ld_shlibs=no
-  fi
     ;;
 esac
 echo "$as_me:$LINENO: result: $enable_shared" >&5
@@ -9107,7 +9361,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -9118,11 +9372,11 @@
 SED=$lt_SED
 
 # Sed that helps us avoid accidentally triggering echo(1) options like -n.
-Xsed="$SED -e s/^X//"
+Xsed="$SED -e 1s/^X//"
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-if test "X\${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 # The names of the tagged configurations supported by this script.
 available_tags=
@@ -9152,7 +9406,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -9228,7 +9488,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -9523,7 +9783,9 @@
 
       case $tagname in
       CXX)
-	if test -n "$CXX" && test "X$CXX" != "Xno"; then
+	if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
+	    ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
+	    (test "X$CXX" != "Xg++"))) ; then
 	  ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
@@ -9581,6 +9843,20 @@
 compiler=$CC
 
 
+# save warnings/boilerplate of simple test code
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+
+
 # Allow CC to be a program name with arguments.
 lt_save_CC=$CC
 lt_save_LD=$LD
@@ -9602,8 +9878,17 @@
 CC=${CXX-"c++"}
 compiler=$CC
 compiler_CXX=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
+for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
+
 # We don't want -fno-exception wen compiling C++ code, so set the
 # no_builtin_flag separately
 if test "$GXX" = yes; then
@@ -9816,7 +10101,7 @@
     link_all_deplibs_CXX=yes
 
     if test "$GXX" = yes; then
-      case $host_os in aix4.012|aix4.012.*)
+      case $host_os in aix4.[012]|aix4.[012].*)
       # We only want to do this on AIX 4.2 and lower, the check
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
@@ -9837,6 +10122,9 @@
 	fi
       esac
       shared_flag='-shared'
+      if test "$aix_use_runtimelinking" = yes; then
+	shared_flag="$shared_flag "'${wl}-G'
+      fi
     else
       # not using gcc
       if test "$host_cpu" = ia64; then
@@ -9884,7 +10172,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -9945,7 +10234,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -9996,6 +10286,7 @@
     esac
     ;;
 
+
   cygwin* | mingw* | pw32*)
     # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, CXX) is actually meaningless,
     # as there is no search path for DLLs.
@@ -10019,65 +10310,76 @@
       ld_shlibs_CXX=no
     fi
   ;;
+      darwin* | rhapsody*)
+        case "$host_os" in
+        rhapsody* | darwin1.[012])
+         allow_undefined_flag_CXX='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           allow_undefined_flag_CXX='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[012])
+               allow_undefined_flag_CXX='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               allow_undefined_flag_CXX='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
+        esac
+      archive_cmds_need_lc_CXX=no
+      hardcode_direct_CXX=no
+      hardcode_automatic_CXX=yes
+      hardcode_shlibpath_var_CXX=unsupported
+      whole_archive_flag_spec_CXX=''
+      link_all_deplibs_CXX=yes
 
-  darwin* | rhapsody*)
-  if test "$GXX" = yes; then
-    archive_cmds_need_lc_CXX=no
-    case "$host_os" in
-    rhapsody* | darwin1.[012])
-      allow_undefined_flag_CXX='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
+    if test "$GXX" = yes ; then
+      lt_int_apple_cc_single_mod=no
+      output_verbose_link_cmd='echo'
+      if $CC -dumpspecs 2>&1 | $EGREP 'single_module' >/dev/null ; then
+       lt_int_apple_cc_single_mod=yes
+      fi
+      if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
+       archive_cmds_CXX='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
       else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_CXX='-undefined dynamic_lookup'
-            ;;
-        esac
+          archive_cmds_CXX='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+        fi
+        module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+        # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+          if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
+            archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          else
+            archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          fi
+            module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      else
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+          module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+          archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         ld_shlibs_CXX=no
+          ;;
+      esac
       fi
-      ;;
-    esac
-    lt_int_apple_cc_single_mod=no
-    output_verbose_link_cmd='echo'
-    if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-      lt_int_apple_cc_single_mod=yes
-    fi
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      archive_cmds_CXX='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    else
-      archive_cmds_CXX='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    fi
-    module_cmds_CXX='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+        ;;
 
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    else
-      archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    fi
-    module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    hardcode_direct_CXX=no
-    hardcode_automatic_CXX=yes
-    hardcode_shlibpath_var_CXX=unsupported
-    whole_archive_flag_spec_CXX='-all_load $convenience'
-    link_all_deplibs_CXX=yes
-  else
-    ld_shlibs_CXX=no
-  fi
-    ;;
-
   dgux*)
     case $cc_basename in
-      ec++)
+      ec++*)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      ghcx)
+      ghcx*)
 	# Green Hills C++ Compiler
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -10088,14 +10390,14 @@
 	;;
     esac
     ;;
-  freebsd12*)
+  freebsd[12]*)
     # C++ shared libraries reported to be fairly broken before switch to ELF
     ld_shlibs_CXX=no
     ;;
   freebsd-elf*)
     archive_cmds_need_lc_CXX=no
     ;;
-  freebsd* | kfreebsd*-gnu)
+  freebsd* | kfreebsd*-gnu | dragonfly*)
     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
     # conventions
     ld_shlibs_CXX=yes
@@ -10112,11 +10414,11 @@
 				# location of the library.
 
     case $cc_basename in
-    CC)
+    CC*)
       # FIXME: insert proper C++ library support
       ld_shlibs_CXX=no
       ;;
-    aCC)
+    aCC*)
       archive_cmds_CXX='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
@@ -10126,7 +10428,7 @@
       # explicitly linking system object files so we need to strip them
       # from the output so that they don't get included in the library
       # dependencies.
-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
+      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "[-]L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
       ;;
     *)
       if test "$GXX" = yes; then
@@ -10177,11 +10479,11 @@
     esac
 
     case $cc_basename in
-      CC)
+      CC*)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      aCC)
+      aCC*)
 	case "$host_cpu" in
 	hppa*64*|ia64*)
 	  archive_cmds_CXX='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
@@ -10221,9 +10523,9 @@
     ;;
   irix5* | irix6*)
     case $cc_basename in
-      CC)
+      CC*)
 	# SGI C++
-	archive_cmds_CXX='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 
 	# Archives containing C++ object files must be created using
 	# "CC -ar", where "CC" is the IRIX C++ compiler.  This is
@@ -10234,7 +10536,7 @@
       *)
 	if test "$GXX" = yes; then
 	  if test "$with_gnu_ld" = no; then
-	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 	  else
 	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` -o $lib'
 	  fi
@@ -10247,7 +10549,7 @@
     ;;
   linux*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10272,17 +10574,41 @@
 	# "CC -Bstatic", where "CC" is the KAI C++ compiler.
 	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
 	;;
-      icpc)
+      icpc*)
 	# Intel C++
 	with_gnu_ld=yes
+	# version 8.0 and above of icpc choke on multiply defined symbols
+	# if we add $predep_objects and $postdep_objects, however 7.1 and
+	# earlier do not add the objects themselves.
+	case `$CC -V 2>&1` in
+	*"Version 7."*)
+  	  archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
+  	  archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+	  ;;
+	*)  # Version 8.0 or newer
+	  tmp_idyn=
+	  case $host_cpu in
+	    ia64*) tmp_idyn=' -i_dynamic';;
+	  esac
+  	  archive_cmds_CXX='$CC -shared'"$tmp_idyn"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	  archive_expsym_cmds_CXX='$CC -shared'"$tmp_idyn"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+	  ;;
+	esac
 	archive_cmds_need_lc_CXX=no
-	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
 	hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
 	whole_archive_flag_spec_CXX='${wl}--whole-archive$convenience ${wl}--no-whole-archive'
 	;;
-      cxx)
+      pgCC*)
+        # Portland Group C++ compiler
+	archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname -o $lib'
+  	archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname ${wl}-retain-symbols-file ${wl}$export_symbols -o $lib'
+
+	hardcode_libdir_flag_spec_CXX='${wl}--rpath ${wl}$libdir'
+	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
+	whole_archive_flag_spec_CXX='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+        ;;
+      cxx*)
 	# Compaq C++
 	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'
@@ -10313,7 +10639,7 @@
     ;;
   mvs*)
     case $cc_basename in
-      cxx)
+      cxx*)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
@@ -10323,7 +10649,7 @@
 	;;
     esac
     ;;
-  netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+  netbsd*)
     if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
       archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -10334,9 +10660,25 @@
     # Workaround some broken pre-1.5 toolchains
     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
     ;;
+  openbsd2*)
+    # C++ shared libraries are fairly broken
+    ld_shlibs_CXX=no
+    ;;
+  openbsd*)
+    hardcode_direct_CXX=yes
+    hardcode_shlibpath_var_CXX=no
+    archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      export_dynamic_flag_spec_CXX='${wl}-E'
+      whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+    fi
+    output_verbose_link_cmd='echo'
+    ;;
   osf3*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10352,14 +10694,14 @@
 	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
 
 	;;
-      RCC)
+      RCC*)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      cxx)
+      cxx*)
 	allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n "$verstring" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n "$verstring" && echo ${wl}-set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 
 	hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	hardcode_libdir_separator_CXX=:
@@ -10377,7 +10719,7 @@
       *)
 	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	  archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	  archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	  hardcode_libdir_separator_CXX=:
@@ -10396,7 +10738,7 @@
     ;;
   osf4* | osf5*)
     case $cc_basename in
-      KCC)
+      KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
 	# KCC will only create a shared library if the output file
@@ -10411,17 +10753,17 @@
 	# the KAI C++ compiler.
 	old_archive_cmds_CXX='$CC -o $oldlib $oldobjs'
 	;;
-      RCC)
+      RCC*)
 	# Rational C++ 2.4.1
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      cxx)
+      cxx*)
 	allow_undefined_flag_CXX=' -expect_unresolved \*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
+	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds_CXX='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done~
 	  echo "-hidden">> $lib.exp~
-	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n "$verstring" && echo -set_version	$verstring` -update_registry $objdir/so_locations -o $lib~
+	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n "$verstring" && echo -set_version	$verstring` -update_registry ${output_objdir}/so_locations -o $lib~
 	  $rm $lib.exp'
 
 	hardcode_libdir_flag_spec_CXX='-rpath $libdir'
@@ -10440,7 +10782,7 @@
       *)
 	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	 archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
+	 archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
 	  hardcode_libdir_separator_CXX=:
@@ -10464,7 +10806,7 @@
   sco*)
     archive_cmds_need_lc_CXX=no
     case $cc_basename in
-      CC)
+      CC*)
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
@@ -10476,12 +10818,12 @@
     ;;
   sunos4*)
     case $cc_basename in
-      CC)
+      CC*)
 	# Sun C++ 4.x
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
 	;;
-      lcc)
+      lcc*)
 	# Lucid
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -10494,7 +10836,7 @@
     ;;
   solaris*)
     case $cc_basename in
-      CC)
+      CC*)
 	# Sun C++ 4.2, 5.x and Centerline C++
 	no_undefined_flag_CXX=' -zdefs'
 	archive_cmds_CXX='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
@@ -10504,13 +10846,17 @@
 	hardcode_libdir_flag_spec_CXX='-R$libdir'
 	hardcode_shlibpath_var_CXX=no
 	case $host_os in
-	  solaris2.0-5 | solaris2.0-5.*) ;;
+	  solaris2.[0-5] | solaris2.[0-5].*) ;;
 	  *)
 	    # The C++ compiler is used as linker so we must use $wl
 	    # flag to pass the commands to the underlying system
-	    # linker.
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
+	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	link_all_deplibs_CXX=yes
@@ -10531,7 +10877,7 @@
 	# in the archive.
 	old_archive_cmds_CXX='$CC -xar -o $oldlib $oldobjs'
 	;;
-      gcx)
+      gcx*)
 	# Green Hills C++ Compiler
 	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 
@@ -10574,7 +10920,7 @@
     ;;
   tandem*)
     case $cc_basename in
-      NCC)
+      NCC*)
 	# NonStop-UX NCC 3.20
 	# FIXME: insert proper C++ library support
 	ld_shlibs_CXX=no
@@ -10783,18 +11129,28 @@
 	;;
       chorus*)
 	case $cc_basename in
-	cxch68)
+	cxch68*)
 	  # Green Hills C++ Compiler
 	  # _LT_AC_TAGVAR(lt_prog_compiler_static, CXX)="--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a"
 	  ;;
 	esac
 	;;
+       darwin*)
+         # PIC is the default on this platform
+         # Common symbols not allowed in MH_DYLIB files
+         case $cc_basename in
+           xlc*)
+           lt_prog_compiler_pic_CXX='-qnocommon'
+           lt_prog_compiler_wl_CXX='-Wl,'
+           ;;
+         esac
+       ;;
       dgux*)
 	case $cc_basename in
-	  ec++)
+	  ec++*)
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    ;;
-	  ghcx)
+	  ghcx*)
 	    # Green Hills C++ Compiler
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
@@ -10802,19 +11158,19 @@
 	    ;;
 	esac
 	;;
-      freebsd* | kfreebsd*-gnu)
+      freebsd* | kfreebsd*-gnu | dragonfly*)
 	# FreeBSD uses GNU C++
 	;;
       hpux9* | hpux10* | hpux11*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
 	    if test "$host_cpu" != ia64; then
 	      lt_prog_compiler_pic_CXX='+Z'
 	    fi
 	    ;;
-	  aCC)
+	  aCC*)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
 	    case "$host_cpu" in
@@ -10832,7 +11188,7 @@
 	;;
       irix5* | irix6* | nonstopux*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_static_CXX='-non_shared'
 	    # CC pic flag -KPIC is the default.
@@ -10843,18 +11199,24 @@
 	;;
       linux*)
 	case $cc_basename in
-	  KCC)
+	  KCC*)
 	    # KAI C++ Compiler
 	    lt_prog_compiler_wl_CXX='--backend -Wl,'
 	    lt_prog_compiler_pic_CXX='-fPIC'
 	    ;;
-	  icpc)
+	  icpc* | ecpc*)
 	    # Intel C++
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    lt_prog_compiler_static_CXX='-static'
 	    ;;
-	  cxx)
+	  pgCC*)
+	    # Portland Group C++ compiler.
+	    lt_prog_compiler_wl_CXX='-Wl,'
+	    lt_prog_compiler_pic_CXX='-fpic'
+	    lt_prog_compiler_static_CXX='-static'
+	    ;;
+	  cxx*)
 	    # Compaq C++
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
@@ -10871,25 +11233,25 @@
 	;;
       mvs*)
 	case $cc_basename in
-	  cxx)
+	  cxx*)
 	    lt_prog_compiler_pic_CXX='-W c,exportall'
 	    ;;
 	  *)
 	    ;;
 	esac
 	;;
-      netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+      netbsd*)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
-	  KCC)
+	  KCC*)
 	    lt_prog_compiler_wl_CXX='--backend -Wl,'
 	    ;;
-	  RCC)
+	  RCC*)
 	    # Rational C++ 2.4.1
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
-	  cxx)
+	  cxx*)
 	    # Digital/Compaq C++
 	    lt_prog_compiler_wl_CXX='-Wl,'
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
@@ -10905,7 +11267,7 @@
 	;;
       sco*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    lt_prog_compiler_pic_CXX='-fPIC'
 	    ;;
 	  *)
@@ -10914,13 +11276,13 @@
 	;;
       solaris*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    # Sun C++ 4.2, 5.x and Centerline C++
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    lt_prog_compiler_static_CXX='-Bstatic'
 	    lt_prog_compiler_wl_CXX='-Qoption ld '
 	    ;;
-	  gcx)
+	  gcx*)
 	    # Green Hills C++ Compiler
 	    lt_prog_compiler_pic_CXX='-PIC'
 	    ;;
@@ -10930,12 +11292,12 @@
 	;;
       sunos4*)
 	case $cc_basename in
-	  CC)
+	  CC*)
 	    # Sun C++ 4.x
 	    lt_prog_compiler_pic_CXX='-pic'
 	    lt_prog_compiler_static_CXX='-Bstatic'
 	    ;;
-	  lcc)
+	  lcc*)
 	    # Lucid
 	    lt_prog_compiler_pic_CXX='-pic'
 	    ;;
@@ -10945,7 +11307,7 @@
 	;;
       tandem*)
 	case $cc_basename in
-	  NCC)
+	  NCC*)
 	    # NonStop-UX NCC 3.20
 	    lt_prog_compiler_pic_CXX='-KPIC'
 	    ;;
@@ -10989,15 +11351,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:10992: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:11354: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:10996: \$? = $ac_status" >&5
+   echo "$as_me:11358: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_CXX=yes
      fi
    fi
@@ -11049,16 +11413,18 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:11052: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:11416: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:11056: \$? = $ac_status" >&5
+   echo "$as_me:11420: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     if test ! -s out/conftest.err; then
+     $echo "X$_lt_compiler_boilerplate" | $Xsed > out/conftest.exp
+     $SED '/^$/d' out/conftest.err >out/conftest.er2
+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
      fi
    fi
@@ -11117,11 +11483,8 @@
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([^ ]*\) [^ ]*/\1 DATA/;/^I /d;/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
-  linux*)
-    link_all_deplibs_CXX=no
-  ;;
   *)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
@@ -11300,7 +11663,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi4*)
+bsdi[45]*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -11358,11 +11721,35 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
+  linux*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      supports_anon_versioning=no
+      case `$LD -v 2>/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+$echo "local: *; };" >> $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        $archive_expsym_cmds="$archive_cmds"
+      fi
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -11416,7 +11803,9 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd*)
+freebsd* | dragonfly*)
+  # DragonFly does not have aout.  When/if they implement a new
+  # versioning mechanism, adjust this.
   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -11435,7 +11824,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.01* | freebsdelf3.01*)
+  freebsd3.[01]* | freebsdelf3.[01]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -11561,10 +11950,17 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
+  case $host_cpu:$lt_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+    sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /usr/X11R6/lib64"
+    sys_lib_search_path_spec="/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64"
+    ;;
+  esac
+
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -11572,18 +11968,30 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
-  ;;
 
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
+  # Find out which ABI we are using (multilib Linux x86_64 hack).
+  libsuff=
+  case "$host_cpu" in
+  x86_64*)
+    echo '#line 11976 "configure"' > conftest.$ac_ext
+    if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *64-bit*)
+        libsuff=64
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+    ;;
+  *)
+    ;;
+  esac
+  sys_lib_dlsearch_path_spec="/lib${libsuff} /usr/lib${libsuff}"
+  sys_lib_search_path_spec="/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}"
   ;;
 
 knetbsd*-gnu)
@@ -11636,7 +12044,11 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
+  case $host_os in
+    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
+    *)                         need_version=no  ;;
+  esac
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -11758,8 +12170,8 @@
 echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_CXX=
 if test -n "$hardcode_libdir_flag_spec_CXX" || \
-   test -n "$runpath_var CXX" || \
-   test "X$hardcode_automatic_CXX"="Xyes" ; then
+   test -n "$runpath_var_CXX" || \
+   test "X$hardcode_automatic_CXX" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
   if test "$hardcode_direct_CXX" != no &&
@@ -11885,7 +12297,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -11988,7 +12401,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12053,7 +12467,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12146,7 +12561,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12211,7 +12627,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12277,7 +12694,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12343,7 +12761,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -12418,7 +12837,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 12421 "configure"
+#line 12840 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12516,7 +12935,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 12519 "configure"
+#line 12938 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12734,7 +13153,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -12810,7 +13235,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_CXX
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -13091,13 +13516,36 @@
 compiler=$CC
 
 
+# save warnings/boilerplate of simple test code
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${F77-"f77"}
 compiler=$CC
 compiler_F77=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
+for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
+
 echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
 echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6
 echo "$as_me:$LINENO: result: $can_build_shared" >&5
@@ -13118,7 +13566,9 @@
   fi
   ;;
 aix4* | aix5*)
-  test "$enable_shared" = yes && enable_static=no
+  if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
+    test "$enable_shared" = yes && enable_static=no
+  fi
   ;;
 esac
 echo "$as_me:$LINENO: result: $enable_shared" >&5
@@ -13221,6 +13671,16 @@
 	lt_prog_compiler_static_F77='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
+      darwin*)
+        # PIC is the default on this platform
+        # Common symbols not allowed in MH_DYLIB files
+       case $cc_basename in
+         xlc*)
+         lt_prog_compiler_pic_F77='-qnocommon'
+         lt_prog_compiler_wl_F77='-Wl,'
+         ;;
+       esac
+       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -13256,12 +13716,19 @@
       ;;
 
     linux*)
-      case $CC in
+      case $cc_basename in
       icc* | ecc*)
 	lt_prog_compiler_wl_F77='-Wl,'
 	lt_prog_compiler_pic_F77='-KPIC'
 	lt_prog_compiler_static_F77='-static'
         ;;
+      pgcc* | pgf77* | pgf90*)
+        # Portland Group compilers (*not* the Pentium gcc compiler,
+	# which looks to be a dead project)
+	lt_prog_compiler_wl_F77='-Wl,'
+	lt_prog_compiler_pic_F77='-fpic'
+	lt_prog_compiler_static_F77='-static'
+        ;;
       ccc*)
         lt_prog_compiler_wl_F77='-Wl,'
         # All Alpha code is PIC.
@@ -13282,9 +13749,14 @@
       ;;
 
     solaris*)
-      lt_prog_compiler_wl_F77='-Wl,'
       lt_prog_compiler_pic_F77='-KPIC'
       lt_prog_compiler_static_F77='-Bstatic'
+      case $cc_basename in
+      f77* | f90* | f95*)
+	lt_prog_compiler_wl_F77='-Qoption ld ';;
+      *)
+	lt_prog_compiler_wl_F77='-Wl,';;
+      esac
       ;;
 
     sunos4*)
@@ -13306,6 +13778,11 @@
       fi
       ;;
 
+    unicos*)
+      lt_prog_compiler_wl_F77='-Wl,'
+      lt_prog_compiler_can_build_shared_F77=no
+      ;;
+
     uts4*)
       lt_prog_compiler_pic_F77='-pic'
       lt_prog_compiler_static_F77='-Bstatic'
@@ -13343,15 +13820,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13346: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13823: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:13350: \$? = $ac_status" >&5
+   echo "$as_me:13827: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_F77=yes
      fi
    fi
@@ -13403,16 +13882,18 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13406: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13885: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:13410: \$? = $ac_status" >&5
+   echo "$as_me:13889: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     if test ! -s out/conftest.err; then
+     $echo "X$_lt_compiler_boilerplate" | $Xsed > out/conftest.exp
+     $SED '/^$/d' out/conftest.err >out/conftest.er2
+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_F77=yes
      fi
    fi
@@ -13492,6 +13973,16 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
+  # Just being paranoid about ensuring that cc_basename is set.
+  for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -13512,6 +14003,27 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
+    # Set some defaults for GNU ld with shared library support. These
+    # are reset later if shared libraries are not supported. Putting them
+    # here allows them to be overridden if necessary.
+    runpath_var=LD_RUN_PATH
+    hardcode_libdir_flag_spec_F77='${wl}--rpath ${wl}$libdir'
+    export_dynamic_flag_spec_F77='${wl}--export-dynamic'
+    # ancient GNU ld didn't support --whole-archive et. al.
+    if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
+	whole_archive_flag_spec_F77="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+  	whole_archive_flag_spec_F77=
+    fi
+    supports_anon_versioning=no
+    case `$LD -v 2>/dev/null` in
+      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+      *\ 2.11.*) ;; # other 2.11 versions
+      *) supports_anon_versioning=yes ;;
+    esac
+
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -13562,7 +14074,7 @@
       allow_undefined_flag_F77=unsupported
       always_export_symbols_F77=no
       enable_shared_with_static_runtimes_F77=yes
-      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -13576,11 +14088,42 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	ld_shlibs=no
+	ld_shlibs_F77=no
       fi
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    linux*)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+	tmp_addflag=
+	case $cc_basename,$host_cpu in
+	pgcc*)				# Portland Group C compiler
+	  whole_archive_flag_spec_F77='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag'
+	  ;;
+	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
+	  whole_archive_flag_spec_F77='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag -Mnomain' ;;
+	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
+	  tmp_addflag=' -i_dynamic' ;;
+	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
+	  tmp_addflag=' -i_dynamic -nofor_main' ;;
+	ifc* | ifort*)			# Intel Fortran compiler
+	  tmp_addflag=' -nofor_main' ;;
+	esac
+	archive_cmds_F77='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+
+	if test $supports_anon_versioning = yes; then
+	  archive_expsym_cmds_F77='$echo "{ global:" > $output_objdir/$libname.ver~
+  cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+  $echo "local: *; };" >> $output_objdir/$libname.ver~
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	fi
+      else
+	ld_shlibs_F77=no
+      fi
+      ;;
+
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_F77='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -13618,32 +14161,6 @@
       hardcode_shlibpath_var_F77=no
       ;;
 
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds_F77="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds_F77='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds_F77="$tmp_archive_cmds"
-      fi
-      link_all_deplibs_F77=no
-    else
-      ld_shlibs_F77=no
-    fi
-    ;;
-
     *)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -13654,16 +14171,11 @@
       ;;
     esac
 
-    if test "$ld_shlibs_F77" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec_F77='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec_F77='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec_F77="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_F77=
-      fi
+    if test "$ld_shlibs_F77" = no; then
+      runpath_var=
+      hardcode_libdir_flag_spec_F77=
+      export_dynamic_flag_spec_F77=
+      whole_archive_flag_spec_F77=
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -13727,7 +14239,7 @@
       link_all_deplibs_F77=yes
 
       if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
+	case $host_os in aix4.[012]|aix4.[012].*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -13748,6 +14260,9 @@
 	  fi
 	esac
 	shared_flag='-shared'
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag="$shared_flag "'${wl}-G'
+	fi
       else
 	# not using gcc
 	if test "$host_cpu" = ia64; then
@@ -13785,7 +14300,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_f77_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -13835,7 +14351,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_f77_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -13886,7 +14403,7 @@
       ld_shlibs_F77=no
       ;;
 
-    bsdi4*)
+    bsdi[45]*)
       export_dynamic_flag_spec_F77=-rdynamic
       ;;
 
@@ -13907,57 +14424,57 @@
       old_archive_From_new_cmds_F77='true'
       # FIXME: Should let the user specify the lib program.
       old_archive_cmds_F77='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
+      fix_srcfile_path_F77='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_F77=yes
       ;;
 
     darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc_F77=no
       case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag_F77='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_F77='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_F77='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_F77='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
+        rhapsody* | darwin1.[012])
+         allow_undefined_flag_F77='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           allow_undefined_flag_F77='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[012])
+               allow_undefined_flag_F77='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               allow_undefined_flag_F77='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
       esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds_F77='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds_F77='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds_F77='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      archive_cmds_need_lc_F77=no
       hardcode_direct_F77=no
       hardcode_automatic_F77=yes
       hardcode_shlibpath_var_F77=unsupported
-      whole_archive_flag_spec_F77='-all_load $convenience'
+      whole_archive_flag_spec_F77=''
       link_all_deplibs_F77=yes
+    if test "$GCC" = yes ; then
+    	output_verbose_link_cmd='echo'
+        archive_cmds_F77='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+      archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      ld_shlibs_F77=no
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+         module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+         archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         ld_shlibs_F77=no
+          ;;
+      esac
     fi
       ;;
 
@@ -13991,7 +14508,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
+    freebsd* | kfreebsd*-gnu | dragonfly*)
       archive_cmds_F77='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec_F77='-R$libdir'
       hardcode_direct_F77=yes
@@ -14078,7 +14595,7 @@
       link_all_deplibs_F77=yes
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -14102,6 +14619,7 @@
       hardcode_shlibpath_var_F77=no
       if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_F77='${wl}-E'
       else
@@ -14147,7 +14665,7 @@
 	allow_undefined_flag_F77=' -expect_unresolved \*'
 	archive_cmds_F77='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds_F77='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec_F77='-rpath $libdir'
@@ -14166,10 +14684,12 @@
     solaris*)
       no_undefined_flag_F77=' -z text'
       if test "$GCC" = yes; then
+	wlarc='${wl}'
 	archive_cmds_F77='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds_F77='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
+	wlarc=''
 	archive_cmds_F77='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds_F77='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -14178,8 +14698,18 @@
       hardcode_shlibpath_var_F77=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
+      *)
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
+ 	# Supported since Solaris 2.6 (maybe 2.5.1?)
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_F77=yes
       ;;
@@ -14453,7 +14983,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi4*)
+bsdi[45]*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -14511,11 +15041,35 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
+  linux*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      supports_anon_versioning=no
+      case `$LD -v 2>/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+$echo "local: *; };" >> $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        $archive_expsym_cmds="$archive_cmds"
+      fi
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -14569,7 +15123,9 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd*)
+freebsd* | dragonfly*)
+  # DragonFly does not have aout.  When/if they implement a new
+  # versioning mechanism, adjust this.
   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -14588,7 +15144,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.01* | freebsdelf3.01*)
+  freebsd3.[01]* | freebsdelf3.[01]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -14714,10 +15270,17 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
+  case $host_cpu:$lt_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+    sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /usr/X11R6/lib64"
+    sys_lib_search_path_spec="/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64"
+    ;;
+  esac
+
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -14725,18 +15288,30 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
-  ;;
 
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
+  # Find out which ABI we are using (multilib Linux x86_64 hack).
+  libsuff=
+  case "$host_cpu" in
+  x86_64*)
+    echo '#line 15296 "configure"' > conftest.$ac_ext
+    if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *64-bit*)
+        libsuff=64
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+    ;;
+  *)
+    ;;
+  esac
+  sys_lib_dlsearch_path_spec="/lib${libsuff} /usr/lib${libsuff}"
+  sys_lib_search_path_spec="/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}"
   ;;
 
 knetbsd*-gnu)
@@ -14789,7 +15364,11 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
+  case $host_os in
+    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
+    *)                         need_version=no  ;;
+  esac
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -14911,8 +15490,8 @@
 echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_F77=
 if test -n "$hardcode_libdir_flag_spec_F77" || \
-   test -n "$runpath_var F77" || \
-   test "X$hardcode_automatic_F77"="Xyes" ; then
+   test -n "$runpath_var_F77" || \
+   test "X$hardcode_automatic_F77" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
   if test "$hardcode_direct_F77" != no &&
@@ -15089,7 +15668,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -15165,7 +15750,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_F77
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -15403,7 +15988,7 @@
 lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String argv) {}; }\n'
+lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
@@ -15414,16 +15999,42 @@
 compiler=$CC
 
 
+# save warnings/boilerplate of simple test code
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${GCJ-"gcj"}
 compiler=$CC
 compiler_GCJ=$CC
+for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
+
 # GCJ did not exist at the time GCC didn't implicitly link libc in.
 archive_cmds_need_lc_GCJ=no
 
+old_archive_cmds_GCJ=$old_archive_cmds
 
+
 lt_prog_compiler_no_builtin_flag_GCJ=
 
 if test "$GCC" = yes; then
@@ -15448,15 +16059,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15451: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16062: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:15455: \$? = $ac_status" >&5
+   echo "$as_me:16066: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
@@ -15559,6 +16172,16 @@
 	lt_prog_compiler_static_GCJ='-bnso -bI:/lib/syscalls.exp'
       fi
       ;;
+      darwin*)
+        # PIC is the default on this platform
+        # Common symbols not allowed in MH_DYLIB files
+       case $cc_basename in
+         xlc*)
+         lt_prog_compiler_pic_GCJ='-qnocommon'
+         lt_prog_compiler_wl_GCJ='-Wl,'
+         ;;
+       esac
+       ;;
 
     mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
@@ -15594,12 +16217,19 @@
       ;;
 
     linux*)
-      case $CC in
+      case $cc_basename in
       icc* | ecc*)
 	lt_prog_compiler_wl_GCJ='-Wl,'
 	lt_prog_compiler_pic_GCJ='-KPIC'
 	lt_prog_compiler_static_GCJ='-static'
         ;;
+      pgcc* | pgf77* | pgf90*)
+        # Portland Group compilers (*not* the Pentium gcc compiler,
+	# which looks to be a dead project)
+	lt_prog_compiler_wl_GCJ='-Wl,'
+	lt_prog_compiler_pic_GCJ='-fpic'
+	lt_prog_compiler_static_GCJ='-static'
+        ;;
       ccc*)
         lt_prog_compiler_wl_GCJ='-Wl,'
         # All Alpha code is PIC.
@@ -15620,9 +16250,14 @@
       ;;
 
     solaris*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
       lt_prog_compiler_pic_GCJ='-KPIC'
       lt_prog_compiler_static_GCJ='-Bstatic'
+      case $cc_basename in
+      f77* | f90* | f95*)
+	lt_prog_compiler_wl_GCJ='-Qoption ld ';;
+      *)
+	lt_prog_compiler_wl_GCJ='-Wl,';;
+      esac
       ;;
 
     sunos4*)
@@ -15644,6 +16279,11 @@
       fi
       ;;
 
+    unicos*)
+      lt_prog_compiler_wl_GCJ='-Wl,'
+      lt_prog_compiler_can_build_shared_GCJ=no
+      ;;
+
     uts4*)
       lt_prog_compiler_pic_GCJ='-pic'
       lt_prog_compiler_static_GCJ='-Bstatic'
@@ -15681,15 +16321,17 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15684: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16324: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:15688: \$? = $ac_status" >&5
+   echo "$as_me:16328: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
+     # So say no if there are warnings other than the usual output.
+     $echo "X$_lt_compiler_boilerplate" | $Xsed >conftest.exp
+     $SED '/^$/d' conftest.err >conftest.er2
+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_GCJ=yes
      fi
    fi
@@ -15741,16 +16383,18 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15744: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16386: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:15748: \$? = $ac_status" >&5
+   echo "$as_me:16390: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
-     if test ! -s out/conftest.err; then
+     $echo "X$_lt_compiler_boilerplate" | $Xsed > out/conftest.exp
+     $SED '/^$/d' out/conftest.err >out/conftest.er2
+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_GCJ=yes
      fi
    fi
@@ -15830,6 +16474,16 @@
   # rely on this symbol name, it's probably fine to never include it in
   # preloaded symbol tables.
   extract_expsyms_cmds=
+  # Just being paranoid about ensuring that cc_basename is set.
+  for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
   case $host_os in
   cygwin* | mingw* | pw32*)
@@ -15850,6 +16504,27 @@
     # If archive_cmds runs LD, not CC, wlarc should be empty
     wlarc='${wl}'
 
+    # Set some defaults for GNU ld with shared library support. These
+    # are reset later if shared libraries are not supported. Putting them
+    # here allows them to be overridden if necessary.
+    runpath_var=LD_RUN_PATH
+    hardcode_libdir_flag_spec_GCJ='${wl}--rpath ${wl}$libdir'
+    export_dynamic_flag_spec_GCJ='${wl}--export-dynamic'
+    # ancient GNU ld didn't support --whole-archive et. al.
+    if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
+	whole_archive_flag_spec_GCJ="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+  	whole_archive_flag_spec_GCJ=
+    fi
+    supports_anon_versioning=no
+    case `$LD -v 2>/dev/null` in
+      *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+      *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+      *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+      *\ 2.11.*) ;; # other 2.11 versions
+      *) supports_anon_versioning=yes ;;
+    esac
+
     # See if GNU ld supports shared libraries.
     case $host_os in
     aix3* | aix4* | aix5*)
@@ -15900,7 +16575,7 @@
       allow_undefined_flag_GCJ=unsupported
       always_export_symbols_GCJ=no
       enable_shared_with_static_runtimes_GCJ=yes
-      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
@@ -15914,11 +16589,42 @@
 	fi~
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
       else
-	ld_shlibs=no
+	ld_shlibs_GCJ=no
       fi
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    linux*)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+	tmp_addflag=
+	case $cc_basename,$host_cpu in
+	pgcc*)				# Portland Group C compiler
+	  whole_archive_flag_spec_GCJ='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag'
+	  ;;
+	pgf77* | pgf90* )			# Portland Group f77 and f90 compilers
+	  whole_archive_flag_spec_GCJ='${wl}--whole-archive,`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
+	  tmp_addflag=' $pic_flag -Mnomain' ;;
+	ecc*,ia64* | icc*,ia64*)		# Intel C compiler on ia64
+	  tmp_addflag=' -i_dynamic' ;;
+	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
+	  tmp_addflag=' -i_dynamic -nofor_main' ;;
+	ifc* | ifort*)			# Intel Fortran compiler
+	  tmp_addflag=' -nofor_main' ;;
+	esac
+	archive_cmds_GCJ='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+
+	if test $supports_anon_versioning = yes; then
+	  archive_expsym_cmds_GCJ='$echo "{ global:" > $output_objdir/$libname.ver~
+  cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+  $echo "local: *; };" >> $output_objdir/$libname.ver~
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	fi
+      else
+	ld_shlibs_GCJ=no
+      fi
+      ;;
+
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -15956,32 +16662,6 @@
       hardcode_shlibpath_var_GCJ=no
       ;;
 
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds_GCJ="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds_GCJ='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds_GCJ="$tmp_archive_cmds"
-      fi
-      link_all_deplibs_GCJ=no
-    else
-      ld_shlibs_GCJ=no
-    fi
-    ;;
-
     *)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
@@ -15992,16 +16672,11 @@
       ;;
     esac
 
-    if test "$ld_shlibs_GCJ" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec_GCJ='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec_GCJ='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec_GCJ="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_GCJ=
-      fi
+    if test "$ld_shlibs_GCJ" = no; then
+      runpath_var=
+      hardcode_libdir_flag_spec_GCJ=
+      export_dynamic_flag_spec_GCJ=
+      whole_archive_flag_spec_GCJ=
     fi
   else
     # PORTME fill in a description of your system's linker (not GNU ld)
@@ -16065,7 +16740,7 @@
       link_all_deplibs_GCJ=yes
 
       if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
+	case $host_os in aix4.[012]|aix4.[012].*)
 	# We only want to do this on AIX 4.2 and lower, the check
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
@@ -16086,6 +16761,9 @@
 	  fi
 	esac
 	shared_flag='-shared'
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag="$shared_flag "'${wl}-G'
+	fi
       else
 	# not using gcc
 	if test "$host_cpu" = ia64; then
@@ -16133,7 +16811,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -16193,7 +16872,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -16244,7 +16924,7 @@
       ld_shlibs_GCJ=no
       ;;
 
-    bsdi4*)
+    bsdi[45]*)
       export_dynamic_flag_spec_GCJ=-rdynamic
       ;;
 
@@ -16265,57 +16945,57 @@
       old_archive_From_new_cmds_GCJ='true'
       # FIXME: Should let the user specify the lib program.
       old_archive_cmds_GCJ='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
+      fix_srcfile_path_GCJ='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_GCJ=yes
       ;;
 
     darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc_GCJ=no
       case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag_GCJ='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_GCJ='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
+        rhapsody* | darwin1.[012])
+         allow_undefined_flag_GCJ='${wl}-undefined ${wl}suppress'
+         ;;
+       *) # Darwin 1.3 on
+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+           allow_undefined_flag_GCJ='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+         else
+           case ${MACOSX_DEPLOYMENT_TARGET} in
+             10.[012])
+               allow_undefined_flag_GCJ='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'
+               ;;
+             10.*)
+               allow_undefined_flag_GCJ='${wl}-undefined ${wl}dynamic_lookup'
+               ;;
+           esac
+         fi
+         ;;
       esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds_GCJ='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds_GCJ='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds_GCJ='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      archive_cmds_need_lc_GCJ=no
       hardcode_direct_GCJ=no
       hardcode_automatic_GCJ=yes
       hardcode_shlibpath_var_GCJ=unsupported
-      whole_archive_flag_spec_GCJ='-all_load $convenience'
+      whole_archive_flag_spec_GCJ=''
       link_all_deplibs_GCJ=yes
+    if test "$GCC" = yes ; then
+    	output_verbose_link_cmd='echo'
+        archive_cmds_GCJ='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
+      module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+      archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+      module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
-      ld_shlibs_GCJ=no
+      case $cc_basename in
+        xlc*)
+         output_verbose_link_cmd='echo'
+         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
+         module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
+         archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          ;;
+       *)
+         ld_shlibs_GCJ=no
+          ;;
+      esac
     fi
       ;;
 
@@ -16349,7 +17029,7 @@
       ;;
 
     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
+    freebsd* | kfreebsd*-gnu | dragonfly*)
       archive_cmds_GCJ='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
       hardcode_libdir_flag_spec_GCJ='-R$libdir'
       hardcode_direct_GCJ=yes
@@ -16436,7 +17116,7 @@
       link_all_deplibs_GCJ=yes
       ;;
 
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
+    netbsd*)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -16460,6 +17140,7 @@
       hardcode_shlibpath_var_GCJ=no
       if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec_GCJ='${wl}-E'
       else
@@ -16505,7 +17186,7 @@
 	allow_undefined_flag_GCJ=' -expect_unresolved \*'
 	archive_cmds_GCJ='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
 	archive_expsym_cmds_GCJ='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'
 
 	# Both c and cxx compiler support -rpath directly
 	hardcode_libdir_flag_spec_GCJ='-rpath $libdir'
@@ -16524,10 +17205,12 @@
     solaris*)
       no_undefined_flag_GCJ=' -z text'
       if test "$GCC" = yes; then
+	wlarc='${wl}'
 	archive_cmds_GCJ='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
 	archive_expsym_cmds_GCJ='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
       else
+	wlarc=''
 	archive_cmds_GCJ='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
 	archive_expsym_cmds_GCJ='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
   	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
@@ -16536,8 +17219,18 @@
       hardcode_shlibpath_var_GCJ=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
+      *)
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
+ 	# Supported since Solaris 2.6 (maybe 2.5.1?)
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_GCJ=yes
       ;;
@@ -16811,7 +17504,7 @@
   shlibpath_var=LIBRARY_PATH
   ;;
 
-bsdi4*)
+bsdi[45]*)
   version_type=linux
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
@@ -16869,11 +17562,35 @@
       ;;
     pw32*)
       # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
       ;;
     esac
     ;;
 
+  linux*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      supports_anon_versioning=no
+      case `$LD -v 2>/dev/null` in
+        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
+        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
+        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
+        *\ 2.11.*) ;; # other 2.11 versions
+        *) supports_anon_versioning=yes ;;
+      esac
+      if test $supports_anon_versioning = yes; then
+        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
+cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
+$echo "local: *; };" >> $output_objdir/$libname.ver~
+        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+      else
+        $archive_expsym_cmds="$archive_cmds"
+      fi
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
   *)
     library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
     ;;
@@ -16927,7 +17644,9 @@
   dynamic_linker='GNU ld.so'
   ;;
 
-freebsd*)
+freebsd* | dragonfly*)
+  # DragonFly does not have aout.  When/if they implement a new
+  # versioning mechanism, adjust this.
   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
   version_type=freebsd-$objformat
   case $version_type in
@@ -16946,7 +17665,7 @@
   freebsd2*)
     shlibpath_overrides_runpath=yes
     ;;
-  freebsd3.01* | freebsdelf3.01*)
+  freebsd3.[01]* | freebsdelf3.[01]*)
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
@@ -17072,10 +17791,17 @@
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
+  case $host_cpu:$lt_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+    sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /usr/X11R6/lib64"
+    sys_lib_search_path_spec="/lib64 /usr/lib64 /usr/local/lib64 /usr/X11R6/lib64"
+    ;;
+  esac
+
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -17083,18 +17809,30 @@
   # people can always --disable-shared, the test was removed, and we
   # assume the GNU/Linux dynamic linker is in use.
   dynamic_linker='GNU/Linux ld.so'
-  ;;
 
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
+  # Find out which ABI we are using (multilib Linux x86_64 hack).
+  libsuff=
+  case "$host_cpu" in
+  x86_64*)
+    echo '#line 17817 "configure"' > conftest.$ac_ext
+    if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *64-bit*)
+        libsuff=64
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+    ;;
+  *)
+    ;;
+  esac
+  sys_lib_dlsearch_path_spec="/lib${libsuff} /usr/lib${libsuff}"
+  sys_lib_search_path_spec="/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}"
   ;;
 
 knetbsd*-gnu)
@@ -17147,7 +17885,11 @@
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  # Some older versions of OpenBSD (3.3 at least) *do* need versioned libs.
+  case $host_os in
+    openbsd3.3 | openbsd3.3.*) need_version=yes ;;
+    *)                         need_version=no  ;;
+  esac
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -17269,8 +18011,8 @@
 echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_GCJ=
 if test -n "$hardcode_libdir_flag_spec_GCJ" || \
-   test -n "$runpath_var GCJ" || \
-   test "X$hardcode_automatic_GCJ"="Xyes" ; then
+   test -n "$runpath_var_GCJ" || \
+   test "X$hardcode_automatic_GCJ" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
   if test "$hardcode_direct_GCJ" != no &&
@@ -17396,7 +18138,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17499,7 +18242,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17564,7 +18308,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17657,7 +18402,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17722,7 +18468,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17788,7 +18535,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17854,7 +18602,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -17929,7 +18678,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 17932 "configure"
+#line 18681 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -18027,7 +18776,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 18030 "configure"
+#line 18779 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -18245,7 +18994,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -18321,7 +19076,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_GCJ
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -18569,11 +19324,35 @@
 compiler=$CC
 
 
+# save warnings/boilerplate of simple test code
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
+eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_compiler_boilerplate=`cat conftest.err`
+$rm conftest*
+
+ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
+eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err
+_lt_linker_boilerplate=`cat conftest.err`
+$rm conftest*
+
+
 # Allow CC to be a program name with arguments.
 lt_save_CC="$CC"
 CC=${RC-"windres"}
 compiler=$CC
 compiler_RC=$CC
+for cc_temp in $compiler""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
+
 lt_cv_prog_compiler_c_o_RC=yes
 
 # The else clause should only fire when bootstrapping the
@@ -18690,7 +19469,13 @@
 # The host system.
 host_alias=$host_alias
 host=$host
+host_os=$host_os
 
+# The build system.
+build_alias=$build_alias
+build=$build
+build_os=$build_os
+
 # An echo program that does not interpret backslashes.
 echo=$lt_echo
 
@@ -18766,7 +19551,7 @@
 # Does compiler simultaneously support -c and -o options?
 compiler_c_o=$lt_lt_cv_prog_compiler_c_o_RC
 
-# Must we lock files when doing compilation ?
+# Must we lock files when doing compilation?
 need_locks=$lt_need_locks
 
 # Do we need the lib prefix for modules?
@@ -19084,7 +19869,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19156,7 +19942,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19210,7 +19997,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19281,7 +20069,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19335,7 +20124,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19402,7 +20192,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19573,7 +20364,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19642,7 +20434,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19820,7 +20613,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19875,7 +20669,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -19990,7 +20785,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -20052,7 +20848,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -20095,7 +20892,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -20224,7 +21022,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -20292,7 +21091,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -20477,7 +21277,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -21157,7 +21958,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -21230,7 +22032,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -21302,7 +22105,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -21475,7 +22279,8 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+	 { ac_try='test -z "$ac_cxx_werror_flag"
+			 || test ! -s conftest.err'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
@@ -22066,7 +22871,7 @@
 } >&5
 cat >&5 <<_CSEOF
 
-This file was extended by openspace $as_me 0.1.1, which was
+This file was extended by openspace $as_me 0.2.0, which was
 generated by GNU Autoconf 2.59.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -22129,7 +22934,7 @@
 
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-openspace config.status 0.1.1
+openspace config.status 0.2.0
 configured by $0, generated by GNU Autoconf 2.59,
   with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
 
@@ -22567,6 +23372,11 @@
   *) ac_INSTALL=$ac_top_builddir$INSTALL ;;
   esac
 
+  if test x"$ac_file" != x-; then
+    { echo "$as_me:$LINENO: creating $ac_file" >&5
+echo "$as_me: creating $ac_file" >&6;}
+    rm -f "$ac_file"
+  fi
   # Let's still pretend it is `configure' which instantiates (i.e., don't
   # use $as_me), people would be surprised to read:
   #    /* config.h.  Generated by config.status.  */
@@ -22605,12 +23415,6 @@
 	 fi;;
       esac
     done` || { (exit 1); exit 1; }
-
-  if test x"$ac_file" != x-; then
-    { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    rm -f "$ac_file"
-  fi
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
   sed "$ac_vpsub

Modified: branches/mloskot-style-refactoring/configure.ac
===================================================================
--- branches/mloskot-style-refactoring/configure.ac	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/configure.ac	2006-02-11 21:32:58 UTC (rev 240)
@@ -2,7 +2,7 @@
 # Process this file with autoconf to produce a configure script.
 
 AC_PREREQ(2.59)
-AC_INIT(openspace, 0.1.1, http://openspace.linux.pl)
+AC_INIT(openspace, 0.2.0, http://openspace.linux.pl)
 AC_CONFIG_SRCDIR(src/main.cpp)
 AC_CONFIG_HEADER(src/config.h)
 AM_INIT_AUTOMAKE

Modified: branches/mloskot-style-refactoring/ltmain.sh
===================================================================
--- branches/mloskot-style-refactoring/ltmain.sh	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/ltmain.sh	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,7 +1,7 @@
 # ltmain.sh - Provide generalized library-building support services.
 # NOTE: Changing this file will not affect anything until you rerun configure.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005
 # Free Software Foundation, Inc.
 # Originally by Gordon Matzigkeit <gord at gnu.ai.mit.edu>, 1996
 #
@@ -17,7 +17,7 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
@@ -33,6 +33,9 @@
 # function.
 progpath="$0"
 
+# define SED for historic ltconfig's generated by Libtool 1.3
+test -z "$SED" && SED=sed
+
 # The name of this program:
 progname=`echo "$progpath" | $SED $basename`
 modename="$progname"
@@ -43,9 +46,21 @@
 
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION=1.5.6
-TIMESTAMP=" (1.1220.2.95 2004/04/11 05:50:42) Debian$Rev: 224 $"
+VERSION=1.5.18
+TIMESTAMP=" (1.1220.2.246 2005/05/16 10:00:18)"
 
+# See if we are running on zsh, and set the options which allow our
+# commands through without removal of \ escapes.
+if test -n "${ZSH_VERSION+set}" ; then
+  setopt NO_GLOB_SUBST
+fi
+# Same for EGREP, and just to be sure, do LTCC as well
+if test "X$EGREP" = X ; then
+    EGREP=egrep
+fi
+if test "X$LTCC" = X ; then
+    LTCC=${CC-gcc}
+fi
 
 # Check that we have a working $echo.
 if test "X$1" = X--no-reexec; then
@@ -107,8 +122,9 @@
 fi
 
 # Make sure IFS has a sensible default
-: ${IFS=" 	
-"}
+lt_nl='
+'
+IFS=" 	$lt_nl"
 
 if test "$build_libtool_libs" != yes && test "$build_old_libs" != yes; then
   $echo "$modename: not configured to build any kind of library" 1>&2
@@ -127,7 +143,32 @@
 execute_dlfiles=
 lo2o="s/\\.lo\$/.${objext}/"
 o2lo="s/\\.${objext}\$/.lo/"
+quote_scanset='[[~#^*{};<>?'"'"' 	]'
 
+if test -z "$max_cmd_len"; then
+  i=0
+  testring="ABCD"
+  new_result=
+  
+  # If test is not a shell built-in, we'll probably end up computing a
+  # maximum length that is only half of the actual maximum length, but
+  # we can't tell.
+  while (test "X"`$SHELL $0 --fallback-echo "X$testring" 2>/dev/null` \
+             = "XX$testring") >/dev/null 2>&1 &&
+          new_result=`expr "X$testring" : ".*" 2>&1` &&
+          max_cmd_len="$new_result" &&
+          test "$i" != 17 # 1/2 MB should be enough
+  do
+    i=`expr $i + 1`
+    testring="$testring$testring"
+  done
+  testring=
+  # Add a significant safety factor because C++ compilers can tack on massive
+  # amounts of additional arguments before passing them to the linker.
+  # It appears as though 1/2 is a usable value.
+  max_cmd_len=`expr $max_cmd_len \/ 2`
+fi
+
 #####################################
 # Shell function definitions:
 # This seems to be the best place for them
@@ -138,7 +179,8 @@
 # Need a lot of goo to handle *both* DLLs and import libs
 # Has to be a shell function in order to 'eat' the argument
 # that is supplied when $file_magic_command is called.
-func_win32_libid () {
+func_win32_libid ()
+{
   win32_libid_type="unknown"
   win32_fileres=`file -L $1 2>/dev/null`
   case $win32_fileres in
@@ -178,12 +220,13 @@
 # Only attempt this if the compiler in the base compile
 # command doesn't match the default compiler.
 # arg is usually of the form 'gcc ...'
-func_infer_tag () {
+func_infer_tag ()
+{
     if test -n "$available_tags" && test -z "$tagname"; then
       CC_quoted=
       for arg in $CC; do
 	case $arg in
-	  *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	  *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	  arg="\"$arg\""
 	  ;;
 	esac
@@ -204,13 +247,23 @@
 	    for arg in $CC; do
 	    # Double-quote args containing other shell metacharacters.
 	    case $arg in
-	      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	      arg="\"$arg\""
 	      ;;
 	    esac
 	    CC_quoted="$CC_quoted $arg"
 	  done
+	    # user sometimes does CC=<HOST>-gcc so we need to match that to 'gcc'
+	    trimedcc=`echo ${CC} | $SED -e "s/${host}-//g"`
+	    # and sometimes libtool has CC=<HOST>-gcc but user does CC=gcc
+	    extendcc=${host}-${CC}
 	    case "$@ " in
+	      "cc "* | " cc "* | "${host}-cc "* | " ${host}-cc "*|\
+	      "gcc "* | " gcc "* | "${host}-gcc "* | " ${host}-gcc "*)
+	      tagname=CC
+	      break ;;
+	      "$trimedcc "* | " $trimedcc "* | "`$echo $trimedcc` "* | " `$echo $trimedcc` "*|\
+	      "$extendcc "* | " $extendcc "* | "`$echo $extendcc` "* | " `$echo $extendcc` "*|\
 	      " $CC "* | "$CC "* | " `$echo $CC` "* | "`$echo $CC` "* | " $CC_quoted"* | "$CC_quoted "* | " `$echo $CC_quoted` "* | "`$echo $CC_quoted` "*)
 	      # The compiler in the base compile command matches
 	      # the one in the tagged configuration.
@@ -235,6 +288,108 @@
       esac
     fi
 }
+
+
+# func_extract_an_archive dir oldlib
+func_extract_an_archive ()
+{
+    f_ex_an_ar_dir="$1"; shift
+    f_ex_an_ar_oldlib="$1"
+
+    $show "(cd $f_ex_an_ar_dir && $AR x $f_ex_an_ar_oldlib)"
+    $run eval "(cd \$f_ex_an_ar_dir && $AR x \$f_ex_an_ar_oldlib)" || exit $?
+    if ($AR t "$f_ex_an_ar_oldlib" | sort | sort -uc >/dev/null 2>&1); then
+     :
+    else
+      $echo "$modename: ERROR: object name conflicts: $f_ex_an_ar_dir/$f_ex_an_ar_oldlib" 1>&2
+      exit $EXIT_FAILURE
+    fi
+}
+
+# func_extract_archives gentop oldlib ...
+func_extract_archives ()
+{
+    my_gentop="$1"; shift
+    my_oldlibs=${1+"$@"}
+    my_oldobjs=""
+    my_xlib=""
+    my_xabs=""
+    my_xdir=""
+    my_status=""
+
+    $show "${rm}r $my_gentop"
+    $run ${rm}r "$my_gentop"
+    $show "$mkdir $my_gentop"
+    $run $mkdir "$my_gentop"
+    my_status=$?
+    if test "$my_status" -ne 0 && test ! -d "$my_gentop"; then
+      exit $my_status
+    fi
+
+    for my_xlib in $my_oldlibs; do
+      # Extract the objects.
+      case $my_xlib in
+	[\\/]* | [A-Za-z]:[\\/]*) my_xabs="$my_xlib" ;;
+	*) my_xabs=`pwd`"/$my_xlib" ;;
+      esac
+      my_xlib=`$echo "X$my_xlib" | $Xsed -e 's%^.*/%%'`
+      my_xdir="$my_gentop/$my_xlib"
+
+      $show "${rm}r $my_xdir"
+      $run ${rm}r "$my_xdir"
+      $show "$mkdir $my_xdir"
+      $run $mkdir "$my_xdir"
+      status=$?
+      if test "$status" -ne 0 && test ! -d "$my_xdir"; then
+	exit $status
+      fi
+      case $host in
+      *-darwin*)
+	$show "Extracting $my_xabs"
+	# Do not bother doing anything if just a dry run
+	if test -z "$run"; then
+	  darwin_orig_dir=`pwd`
+	  cd $my_xdir || exit $?
+	  darwin_archive=$my_xabs
+	  darwin_curdir=`pwd`
+	  darwin_base_archive=`$echo "X$darwin_archive" | $Xsed -e 's%^.*/%%'`
+	  darwin_arches=`lipo -info "$darwin_archive" 2>/dev/null | $EGREP Architectures 2>/dev/null`
+	  if test -n "$darwin_arches"; then 
+	    darwin_arches=`echo "$darwin_arches" | $SED -e 's/.*are://'`
+	    darwin_arch=
+	    $show "$darwin_base_archive has multiple architectures $darwin_arches"
+	    for darwin_arch in  $darwin_arches ; do
+	      mkdir -p "unfat-$$/${darwin_base_archive}-${darwin_arch}"
+	      lipo -thin $darwin_arch -output "unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}" "${darwin_archive}"
+	      cd "unfat-$$/${darwin_base_archive}-${darwin_arch}"
+	      func_extract_an_archive "`pwd`" "${darwin_base_archive}"
+	      cd "$darwin_curdir"
+	      $rm "unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}"
+	    done # $darwin_arches
+      ## Okay now we have a bunch of thin objects, gotta fatten them up :)
+	    darwin_filelist=`find unfat-$$ -type f -name \*.o -print -o -name \*.lo -print| xargs basename | sort -u | $NL2SP`
+	    darwin_file=
+	    darwin_files=
+	    for darwin_file in $darwin_filelist; do
+	      darwin_files=`find unfat-$$ -name $darwin_file -print | $NL2SP`
+	      lipo -create -output "$darwin_file" $darwin_files
+	    done # $darwin_filelist
+	    ${rm}r unfat-$$
+	    cd "$darwin_orig_dir"
+	  else
+	    cd "$darwin_orig_dir"
+ 	    func_extract_an_archive "$my_xdir" "$my_xabs"
+	  fi # $darwin_arches
+	fi # $run
+      ;;
+      *)
+        func_extract_an_archive "$my_xdir" "$my_xabs"
+        ;;
+      esac
+      my_oldobjs="$my_oldobjs "`find $my_xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
+    done
+    func_extract_archives_result="$my_oldobjs"
+}
 # End of Shell function definitions
 #####################################
 
@@ -305,10 +460,10 @@
   --version)
     $echo "$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP"
     $echo
-    $echo "Copyright (C) 2003  Free Software Foundation, Inc."
+    $echo "Copyright (C) 2005  Free Software Foundation, Inc."
     $echo "This is free software; see the source for copying conditions.  There is NO"
     $echo "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
-    exit $EXIT_SUCCESS
+    exit $?
     ;;
 
   --config)
@@ -317,7 +472,7 @@
     for tagname in $taglist; do
       ${SED} -n -e "/^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$/,/^# ### END LIBTOOL TAG CONFIG: $tagname$/p" < "$progpath"
     done
-    exit $EXIT_SUCCESS
+    exit $?
     ;;
 
   --debug)
@@ -342,7 +497,7 @@
     else
       $echo "disable static libraries"
     fi
-    exit $EXIT_SUCCESS
+    exit $?
     ;;
 
   --finish) mode="finish" ;;
@@ -399,7 +554,7 @@
   # Infer the operation mode.
   if test -z "$mode"; then
     $echo "*** Warning: inferring the mode of operation is deprecated." 1>&2
-    $echo "*** Future versions of Libtool will require -mode=MODE be specified." 1>&2
+    $echo "*** Future versions of Libtool will require --mode=MODE be specified." 1>&2
     case $nonopt in
     *cc | cc* | *++ | gcc* | *-gcc* | g++* | xlc*)
       mode=link
@@ -516,7 +671,7 @@
 	    # Many Bourne shells cannot handle close brackets correctly
 	    # in scan sets, so we specify it separately.
 	    case $arg in
-	      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	      arg="\"$arg\""
 	      ;;
 	    esac
@@ -547,8 +702,11 @@
       case $lastarg in
       # Double-quote args containing other shell metacharacters.
       # Many Bourne shells cannot handle close brackets correctly
-      # in scan sets, so we specify it separately.
-      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+      # in scan sets, and some SunOS ksh mistreat backslash-escaping
+      # in scan sets (worked around with variable expansion),
+      # and furthermore cannot handle '|' '&' '(' ')' in scan sets 
+      # at all, so we specify them separately.
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	lastarg="\"$lastarg\""
 	;;
       esac
@@ -621,6 +779,15 @@
       esac
     done
 
+    qlibobj=`$echo "X$libobj" | $Xsed -e "$sed_quote_subst"`
+    case $qlibobj in
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
+	qlibobj="\"$qlibobj\"" ;;
+    esac
+    if test "X$libobj" != "X$qlibobj"; then
+	$echo "$modename: libobj name \`$libobj' may not contain shell special characters."
+	exit $EXIT_FAILURE
+    fi
     objname=`$echo "X$obj" | $Xsed -e 's%^.*/%%'`
     xdir=`$echo "X$obj" | $Xsed -e 's%/[^/]*$%%'`
     if test "X$xdir" = "X$obj"; then
@@ -673,7 +840,7 @@
     # Lock this critical section if it is needed
     # We use this script file to make the link, it avoids creating a new file
     if test "$need_locks" = yes; then
-      until $run ln "$progpath" "$lockfile" 2>/dev/null; do
+      until $run ln "$srcfile" "$lockfile" 2>/dev/null; do
 	$show "Waiting for $lockfile to be removed"
 	sleep 2
       done
@@ -693,12 +860,17 @@
 	$run $rm $removelist
 	exit $EXIT_FAILURE
       fi
-      $echo $srcfile > "$lockfile"
+      $echo "$srcfile" > "$lockfile"
     fi
 
     if test -n "$fix_srcfile_path"; then
       eval srcfile=\"$fix_srcfile_path\"
     fi
+    qsrcfile=`$echo "X$srcfile" | $Xsed -e "$sed_quote_subst"`
+    case $qsrcfile in
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
+      qsrcfile="\"$qsrcfile\"" ;;
+    esac
 
     $run $rm "$libobj" "${libobj}T"
 
@@ -720,10 +892,10 @@
       fbsd_hideous_sh_bug=$base_compile
 
       if test "$pic_mode" != no; then
-	command="$base_compile $srcfile $pic_flag"
+	command="$base_compile $qsrcfile $pic_flag"
       else
 	# Don't build PIC code
-	command="$base_compile $srcfile"
+	command="$base_compile $qsrcfile"
       fi
 
       if test ! -d "${xdir}$objdir"; then
@@ -803,9 +975,9 @@
     if test "$build_old_libs" = yes; then
       if test "$pic_mode" != yes; then
 	# Don't build PIC code
-	command="$base_compile $srcfile"
+	command="$base_compile $qsrcfile"
       else
-	command="$base_compile $srcfile $pic_flag"
+	command="$base_compile $qsrcfile $pic_flag"
       fi
       if test "$compiler_c_o" = yes; then
 	command="$command -o $obj"
@@ -983,7 +1155,7 @@
       arg="$1"
       shift
       case $arg in
-      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	qarg=\"`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`\" ### testsuite: skip nested quoting test
 	;;
       *) qarg=$arg ;;
@@ -1227,6 +1399,13 @@
 	  prev=
 	  continue
 	  ;;
+        darwin_framework)
+	  compiler_flags="$compiler_flags $arg"
+	  compile_command="$compile_command $arg"
+	  finalize_command="$finalize_command $arg"
+	  prev=
+	  continue
+	  ;;
 	*)
 	  eval "$prev=\"\$arg\""
 	  prev=
@@ -1285,6 +1464,14 @@
 	continue
 	;;
 
+      -framework)
+        prev=darwin_framework
+        compiler_flags="$compiler_flags $arg"
+	compile_command="$compile_command $arg"
+	finalize_command="$finalize_command $arg"
+        continue
+        ;;
+
       -inst-prefix-dir)
 	prev=inst_prefix
 	continue
@@ -1345,7 +1532,7 @@
 	    # These systems don't actually have a C library (as such)
 	    test "X$arg" = "X-lc" && continue
 	    ;;
-	  *-*-openbsd* | *-*-freebsd*)
+	  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
 	    # Do not include libc due to us having libc/libc_r.
 	    test "X$arg" = "X-lc" && continue
 	    ;;
@@ -1356,7 +1543,7 @@
 	  esac
 	elif test "X$arg" = "X-lc_r"; then
 	 case $host in
-	 *-*-openbsd* | *-*-freebsd*)
+	 *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
 	   # Do not include libc_r directly, use -pthread flag.
 	   continue
 	   ;;
@@ -1366,8 +1553,20 @@
 	continue
 	;;
 
+      # Tru64 UNIX uses -model [arg] to determine the layout of C++
+      # classes, name mangling, and exception handling.
+      -model)
+	compile_command="$compile_command $arg"
+	compiler_flags="$compiler_flags $arg"
+	finalize_command="$finalize_command $arg"
+	prev=xcompiler
+	continue
+	;;
+
      -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
-	deplibs="$deplibs $arg"
+	compiler_flags="$compiler_flags $arg"
+	compile_command="$compile_command $arg"
+	finalize_command="$finalize_command $arg"
 	continue
 	;;
 
@@ -1376,18 +1575,19 @@
 	continue
 	;;
 
-      # gcc -m* arguments should be passed to the linker via $compiler_flags
-      # in order to pass architecture information to the linker
-      # (e.g. 32 vs 64-bit).  This may also be accomplished via -Wl,-mfoo
-      # but this is not reliable with gcc because gcc may use -mfoo to
-      # select a different linker, different libraries, etc, while
-      # -Wl,-mfoo simply passes -mfoo to the linker.
-      -m*)
+      # -64, -mips[0-9] enable 64-bit mode on the SGI compiler
+      # -r[0-9][0-9]* specifies the processor on the SGI compiler
+      # -xarch=*, -xtarget=* enable 64-bit mode on the Sun compiler
+      # +DA*, +DD* enable 64-bit mode on the HP compiler
+      # -q* pass through compiler args for the IBM compiler
+      # -m* pass through architecture-specific compiler args for GCC
+      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*)
+
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
 	case $arg in
-	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	*$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	  arg="\"$arg\""
 	  ;;
 	esac
@@ -1503,7 +1703,7 @@
 	for flag in $args; do
 	  IFS="$save_ifs"
 	  case $flag in
-	    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	    *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	    flag="\"$flag\""
 	    ;;
 	  esac
@@ -1521,7 +1721,7 @@
 	for flag in $args; do
 	  IFS="$save_ifs"
 	  case $flag in
-	    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	    *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	    flag="\"$flag\""
 	    ;;
 	  esac
@@ -1548,13 +1748,18 @@
 	continue
 	;;
 
+      -Kthread | -mthreads | -mt | -pthread | -pthreads | -threads | -qthreaded | -kthread )
+        compiler_flags="$compiler_flags $arg"
+        continue
+        ;;
+
       # Some other compiler flag.
       -* | +*)
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
 	case $arg in
-	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	*$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	  arg="\"$arg\""
 	  ;;
 	esac
@@ -1688,7 +1893,7 @@
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
 	case $arg in
-	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	*$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	  arg="\"$arg\""
 	  ;;
 	esac
@@ -1838,10 +2043,7 @@
 	case $pass in
 	dlopen) libs="$dlfiles" ;;
 	dlpreopen) libs="$dlprefiles" ;;
-	link)
-	  libs="$deplibs %DEPLIBS%"
-	  test "X$link_all_deplibs" != Xno && libs="$libs $dependency_libs"
-	  ;;
+	link) libs="$deplibs %DEPLIBS% $dependency_libs" ;;
 	esac
       fi
       if test "$pass" = dlopen; then
@@ -1858,7 +2060,7 @@
 	    compile_deplibs="$deplib $compile_deplibs"
 	    finalize_deplibs="$deplib $finalize_deplibs"
 	  else
-	    deplibs="$deplib $deplibs"
+	    compiler_flags="$compiler_flags $deplib"
 	  fi
 	  continue
 	  ;;
@@ -1977,7 +2179,22 @@
 	  fi
 	  case $linkmode in
 	  lib)
-	    if test "$deplibs_check_method" != pass_all; then
+	    valid_a_lib=no
+	    case $deplibs_check_method in
+	      match_pattern*)
+		set dummy $deplibs_check_method
+	        match_pattern_regex=`expr "$deplibs_check_method" : "$2 \(.*\)"`
+		if eval $echo \"$deplib\" 2>/dev/null \
+		    | $SED 10q \
+		    | $EGREP "$match_pattern_regex" > /dev/null; then
+		  valid_a_lib=yes
+		fi
+		;;
+	      pass_all)
+		valid_a_lib=yes
+		;;
+            esac
+	    if test "$valid_a_lib" != yes; then
 	      $echo
 	      $echo "*** Warning: Trying to link with static lib archive $deplib."
 	      $echo "*** I have the capability to make that library automatically link in when"
@@ -2051,7 +2268,9 @@
 	# it will not redefine variables installed, or shouldnotlink
 	installed=yes
 	shouldnotlink=no
+	avoidtemprpath=
 
+
 	# Read the .la file
 	case $lib in
 	*/* | *\\*) . $lib ;;
@@ -2149,11 +2368,19 @@
 	    dir="$libdir"
 	    absdir="$libdir"
 	  fi
+	  test "X$hardcode_automatic" = Xyes && avoidtemprpath=yes
 	else
-	  dir="$ladir/$objdir"
-	  absdir="$abs_ladir/$objdir"
-	  # Remove this search path later
-	  notinst_path="$notinst_path $abs_ladir"
+	  if test ! -f "$ladir/$objdir/$linklib" && test -f "$abs_ladir/$linklib"; then
+	    dir="$ladir"
+	    absdir="$abs_ladir"
+	    # Remove this search path later
+	    notinst_path="$notinst_path $abs_ladir"
+	  else
+	    dir="$ladir/$objdir"
+	    absdir="$abs_ladir/$objdir"
+	    # Remove this search path later
+	    notinst_path="$notinst_path $abs_ladir"
+	  fi
 	fi # $installed = yes
 	name=`$echo "X$laname" | $Xsed -e 's/\.la$//' -e 's/^lib//'`
 
@@ -2226,7 +2453,7 @@
 	  if test -n "$library_names" &&
 	     { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
 	    # We need to hardcode the library path
-	    if test -n "$shlibpath_var"; then
+	    if test -n "$shlibpath_var" && test -z "$avoidtemprpath" ; then
 	      # Make sure the rpath contains only unique directories.
 	      case "$temp_rpath " in
 	      *" $dir "*) ;;
@@ -2670,13 +2897,13 @@
 	      *) continue ;;
 	      esac
 	      case " $deplibs " in
+	      *" $path "*) ;;
+	      *) deplibs="$path $deplibs" ;;
+	      esac
+	      case " $deplibs " in
 	      *" $depdepl "*) ;;
 	      *) deplibs="$depdepl $deplibs" ;;
 	      esac
-	      case " $deplibs " in
-	      *" $path "*) ;;
-	      *) deplibs="$deplibs $path" ;;
-	      esac
 	    done
 	  fi # link_all_deplibs != no
 	fi # linkmode = lib
@@ -2929,11 +3156,6 @@
 	    age="$number_minor"
 	    revision="$number_minor"
 	    ;;
-	  *)
-	    $echo "$modename: unknown library version type \`$version_type'" 1>&2
-	    $echo "Fatal configuration error.  See the $PACKAGE docs for more information." 1>&2
-	    exit $EXIT_FAILURE
-	    ;;
 	  esac
 	  ;;
 	no)
@@ -2947,7 +3169,7 @@
 	case $current in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo "$modename: CURRENT \`$current' is not a nonnegative integer" 1>&2
+	  $echo "$modename: CURRENT \`$current' must be a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -2956,7 +3178,7 @@
 	case $revision in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo "$modename: REVISION \`$revision' is not a nonnegative integer" 1>&2
+	  $echo "$modename: REVISION \`$revision' must be a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -2965,7 +3187,7 @@
 	case $age in
 	0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;
 	*)
-	  $echo "$modename: AGE \`$age' is not a nonnegative integer" 1>&2
+	  $echo "$modename: AGE \`$age' must be a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
 	  exit $EXIT_FAILURE
 	  ;;
@@ -2991,7 +3213,7 @@
 	  versuffix="$major.$age.$revision"
 	  # Darwin ld doesn't like 0 for these options...
 	  minor_current=`expr $current + 1`
-	  verstring="-compatibility_version $minor_current -current_version $minor_current.$revision"
+	  verstring="${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision"
 	  ;;
 
 	freebsd-aout)
@@ -3197,7 +3419,7 @@
 	  *-*-netbsd*)
 	    # Don't link with libc until the a.out ld.so is fixed.
 	    ;;
-	  *-*-openbsd* | *-*-freebsd*)
+	  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)
 	    # Do not include libc due to us having libc/libc_r.
 	    test "X$arg" = "X-lc" && continue
 	    ;;
@@ -3370,6 +3592,13 @@
 			*) potlib=`$echo "X$potlib" | $Xsed -e 's,[^/]*$,,'`"$potliblink";;
 			esac
 		      done
+		      # It is ok to link against an archive when
+		      # building a shared library.
+		      if $AR -t $potlib > /dev/null 2>&1; then
+		        newdeplibs="$newdeplibs $a_deplib"
+		        a_deplib=""
+		        break 2
+		      fi
 		      if eval $file_magic_cmd \"\$potlib\" 2>/dev/null \
 			 | ${SED} 10q \
 			 | $EGREP "$file_magic_regex" > /dev/null; then
@@ -3679,67 +3908,13 @@
 	    eval libobjs=\"\$libobjs $whole_archive_flag_spec\"
 	  else
 	    gentop="$output_objdir/${outputname}x"
-	    $show "${rm}r $gentop"
-	    $run ${rm}r "$gentop"
-	    $show "$mkdir $gentop"
-	    $run $mkdir "$gentop"
-	    status=$?
-	    if test "$status" -ne 0 && test ! -d "$gentop"; then
-	      exit $status
-	    fi
 	    generated="$generated $gentop"
 
-	    for xlib in $convenience; do
-	      # Extract the objects.
-	      case $xlib in
-	      [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
-	      *) xabs=`pwd`"/$xlib" ;;
-	      esac
-	      xlib=`$echo "X$xlib" | $Xsed -e 's%^.*/%%'`
-	      xdir="$gentop/$xlib"
-
-	      $show "${rm}r $xdir"
-	      $run ${rm}r "$xdir"
-	      $show "$mkdir $xdir"
-	      $run $mkdir "$xdir"
-	      status=$?
-	      if test "$status" -ne 0 && test ! -d "$xdir"; then
-		exit $status
-	      fi
-	      # We will extract separately just the conflicting names and we will no
-	      # longer touch any unique names. It is faster to leave these extract
-	      # automatically by $AR in one run.
-	      $show "(cd $xdir && $AR x $xabs)"
-	      $run eval "(cd \$xdir && $AR x \$xabs)" || exit $?
-	      if ($AR t "$xabs" | sort | sort -uc >/dev/null 2>&1); then
-		:
-	      else
-		$echo "$modename: warning: object name conflicts; renaming object files" 1>&2
-		$echo "$modename: warning: to ensure that they will not overwrite" 1>&2
-		$AR t "$xabs" | sort | uniq -cd | while read -r count name
-		do
-		  i=1
-		  while test "$i" -le "$count"
-		  do
-		   # Put our $i before any first dot (extension)
-		   # Never overwrite any file
-		   name_to="$name"
-		   while test "X$name_to" = "X$name" || test -f "$xdir/$name_to"
-		   do
-		     name_to=`$echo "X$name_to" | $Xsed -e "s/\([^.]*\)/\1-$i/"`
-		   done
-		   $show "(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')"
-		   $run eval "(cd \$xdir && $AR xN $i \$xabs '$name' && $mv '$name' '$name_to')" || exit $?
-		   i=`expr $i + 1`
-		  done
-		done
-	      fi
-
-	      libobjs="$libobjs "`find $xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
-	    done
+	    func_extract_archives $gentop $convenience
+	    libobjs="$libobjs $func_extract_archives_result"
 	  fi
 	fi
-
+	
 	if test "$thread_safe" = yes && test -n "$thread_safe_flag_spec"; then
 	  eval flag=\"$thread_safe_flag_spec\"
 	  linker_flags="$linker_flags $flag"
@@ -3788,6 +3963,7 @@
 	    save_libobjs=$libobjs
 	  fi
 	  save_output=$output
+	  output_la=`$echo "X$output" | $Xsed -e "$basename"`
 
 	  # Clear the reloadable object creation command queue and
 	  # initialize k to one.
@@ -3797,7 +3973,7 @@
 	  delfiles=
 	  last_robj=
 	  k=1
-	  output=$output_objdir/$save_output-${k}.$objext
+	  output=$output_objdir/$output_la-${k}.$objext
 	  # Loop over the list of objects to be linked.
 	  for obj in $save_libobjs
 	  do
@@ -3817,9 +3993,9 @@
 		# the last one created.
 		eval concat_cmds=\"\$concat_cmds~$reload_cmds $objlist $last_robj\"
 	      fi
-	      last_robj=$output_objdir/$save_output-${k}.$objext
+	      last_robj=$output_objdir/$output_la-${k}.$objext
 	      k=`expr $k + 1`
-	      output=$output_objdir/$save_output-${k}.$objext
+	      output=$output_objdir/$output_la-${k}.$objext
 	      objlist=$obj
 	      len=1
 	    fi
@@ -3839,13 +4015,13 @@
 	    eval concat_cmds=\"\$concat_cmds~$export_symbols_cmds\"
           fi
 
-	  # Set up a command to remove the reloadale object files
+	  # Set up a command to remove the reloadable object files
 	  # after they are used.
 	  i=0
 	  while test "$i" -lt "$k"
 	  do
 	    i=`expr $i + 1`
-	    delfiles="$delfiles $output_objdir/$save_output-${i}.$objext"
+	    delfiles="$delfiles $output_objdir/$output_la-${i}.$objext"
 	  done
 
 	  $echo "creating a temporary reloadable object file: $output"
@@ -3977,64 +4153,10 @@
 	  eval reload_conv_objs=\"\$reload_objs $whole_archive_flag_spec\"
 	else
 	  gentop="$output_objdir/${obj}x"
-	  $show "${rm}r $gentop"
-	  $run ${rm}r "$gentop"
-	  $show "$mkdir $gentop"
-	  $run $mkdir "$gentop"
-	  status=$?
-	  if test "$status" -ne 0 && test ! -d "$gentop"; then
-	    exit $status
-	  fi
 	  generated="$generated $gentop"
 
-	  for xlib in $convenience; do
-	    # Extract the objects.
-	    case $xlib in
-	    [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
-	    *) xabs=`pwd`"/$xlib" ;;
-	    esac
-	    xlib=`$echo "X$xlib" | $Xsed -e 's%^.*/%%'`
-	    xdir="$gentop/$xlib"
-
-	    $show "${rm}r $xdir"
-	    $run ${rm}r "$xdir"
-	    $show "$mkdir $xdir"
-	    $run $mkdir "$xdir"
-	    status=$?
-	    if test "$status" -ne 0 && test ! -d "$xdir"; then
-	      exit $status
-	    fi
-	    # We will extract separately just the conflicting names and we will no
-	    # longer touch any unique names. It is faster to leave these extract
-	    # automatically by $AR in one run.
-	    $show "(cd $xdir && $AR x $xabs)"
-	    $run eval "(cd \$xdir && $AR x \$xabs)" || exit $?
-	    if ($AR t "$xabs" | sort | sort -uc >/dev/null 2>&1); then
-	      :
-	    else
-	      $echo "$modename: warning: object name conflicts; renaming object files" 1>&2
-	      $echo "$modename: warning: to ensure that they will not overwrite" 1>&2
-	      $AR t "$xabs" | sort | uniq -cd | while read -r count name
-	      do
-		i=1
-		while test "$i" -le "$count"
-		do
-		 # Put our $i before any first dot (extension)
-		 # Never overwrite any file
-		 name_to="$name"
-		 while test "X$name_to" = "X$name" || test -f "$xdir/$name_to"
-		 do
-		   name_to=`$echo "X$name_to" | $Xsed -e "s/\([^.]*\)/\1-$i/"`
-		 done
-		 $show "(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')"
-		 $run eval "(cd \$xdir && $AR xN $i \$xabs '$name' && $mv '$name' '$name_to')" || exit $?
-		 i=`expr $i + 1`
-		done
-	      done
-	    fi
-
-	    reload_conv_objs="$reload_objs "`find $xdir -name \*.$objext -print -o -name \*.lo -print | $NL2SP`
-	  done
+	  func_extract_archives $gentop $convenience
+	  reload_conv_objs="$reload_objs $func_extract_archives_result"
 	fi
       fi
 
@@ -4296,12 +4418,12 @@
 
 	    # Prepare the list of exported symbols
 	    if test -z "$export_symbols"; then
-	      export_symbols="$output_objdir/$output.exp"
+	      export_symbols="$output_objdir/$outputname.exp"
 	      $run $rm $export_symbols
 	      $run eval "${SED} -n -e '/^: @PROGRAM@$/d' -e 's/^.* \(.*\)$/\1/p' "'< "$nlist" > "$export_symbols"'
 	    else
-	      $run eval "${SED} -e 's/\([][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'"' < "$export_symbols" > "$output_objdir/$output.exp"'
-	      $run eval 'grep -f "$output_objdir/$output.exp" < "$nlist" > "$nlist"T'
+	      $run eval "${SED} -e 's/\([ ][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'"' < "$export_symbols" > "$output_objdir/$outputname.exp"'
+	      $run eval 'grep -f "$output_objdir/$outputname.exp" < "$nlist" > "$nlist"T'
 	      $run eval 'mv "$nlist"T "$nlist"'
 	    fi
 	  fi
@@ -4353,7 +4475,26 @@
 #endif
 
 /* The mapping between symbol names and symbols. */
+"
+
+	    case $host in
+	    *cygwin* | *mingw* )
+	  $echo >> "$output_objdir/$dlsyms" "\
+/* DATA imports from DLLs on WIN32 can't be const, because
+   runtime relocations are performed -- see ld's documentation
+   on pseudo-relocs */
+struct {
+"
+	      ;;
+	    * )
+	  $echo >> "$output_objdir/$dlsyms" "\
 const struct {
+"
+	      ;;
+	    esac
+
+
+	  $echo >> "$output_objdir/$dlsyms" "\
   const char *name;
   lt_ptr address;
 }
@@ -4582,7 +4723,7 @@
 	esac
 	case $host in
 	  *cygwin* | *mingw* )
-	    cwrappersource=`$echo ${objdir}/lt-${output}.c`
+	    cwrappersource=`$echo ${objdir}/lt-${outputname}.c`
 	    cwrapper=`$echo ${output}.exe`
 	    $rm $cwrappersource $cwrapper
 	    trap "$rm $cwrappersource $cwrapper; exit $EXIT_FAILURE" 1 2 15
@@ -4815,7 +4956,7 @@
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
-if test \"\${CDPATH+set}\" = set; then CDPATH=:; export CDPATH; fi
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 relink_command=\"$relink_command\"
 
@@ -4992,71 +5133,73 @@
 
       if test -n "$addlibs"; then
 	gentop="$output_objdir/${outputname}x"
-	$show "${rm}r $gentop"
-	$run ${rm}r "$gentop"
-	$show "$mkdir $gentop"
-	$run $mkdir "$gentop"
-	status=$?
-	if test "$status" -ne 0 && test ! -d "$gentop"; then
-	  exit $status
-	fi
 	generated="$generated $gentop"
 
-	# Add in members from convenience archives.
-	for xlib in $addlibs; do
-	  # Extract the objects.
-	  case $xlib in
-	  [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
-	  *) xabs=`pwd`"/$xlib" ;;
-	  esac
-	  xlib=`$echo "X$xlib" | $Xsed -e 's%^.*/%%'`
-	  xdir="$gentop/$xlib"
-
-	  $show "${rm}r $xdir"
-	  $run ${rm}r "$xdir"
-	  $show "$mkdir $xdir"
-	  $run $mkdir "$xdir"
-	  status=$?
-	  if test "$status" -ne 0 && test ! -d "$xdir"; then
-	    exit $status
-	  fi
-	  # We will extract separately just the conflicting names and we will no
-	  # longer touch any unique names. It is faster to leave these extract
-	  # automatically by $AR in one run.
-	  $show "(cd $xdir && $AR x $xabs)"
-	  $run eval "(cd \$xdir && $AR x \$xabs)" || exit $?
-	  if ($AR t "$xabs" | sort | sort -uc >/dev/null 2>&1); then
-	    :
-	  else
-	    $echo "$modename: warning: object name conflicts; renaming object files" 1>&2
-	    $echo "$modename: warning: to ensure that they will not overwrite" 1>&2
-	    $AR t "$xabs" | sort | uniq -cd | while read -r count name
-	    do
-	      i=1
-	      while test "$i" -le "$count"
-	      do
-	       # Put our $i before any first dot (extension)
-	       # Never overwrite any file
-	       name_to="$name"
-	       while test "X$name_to" = "X$name" || test -f "$xdir/$name_to"
-	       do
-		 name_to=`$echo "X$name_to" | $Xsed -e "s/\([^.]*\)/\1-$i/"`
-	       done
-	       $show "(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')"
-	       $run eval "(cd \$xdir && $AR xN $i \$xabs '$name' && $mv '$name' '$name_to')" || exit $?
-	       i=`expr $i + 1`
-	      done
-	    done
-	  fi
-
-	  oldobjs="$oldobjs "`find $xdir -name \*.${objext} -print -o -name \*.lo -print | $NL2SP`
-	done
+	func_extract_archives $gentop $addlibs
+	oldobjs="$oldobjs $func_extract_archives_result"
       fi
 
       # Do each command in the archive commands.
       if test -n "$old_archive_from_new_cmds" && test "$build_libtool_libs" = yes; then
        cmds=$old_archive_from_new_cmds
       else
+	# POSIX demands no paths to be encoded in archives.  We have
+	# to avoid creating archives with duplicate basenames if we
+	# might have to extract them afterwards, e.g., when creating a
+	# static archive out of a convenience library, or when linking
+	# the entirety of a libtool archive into another (currently
+	# not supported by libtool).
+	if (for obj in $oldobjs
+	    do
+	      $echo "X$obj" | $Xsed -e 's%^.*/%%'
+	    done | sort | sort -uc >/dev/null 2>&1); then
+	  :
+	else
+	  $echo "copying selected object files to avoid basename conflicts..."
+
+	  if test -z "$gentop"; then
+	    gentop="$output_objdir/${outputname}x"
+	    generated="$generated $gentop"
+
+	    $show "${rm}r $gentop"
+	    $run ${rm}r "$gentop"
+	    $show "$mkdir $gentop"
+	    $run $mkdir "$gentop"
+	    status=$?
+	    if test "$status" -ne 0 && test ! -d "$gentop"; then
+	      exit $status
+	    fi
+	  fi
+
+	  save_oldobjs=$oldobjs
+	  oldobjs=
+	  counter=1
+	  for obj in $save_oldobjs
+	  do
+	    objbase=`$echo "X$obj" | $Xsed -e 's%^.*/%%'`
+	    case " $oldobjs " in
+	    " ") oldobjs=$obj ;;
+	    *[\ /]"$objbase "*)
+	      while :; do
+		# Make sure we don't pick an alternate name that also
+		# overlaps.
+		newobj=lt$counter-$objbase
+		counter=`expr $counter + 1`
+		case " $oldobjs " in
+		*[\ /]"$newobj "*) ;;
+		*) if test ! -f "$gentop/$newobj"; then break; fi ;;
+		esac
+	      done
+	      $show "ln $obj $gentop/$newobj || cp $obj $gentop/$newobj"
+	      $run ln "$obj" "$gentop/$newobj" ||
+	      $run cp "$obj" "$gentop/$newobj"
+	      oldobjs="$oldobjs $gentop/$newobj"
+	      ;;
+	    *) oldobjs="$oldobjs $obj" ;;
+	    esac
+	  done
+	fi
+
 	eval cmds=\"$old_archive_cmds\"
 
 	if len=`expr "X$cmds" : ".*"` &&
@@ -5070,20 +5213,7 @@
 	  objlist=
 	  concat_cmds=
 	  save_oldobjs=$oldobjs
-	  # GNU ar 2.10+ was changed to match POSIX; thus no paths are
-	  # encoded into archives.  This makes 'ar r' malfunction in
-	  # this piecewise linking case whenever conflicting object
-	  # names appear in distinct ar calls; check, warn and compensate.
-	    if (for obj in $save_oldobjs
-	    do
-	      $echo "X$obj" | $Xsed -e 's%^.*/%%'
-	    done | sort | sort -uc >/dev/null 2>&1); then
-	    :
-	  else
-	    $echo "$modename: warning: object name conflicts; overriding AR_FLAGS to 'cq'" 1>&2
-	    $echo "$modename: warning: to ensure that POSIX-compatible ar will work" 1>&2
-	    AR_FLAGS=cq
-	  fi
+
 	  # Is there a better way of finding the last object in the list?
 	  for obj in $save_oldobjs
 	  do
@@ -5177,9 +5307,53 @@
 		  $echo "$modename: \`$deplib' is not a valid libtool archive" 1>&2
 		  exit $EXIT_FAILURE
 		fi
-		newdependency_libs="$newdependency_libs $libdir/$name"
+		if test "X$EGREP" = X ; then
+			EGREP=egrep
+		fi
+		# We do not want portage's install root ($D) present.  Check only for
+		# this if the .la is being installed.
+		if test "$installed" = yes && test "$D"; then
+		  eval mynewdependency_lib=`echo "$libdir/$name" |sed -e "s:$D:/:g" -e 's:/\+:/:g'`
+		else
+		  mynewdependency_lib="$libdir/$name"
+		fi
+		# Do not add duplicates
+		if test "$mynewdependency_lib"; then
+		  my_little_ninja_foo_1=`echo $newdependency_libs |$EGREP -e "$mynewdependency_lib"`
+		  if test -z "$my_little_ninja_foo_1"; then
+		    newdependency_libs="$newdependency_libs $mynewdependency_lib"
+		  fi
+		fi
 		;;
-	      *) newdependency_libs="$newdependency_libs $deplib" ;;
+		  *)
+		if test "$installed" = yes; then
+		  # Rather use S=WORKDIR if our version of portage supports it.
+		  # This is because some ebuild (gcc) do not use $S as buildroot.
+		  if test "$PWORKDIR"; then
+		    S="$PWORKDIR"
+		  fi
+		  # We do not want portage's build root ($S) present.
+		  my_little_ninja_foo_2=`echo $deplib |$EGREP -e "$S"`
+		  if test -n "$my_little_ninja_foo_2" && test "$S"; then
+		    mynewdependency_lib=""
+		  # We do not want portage's install root ($D) present.
+		  my_little_ninja_foo_3=`echo $deplib |$EGREP -e "$D"`
+		  elif test -n "$my_little_ninja_foo_3" && test "$D"; then
+		    eval mynewdependency_lib=`echo "$deplib" |sed -e "s:$D:/:g" -e 's:/\+:/:g'`
+		  else
+		    mynewdependency_lib="$deplib"
+		  fi
+		else
+		  mynewdependency_lib="$deplib"
+		fi
+		# Do not add duplicates
+		if test "$mynewdependency_lib"; then
+		  my_little_ninja_foo_4=`echo $newdependency_libs |$EGREP -e "$mynewdependency_lib"`
+		  if test -z "$my_little_ninja_foo_4"; then
+			newdependency_libs="$newdependency_libs $mynewdependency_lib"
+		  fi
+		fi
+		;;
 	      esac
 	    done
 	    dependency_libs="$newdependency_libs"
@@ -5231,6 +5405,10 @@
 	  case $host,$output,$installed,$module,$dlname in
 	    *cygwin*,*lai,yes,no,*.dll | *mingw*,*lai,yes,no,*.dll) tdlname=../bin/$dlname ;;
 	  esac
+	  # Do not add duplicates
+	  if test "$installed" = yes && test "$D"; then
+	    install_libdir=`echo "$install_libdir" |sed -e "s:$D:/:g" -e 's:/\+:/:g'`
+	  fi
 	  $echo > $output "\
 # $outputname - a libtool library file
 # Generated by $PROGRAM - GNU $PACKAGE $VERSION$TIMESTAMP
@@ -5295,7 +5473,7 @@
       # Aesthetically quote it.
       arg=`$echo "X$nonopt" | $Xsed -e "$sed_quote_subst"`
       case $arg in
-      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	arg="\"$arg\""
 	;;
       esac
@@ -5311,7 +5489,7 @@
     # Aesthetically quote it.
     arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
     case $arg in
-    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
+    *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
       arg="\"$arg\""
       ;;
     esac
@@ -5359,7 +5537,7 @@
       # Aesthetically quote the argument.
       arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
       case $arg in
-      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
+      *$quote_scanset* | *]* | *\|* | *\&* | *\(* | *\)* | "")
 	arg="\"$arg\""
 	;;
       esac
@@ -6398,7 +6576,7 @@
 $echo
 $echo "Try \`$modename --help' for more information about other modes."
 
-exit $EXIT_SUCCESS
+exit $?
 
 # The TAGs below are defined such that we never get into a situation
 # in which we disable both kinds of libraries.  Given conflicting

Modified: branches/mloskot-style-refactoring/openspacerc.in
===================================================================
--- branches/mloskot-style-refactoring/openspacerc.in	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/openspacerc.in	2006-02-11 21:32:58 UTC (rev 240)
@@ -213,31 +213,38 @@
 		</filter_files>
 		
 		
-		<mkdir>
+		<OSMkdir>
 			<type>PLUGIN</type>
-		</mkdir>
-		<access>
+			<text>mkdir</text>
+		</OSMkdir>
+		<OSAccess>
 			<type>PLUGIN</type>
-		</access>
+			<text>access</text>
+		</OSAccess>
 		<remove>
 			<type>INTERNAL</type>
 			<key>Delete</key>
 		</remove>
-		<rename>
+		<OSRename>
 			<type>PLUGIN</type>
-		</rename>
-		<clone>
+			<text>rename</text>
+		</OSRename>
+		<OSClone>
 			<type>PLUGIN</type>
-		</clone>
-		<symlink>
+			<text>clone</text>
+		</OSClone>
+		<OSSymlink>
 			<type>PLUGIN</type>
-		</symlink>
-		<compress>
+			<text>symlink</text>
+		</OSSymlink>
+		<OSCompress>
 			<type>PLUGIN</type>
-		</compress>
-		<editsymlink>
+			<text>compress</text>
+		</OSCompress>
+		<OSEditSymlink>
 			<type>PLUGIN</type>
-		</editsymlink>
+			<text>edit symlink</text>
+		</OSEditSymlink>
 		<other>
 			<type>INTERNAL</type>
 			<icon>other</icon>
@@ -426,20 +433,20 @@
 		<common>
 			<command>copy</command>
 			<command>move</command>
-			<command>mkdir</command>
-			<command>access</command>
+			<command>OSMkdir</command>
+			<command>OSAccess</command>
 			<command>remove</command>
-			<command>rename</command>
-			<command>clone</command>
-			<command>symlink</command>
-			<command>editsymlink</command>
+			<command>OSRename</command>
+			<command>OSClone</command>
+			<command>OSSymlink</command>
+			<command>OSEditSymlink</command>
 			<command>special</command>
 			<command>totalsize</command>
 			<command>new_file</command>
 			<command>ls</command>
 		</common>
 		<compress>
-			<command>compress</command>
+			<command>OSCompress</command>
 		</compress>
 		
 		<panel>

Modified: branches/mloskot-style-refactoring/src/Makefile
===================================================================
--- branches/mloskot-style-refactoring/src/Makefile	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/Makefile	2006-02-11 21:32:58 UTC (rev 240)
@@ -25,7 +25,7 @@
 pkgincludedir = $(includedir)/openspace
 top_builddir = ..
 am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
-INSTALL = /usr/bin/install -c
+INSTALL = /bin/install -c
 install_sh_DATA = $(install_sh) -c -m 644
 install_sh_PROGRAM = $(install_sh) -c
 install_sh_SCRIPT = $(install_sh) -c
@@ -37,7 +37,7 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-host_triplet = x86_64-unknown-linux-gnu
+host_triplet = i686-pc-linux-gnu
 bin_PROGRAMS = openspace$(EXEEXT)
 subdir = src
 DIST_COMMON = $(noinst_HEADERS) $(srcdir)/Makefile.am \
@@ -112,14 +112,14 @@
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-ACLOCAL = ${SHELL} /home/mloskot/dev/openspace/work/missing --run aclocal-1.8
+ACLOCAL = ${SHELL} /root/openspace/missing --run aclocal-1.8
 AMDEP_FALSE = #
 AMDEP_TRUE = 
-AMTAR = ${SHELL} /home/mloskot/dev/openspace/work/missing --run tar
+AMTAR = ${SHELL} /root/openspace/missing --run tar
 AR = ar
-AUTOCONF = ${SHELL} /home/mloskot/dev/openspace/work/missing --run autoconf
-AUTOHEADER = ${SHELL} /home/mloskot/dev/openspace/work/missing --run autoheader
-AUTOMAKE = ${SHELL} /home/mloskot/dev/openspace/work/missing --run automake-1.8
+AUTOCONF = ${SHELL} /root/openspace/missing --run autoconf
+AUTOHEADER = ${SHELL} /root/openspace/missing --run autoheader
+AUTOMAKE = ${SHELL} /root/openspace/missing --run automake-1.8
 AWK = gawk
 CC = gcc
 CCDEPMODE = depmode=gcc3
@@ -152,20 +152,20 @@
 LIBTOOL = $(SHELL) $(top_builddir)/libtool
 LN_S = ln -s
 LTLIBOBJS = 
-MAKEINFO = ${SHELL} /home/mloskot/dev/openspace/work/missing --run makeinfo
+MAKEINFO = ${SHELL} /root/openspace/missing --run makeinfo
 OBJEXT = o
 PACKAGE = openspace
 PACKAGE_BUGREPORT = http://openspace.linux.pl
 PACKAGE_NAME = openspace
-PACKAGE_STRING = openspace 0.1.1
+PACKAGE_STRING = openspace 0.2.0
 PACKAGE_TARNAME = openspace
-PACKAGE_VERSION = 0.1.1
+PACKAGE_VERSION = 0.2.0
 PATH_SEPARATOR = :
 RANLIB = ranlib
 SET_MAKE = 
 SHELL = /bin/sh
 STRIP = strip
-VERSION = 0.1.1
+VERSION = 0.2.0
 XML2_CONFIG = yes
 ac_ct_AR = ar
 ac_ct_CC = gcc
@@ -181,32 +181,32 @@
 am__leading_dot = .
 am__quote = 
 bindir = ${exec_prefix}/bin
-build = x86_64-unknown-linux-gnu
+build = i686-pc-linux-gnu
 build_alias = 
-build_cpu = x86_64
+build_cpu = i686
 build_os = linux-gnu
-build_vendor = unknown
+build_vendor = pc
 datadir = ${prefix}/share
 exec_prefix = ${prefix}
-host = x86_64-unknown-linux-gnu
+host = i686-pc-linux-gnu
 host_alias = 
-host_cpu = x86_64
+host_cpu = i686
 host_os = linux-gnu
-host_vendor = unknown
+host_vendor = pc
 includedir = ${prefix}/include
 infodir = ${prefix}/info
-install_sh = /home/mloskot/dev/openspace/work/install-sh
+install_sh = /root/openspace/install-sh
 libdir = ${exec_prefix}/lib
 libexecdir = ${exec_prefix}/libexec
 localstatedir = ${prefix}/var
 mandir = ${prefix}/man
 mkdir_p = mkdir -p -- .
 oldincludedir = /usr/include
-prefix = /home/mloskot/usr
+prefix = /usr
 program_transform_name = s,x,x,
 sbindir = ${exec_prefix}/sbin
 sharedstatedir = ${prefix}/com
-sysconfdir = ${prefix}/etc
+sysconfdir = /etc
 target_alias = 
 openspace_SOURCES = main.cpp OSCMDDialogBox.cpp OSCMDDialogBox.h \
 	OSCommandTypeInfo.cpp OSCommandTypeInfo.h OSConfigure.cpp OSConfigure.h OSFile.h \

Modified: branches/mloskot-style-refactoring/src/OSCMDDialogBox.h
===================================================================
--- branches/mloskot-style-refactoring/src/OSCMDDialogBox.h	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/OSCMDDialogBox.h	2006-02-11 21:32:58 UTC (rev 240)
@@ -31,10 +31,10 @@
 #include <vector>
 #include <string>
 
+#include "OSVirtualFileSystemBase.h"
+
 using namespace std;
 
-// Forward declarations
-class OSVirtualFileSystemBase;
 
 /**
  * Command dialog base class.

Modified: branches/mloskot-style-refactoring/src/config.h
===================================================================
--- branches/mloskot-style-refactoring/src/config.h	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/config.h	2006-02-11 21:32:58 UTC (rev 240)
@@ -134,19 +134,19 @@
 #define PACKAGE_NAME "openspace"
 
 /* Define to the full name and version of this package. */
-#define PACKAGE_STRING "openspace 0.1.1"
+#define PACKAGE_STRING "openspace 0.2.0"
 
 /* Define to the one symbol short name of this package. */
 #define PACKAGE_TARNAME "openspace"
 
 /* Define to the version of this package. */
-#define PACKAGE_VERSION "0.1.1"
+#define PACKAGE_VERSION "0.2.0"
 
 /* Define to 1 if you have the ANSI C header files. */
 #define STDC_HEADERS 1
 
 /* Version number of package */
-#define VERSION "0.1.1"
+#define VERSION "0.2.0"
 
 /* Define to empty if `const' does not conform to ANSI C. */
 /* #undef const */

Modified: branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.am
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.am	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.am	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,27 +1,27 @@
-#pkglib_LTLIBRARIES= libaccess.la libmkdir.la librename.la libclone.la libsymlink.la libeditsymlink.la libcompress.la libmd5sum.la
-#pkglibdir=$(libdir)/openspace/plugins/cmddialog
-#INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
+pkglib_LTLIBRARIES=libOSMkdir.la libOSAccess.la libOSRename.la libOSClone.la libOSSymlink.la libOSEditSymlink.la libOSCompress.la libOSMd5sum.la
+pkglibdir=$(libdir)/openspace/plugins/cmddialog
+INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 
-#libaccess_la_SOURCES =access.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#libaccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSMkdir_la_SOURCES =OSMkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libmkdir_la_SOURCES =mkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#libmkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSAccess_la_SOURCES =OSAccess.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSAccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
 
-#librename_la_SOURCES =rename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#librename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSRename_la_SOURCES =OSRename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSRename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libclone_la_SOURCES =clone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libclone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSClone_la_SOURCES =OSClone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSClone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libsymlink_la_SOURCES =symlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSSymlink_la_SOURCES =OSSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libeditsymlink_la_SOURCES =editsymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libeditsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSEditSymlink_la_SOURCES =OSEditSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSEditSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libcompress_la_SOURCES =compress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libcompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSCompress_la_SOURCES =OSCompress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSCompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-#libmd5sum_la_SOURCES =md5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libmd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSMd5sum_la_SOURCES =OSMd5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 

Modified: branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.in
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.in	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/Makefile.in	2006-02-11 21:32:58 UTC (rev 240)
@@ -14,35 +14,12 @@
 
 @SET_MAKE@
 
-#pkglib_LTLIBRARIES= libaccess.la libmkdir.la librename.la libclone.la libsymlink.la libeditsymlink.la libcompress.la libmd5sum.la
-#pkglibdir=$(libdir)/openspace/plugins/cmddialog
-#INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
+SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) $(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) $(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) $(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
 
-#libaccess_la_SOURCES =access.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#libaccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-
-#libmkdir_la_SOURCES =mkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#libmkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-
-#librename_la_SOURCES =rename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../cmddialog.cpp ../../cmddialog.h
-#librename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-
-#libclone_la_SOURCES =clone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libclone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-
-#libsymlink_la_SOURCES =symlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-
-#libeditsymlink_la_SOURCES =editsymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libeditsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-
-#libcompress_la_SOURCES =compress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libcompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
 VPATH = @srcdir@
 pkgdatadir = $(datadir)/@PACKAGE@
-pkglibdir = $(libdir)/@PACKAGE@
 pkgincludedir = $(includedir)/@PACKAGE@
 top_builddir = ../../..
 am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
@@ -68,9 +45,79 @@
 mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
-SOURCES =
-DIST_SOURCES =
+am__installdirs = "$(DESTDIR)$(pkglibdir)"
+pkglibLTLIBRARIES_INSTALL = $(INSTALL)
+LTLIBRARIES = $(pkglib_LTLIBRARIES)
+libOSAccess_la_LIBADD =
+am_libOSAccess_la_OBJECTS = OSAccess.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSAccess_la_OBJECTS = $(am_libOSAccess_la_OBJECTS)
+libOSClone_la_LIBADD =
+am_libOSClone_la_OBJECTS = OSClone.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSClone_la_OBJECTS = $(am_libOSClone_la_OBJECTS)
+libOSCompress_la_LIBADD =
+am_libOSCompress_la_OBJECTS = OSCompress.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSCompress_la_OBJECTS = $(am_libOSCompress_la_OBJECTS)
+libOSEditSymlink_la_LIBADD =
+am_libOSEditSymlink_la_OBJECTS = OSEditSymlink.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSEditSymlink_la_OBJECTS = $(am_libOSEditSymlink_la_OBJECTS)
+libOSMd5sum_la_LIBADD =
+am_libOSMd5sum_la_OBJECTS = OSMd5sum.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSMd5sum_la_OBJECTS = $(am_libOSMd5sum_la_OBJECTS)
+libOSMkdir_la_LIBADD =
+am_libOSMkdir_la_OBJECTS = OSMkdir.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSMkdir_la_OBJECTS = $(am_libOSMkdir_la_OBJECTS)
+libOSRename_la_LIBADD =
+am_libOSRename_la_OBJECTS = OSRename.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSRename_la_OBJECTS = $(am_libOSRename_la_OBJECTS)
+libOSSymlink_la_LIBADD =
+am_libOSSymlink_la_OBJECTS = OSSymlink.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSSymlink_la_OBJECTS = $(am_libOSSymlink_la_OBJECTS)
+DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
+depcomp = $(SHELL) $(top_srcdir)/depcomp
+am__depfiles_maybe = depfiles
+ at AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/OSAccess.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSCMDDialogBox.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSClone.Plo ./$(DEPDIR)/OSCompress.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSEditSymlink.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSMd5sum.Plo ./$(DEPDIR)/OSMkdir.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSRename.Plo ./$(DEPDIR)/OSSymlink.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
+	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CFLAGS) $(CFLAGS)
+CCLD = $(CC)
+LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) \
+	$(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) \
+	$(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) \
+	$(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
+DIST_SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) \
+	$(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) \
+	$(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) \
+	$(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
+ETAGS = etags
+CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+pkglibdir = $(libdir)/openspace/plugins/cmddialog
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -167,9 +214,28 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
+pkglib_LTLIBRARIES = libOSMkdir.la libOSAccess.la libOSRename.la libOSClone.la libOSSymlink.la libOSEditSymlink.la libOSCompress.la libOSMd5sum.la
+INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
+libOSMkdir_la_SOURCES = OSMkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSAccess_la_SOURCES = OSAccess.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSAccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSRename_la_SOURCES = OSRename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSRename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSClone_la_SOURCES = OSClone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSClone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSSymlink_la_SOURCES = OSSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSEditSymlink_la_SOURCES = OSEditSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSEditSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSCompress_la_SOURCES = OSCompress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSCompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSMd5sum_la_SOURCES = OSMd5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 all: all-am
 
 .SUFFIXES:
+.SUFFIXES: .cpp .lo .o .obj
 $(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -199,7 +265,139 @@
 	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
 $(ACLOCAL_M4):  $(am__aclocal_m4_deps)
 	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+install-pkglibLTLIBRARIES: $(pkglib_LTLIBRARIES)
+	@$(NORMAL_INSTALL)
+	test -z "$(pkglibdir)" || $(mkdir_p) "$(DESTDIR)$(pkglibdir)"
+	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
+	  if test -f $$p; then \
+	    f="`echo $$p | sed -e 's|^.*/||'`"; \
+	    echo " $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(pkglibdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(pkglibdir)/$$f"; \
+	  else :; fi; \
+	done
 
+uninstall-pkglibLTLIBRARIES:
+	@$(NORMAL_UNINSTALL)
+	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
+	    p="`echo $$p | sed -e 's|^.*/||'`"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(pkglibdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(pkglibdir)/$$p"; \
+	done
+
+clean-pkglibLTLIBRARIES:
+	-test -z "$(pkglib_LTLIBRARIES)" || rm -f $(pkglib_LTLIBRARIES)
+	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
+	  dir="`echo $$p | sed -e 's|/[^/]*$$||'`"; \
+	  test "$$dir" != "$$p" || dir=.; \
+	  echo "rm -f \"$${dir}/so_locations\""; \
+	  rm -f "$${dir}/so_locations"; \
+	done
+libOSAccess.la: $(libOSAccess_la_OBJECTS) $(libOSAccess_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSAccess_la_LDFLAGS) $(libOSAccess_la_OBJECTS) $(libOSAccess_la_LIBADD) $(LIBS)
+libOSClone.la: $(libOSClone_la_OBJECTS) $(libOSClone_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSClone_la_LDFLAGS) $(libOSClone_la_OBJECTS) $(libOSClone_la_LIBADD) $(LIBS)
+libOSCompress.la: $(libOSCompress_la_OBJECTS) $(libOSCompress_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSCompress_la_LDFLAGS) $(libOSCompress_la_OBJECTS) $(libOSCompress_la_LIBADD) $(LIBS)
+libOSEditSymlink.la: $(libOSEditSymlink_la_OBJECTS) $(libOSEditSymlink_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSEditSymlink_la_LDFLAGS) $(libOSEditSymlink_la_OBJECTS) $(libOSEditSymlink_la_LIBADD) $(LIBS)
+libOSMd5sum.la: $(libOSMd5sum_la_OBJECTS) $(libOSMd5sum_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSMd5sum_la_LDFLAGS) $(libOSMd5sum_la_OBJECTS) $(libOSMd5sum_la_LIBADD) $(LIBS)
+libOSMkdir.la: $(libOSMkdir_la_OBJECTS) $(libOSMkdir_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSMkdir_la_LDFLAGS) $(libOSMkdir_la_OBJECTS) $(libOSMkdir_la_LIBADD) $(LIBS)
+libOSRename.la: $(libOSRename_la_OBJECTS) $(libOSRename_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSRename_la_LDFLAGS) $(libOSRename_la_OBJECTS) $(libOSRename_la_LIBADD) $(LIBS)
+libOSSymlink.la: $(libOSSymlink_la_OBJECTS) $(libOSSymlink_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSSymlink_la_LDFLAGS) $(libOSSymlink_la_OBJECTS) $(libOSSymlink_la_LIBADD) $(LIBS)
+
+mostlyclean-compile:
+	-rm -f *.$(OBJEXT)
+
+distclean-compile:
+	-rm -f *.tab.c
+
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSAccess.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCMDDialogBox.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSClone.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCompress.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSEditSymlink.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMd5sum.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMkdir.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSRename.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSSymlink.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Plo at am__quote@
+
+.cpp.o:
+ at am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ $<
+
+.cpp.obj:
+ at am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.cpp.lo:
+ at am__fastdepCXX_TRUE@	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LTCXXCOMPILE) -c -o $@ $<
+
+OSThreadExec.o: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.o -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
+
+OSThreadExec.obj: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.obj -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`
+
+OSThreadExec.lo: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.lo -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Plo"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Plo' tmpdepfile='$(DEPDIR)/OSThreadExec.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
+
+OSCMDDialogBox.o: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.o -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.o `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Po"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Po' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.o `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp
+
+OSCMDDialogBox.obj: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.obj -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.obj `if test -f '../../OSCMDDialogBox.cpp'; then $(CYGPATH_W) '../../OSCMDDialogBox.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSCMDDialogBox.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Po"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Po' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.obj `if test -f '../../OSCMDDialogBox.cpp'; then $(CYGPATH_W) '../../OSCMDDialogBox.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSCMDDialogBox.cpp'; fi`
+
+OSCMDDialogBox.lo: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.lo -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.lo `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Plo"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Plo' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.lo `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp
+
 mostlyclean-libtool:
 	-rm -f *.lo
 
@@ -209,13 +407,55 @@
 distclean-libtool:
 	-rm -f libtool
 uninstall-info-am:
+
+ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
+	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	mkid -fID $$unique
 tags: TAGS
-TAGS:
 
+TAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
+	  test -n "$$unique" || unique=$$empty_fix; \
+	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
+	    $$tags $$unique; \
+	fi
 ctags: CTAGS
-CTAGS:
+CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	test -z "$(CTAGS_ARGS)$$tags$$unique" \
+	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
+	     $$tags $$unique
 
+GTAGS:
+	here=`$(am__cd) $(top_builddir) && pwd` \
+	  && cd $(top_srcdir) \
+	  && gtags -i $(GTAGS_ARGS) $$here
 
+distclean-tags:
+	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
+
 distdir: $(DISTFILES)
 	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
 	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
@@ -245,8 +485,11 @@
 	done
 check-am: all-am
 check: check-am
-all-am: Makefile
+all-am: Makefile $(LTLIBRARIES)
 installdirs:
+	for dir in "$(DESTDIR)$(pkglibdir)"; do \
+	  test -z "$$dir" || $(mkdir_p) "$$dir"; \
+	done
 install: install-am
 install-exec: install-exec-am
 install-data: install-data-am
@@ -273,11 +516,14 @@
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-am
 
-clean-am: clean-generic clean-libtool mostlyclean-am
+clean-am: clean-generic clean-libtool clean-pkglibLTLIBRARIES \
+	mostlyclean-am
 
 distclean: distclean-am
+	-rm -rf ./$(DEPDIR)
 	-rm -f Makefile
-distclean-am: clean-am distclean-generic distclean-libtool
+distclean-am: clean-am distclean-compile distclean-generic \
+	distclean-libtool distclean-tags
 
 dvi: dvi-am
 
@@ -291,7 +537,7 @@
 
 install-data-am:
 
-install-exec-am:
+install-exec-am: install-pkglibLTLIBRARIES
 
 install-info: install-info-am
 
@@ -300,12 +546,14 @@
 installcheck-am:
 
 maintainer-clean: maintainer-clean-am
+	-rm -rf ./$(DEPDIR)
 	-rm -f Makefile
 maintainer-clean-am: distclean-am maintainer-clean-generic
 
 mostlyclean: mostlyclean-am
 
-mostlyclean-am: mostlyclean-generic mostlyclean-libtool
+mostlyclean-am: mostlyclean-compile mostlyclean-generic \
+	mostlyclean-libtool
 
 pdf: pdf-am
 
@@ -315,21 +563,21 @@
 
 ps-am:
 
-uninstall-am: uninstall-info-am
+uninstall-am: uninstall-info-am uninstall-pkglibLTLIBRARIES
 
-.PHONY: all all-am check check-am clean clean-generic clean-libtool \
-	distclean distclean-generic distclean-libtool distdir dvi \
-	dvi-am html html-am info info-am install install-am \
-	install-data install-data-am install-exec install-exec-am \
-	install-info install-info-am install-man install-strip \
-	installcheck installcheck-am installdirs maintainer-clean \
-	maintainer-clean-generic mostlyclean mostlyclean-generic \
-	mostlyclean-libtool pdf pdf-am ps ps-am uninstall uninstall-am \
-	uninstall-info-am
+.PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
+	clean-libtool clean-pkglibLTLIBRARIES ctags distclean \
+	distclean-compile distclean-generic distclean-libtool \
+	distclean-tags distdir dvi dvi-am html html-am info info-am \
+	install install-am install-data install-data-am install-exec \
+	install-exec-am install-info install-info-am install-man \
+	install-pkglibLTLIBRARIES install-strip installcheck \
+	installcheck-am installdirs maintainer-clean \
+	maintainer-clean-generic mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
+	tags uninstall uninstall-am uninstall-info-am \
+	uninstall-pkglibLTLIBRARIES
 
-
-#libmd5sum_la_SOURCES =md5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../cmddialog.cpp ../../cmddialog.h
-#libmd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSAccess.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSAccess.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,228 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+#include <sys/types.h>
+#include <grp.h>
+#include <pwd.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <unistd.h>
+
+
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+class OSAccess:public OSCMDDialogBox
+{
+  FXDECLARE (OSAccess) protected:
+
+    OSAccess (const OSAccess &)
+    {
+    }
+
+  private:
+  
+    FXCheckButton *ur;
+    FXCheckButton *uw;
+    FXCheckButton *ux;
+    FXCheckButton *gr;
+    FXCheckButton *gw;
+    FXCheckButton *gx;
+    FXCheckButton *or_;
+    FXCheckButton *ow;
+    FXCheckButton *ox;
+    FXDataTarget radiotarget;
+    FXRadioButton *set;
+    FXRadioButton *clear;
+    FXRadioButton *add;
+    FXint cmd;
+    FXCheckButton *rec;
+    FXCheckButton *dironly;
+    FXComboBox *user;
+    FXComboBox *userbis;
+    FXComboBox *grp;
+    FXTextField *text;
+
+
+
+  public:
+  
+    enum
+    {
+	ID_PRESS = OSCMDDialogBox::ID_LAST,
+	ID_RUSR,
+	ID_WUSR,
+	ID_XUSR,
+	ID_RGRP,
+	ID_WGRP,
+	ID_XGRP,
+	ID_ROTH,
+	ID_WOTH,
+	ID_XOTH,
+	ID_LAST
+    };
+
+
+
+    
+    OSAccess ()
+    {
+    }
+    OSAccess (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+    virtual int OSAccess::exec (void)
+    {
+
+	unsigned int mode = 0;
+	if (ur->getCheck ())
+	    mode = mode | S_IRUSR;
+	if (uw->getCheck ())
+	    mode = mode | S_IWUSR;
+	if (ux->getCheck ())
+	    mode = mode | S_IXUSR;
+	if (gr->getCheck ())
+	    mode = mode | S_IRGRP;
+	if (gw->getCheck ())
+	    mode = mode | S_IWGRP;
+	if (gx->getCheck ())
+	    mode = mode | S_IXGRP;
+	if (or_->getCheck ())
+	    mode = mode | S_IROTH;
+	if (ow->getCheck ())
+	    mode = mode | S_IWOTH;
+	if (ox->getCheck ())
+	    mode = mode | S_IXOTH;
+
+	bool recursive = false;
+	if (rec->getCheck ())
+	    recursive = true;
+	
+	vector < string >::iterator iter;
+
+    	for (iter = src.begin (); iter != src.end(); iter++)
+   	{
+	
+	    fb->mode (*iter, mode, recursive);
+	   
+	    fb->owner (*iter, user->getText ().text (), recursive);
+	    fb->group (*iter, grp->getText ().text (), recursive);
+	
+	}
+
+    }
+
+
+    long OSAccess::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSAccess) OSAccessMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSAccess::ID_PRESS, OSAccess::press),};
+FXIMPLEMENT (OSAccess, OSCMDDialogBox, OSAccessMap, ARRAYNUMBER (OSAccessMap)) 
+
+OSAccess::OSAccess (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+   vector < string >::iterator iter;
+    for (iter = src.begin (); iter != src.end(); iter++)
+    {
+	new FXLabel (contents, iter->c_str ());
+    }
+
+    FXHorizontalFrame *accessframe = new FXHorizontalFrame (contents, LAYOUT_FILL_X | LAYOUT_FILL_Y);
+    FXHorizontalFrame *chmodframe = new FXHorizontalFrame (contents, PACK_UNIFORM_WIDTH | PACK_UNIFORM_HEIGHT | LAYOUT_FILL_X | LAYOUT_FILL_Y);
+    FXGroupBox *group1 = new FXGroupBox (accessframe, "User", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
+    ur = new FXCheckButton (group1, "Read", this, ID_RUSR);
+    uw = new FXCheckButton (group1, "Write", this, ID_WUSR);
+    ux = new FXCheckButton (group1, "Execute", this, ID_XUSR);
+    FXGroupBox *group2 = new FXGroupBox (accessframe, "Group", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
+    gr = new FXCheckButton (group2, "Read", this, ID_RGRP);
+    gw = new FXCheckButton (group2, "Write", this, ID_WGRP);
+    gx = new FXCheckButton (group2, "Execute", this, ID_XGRP);
+    FXGroupBox *group3 = new FXGroupBox (accessframe, "Others", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
+    or_ = new FXCheckButton (group3, "Read", this, ID_ROTH);
+    ow = new FXCheckButton (group3, "Write", this, ID_WOTH);
+    ox = new FXCheckButton (group3, "Execute", this, ID_XOTH);
+
+    FXGroupBox *group4 = new FXGroupBox (chmodframe, "Options", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
+
+    rec = new FXCheckButton (group4, "Recursive folders", NULL, 0);
+
+
+    FXGroupBox *group5 = new FXGroupBox (chmodframe, "Owner", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
+    new FXLabel (group5, "User");
+    user = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
+    user->setNumVisible (5);
+    new FXLabel (group5, "Group");
+    grp = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
+    grp->setNumVisible (5);
+
+
+    if (fb->mode (src[0]) & S_IRUSR)
+	ur->setCheck ();
+    if (fb->mode (src[0]) & S_IWUSR)
+	uw->setCheck ();
+    if (fb->mode (src[0]) & S_IXUSR)
+	ux->setCheck ();
+    if (fb->mode (src[0]) & S_IRGRP)
+	gr->setCheck ();
+    if (fb->mode (src[0]) & S_IWGRP)
+	gw->setCheck ();
+    if (fb->mode (src[0]) & S_IXGRP)
+	gx->setCheck ();
+
+
+    if (fb->mode (src[0]) & S_IROTH)
+	or_->setCheck ();
+    if (fb->mode (src[0]) & S_IWOTH)
+	ow->setCheck ();
+    if (fb->mode (src[0]) & S_IXOTH)
+	ox->setCheck ();
+
+
+
+    // User names (sorted in ascending order)
+    struct passwd *pwde;
+    while ((pwde = getpwent ()))
+    {
+	user->appendItem (pwde->pw_name);
+
+    }
+    endpwent ();
+    user->setSortFunc (FXList::ascending);
+    user->sortItems ();
+    string own = fb->owner (src[0]);
+    user->setCurrentItem (user->findItem (own.c_str ()));
+
+    // Group names (sorted in ascending order)
+    struct group *grpe;
+    while ((grpe = getgrent ()))
+    {
+	grp->appendItem (grpe->gr_name);
+    }
+    endgrent ();
+    grp->setSortFunc (FXList::ascending);
+    grp->sortItems ();
+    string grou = fb->group (src[0]);
+    grp->setCurrentItem (grp->findItem (grou.c_str ()));
+
+}
+
+long OSAccess::press (FXObject * sender, FXSelector, void *)
+{
+}
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSAccess (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,147 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSClone: public OSCMDDialogBox
+{
+FXDECLARE ( OSClone ) protected:
+
+    OSClone ( const OSClone & )
+    {}
+
+private:
+    vector < FXTextField * >vec;
+    string dir;
+
+public:
+
+    enum
+    {
+        ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+
+    OSClone ()
+    {}
+    OSClone ( FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src );
+
+
+    virtual int OSClone::exec ( void )
+    {
+        int error = 0;
+    /*
+        
+        vector < string >::iterator iter;
+        int i = 0;
+        for ( iter = src.begin (); iter != src.end(); iter++ )
+        {
+            string newname = dir + SEPARATOR + vec[ i ] ->getText ().text ();
+            string newonlyname = vec[ i ] ->getText ().text ();
+
+            string destdir = "/tmp/openspace";
+            string filename = FXFile::name( iter->c_str() ).text();
+            string dirname = FXFile::directory( iter->c_str() ).text();
+
+            thread_elem *el2 = new OSThreadExec ( fb, "copy", "upload", *iter, destdir );
+            fb->copy ( el2 );
+            delete el2;
+
+
+
+            if ( fb->rename ( destdir + "/" + filename, destdir + "/" + newonlyname ) == false )
+            {
+                error = -1;
+                string err = "can't clone " + *iter + " to " + newname;
+
+                FXLabel *lab = new FXLabel ( contents, err.c_str () );
+                lab->create ();
+                this->layout ();
+                this->resize ( this->getWidth (), this->getHeight () + lab->getHeight () );
+
+            }
+            else
+            {
+
+                el2 = new OSThreadExec ( fb, "move", "upload", destdir + "/" + newonlyname, dirname );
+                fb->copy ( el2 );
+                delete el2;
+
+            }
+
+
+            i++;
+        }
+
+    */
+        return error;
+
+    }
+
+
+    long OSClone::press ( FXObject * sender, FXSelector, void * );
+
+};
+
+FXDEFMAP ( OSClone ) OSCloneMap[] =
+    {
+        FXMAPFUNC ( SEL_COMMAND, OSClone::ID_ENTER, OSClone::press ), };
+FXIMPLEMENT ( OSClone, OSCMDDialogBox, OSCloneMap, ARRAYNUMBER ( OSCloneMap ) )
+
+OSClone::OSClone ( FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src ) :
+        OSCMDDialogBox ( w, fb, src )
+{
+
+
+    vector < string >::iterator iter;
+
+    for ( iter = src.begin (); iter != src.end(); iter++ )
+    {
+
+
+        dir = FXFile::directory ( iter->c_str () ).text ();
+
+        FXString name = FXFile::name ( iter->c_str () );
+        new FXLabel ( contents, name );
+        FXTextField *text = new FXTextField ( contents, 25, this, ID_ENTER );
+        text->setFocus ();
+        text->setText ( name );
+        vec.push_back ( text );
+
+    }
+
+
+
+}
+
+long OSClone::press ( FXObject * sender, FXSelector, void * )
+{
+
+    FXObject * target = ( FXObject * ) ok->getTarget ();
+    target->handle ( ok, FXSEL ( SEL_COMMAND, ID_COMMAND ), NULL );
+
+}
+
+
+
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog ( FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src )
+{
+    return new OSClone ( w, fb, src );
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSCompress.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSCompress.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,119 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSCompress:public OSCMDDialogBox
+{
+  FXDECLARE (OSCompress) protected:
+
+    OSCompress (const OSCompress &)
+    {
+    }
+
+  private:
+   
+    string dir;
+    FXTextField *textfield;
+    FXComboBox* combo;
+
+  public:
+
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+
+       OSCompress ()
+    {
+    }
+    OSCompress (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+
+    virtual int OSCompress::exec (void)
+    {
+	int error = 0;
+	vector < string >::iterator iter;
+	string file_list;
+	string arch_filename=textfield->getText().text();
+	string type=combo->getText().text();
+	
+    	for (iter = src.begin (); iter != src.end(); iter++)
+    	{
+		string sr = (*iter);
+		sr=FXFile::name(sr.c_str()).text();
+		file_list+=" \"" +  sr + "\"";
+	}
+
+	string command;
+	if(type=="tar.bz2")
+	command="tar cjf " + arch_filename +".tar.bz2 "+ file_list;
+	else
+	command="tar czf " + arch_filename +".tar.gz "+ file_list;
+	
+	system(command.c_str());
+
+
+    }
+
+
+    long OSCompress::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSCompress) OSCompressMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSCompress::ID_ENTER, OSCompress::press),};
+FXIMPLEMENT (OSCompress, OSCMDDialogBox, OSCompressMap, ARRAYNUMBER (OSCompressMap)) 
+
+OSCompress::OSCompress (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+  new FXLabel(contents,"archive type: ");
+
+    combo = new FXComboBox (contents, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
+    combo->setNumVisible (3);
+    combo->appendItem("tar.bz2");
+    combo->appendItem("tar.gz");
+
+	new FXLabel(contents,"archive filename: ");
+	textfield = new FXTextField (contents, 25, this, ID_ENTER);
+	textfield->setFocus ();
+
+
+}
+
+long OSCompress::press (FXObject * sender, FXSelector, void *)
+{
+
+    FXObject *target = (FXObject *) ok->getTarget ();
+    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
+
+}
+
+
+
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSCompress (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,143 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSEditSymlink:public OSCMDDialogBox
+{
+  FXDECLARE (OSEditSymlink) protected:
+
+    OSEditSymlink (const OSEditSymlink &)
+    {
+    }
+    
+  private:
+   
+    vector < FXTextField * >vec;
+    string dir;
+    FXCheckButton *hardlink;  
+
+  public:
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+    OSEditSymlink ()
+    {
+    }
+    OSEditSymlink (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+
+    virtual int OSEditSymlink::exec (void)
+    {
+    
+        int error = 0;
+    /*
+	
+	vector < string >::iterator iter;
+	int i=0;
+    	for (iter = src.begin (); iter != src.end(); iter++)
+    	{
+	
+	string newname = vec[i]->getText ().text ();
+	delete vec[i];
+	i++;
+	if(newname=="")
+	continue;
+
+	    
+  
+	int error = 0;
+	    vector<string> srcfile;
+	    srcfile.push_back(*iter);
+	    thread_elem *el = new thread_elem (fb, "remove", "",srcfile);
+	    fb->remove(el);
+	
+           bool ret=fb->symlink ( newname,*iter);	
+	
+	    if ( ret== false)
+	    {
+		error = -1;
+		string err = "can't symlink " + *iter + " to " + newname;
+
+		FXLabel *lab = new FXLabel (contents, err.c_str ());
+		lab->create ();
+		this->layout ();
+		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
+
+	    }
+	
+	}
+
+    */	
+	return error;
+	
+    }
+
+
+
+    long OSEditSymlink::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSEditSymlink) OSEditSymlinkMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSEditSymlink::ID_ENTER, OSEditSymlink::press),};
+FXIMPLEMENT (OSEditSymlink, OSCMDDialogBox, OSEditSymlinkMap, ARRAYNUMBER (OSEditSymlinkMap)) 
+
+OSEditSymlink::OSEditSymlink (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+
+    vector < string >::iterator iter;
+
+    for (iter = src.begin (); iter != src.end(); iter++)
+    {
+	string sym=fb->symlink(*iter);
+	if(sym=="")
+	continue;
+
+	new FXLabel(contents,"source: ");
+	new FXLabel (contents, iter->c_str ());
+	new FXLabel(contents,"link: ");
+	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
+	text->setFocus ();
+	text->setText (sym.c_str());
+	vec.push_back (text);
+
+    }
+
+
+}
+
+long OSEditSymlink::press (FXObject * sender, FXSelector, void *)
+{
+
+    FXObject *target = (FXObject *) ok->getTarget ();
+    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
+
+}
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSEditSymlink (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,112 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+#include <fstream>
+#include <sstream>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSMd5sum:public OSCMDDialogBox
+{
+  FXDECLARE (OSMd5sum) protected:
+
+    OSMd5sum (const OSMd5sum &)
+    {
+    }
+    
+  private:
+
+ 
+
+  public:
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+    OSMd5sum ()
+    {
+    }
+    OSMd5sum (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+
+    virtual int OSMd5sum::exec (void)
+    {
+	
+    }
+
+
+    long OSMd5sum::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSMd5sum) OSMd5sumMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSMd5sum::ID_ENTER, OSMd5sum::press),};
+FXIMPLEMENT (OSMd5sum, OSCMDDialogBox, OSMd5sumMap, ARRAYNUMBER (OSMd5sumMap)) 
+
+OSMd5sum::OSMd5sum (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+FILE *pipe;
+char readbuf[1024];
+
+    vector < string >::iterator iter;
+FXPacker *vv = new FXGroupBox (contents, "info", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
+new FXLabel(vv,"MD5SUM additional plugin - Mateusz Dworak - GPL ");
+new FXSeparator(contents);
+    for (iter = src.begin (); iter != src.end(); iter++)
+    {
+  
+	string cmd="md5sum "+*iter;
+	pipe = popen (cmd.c_str(), "r");
+
+    	if (pipe != NULL)
+   	{
+		string line;
+		while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
+		{
+		std::stringstream parser (readbuf);
+		string md5;	
+		parser >> md5;
+		
+		new FXLabel(contents,iter->c_str());
+		FXTextField*textfield = new FXTextField (contents, 31);
+		textfield->setText(md5.c_str());
+		}
+	}
+
+    }
+
+
+
+}
+
+long OSMd5sum::press (FXObject * sender, FXSelector, void *)
+{
+
+ 
+
+}
+
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSMd5sum (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMkdir.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMkdir.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,75 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+class OSMkdir:public OSCMDDialogBox
+{
+  FXDECLARE (OSMkdir) protected:
+
+    OSMkdir (const OSMkdir &)
+    {
+    }
+  private:
+  FXTextField *text;
+
+  public:
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+    OSMkdir ()
+    {
+    }
+    OSMkdir (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+    int OSMkdir::exec (void)
+    {
+	string s = text->getText ().text ();
+	fb->mkdir (s, 493);
+    }
+
+
+    long OSMkdir::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSMkdir) OSMkdirMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSMkdir::ID_ENTER, OSMkdir::press),};
+FXIMPLEMENT (OSMkdir, OSCMDDialogBox, OSMkdirMap, ARRAYNUMBER (OSMkdirMap)) 
+
+OSMkdir::OSMkdir (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+
+    text = new FXTextField (contents, 25, this, ID_ENTER);
+    text->setFocus ();
+
+}
+
+long OSMkdir::press (FXObject * sender, FXSelector, void *)
+{
+
+    FXObject *target = (FXObject *) ok->getTarget ();
+    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
+
+}
+
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSMkdir (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSRename.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSRename.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,124 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSRename:public OSCMDDialogBox
+{
+  FXDECLARE (OSRename) protected:
+
+    OSRename (const OSRename &)
+    {
+    }
+    
+  private:
+
+    vector < FXTextField * >vec;
+    string dir;  
+
+  public:
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+    OSRename ()
+    {
+    }
+    OSRename (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+
+    virtual int OSRename::exec (void)
+    {
+	int error = 0;
+	vector < string >::iterator iter;
+	int i=0;
+    	for (iter = src.begin (); iter != src.end(); iter++)
+    	{
+	    string newname = dir + SEPARATOR + vec[i]->getText ().text ();
+	    if (fb->rename (*iter, newname) == false)
+	    {
+		error = -1;
+		string err = "can't rename " + *iter + " to " + newname;
+
+		FXLabel *lab = new FXLabel (contents, err.c_str ());
+		lab->create ();
+		this->layout ();
+		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
+
+	    }
+	i++;
+	}
+
+
+	return error;
+
+    }
+
+
+    long OSRename::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSRename) OSRenameMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSRename::ID_ENTER, OSRename::press),};
+FXIMPLEMENT (OSRename, OSCMDDialogBox, OSRenameMap, ARRAYNUMBER (OSRenameMap)) 
+
+OSRename::OSRename (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+
+    vector < string >::iterator iter;
+
+    for (iter = src.begin (); iter != src.end(); iter++)
+    {
+  
+
+	dir = FXFile::directory (iter->c_str ()).text ();
+	//fxmessage(dir.c_str());
+	//fxmessage("\n woho");
+	FXString name = FXFile::name (iter->c_str ());
+	new FXLabel (contents, name);
+	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
+	text->setFocus ();
+	text->setText (name);
+	vec.push_back (text);
+
+    }
+
+
+
+}
+
+long OSRename::press (FXObject * sender, FXSelector, void *)
+{
+
+    FXObject *target = (FXObject *) ok->getTarget ();
+    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
+
+}
+
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSRename (w, fb, src);
+}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSSymlink.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSSymlink.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -0,0 +1,129 @@
+#include <fx.h>
+#include "../../OSCMDDialogBox.h"
+
+#include <string>
+using namespace std;
+
+#ifdef WIN32
+#define EXPORTFUNCTION extern "C" __declspec(dllexport)
+#else
+#define EXPORTFUNCTION extern "C"
+#endif
+
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+class OSSymlink:public OSCMDDialogBox
+{
+  FXDECLARE (OSSymlink) protected:
+
+    OSSymlink (const OSSymlink &)
+    {
+    }
+
+  private:
+  
+    vector < FXTextField * >vec;
+    string dir;
+    FXCheckButton *hardlink;
+
+  public:
+
+    enum
+    {
+	ID_ENTER = OSCMDDialogBox::ID_LAST,
+    };
+
+    OSSymlink ()
+    {
+    }
+    OSSymlink (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
+
+
+    virtual int OSSymlink::exec (void)
+    {
+	int error = 0;
+	vector < string >::iterator iter;
+	int i=0;
+    	for (iter = src.begin (); iter != src.end(); iter++)
+    	{
+	    string newname =  vec[i]->getText ().text ();
+	    
+	    bool ret;
+	    if (hardlink->getCheck ())
+	    	ret=fb->hardlink (*iter, newname);
+	    else
+	        ret=fb->symlink (*iter, newname);	
+			
+	    if ( ret== false)
+	    {
+		error = -1;
+		string err = "can't symlink " + *iter + " to " + newname;
+
+		FXLabel *lab = new FXLabel (contents, err.c_str ());
+		lab->create ();
+		this->layout ();
+		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
+
+	    }
+	i++;
+	}
+
+
+	return error;
+
+    }
+
+
+    long OSSymlink::press (FXObject * sender, FXSelector, void *);
+
+};
+
+FXDEFMAP (OSSymlink) OSSymlinkMap[] =
+{
+FXMAPFUNC (SEL_COMMAND, OSSymlink::ID_ENTER, OSSymlink::press),};
+FXIMPLEMENT (OSSymlink, OSCMDDialogBox, OSSymlinkMap, ARRAYNUMBER (OSSymlinkMap)) 
+
+OSSymlink::OSSymlink (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
+OSCMDDialogBox (w, fb, src)
+{
+
+
+    vector < string >::iterator iter;
+
+    for (iter = src.begin (); iter != src.end(); iter++)
+    {
+  
+
+	new FXLabel(contents,"source: ");
+	new FXLabel (contents, iter->c_str ());
+	new FXLabel(contents,"link: ");
+	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
+	text->setFocus ();
+	text->setText (iter->c_str ());
+	vec.push_back (text);
+
+    }
+
+hardlink = new FXCheckButton (contents, "hardlink");
+
+}
+
+long OSSymlink::press (FXObject * sender, FXSelector, void *)
+{
+
+    FXObject *target = (FXObject *) ok->getTarget ();
+    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
+
+}
+
+
+EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
+{
+    return new OSSymlink (w, fb, src);
+}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/access.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,228 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-#include <sys/types.h>
-#include <grp.h>
-#include <pwd.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-
-
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-class access_cmddialog:public cmddialog
-{
-  FXDECLARE (access_cmddialog) protected:
-
-    access_cmddialog (const access_cmddialog &)
-    {
-    }
-
-  private:
-  
-    FXCheckButton *ur;
-    FXCheckButton *uw;
-    FXCheckButton *ux;
-    FXCheckButton *gr;
-    FXCheckButton *gw;
-    FXCheckButton *gx;
-    FXCheckButton *or_;
-    FXCheckButton *ow;
-    FXCheckButton *ox;
-    FXDataTarget radiotarget;
-    FXRadioButton *set;
-    FXRadioButton *clear;
-    FXRadioButton *add;
-    FXint cmd;
-    FXCheckButton *rec;
-    FXCheckButton *dironly;
-    FXComboBox *user;
-    FXComboBox *userbis;
-    FXComboBox *grp;
-    FXTextField *text;
-
-
-
-  public:
-  
-    enum
-    {
-	ID_PRESS = cmddialog::ID_LAST,
-	ID_RUSR,
-	ID_WUSR,
-	ID_XUSR,
-	ID_RGRP,
-	ID_WGRP,
-	ID_XGRP,
-	ID_ROTH,
-	ID_WOTH,
-	ID_XOTH,
-	ID_LAST
-    };
-
-
-
-    
-    access_cmddialog ()
-    {
-    }
-    access_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-    virtual int access_cmddialog::exec (void)
-    {
-
-	unsigned int mode = 0;
-	if (ur->getCheck ())
-	    mode = mode | S_IRUSR;
-	if (uw->getCheck ())
-	    mode = mode | S_IWUSR;
-	if (ux->getCheck ())
-	    mode = mode | S_IXUSR;
-	if (gr->getCheck ())
-	    mode = mode | S_IRGRP;
-	if (gw->getCheck ())
-	    mode = mode | S_IWGRP;
-	if (gx->getCheck ())
-	    mode = mode | S_IXGRP;
-	if (or_->getCheck ())
-	    mode = mode | S_IROTH;
-	if (ow->getCheck ())
-	    mode = mode | S_IWOTH;
-	if (ox->getCheck ())
-	    mode = mode | S_IXOTH;
-
-	bool recursive = false;
-	if (rec->getCheck ())
-	    recursive = true;
-	
-	vector < string >::iterator iter;
-
-    	for (iter = src.begin (); iter != src.end(); iter++)
-   	{
-	
-	    fb->mode (*iter, mode, recursive);
-	   
-	    fb->owner (*iter, user->getText ().text (), recursive);
-	    fb->group (*iter, grp->getText ().text (), recursive);
-	
-	}
-
-    }
-
-
-    long access_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (access_cmddialog) access_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, access_cmddialog::ID_PRESS, access_cmddialog::press),};
-FXIMPLEMENT (access_cmddialog, cmddialog, access_cmddialogMap, ARRAYNUMBER (access_cmddialogMap)) 
-
-access_cmddialog::access_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-   vector < string >::iterator iter;
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-	new FXLabel (contents, iter->c_str ());
-    }
-
-    FXHorizontalFrame *accessframe = new FXHorizontalFrame (contents, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXHorizontalFrame *chmodframe = new FXHorizontalFrame (contents, PACK_UNIFORM_WIDTH | PACK_UNIFORM_HEIGHT | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXGroupBox *group1 = new FXGroupBox (accessframe, "User", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    ur = new FXCheckButton (group1, "Read", this, ID_RUSR);
-    uw = new FXCheckButton (group1, "Write", this, ID_WUSR);
-    ux = new FXCheckButton (group1, "Execute", this, ID_XUSR);
-    FXGroupBox *group2 = new FXGroupBox (accessframe, "Group", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    gr = new FXCheckButton (group2, "Read", this, ID_RGRP);
-    gw = new FXCheckButton (group2, "Write", this, ID_WGRP);
-    gx = new FXCheckButton (group2, "Execute", this, ID_XGRP);
-    FXGroupBox *group3 = new FXGroupBox (accessframe, "Others", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    or_ = new FXCheckButton (group3, "Read", this, ID_ROTH);
-    ow = new FXCheckButton (group3, "Write", this, ID_WOTH);
-    ox = new FXCheckButton (group3, "Execute", this, ID_XOTH);
-
-    FXGroupBox *group4 = new FXGroupBox (chmodframe, "Options", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-
-    rec = new FXCheckButton (group4, "Recursive folders", NULL, 0);
-
-
-    FXGroupBox *group5 = new FXGroupBox (chmodframe, "Owner", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    new FXLabel (group5, "User");
-    user = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    user->setNumVisible (5);
-    new FXLabel (group5, "Group");
-    grp = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    grp->setNumVisible (5);
-
-
-    if (fb->mode (src[0]) & S_IRUSR)
-	ur->setCheck ();
-    if (fb->mode (src[0]) & S_IWUSR)
-	uw->setCheck ();
-    if (fb->mode (src[0]) & S_IXUSR)
-	ux->setCheck ();
-    if (fb->mode (src[0]) & S_IRGRP)
-	gr->setCheck ();
-    if (fb->mode (src[0]) & S_IWGRP)
-	gw->setCheck ();
-    if (fb->mode (src[0]) & S_IXGRP)
-	gx->setCheck ();
-
-
-    if (fb->mode (src[0]) & S_IROTH)
-	or_->setCheck ();
-    if (fb->mode (src[0]) & S_IWOTH)
-	ow->setCheck ();
-    if (fb->mode (src[0]) & S_IXOTH)
-	ox->setCheck ();
-
-
-
-    // User names (sorted in ascending order)
-    struct passwd *pwde;
-    while ((pwde = getpwent ()))
-    {
-	user->appendItem (pwde->pw_name);
-
-    }
-    endpwent ();
-    user->setSortFunc (FXList::ascending);
-    user->sortItems ();
-    string own = fb->owner (src[0]);
-    user->setCurrentItem (user->findItem (own.c_str ()));
-
-    // Group names (sorted in ascending order)
-    struct group *grpe;
-    while ((grpe = getgrent ()))
-    {
-	grp->appendItem (grpe->gr_name);
-    }
-    endgrent ();
-    grp->setSortFunc (FXList::ascending);
-    grp->sortItems ();
-    string grou = fb->group (src[0]);
-    grp->setCurrentItem (grp->findItem (grou.c_str ()));
-
-}
-
-long access_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new access_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/clone.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,145 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class clone_cmddialog: public cmddialog
-{
-FXDECLARE ( clone_cmddialog ) protected:
-
-    clone_cmddialog ( const clone_cmddialog & )
-    {}
-
-private:
-    vector < FXTextField * >vec;
-    string dir;
-
-public:
-
-    enum
-    {
-        ID_ENTER = cmddialog::ID_LAST,
-    };
-
-
-    clone_cmddialog ()
-    {}
-    clone_cmddialog ( FXWindow * w, filelist_base * fb, vector < string > src );
-
-
-    virtual int clone_cmddialog::exec ( void )
-    {
-        int error = 0;
-        vector < string >::iterator iter;
-        int i = 0;
-        for ( iter = src.begin (); iter != src.end(); iter++ )
-        {
-            string newname = dir + SEPARATOR + vec[ i ] ->getText ().text ();
-            string newonlyname = vec[ i ] ->getText ().text ();
-
-            string destdir = "/tmp/openspace";
-            string filename = FXFile::name( iter->c_str() ).text();
-            string dirname = FXFile::directory( iter->c_str() ).text();
-
-            thread_elem *el2 = new thread_elem ( fb, "copy", "upload", *iter, destdir );
-            fb->copy ( el2 );
-            delete el2;
-
-
-
-            if ( fb->rename ( destdir + "/" + filename, destdir + "/" + newonlyname ) == false )
-            {
-                error = -1;
-                string err = "can't clone " + *iter + " to " + newname;
-
-                FXLabel *lab = new FXLabel ( contents, err.c_str () );
-                lab->create ();
-                this->layout ();
-                this->resize ( this->getWidth (), this->getHeight () + lab->getHeight () );
-
-            }
-            else
-            {
-
-                el2 = new thread_elem ( fb, "move", "upload", destdir + "/" + newonlyname, dirname );
-                fb->copy ( el2 );
-                delete el2;
-
-            }
-
-
-            i++;
-        }
-
-
-        return error;
-
-    }
-
-
-    long clone_cmddialog::press ( FXObject * sender, FXSelector, void * );
-
-};
-
-FXDEFMAP ( clone_cmddialog ) clone_cmddialogMap[] =
-    {
-        FXMAPFUNC ( SEL_COMMAND, clone_cmddialog::ID_ENTER, clone_cmddialog::press ), };
-FXIMPLEMENT ( clone_cmddialog, cmddialog, clone_cmddialogMap, ARRAYNUMBER ( clone_cmddialogMap ) )
-
-clone_cmddialog::clone_cmddialog ( FXWindow * w, filelist_base * fb, vector < string > src ) :
-        cmddialog ( w, fb, src )
-{
-
-
-    vector < string >::iterator iter;
-
-    for ( iter = src.begin (); iter != src.end(); iter++ )
-    {
-
-
-        dir = FXFile::directory ( iter->c_str () ).text ();
-
-        FXString name = FXFile::name ( iter->c_str () );
-        new FXLabel ( contents, name );
-        FXTextField *text = new FXTextField ( contents, 25, this, ID_ENTER );
-        text->setFocus ();
-        text->setText ( name );
-        vec.push_back ( text );
-
-    }
-
-
-
-}
-
-long clone_cmddialog::press ( FXObject * sender, FXSelector, void * )
-{
-
-    FXObject * target = ( FXObject * ) ok->getTarget ();
-    target->handle ( ok, FXSEL ( SEL_COMMAND, ID_COMMAND ), NULL );
-
-}
-
-
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog ( FXWindow * w, filelist_base * fb, vector < string > src )
-{
-    return new clone_cmddialog ( w, fb, src );
-}
\ No newline at end of file

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/compress.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,119 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class compress_cmddialog:public cmddialog
-{
-  FXDECLARE (compress_cmddialog) protected:
-
-    compress_cmddialog (const compress_cmddialog &)
-    {
-    }
-
-  private:
-   
-    string dir;
-    FXTextField *textfield;
-    FXComboBox* combo;
-
-  public:
-
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-
-       compress_cmddialog ()
-    {
-    }
-    compress_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int compress_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	string file_list;
-	string arch_filename=textfield->getText().text();
-	string type=combo->getText().text();
-	
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-		string sr = (*iter);
-		sr=FXFile::name(sr.c_str()).text();
-		file_list+=" \"" +  sr + "\"";
-	}
-
-	string command;
-	if(type=="tar.bz2")
-	command="tar cjf " + arch_filename +".tar.bz2 "+ file_list;
-	else
-	command="tar czf " + arch_filename +".tar.gz "+ file_list;
-	
-	system(command.c_str());
-
-
-    }
-
-
-    long compress_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (compress_cmddialog) compress_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, compress_cmddialog::ID_ENTER, compress_cmddialog::press),};
-FXIMPLEMENT (compress_cmddialog, cmddialog, compress_cmddialogMap, ARRAYNUMBER (compress_cmddialogMap)) 
-
-compress_cmddialog::compress_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-  new FXLabel(contents,"archive type: ");
-
-    combo = new FXComboBox (contents, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    combo->setNumVisible (3);
-    combo->appendItem("tar.bz2");
-    combo->appendItem("tar.gz");
-
-	new FXLabel(contents,"archive filename: ");
-	textfield = new FXTextField (contents, 25, this, ID_ENTER);
-	textfield->setFocus ();
-
-
-}
-
-long compress_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new compress_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/editsymlink.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,140 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class editsymlink_cmddialog:public cmddialog
-{
-  FXDECLARE (editsymlink_cmddialog) protected:
-
-    editsymlink_cmddialog (const editsymlink_cmddialog &)
-    {
-    }
-    
-  private:
-   
-    vector < FXTextField * >vec;
-    string dir;
-    FXCheckButton *hardlink;  
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    editsymlink_cmddialog ()
-    {
-    }
-    editsymlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int editsymlink_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	
-	string newname = vec[i]->getText ().text ();
-	delete vec[i];
-	i++;
-	if(newname=="")
-	continue;
-
-	    
-  
-	int error = 0;
-	    vector<string> srcfile;
-	    srcfile.push_back(*iter);
-	    thread_elem *el = new thread_elem (fb, "remove", "",srcfile);
-	    fb->remove(el);
-	
-           bool ret=fb->symlink ( newname,*iter);	
-	
-	    if ( ret== false)
-	    {
-		error = -1;
-		string err = "can't symlink " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	
-	}
-
-
-	return error;
-
-    }
-
-
-
-    long editsymlink_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (editsymlink_cmddialog) editsymlink_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, editsymlink_cmddialog::ID_ENTER, editsymlink_cmddialog::press),};
-FXIMPLEMENT (editsymlink_cmddialog, cmddialog, editsymlink_cmddialogMap, ARRAYNUMBER (editsymlink_cmddialogMap)) 
-
-editsymlink_cmddialog::editsymlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-	string sym=fb->symlink(*iter);
-	if(sym=="")
-	continue;
-
-	new FXLabel(contents,"source: ");
-	new FXLabel (contents, iter->c_str ());
-	new FXLabel(contents,"link: ");
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (sym.c_str());
-	vec.push_back (text);
-
-    }
-
-
-}
-
-long editsymlink_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new editsymlink_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/md5sum.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,112 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-#include <fstream>
-#include <sstream>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class md5sum_cmddialog:public cmddialog
-{
-  FXDECLARE (md5sum_cmddialog) protected:
-
-    md5sum_cmddialog (const md5sum_cmddialog &)
-    {
-    }
-    
-  private:
-
- 
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    md5sum_cmddialog ()
-    {
-    }
-    md5sum_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int md5sum_cmddialog::exec (void)
-    {
-	
-    }
-
-
-    long md5sum_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (md5sum_cmddialog) md5sum_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, md5sum_cmddialog::ID_ENTER, md5sum_cmddialog::press),};
-FXIMPLEMENT (md5sum_cmddialog, cmddialog, md5sum_cmddialogMap, ARRAYNUMBER (md5sum_cmddialogMap)) 
-
-md5sum_cmddialog::md5sum_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-FILE *pipe;
-char readbuf[1024];
-
-    vector < string >::iterator iter;
-FXPacker *vv = new FXGroupBox (contents, "info", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
-new FXLabel(vv,"MD5SUM additional plugin - Mateusz Dworak - GPL ");
-new FXSeparator(contents);
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-	string cmd="md5sum "+*iter;
-	pipe = popen (cmd.c_str(), "r");
-
-    	if (pipe != NULL)
-   	{
-		string line;
-		while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-		{
-		std::stringstream parser (readbuf);
-		string md5;	
-		parser >> md5;
-		
-		new FXLabel(contents,iter->c_str());
-		FXTextField*textfield = new FXTextField (contents, 31);
-		textfield->setText(md5.c_str());
-		}
-	}
-
-    }
-
-
-
-}
-
-long md5sum_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
- 
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new md5sum_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/mkdir.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,75 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-class special_cmddialog:public cmddialog
-{
-  FXDECLARE (special_cmddialog) protected:
-
-    special_cmddialog (const special_cmddialog &)
-    {
-    }
-  private:
-  FXTextField *text;
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    special_cmddialog ()
-    {
-    }
-    special_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-    virtual int special_cmddialog::exec (void)
-    {
-	string s = text->getText ().text ();
-	fb->mkdir (s, 493);
-    }
-
-
-    long special_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (special_cmddialog) special_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, special_cmddialog::ID_ENTER, special_cmddialog::press),};
-FXIMPLEMENT (special_cmddialog, cmddialog, special_cmddialogMap, ARRAYNUMBER (special_cmddialogMap)) 
-
-special_cmddialog::special_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    text = new FXTextField (contents, 25, this, ID_ENTER);
-    text->setFocus ();
-
-}
-
-long special_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new special_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/rename.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,124 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class rename_cmddialog:public cmddialog
-{
-  FXDECLARE (rename_cmddialog) protected:
-
-    rename_cmddialog (const rename_cmddialog &)
-    {
-    }
-    
-  private:
-
-    vector < FXTextField * >vec;
-    string dir;  
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    rename_cmddialog ()
-    {
-    }
-    rename_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int rename_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	    string newname = dir + SEPARATOR + vec[i]->getText ().text ();
-	    if (fb->rename (*iter, newname) == false)
-	    {
-		error = -1;
-		string err = "can't rename " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	i++;
-	}
-
-
-	return error;
-
-    }
-
-
-    long rename_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (rename_cmddialog) rename_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, rename_cmddialog::ID_ENTER, rename_cmddialog::press),};
-FXIMPLEMENT (rename_cmddialog, cmddialog, rename_cmddialogMap, ARRAYNUMBER (rename_cmddialogMap)) 
-
-rename_cmddialog::rename_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-
-	dir = FXFile::directory (iter->c_str ()).text ();
-	//fxmessage(dir.c_str());
-	//fxmessage("\n woho");
-	FXString name = FXFile::name (iter->c_str ());
-	new FXLabel (contents, name);
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (name);
-	vec.push_back (text);
-
-    }
-
-
-
-}
-
-long rename_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new rename_cmddialog (w, fb, src);
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/symlink.cpp	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,129 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class symlink_cmddialog:public cmddialog
-{
-  FXDECLARE (symlink_cmddialog) protected:
-
-    symlink_cmddialog (const symlink_cmddialog &)
-    {
-    }
-
-  private:
-  
-    vector < FXTextField * >vec;
-    string dir;
-    FXCheckButton *hardlink;
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    symlink_cmddialog ()
-    {
-    }
-    symlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int symlink_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	    string newname =  vec[i]->getText ().text ();
-	    
-	    bool ret;
-	    if (hardlink->getCheck ())
-	    	ret=fb->hardlink (*iter, newname);
-	    else
-	        ret=fb->symlink (*iter, newname);	
-			
-	    if ( ret== false)
-	    {
-		error = -1;
-		string err = "can't symlink " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	i++;
-	}
-
-
-	return error;
-
-    }
-
-
-    long symlink_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (symlink_cmddialog) symlink_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, symlink_cmddialog::ID_ENTER, symlink_cmddialog::press),};
-FXIMPLEMENT (symlink_cmddialog, cmddialog, symlink_cmddialogMap, ARRAYNUMBER (symlink_cmddialogMap)) 
-
-symlink_cmddialog::symlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-
-	new FXLabel(contents,"source: ");
-	new FXLabel (contents, iter->c_str ());
-	new FXLabel(contents,"link: ");
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (iter->c_str ());
-	vec.push_back (text);
-
-    }
-
-hardlink = new FXCheckButton (contents, "hardlink");
-
-}
-
-long symlink_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new symlink_cmddialog (w, fb, src);
-}

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2006-02-11 21:32:58 UTC (rev 240)
@@ -1,14 +1,16 @@
-pkglib_LTLIBRARIES= libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES= libfilelistlocal.la  
+#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 pkglibdir=$(libdir)/openspace/plugins/filelist
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 
 libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
 libfilelistlocal_la_SOURCES =filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
-libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
+
+#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2005-11-12 13:16:41 UTC (rev 239)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2006-02-11 21:32:58 UTC (rev 240)
@@ -14,7 +14,7 @@
 
 @SET_MAKE@
 
-SOURCES = $(libfilelistarchive_la_SOURCES) $(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) $(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
+SOURCES = $(libfilelistlocal_la_SOURCES)
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -48,34 +48,17 @@
 am__installdirs = "$(DESTDIR)$(pkglibdir)"
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
-libfilelistarchive_la_LIBADD =
-am_libfilelistarchive_la_OBJECTS = filelist_archive.lo OSThreadExec.lo
-libfilelistarchive_la_OBJECTS = $(am_libfilelistarchive_la_OBJECTS)
-libfilelistftp_la_LIBADD =
-am_libfilelistftp_la_OBJECTS = filelist_ftp.lo pftp.lo OSThreadExec.lo
-libfilelistftp_la_OBJECTS = $(am_libfilelistftp_la_OBJECTS)
 libfilelistlocal_la_LIBADD =
 am_libfilelistlocal_la_OBJECTS = filelist_local.lo OSFXFile.lo \
 	OSThreadExec.lo OSUtils.lo
 libfilelistlocal_la_OBJECTS = $(am_libfilelistlocal_la_OBJECTS)
-libfilelistsearch_la_LIBADD =
-am_libfilelistsearch_la_OBJECTS = filelist_search.lo OSFXFile.lo \
-	OSThreadExec.lo
-libfilelistsearch_la_OBJECTS = $(am_libfilelistsearch_la_OBJECTS)
-libfilelistsftp_la_LIBADD =
-am_libfilelistsftp_la_OBJECTS = filelist_sftp.lo OSThreadExec.lo
-libfilelistsftp_la_OBJECTS = $(am_libfilelistsftp_la_OBJECTS)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 @AMDEP_TRUE at DEP_FILES = ./$(DEPDIR)/OSFXFile.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSUtils.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_archive.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_ftp.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_local.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_search.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_sftp.Plo ./$(DEPDIR)/pftp.Plo
+ at AMDEP_TRUE@	./$(DEPDIR)/filelist_local.Plo
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
 LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
@@ -92,15 +75,12 @@
 CCLD = $(CC)
 LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libfilelistarchive_la_SOURCES) \
-	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
-	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
-DIST_SOURCES = $(libfilelistarchive_la_SOURCES) \
-	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
-	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
+SOURCES = $(libfilelistlocal_la_SOURCES)
+DIST_SOURCES = $(libfilelistlocal_la_SOURCES)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 pkglibdir = $(libdir)/openspace/plugins/filelist
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
@@ -198,18 +178,10 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-pkglib_LTLIBRARIES = libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES = libfilelistlocal.la  
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
 libfilelistlocal_la_SOURCES = filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
-libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsearch_la_SOURCES = filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistarchive_la_SOURCES = filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsftp_la_SOURCES = filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistftp_la_SOURCES = filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 all: all-am
 
 .SUFFIXES:
@@ -270,16 +242,8 @@
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
-libfilelistarchive.la: $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistarchive_la_LDFLAGS) $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_LIBADD) $(LIBS)
-libfilelistftp.la: $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistftp_la_LDFLAGS) $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_LIBADD) $(LIBS)
 libfilelistlocal.la: $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_DEPENDENCIES) 
 	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistlocal_la_LDFLAGS) $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_LIBADD) $(LIBS)
-libfilelistsearch.la: $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsearch_la_LDFLAGS) $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_LIBADD) $(LIBS)
-libfilelistsftp.la: $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsftp_la_LDFLAGS) $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
@@ -290,12 +254,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFXFile.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSUtils.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_archive.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_ftp.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_local.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_search.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_sftp.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/pftp.Plo at am__quote@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
@@ -549,6 +508,15 @@
 	tags uninstall uninstall-am uninstall-info-am \
 	uninstall-pkglibLTLIBRARIES
 
+
+#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:



From compbatant at berlios.de  Sat Feb 11 22:53:23 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sat, 11 Feb 2006 22:53:23 +0100
Subject: [Openspace-svn] r241 - in branches/mloskot-style-refactoring/src/plugins: cmddialog filelist
Message-ID: <200602112153.k1BLrNaR020801@sheep.berlios.de>

Author: compbatant
Date: 2006-02-11 22:53:06 +0100 (Sat, 11 Feb 2006)
New Revision: 241

Added:
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h
Removed:
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.h
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h
Modified:
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp
   branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
Log:
changing name convencion for VFS plugins


Modified: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,5 +1,6 @@
 #include <fx.h>
 #include "../../OSCMDDialogBox.h"
+#include "../../OSThreadExec.h"
 
 #include <string>
 using namespace std;
@@ -45,7 +46,7 @@
     virtual int OSClone::exec ( void )
     {
         int error = 0;
-    /*
+    
         
         vector < string >::iterator iter;
         int i = 0;
@@ -58,7 +59,7 @@
             string filename = FXFile::name( iter->c_str() ).text();
             string dirname = FXFile::directory( iter->c_str() ).text();
 
-            thread_elem *el2 = new OSThreadExec ( fb, "copy", "upload", *iter, destdir );
+            OSThreadExec *el2 = new OSThreadExec ( fb, "copy", "upload", *iter, destdir );
             fb->copy ( el2 );
             delete el2;
 
@@ -88,7 +89,7 @@
             i++;
         }
 
-    */
+    
         return error;
 
     }

Modified: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,5 +1,6 @@
 #include <fx.h>
 #include "../../OSCMDDialogBox.h"
+#include "../../OSThreadExec.h"
 
 #include <string>
 using namespace std;
@@ -49,7 +50,7 @@
     {
     
         int error = 0;
-    /*
+    
 	
 	vector < string >::iterator iter;
 	int i=0;
@@ -67,7 +68,7 @@
 	int error = 0;
 	    vector<string> srcfile;
 	    srcfile.push_back(*iter);
-	    thread_elem *el = new thread_elem (fb, "remove", "",srcfile);
+	    OSThreadExec *el = new OSThreadExec (fb, "remove", "",srcfile);
 	    fb->remove(el);
 	
            bool ret=fb->symlink ( newname,*iter);	
@@ -86,7 +87,7 @@
 	
 	}
 
-    */	
+    	
 	return error;
 	
     }

Deleted: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,112 +0,0 @@
-#include <fx.h>
-#include "../../OSCMDDialogBox.h"
-
-#include <string>
-#include <fstream>
-#include <sstream>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class OSMd5sum:public OSCMDDialogBox
-{
-  FXDECLARE (OSMd5sum) protected:
-
-    OSMd5sum (const OSMd5sum &)
-    {
-    }
-    
-  private:
-
- 
-
-  public:
-
-    enum
-    {
-	ID_ENTER = OSCMDDialogBox::ID_LAST,
-    };
-
-    OSMd5sum ()
-    {
-    }
-    OSMd5sum (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src);
-
-
-    virtual int OSMd5sum::exec (void)
-    {
-	
-    }
-
-
-    long OSMd5sum::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (OSMd5sum) OSMd5sumMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, OSMd5sum::ID_ENTER, OSMd5sum::press),};
-FXIMPLEMENT (OSMd5sum, OSCMDDialogBox, OSMd5sumMap, ARRAYNUMBER (OSMd5sumMap)) 
-
-OSMd5sum::OSMd5sum (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src):
-OSCMDDialogBox (w, fb, src)
-{
-FILE *pipe;
-char readbuf[1024];
-
-    vector < string >::iterator iter;
-FXPacker *vv = new FXGroupBox (contents, "info", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
-new FXLabel(vv,"MD5SUM additional plugin - Mateusz Dworak - GPL ");
-new FXSeparator(contents);
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-	string cmd="md5sum "+*iter;
-	pipe = popen (cmd.c_str(), "r");
-
-    	if (pipe != NULL)
-   	{
-		string line;
-		while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-		{
-		std::stringstream parser (readbuf);
-		string md5;	
-		parser >> md5;
-		
-		new FXLabel(contents,iter->c_str());
-		FXTextField*textfield = new FXTextField (contents, 31);
-		textfield->setText(md5.c_str());
-		}
-	}
-
-    }
-
-
-
-}
-
-long OSMd5sum::press (FXObject * sender, FXSelector, void *)
-{
-
- 
-
-}
-
-
-
-EXPORTFUNCTION OSCMDDialogBox *get_cmddialog (FXWindow * w, OSVirtualFileSystemBase * fb, vector < string > src)
-{
-    return new OSMd5sum (w, fb, src);
-}

Copied: branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum.cpp (from rev 240, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum)

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.am	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,16 +1,18 @@
-pkglib_LTLIBRARIES= libfilelistlocal.la  
-#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES= libOSVfsLocal.la libOSVfsSearch.la libOSVfsArchive.la libOSVfsFtp.la   
 pkglibdir=$(libdir)/openspace/plugins/filelist
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 
-libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-libfilelistlocal_la_SOURCES =filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+libOSVfsLocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSVfsLocal_la_SOURCES =OSVfsLocal.cpp OSVfsLocal.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
 
-#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsSearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsSearch_la_SOURCES =OSVfsSearch.cpp OSVfsSearch.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsArchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsArchive_la_SOURCES =OSVfsArchive.cpp OSVfsArchive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsFtp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsFtp_la_SOURCES =OSVfsFtp.cpp OSVfsFtp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
+
+
 #libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
 #libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
+

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.cpp)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.cpp)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.h)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp)

Copied: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h (from rev 239, branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h)

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,395 +0,0 @@
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-#include "filelist_archive.h"
-
-
-vfs filelist_archive::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container("name"));
-	v.information="tar.bz2 and tar.gz archive - default plugin";
-	v.version="1";
-	v.type="vfs";
-return v;	
-	
-}
-
-
-int filelist_archive::osopendir (string dir)
-{
-
-this->dir=dir;
-iter=files.begin();
-}
-osfile filelist_archive::osreaddir (void)
-{
-
-osfile os_file;
-
-while(iter!=files.end())
-{
-os_file.name=*iter;
-	string modfile=os_file.name.substr(0,os_file.name.length () - 1);
-	
-	string::size_type pos=modfile.rfind("/");
-	if (pos != string::npos)
-	{
-		string dirf="/"+os_file.name.substr(0,pos);
-		
-		
-		if(dirf!=dir)
-		{
-		iter++;
-		continue;
-		}
-		else
-		os_file.name=os_file.name.substr(pos+1);
-		
-		
-		
-	}
-	else if(dir!="/")
-	{
-	iter++;
-	continue;
-	}
-
-	    os_file.type = 0;
-	    os_file.size = 300;
-	  
-	    
-	    string s = os_file.name.substr (os_file.name.length () - 1, 1);
-
-	    if (s == "/")
-	    {
-	        os_file.name = os_file.name.substr (0,os_file.name.length () - 1);
-		os_file.type = FOLDER;
-	    }
-	    else
-		os_file.type = 0;
-	    
-	    iter++;
-	  
-	    return os_file;
-}		    
-
-
-    
-    os_file.name = "";
-    return os_file;
-
-}
-int filelist_archive::mkdir (string dir, int mode)
-{
-}
-int filelist_archive::copy (thread_elem * te)
-{
-filesoperation("copy",te);
-}
-
-int filelist_archive::move (thread_elem * te)
-{
-filesoperation("move",te);
-}
-int filelist_archive::remove (thread_elem * te)
-{
-filesoperation("remove",te);
-}
-
-int filelist_archive::filesoperation(string typeoperation,thread_elem * te)
-{
-
- vector < string >::iterator iter;
- 
-	string::size_type pos = te->options.find ("upload");
-	if (pos != string::npos && typeoperation!="remove")
-	{
-		
-		string file_list;
-		vector <string> file_list_vec;
-   		 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   		 {
-			string sr = (*iter);
-			file_list_vec.push_back(sr);
-			sr=sr.substr(1,sr.length()-1);
-			file_list+=" \"" +  sr + "\"";
-			
-			
-		 }	
-			if(dir=="/")
-			{
-			string command="cd " +te->dst +" && tar xf" + type + " " + archive_filename + " " + file_list;
-			system(command.c_str());
-			
-			}
-			else
-			{
-			
-			string tmpdir;
-			string destdir;
-			tmpdir=FXFile::time ("%S%H%M%d%m%y", FXFile::now()).text ();
-			destdir=string("/tmp/openspace/tmp") + tmpdir;
-			FXFile::createDirectory(destdir.c_str(),0);
-			
-			
-			string command="cd " +destdir +" && tar xf" + type + " " + archive_filename + " " + file_list;
-			system(command.c_str());
-			
-				for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   				{	
-				string sr = (*iter);
-				sr=sr.substr(1,sr.length()-1);
-				string tmpfile=destdir+"/"+sr;
-				string d=te->dst.c_str() + string("/")+FXFile::name(iter->c_str()).text();
-				FXFile::move(tmpfile.c_str(),d.c_str());				
-				}	
-			FXFile::remove(destdir.c_str());	
-			}
-		
-		if(typeoperation=="move")
-		{
-		
-		thread_elem *el2 = new thread_elem (this, "remove", "", file_list_vec);
-		this->remove(el2);
-		delete el2;
-		
-		}
-		
-		
-	}
-	else //download
-	{
-		string decompress,compress,archive_filename_decompressed;
-		if(type=="z")
-		{
-			decompress="gunzip";
-			compress="gzip";
-			archive_filename_decompressed=archive_filename.substr(0,archive_filename.length()-3);
-		}
-		else //bzip2
-		{
-			decompress="bunzip2";
-			compress="bzip2";
-			archive_filename_decompressed=archive_filename.substr(0,archive_filename.length()-4);
-		}
-		
-		string command=decompress + " " + archive_filename;
-		system(command.c_str());
-		
-		if(typeoperation=="remove")
-		{
-			string file_list;
-		
-   			 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   			 {
-			string sr = (*iter);
-			sr=sr.substr(1,sr.length()-1);
-			file_list+=" \"" +  sr + "\"";	
-			
-			vector <string>::iterator searchit=find(files.begin(), files.end(), sr);
-				if (files.end()!=searchit)// Search the list.
-					{
-					files.erase(searchit);	
-					}
-					
-			 }	
-			command="tar --delete -f " + archive_filename_decompressed + " " +file_list;
-		
-			system(command.c_str());
-		
-		}
-		else
-		{
-		
-			 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   			 {
-			 string file;
-			 string sr = (*iter);
-			 string dir=FXFile::directory(sr.c_str()).text();
-			 
-
-			 
-			 
-				if(this->dir=="/")
-				{
-				file=FXFile::name(sr.c_str()).text();
-				
-					if (files.end()==find(files.begin(), files.end(), file))// Search the list.
-					{
-					string dirtest=dir+"/"+FXFile::name(file.c_str()).text();
-					
-					
-						
-						if(FXFile::isDirectory(dirtest.c_str()))						
-						files.push_back(file+"/");
-						else
-						files.push_back(file);	
-					}
-					else	
-					{
-					command="cd " +dir + " && tar --delete -f " + archive_filename_decompressed + " " +file;
-					
-					system(command.c_str());
-					}
-				
-				command="cd " +dir + " && tar rf " + archive_filename_decompressed + " " +file;
-				system(command.c_str());
-				
-				}
-				else
-				{
-			 			
-				string reldir=this->dir.substr(1,this->dir.length()-1);
-				file=reldir +"/"+ FXFile::name(sr.c_str()).text();	
-				
-				string tmpdir;
-				string destdir;
-				tmpdir=FXFile::time ("%S%H%M%d%m%y", FXFile::now()).text ();
-				destdir=string("/tmp/openspace/tmp") + tmpdir;
-			
-				FXFile::createDirectory(destdir.c_str(),0);
-				command="cd "+destdir + " && mkdir -p " + reldir;
-				system(command.c_str());
-				string d=destdir+"/" + reldir + "/" + FXFile::name(sr.c_str()).text();
-				
-				if(typeoperation=="copy")
-				FXFile::copy(sr.c_str(),d.c_str());
-				else if(typeoperation=="move")
-				{
-				
-				FXFile::move(sr.c_str(),d.c_str());
-				}
-
-				
-				
-					if (files.end()==find(files.begin(), files.end(), file))// Search the list.
-					{
-					string dirtest=dir+"/"+FXFile::name(file.c_str()).text();
-					
-					
-						
-						if(FXFile::isDirectory(dirtest.c_str()))						
-						files.push_back(file+"/");
-						else
-						files.push_back(file);	
-					}
-					else
-					{	
-					command="cd " +destdir + " && tar --delete -f " + archive_filename_decompressed + " " +file;
-					
-					system(command.c_str());
-					}
-				
-				command="cd " + destdir + " && tar rf " + archive_filename_decompressed + " " +file;
-				system(command.c_str());
-				
-				
-	
-				FXFile::remove(destdir.c_str());
-				
-				}
-				
-							
-		 	}
-		}	
-		command=compress + " " + archive_filename_decompressed;
-		system(command.c_str());
-		
-			
-	}
-	
-te->end=true;
-
-
-}
-
-
-int filelist_archive::rename (string orgname, string newname)
-{
-}
-int filelist_archive::init (vector < string > *vector_name, pathtype pt, configure * conf)
-{
-archive_filename = pt.server;
-
-
-string  command;
-
-if ((archive_filename.length () >= 6 && archive_filename.substr (archive_filename.length () - 6, 6) == "tar.gz") ||(archive_filename.length () >= 3 && archive_filename.substr (archive_filename.length () - 3, 3) == "tgz"))
-type="z";
-else
-type="j";
-
-command="tar tf" + type + " " + archive_filename;
-
-
-pipe = popen(command.c_str(), "r");
-
-if (pipe != NULL)
-    {
-	string line;
-	while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-	{
-
-
-	    string path = readbuf;
-	    path = path.substr (0, path.length () - 1);
-	    files.push_back(path);
-	   
-	}
-
-	pclose (pipe);
-    }
-    
-iter=files.begin();
-
-}
-int filelist_archive::mode (string file)
-{
-}
-string filelist_archive::owner (string file)
-{
-return "";
-}
-string filelist_archive::group (string file)
-{
-return "";
-}
-bool filelist_archive::mode (string file, unsigned int, bool recursive)
-{
-}
-bool filelist_archive::owner (string file, string, bool recursive)
-{
-}
-bool filelist_archive::group (string file, string, bool recursive)
-{
-}
-string filelist_archive::info (void)
-{
-return "";
-}
-void filelist_archive::totalsize (string path, unsigned long &size)
-{
-}
-string filelist_archive::symlink (string path)
-{
-return "";
-}
-bool filelist_archive::symlink (string src, string dst)
-{
-}
-bool filelist_archive::hardlink (string src, string dst)
-{
-}
-
-int filelist_archive::quit (void)
-{
-}
-EXPORTFUNCTION filelist_base *get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_archive ();
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_archive.h	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,59 +0,0 @@
-#ifndef FILELIST_archive
-#define FILELIST_archive
-
-#include "../../OSVirtualFileSystemBase.h"
-#include "../../OSVirtualFileSystemInfo.h"
-#include "../../OSPathType.h"
-#include "../../OSFile.h"
-
-#include <string>
-#include <vector>
-
-// Forward declarations
-class OSThreadExec;
-class OSConfigure;
-
-/**
- * Archive plugin of type of file list.
- *
- * @todo Why all filelist_* plugins redeclare the same interface?
- */
-class filelist_archive : public OSVirtualFileSystemBase
-{
- 
-private:  
-    std::string archive_filename;
-    FILE *pipe;
-    char readbuf[1024];
-    std::vector<std::string> files;
-    std::vector<std::string>::iterator iter;
-    std::string dir;
-    std::string type;
-    
-public:    
-
-    int osopendir (std::string dir);
-    OSFile osreaddir (void);
-    int mkdir (std::string dir, int mode = 0);
-    int copy (OSThreadExec* te);
-    int move (OSThreadExec* te);
-    int remove (OSThreadExec* te);
-    int rename (std::string orgname, std::string newname);
-    int init (std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf);
-    int mode (std::string file);
-    std::string owner (std::string file);
-    std::string group (std::string file);
-    bool mode (std::string file, unsigned int, bool recursive);
-    bool owner (std::string file, std::string, bool recursive);
-    bool group (std::string file, std::string, bool recursive);
-    std::string info (void);
-    void totalsize (std::string path, unsigned long &size);
-    std::string symlink (std::string path);
-    bool symlink (std::string src, std::string dst);
-    bool hardlink (std::string src, std::string dst);
-    OSVirtualFileSystemInfo setup (void);
-    int quit (void);
-    
-    int filesoperation(std::string type, OSThreadExec* te);
-};
-#endif

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,762 +0,0 @@
-// $Id$
-/////////////////////////////////////////////////////////////////////////////
-// This file is part of OpenSpace project.
-//
-// OpenSpace is free software; you can redistribute it and/or modify
-// it under the terms of the GNU General Public License as published by
-// the Free Software Foundation; either version 2 of the License, or
-// (at your option) any later version.
-//
-// OpenSpace is distributed in the hope that it will be useful,
-// but WITHOUT ANY WARRANTY; without even the implied warranty of
-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-// GNU General Public License for more details.
-//
-// You should have received a copy of the GNU General Public License
-// along with OpenSpace; if not, write to the Free Software
-// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-/////////////////////////////////////////////////////////////////////////////
-//
-// C++ Implementation: $MODULE$
-//
-// Author: Mateusz Dworak <http://openspace.linux.pl>, (C) 2005
-//
-// Description:
-//  FTP plugin derived from OpenSpace file list VFS plugin.
-//
-/////////////////////////////////////////////////////////////////////////////
-
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-#include "filelist_ftp.h"
-#include "../../OSVirtualFileSystemBase.h"
-
-#include <sstream>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <sys/types.h>
-#include <dirent.h>
-
-#include <string>
-#include <vector>
-#include <map>
-
-SimpleLogger::SimpleLogger()
-{
-    te = NULL;
-}
-
-void SimpleLogger::start( uint32_t bytes, const FXString & name, uint32_t size )
-{
-    if ( te != NULL && name != "" )
-    {
-        te->act_file_size = 0;
-        te->act_file_name = name.text ();
-        if ( size != 0 )
-            te->file_size = size;
-    }
-}
-bool SimpleLogger::update( uint32_t bytes, const FXString & s )
-{
-    if ( te != NULL )
-    {
-        te->act_file_size += bytes;
-        te->act_total_size += bytes;
-
-        if ( te->cancel == true )
-            return false;
-    }
-    return true;
-}
-void SimpleLogger::end( uint32_t bytes, const FXString & )
-{}
-
-void SimpleLogger::choke()
-{}
-
-void SimpleLogger::error( int error )
-{}
-
-void SimpleLogger::logLine( FXString & line )
-{
-    fxmessage( "LOG=%s\n", line.text() );
-}
-void SimpleLogger::error( FXString & error )
-{
-    fxmessage( "ERROR=%s\n", error.text() );
-}
-
-vfs filelist_ftp::setup ( void )
-{
-    OSVirtualFileSystemBase v;
-
-    v.vfsheaders.push_back( vfsheader_container( "name" ) );
-    v.vfsheaders.push_back( vfsheader_container( "size", "size" ) );
-    v.vfsheaders.push_back( vfsheader_container( "owner" ) );
-    v.vfsheaders.push_back( vfsheader_container( "group" ) );
-    v.information = "FTP - default plugin";
-    v.version = "1";
-    v.type = "network";
-    return v;
-
-}
-
-
-int filelist_ftp::priv_osopendir ( std::string dir, std::string prefix, std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter )
-{
-
-    filesMap.clear();
-
-
-    FXString di = dir.c_str();
-    pftp->setDir( di );
-    FXString di2;
-    pftp->pwd( di2 );
-
-    if ( FXFile::name( di ) != FXFile::name( di2 ) || di2 == "" )
-        return -1;
-
-
-
-    FXMemoryStream str;
-    str.open( FXStreamSave, NULL );
-
-
-    pftp->list( str );
-
-    // nil terminate the buffer
-    FXuchar nil = 0;
-    str.save( &nil, 1 );
-
-    // and get it
-    FXuchar* buffer;
-    unsigned long sp;
-    str.takeBuffer( buffer, sp );
-
-    char * ptr = reinterpret_cast<char *>( buffer );
-    char * next = strchr( ptr, '\n' );
-    char * start = ptr;
-
-
-    //get attributes # user group size date =(3 or 4? fields) name
-    while ( next && ( ptr - start < ( int ) sp ) )
-    {
-
-        next[ 0 ] = 0;
-        if ( next[ -1 ] == '\r' )
-            next[ -1 ] = 0;
-
-        // Some FTP servers send other lines than raw directory
-        if ( ptr[ 0 ] != 'd' && ptr[ 0 ] != '-' )
-        {
-            ptr = next + 1;
-            next = strchr( ptr, '\n' );
-            continue;
-        }
-
-
-
-        osfile os_file;
-        os_file.type = 0;
-        if ( ptr[ 0 ] == 'd' )
-            os_file.type = os_file.type | FOLDER;
-        else
-            os_file.type = 0;
-
-        std::stringstream parser ( ptr );
-        std::std::string field;
-
-        std::string user;
-        std::string group;
-        std::string size;
-        std::string date;
-        std::string attrib;
-        std::string name;
-
-        parser >> attrib;
-
-        attrib = attrib.substr( 1, attrib.length() - 1 );
-
-        parser >> field;
-        parser >> user;
-        parser >> group;
-        parser >> size;
-        os_file.size = atoi( size.c_str() );
-
-
-        parser >> date;
-        parser >> date;
-        parser >> date;
-
-
-        os_file.user = user;
-        os_file.group = group;
-        os_file.mode = attrib;
-
-
-
-        std::string n;
-        while ( parser >> n )
-        {
-            if ( name != "" )
-                name = name + " " + n;
-            else
-                name = n;
-        }
-
-        os_file.name = prefix + name;
-
-
-        if ( prefix == "" )
-        {
-
-
-            for ( int i = 0; i < fieldsnum - 1; i++ )
-            {
-
-                if ( fields[ i + 1 ] == "size" )
-                    os_file.attrib.push_back( size );
-                else if ( fields[ i + 1 ] == "owner" )
-                    os_file.attrib.push_back( user );
-                else if ( fields[ i + 1 ] == "group" )
-                    os_file.attrib.push_back( group );
-                else if ( fields[ i + 1 ] == "mode" )
-                    os_file.attrib.push_back( attrib );
-
-
-            }
-
-        }
-        filesMap[ os_file.name ] = os_file;
-
-
-
-        if ( prefix != "" )
-        {
-            filesMapGlobal[ os_file.name ] = os_file;
-        }
-        ptr = next + 1;
-        next = strchr( ptr, '\n' );
-    }
-    FXFREE( &buffer );
-
-    iter = filesMap.begin();
-
-}
-
-
-
-int filelist_ftp::osopendir ( std::string dir )
-{
-
-
-    this->dir = dir;
-
-    return priv_osopendir( dir, "", filesMap, iter );
-
-
-
-}
-
-osfile filelist_ftp::priv_osreaddir ( std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter )
-{
-    osfile os_file;
-
-    if ( iter != filesMap.end() )
-    {
-        os_file = iter->second;
-
-        iter++;
-        return os_file;
-    }
-
-
-
-    os_file.name = "";
-    return os_file;
-
-}
-
-
-osfile filelist_ftp::osreaddir ( void )
-{
-
-    return priv_osreaddir( filesMap, iter );
-}
-int filelist_ftp::mkdir ( std::string dir, int mode )
-{
-    pftp->mkDir( dir.c_str() );
-}
-
-
-static const int BUCKETSIZE = 128;
-struct Bucket
-{
-    uint8_t bucket[ BUCKETSIZE ];
-};
-
-
-
-
-
-
-
-
-void filelist_ftp::local_totalsize ( std::string path, unsigned long &size )
-{
-
-    if ( FXFile::isDirectory ( path.c_str () ) )
-    {
-        struct stat status;
-        struct dirent *dp;
-        DIR *dirp;
-
-
-        dirp = opendir ( path.c_str () );
-
-        while ( ( dp = readdir ( dirp ) ) != NULL )
-        {
-            if ( dp->d_name[ 0 ] != '.' || ( dp->d_name[ 1 ] != '\0' && ( dp->d_name[ 1 ] != '.' || dp->d_name[ 2 ] != '\0' ) ) )
-            {
-
-                std::string file = path;
-                file.append ( dp->d_name );
-#ifndef WIN32
-                lstat ( file.c_str (), &status );
-#else
-                stat ( file.c_str (), &status );
-#endif
-                if ( S_ISDIR ( status.st_mode ) )
-                {
-                    size = size + ( unsigned int ) status.st_size;
-                    file.append ( "/" );
-                    totalsize ( file, size );
-
-                }
-                else
-                {
-                    size = size + status.st_size;
-                }
-            }
-        }
-
-        closedir ( dirp );
-    }
-    else
-    {
-        size += FXFile::size ( path.c_str () );
-
-    }
-
-}
-
-
-
-
-
-
-
-int filelist_ftp::copy ( thread_elem * te )
-{
-    log->te = te;
-    unsigned long size = 0;
-
-    std::string::size_type pos = te->options.find ( "upload" );
-    if ( pos == std::string::npos )
-    {
-
-        std::string dir_copy = this->dir;
-
-        std::vector < std::string >::iterator iter;
-
-        for ( iter = te->src.begin (); iter != te->src.end(); iter++ )
-        {
-            std::string sr = ( *iter );
-            if ( FXFile::isDirectory ( sr.c_str () ) )
-                sr.append ( "/" );
-            local_totalsize ( sr, size );
-        }
-
-        te->total_size = size;
-
-        for ( iter = te->src.begin (); iter != te->src.end(); iter++ )
-        {
-
-            FXString file = iter->c_str();
-            goLocalRecursive( file.text(), "", te );
-            pftp->setDir( dir_copy.c_str() );
-
-        }
-        this->dir = dir_copy;
-
-    }
-    else
-    {
-
-
-
-        getRecursiveFiles( te->src, size );
-
-        te->total_size = size;
-        for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
-        {
-            if ( te->cancel == true )
-                break;
-
-            if ( iterGlobal->second.type & FOLDER )
-            {
-
-                std::string filename = te->dst + "/" + iterGlobal->first;
-                FXFile::createDirectory( filename.c_str(), str_mode_int( iterGlobal->second.mode ) );
-
-            }
-            else
-            {
-                std::string filename = te->dst + "/" + iterGlobal->first;
-                FXFile::createDirectory( FXFile::directory( filename.c_str() ), str_mode_int( iterGlobal->second.mode ) );
-                te->file_size = iterGlobal->second.size;
-
-                pftp->download( iterGlobal->first.c_str(), filename.c_str(), false );
-
-                FXFile::mode( filename.c_str(), str_mode_int( iterGlobal->second.mode ) );
-            }
-            te->act_file_name = iterGlobal->first;
-            if ( iterGlobal == filesMapGlobal.begin() ) break;
-
-        }
-
-
-
-
-
-    }
-    log->te = NULL;
-}
-
-
-void filelist_ftp::goLocalRecursive ( std::string path, std::string prefix, thread_elem *te )
-{
-
-    if ( te->cancel == true )
-        return ;
-
-    if ( FXFile::isDirectory ( path.c_str () ) )
-    {
-        struct stat status;
-        struct dirent *dp;
-        DIR *dirp;
-
-        prefix = prefix + FXFile::name( path.c_str() ).text();
-        std::string fulldir = this->dir + "/" + prefix;
-
-        pftp->mkDir( fulldir.c_str() );
-        this->mode ( fulldir, FXFile::mode( path.c_str() ), false );
-        pftp->setDir( fulldir.c_str() );
-
-        dirp = opendir ( path.c_str () );
-
-        while ( ( dp = readdir ( dirp ) ) != NULL )
-        {
-            if ( dp->d_name[ 0 ] != '.' || ( dp->d_name[ 1 ] != '\0' && ( dp->d_name[ 1 ] != '.' || dp->d_name[ 2 ] != '\0' ) ) )
-            {
-
-                std::string file = path + "/";
-                file.append ( dp->d_name );
-                goLocalRecursive( file, prefix + "/", te );
-            }
-        }
-
-        closedir ( dirp );
-    }
-    else
-    {
-        std::string pre = this->dir + "/" + prefix.substr( 0, prefix.length() - 1 );
-        if ( this->dir != pre )
-        {
-            pftp->setDir( pre.c_str() );
-            this->dir = pre;
-        }
-
-        FXString fil = path.c_str();
-        pftp->upload( fil, 0, false );
-        this->mode ( path, FXFile::mode( fil ), false );
-
-
-    }
-
-}
-
-
-
-
-
-
-
-
-int filelist_ftp::move ( thread_elem * te )
-{}
-
-
-void filelist_ftp::gorecursive( std::string file, unsigned long &size )
-{
-
-
-    std::map <std::string, osfile> filesMap;
-    std::map <std::string, osfile>::iterator iter;
-
-    if ( priv_osopendir( file, file + "/", filesMap, iter ) != -1 )
-    {
-
-        while ( 1 )
-        {
-            osfile os_file = priv_osreaddir ( filesMap, iter );
-            if ( os_file.name == "" )
-                break;
-
-            if ( os_file.type & FOLDER )
-            {
-                gorecursive( os_file.name, size );
-            }
-            else
-                size = size + os_file.size;
-        }
-
-    }
-
-
-}
-
-void filelist_ftp::getRecursiveFiles( std::vector < std::string >src, unsigned long &size )
-{
-
-    filesMapGlobal.clear();
-
-
-    std::vector < std::string >::iterator iter_files;
-
-    for ( iter_files = src.begin (); iter_files != src.end(); iter_files++ )
-    {
-
-        std::string name = FXFile::name( iter_files->c_str() ).text();
-        osfile os_file;
-        os_file.name = name;
-        os_file.type = filesMap[ name ].type;
-        os_file.size = filesMap[ name ].size;
-        os_file.mode = filesMap[ name ].mode;
-        os_file.group = filesMap[ name ].user;
-        os_file.user = filesMap[ name ].group;
-        filesMapGlobal[ name ] = os_file;
-
-    }
-
-
-    for ( iterGlobal = filesMapGlobal.begin();iterGlobal != filesMapGlobal.end(); iterGlobal++ )
-    {
-
-
-        if ( iterGlobal->second.type & FOLDER )
-        {
-            gorecursive( iterGlobal->first, size );
-            FXString di = this->dir.c_str();
-            pftp->setDir( di );
-        }
-        else
-            size = size + iterGlobal->second.size;
-
-    }
-}
-
-int filelist_ftp::remove ( thread_elem * te )
-{
-    unsigned long size;
-    getRecursiveFiles( te->src, size );
-
-    for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
-    {
-
-
-        if ( iterGlobal->second.type & FOLDER )
-            pftp->rmDir( iterGlobal->first.c_str() );
-        else
-            pftp->del( iterGlobal->first.c_str() );
-
-        te->act_file_name = iterGlobal->first;
-        if ( iterGlobal == filesMapGlobal.begin() ) break;
-
-    }
-
-
-
-}
-int filelist_ftp::rename ( std::string orgname, std::string newname )
-{
-
-    FXString tmp;
-    pftp->sendCmd( "RNFR ", FXFile::name( orgname.c_str() ), tmp );
-    pftp->sendCmd( "RNTO ", FXFile::name( newname.c_str() ), tmp );
-
-}
-int filelist_ftp::init ( std::vector < std::string > *vector_name, pathtype pt, configure * conf )
-{
-
-    fieldsnum = vector_name->size ();
-    fields = ( *vector_name );
-
-    log = new SimpleLogger;
-    pftp = new PFTP( pt.server.c_str(), pt.user.c_str(), pt.password.c_str(), "", log );
-
-    if ( pftp->isConnected() && getinitialdir() != "" )
-    {}
-    else return -1;
-}
-
-int filelist_ftp::str_mode_int( std::string per )
-{
-    unsigned int mode = 0;
-    if ( per[ 0 ] == 'r' )
-        mode = mode | S_IRUSR;
-    if ( per[ 1 ] == 'w' )
-        mode = mode | S_IWUSR;
-    if ( per[ 2 ] == 'x' )
-        mode = mode | S_IXUSR;
-    if ( per[ 3 ] == 'r' )
-        mode = mode | S_IRGRP;
-    if ( per[ 4 ] == 'w' )
-        mode = mode | S_IWGRP;
-    if ( per[ 5 ] == 'x' )
-        mode = mode | S_IXGRP;
-    if ( per[ 6 ] == 'r' )
-        mode = mode | S_IROTH;
-    if ( per[ 7 ] == 'w' )
-        mode = mode | S_IWOTH;
-    if ( per[ 8 ] == 'x' )
-        mode = mode | S_IXOTH;
-    return mode;
-}
-
-int filelist_ftp::mode ( std::string file )
-{
-
-    std::string per = filesMap[ FXFile::name( file.c_str() ).text() ].mode;
-
-    return str_mode_int( per );
-
-}
-std::string filelist_ftp::owner ( std::string file )
-{
-    return filesMap[ FXFile::name( file.c_str() ).text() ].user;
-}
-std::string filelist_ftp::group ( std::string file )
-{
-    return filesMap[ FXFile::name( file.c_str() ).text() ].group;
-}
-bool filelist_ftp::mode ( std::string file, unsigned int per, bool recursive )
-{
-
-    unsigned int mode = per;
-
-    int x = ( ( mode & S_IRUSR ) | ( mode & S_IWUSR ) | ( mode & S_IXUSR ) ) / 64;
-    int y = ( ( mode & S_IRGRP ) | ( mode & S_IWGRP ) | ( mode & S_IXGRP ) ) / 8;
-    int z = ( ( mode & S_IROTH ) | ( mode & S_IWOTH ) | ( mode & S_IXOTH ) );
-
-    file = FXFile::name( file.c_str() ).text();
-
-    FXString tmp;
-    char chstr[ 20 ];
-    sprintf ( chstr, "%d%d%d", x, y, z );
-
-    if ( recursive == false )
-    {
-        std::string cmd = "CHMOD " + std::string( chstr ) + " " + file;
-        pftp->sendCmd( "SITE ", cmd.c_str(), tmp );
-    }
-    else
-    {
-        unsigned long size;
-        std::vector < std::string >src;
-        src.push_back( file );
-        getRecursiveFiles( src, size );
-
-        for ( iterGlobal = --filesMapGlobal.end();; iterGlobal-- )
-        {
-
-
-            std::string cmd = "CHMOD " + std::string( chstr ) + " " + iterGlobal->first;
-            pftp->sendCmd( "SITE ", cmd.c_str(), tmp );
-
-
-            if ( iterGlobal == filesMapGlobal.begin() ) break;
-
-        }
-
-
-    }
-
-
-
-}
-bool filelist_ftp::owner ( std::string file, std::string, bool recursive )
-{}
-bool filelist_ftp::group ( std::string file, std::string, bool recursive )
-{}
-std::string filelist_ftp::info ( void )
-{
-    return "";
-}
-void filelist_ftp::totalsize ( std::string path, unsigned long &size )
-{
-    size = 0;
-
-    std::string file = FXFile::name( path.c_str() ).text();
-    if ( file == "" )
-        file = FXFile::name( path.substr( 0, path.length() - 1 ).c_str() ).text();
-
-
-
-    if ( filesMap[ file ].type & FOLDER )
-    {
-        std::vector < std::string >src;
-        src.push_back( file );
-        getRecursiveFiles( src, size );
-    }
-    else
-        size = filesMap[ file ].size;
-
-
-
-}
-std::string filelist_ftp::symlink ( std::string path )
-{
-    return "";
-}
-bool filelist_ftp::symlink ( std::string src, std::string dst )
-{}
-bool filelist_ftp::hardlink ( std::string src, std::string dst )
-{}
-
-int filelist_ftp::quit ( void )
-{
-    pftp->logout();
-}
-
-std::string filelist_ftp::getinitialdir( void )
-{
-    FXString base;
-    pftp->pwd( base );
-
-    return base.text();
-}
-
-
-
-EXPORTFUNCTION filelist_base *get_filelist ( void )
-{
-    FXTRACE ( ( 5, "PLUGIN LOAD\n" ) );
-    return new filelist_ftp ();
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_ftp.h	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,128 +0,0 @@
-// $Id$
-/////////////////////////////////////////////////////////////////////////////
-// This file is part of OpenSpace project.
-//
-// OpenSpace is free software; you can redistribute it and/or modify
-// it under the terms of the GNU General Public License as published by
-// the Free Software Foundation; either version 2 of the License, or
-// (at your option) any later version.
-//
-// OpenSpace is distributed in the hope that it will be useful,
-// but WITHOUT ANY WARRANTY; without even the implied warranty of
-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-// GNU General Public License for more details.
-//
-// You should have received a copy of the GNU General Public License
-// along with OpenSpace; if not, write to the Free Software
-// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-/////////////////////////////////////////////////////////////////////////////
-//
-// C++ Interface: $MODULE$
-//
-// Author: Mateusz Dworak <http://openspace.linux.pl>, (C) 2005
-//
-// Description:
-//  FTP plugin derived from OpenSpace file list VFS plugin.
-//
-/////////////////////////////////////////////////////////////////////////////
-#ifndef FILELIST_ftp
-#define FILELIST_ftp
-
-#include "../../OSVirtualFileSystemBase.h"
-#include "../../OSPathType.h"
-#include "../../OSFile.h"
-#include "pftp.h"
-
-#include <map>
-#include <string>
-#include <vector>
-
-// Forward declarations
-class OSThreadExec;
-class OSConfigure;
-
-/**
- * Events logger class.
- * 
- * @todo Encapsulate public data members.
- */
-class SimpleLogger : public Logger
-{
-public:
-
-    OSThreadExec* te;
-
-    /**
-     * Default constructor.
-     */
-    SimpleLogger( void );
-
-    void start( uint32_t bytes, const FXString & name, uint32_t size );
-    bool update( uint32_t bytes, const FXString & s );
-    void end( uint32_t bytes, const FXString & );
-    void choke( void );
-    void error( int error );
-    void logLine( FXString & line );
-    void error( FXString & error );
-
-}; // SimpleLogger
-
-
-/**
- * FTP plugin main class.
- * 
- * @todo Pass "big" vectors through by-reference not by-value!
- */
-class filelist_ftp : public OSVirtualFileSystemBase
-{
-
-private:
-
-    PFTP *pftp;
-    SimpleLogger *log;
-    std::string dir;
-
-    std::map<std::string, OSFile> filesMap;
-    std::map<std::string, OSFile>::iterator iter;
-    std::map<std::string, OSFile> filesMapGlobal;
-    std::map<std::string, OSFile>::iterator iterGlobal;
-
-    int fieldsnum;
-    std::vector<std::string> fields;
-
-    int priv_osopendir( std::string dir, std::string prefix, std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter );
-    void gorecursive( std::string file, unsigned long &size );
-    OSFile priv_osreaddir( std::map <std::string, osfile> & filesMap, std::map <std::string, OSFile>::iterator & iter2 );
-    void getRecursiveFiles( std::vector<std::string> src, unsigned long &size );
-    void goLocalRecursive( std::string path, std::string prefix, OSThreadExec* te );
-    void local_totalsize( std::string path, unsigned long &size );
-    int str_mode_int( std::string per );
-
-public:
-    
-    int osopendir( std::string dir );
-    OSFile osreaddir( void );
-    int mkdir( std::string dir, int mode = 0 );
-    int copy( OSThreadExec * te );
-    int move( OSThreadExec * te );
-    int remove( OSThreadExec * te );
-    int rename( std::string orgname, std::string newname );
-    int init( std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf );
-    int mode( std::string file );
-    std::string owner( std::string file );
-    std::string group( std::string file );
-    bool mode( std::string file, unsigned int, bool recursive );
-    bool owner( std::string file, std::string, bool recursive );
-    bool group( std::string file, std::string, bool recursive );
-    std::string info( void );
-    void totalsize( std::string path, unsigned long &size );
-    std::string symlink( std::string path );
-    bool symlink( std::string src, std::string dst );
-    bool hardlink( std::string src, std::string dst );
-    OSVirtualFileSystemInfo setup( void );
-    int quit( void );
-    std::string getinitialdir( void );
-
-
-};
-#endif

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,602 +0,0 @@
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-#include "filelist_local.h"
-#include "OSFXFile.h"
-#include "../../OSVirtualFileSystemHeader.h"
-#include "../../OSVirtualFileSystemInfo.h"
-#include "../../OSThreadExec.h"
-#include "../../OSFile.h"
-#include "../../OSUtils.h"
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-#include <fx.h>
-#include <errno.h>
-#include <fstream>
-#include <sstream>
-#include <sys/mount.h>
-#include <sys/types.h>
-#include <unistd.h>
-#include <pwd.h>
-#include <grp.h>
-
-#include <string>
-#include <vector>
-
-// XXX - What this global is for?
-std::vector<std::string> name;
-
-OSVirtualFileSystemInfo filelist_local::setup (void)
-{
-	OSVirtualFileSystemInfo v;
-	
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("name"));
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("size","size"));
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("owner"));
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("group"));
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("accessed","date"));
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("modified","date"));
-	v.information="Local file list - default plugin";
-	v.version="1";
-	
-    return v;	
-}
-
-int filelist_local::init (std::vector<std::string> *vector_name, OSPathType pt, OSConfigure * conf)
-{
-
-    fieldsnum = vector_name->size ();
-    fields = (*vector_name);
-
-    return 0;
-}
-
-
-OSFile filelist_local::osreaddir ()
-{
-
-    OSFile os_file;
-    if (dp == NULL)
-    {
-	os_file.name = "";
-	return os_file;
-    }
-    if ((dirrec = readdir (dp)) == NULL)
-    {
-	closedir (dp);
-	os_file.name = "";
-	return os_file;
-    }
-
-    os_file.name = dirrec->d_name;
-    os_file.type = 0;
-
-    os_file.size = FXFile::size (os_file.name.c_str ());
-
-    if (stat (dirrec->d_name, &status) != -1)
-    {
-
-	struct stat status2;
-	if (lstat (dirrec->d_name, &status2) != -1)
-	{
-	    if (S_ISLNK (status2.st_mode))
-	    {
-		os_file.type = os_file.type | SYMLINK;
-	    }
-
-	}
-
-
-	if (S_ISDIR (status.st_mode))
-	{
-	    os_file.type = os_file.type | FOLDER;
-	}
-	else
-	{
-	    /*
-	       char line[20];
-	       FILE *fr;    
-	       fr = fopen (dirrec->d_name, "rt"); 
-	       fgets(line, sizeof(line), fr);   
-	       fclose(fr);  
-	       std::string con=line;
-
-	       os_file.content=con.substr(0,con.size()-1);
-	     */
-	}
-
-
-
-
-	if (S_ISCHR (status.st_mode))
-	    os_file.type = os_file.type | CHARDEV;
-
-	if (S_ISBLK (status.st_mode))
-	    os_file.type = os_file.type | BLOCKDEV;
-
-	if (access (dirrec->d_name, X_OK) == 0)
-	    os_file.type = os_file.type | EXECUTABLE;
-    }
-
-
-
-
-
-    for (int i = 0; i < fieldsnum - 1; i++)
-    {
-
-	if (fields[i + 1] == "size")
-	    os_file.attrib.push_back(numtostring (os_file.size));
-	else if (fields[i + 1] == "owner")
-	   os_file.attrib.push_back(FXFile::owner (os_file.name.c_str ()).text ());
-	else if (fields[i + 1] == "group")
-	   os_file.attrib.push_back(FXFile::group (os_file.name.c_str ()).text ());
-	else if (fields[i + 1] == "accessed")
-	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::accessed (os_file.name.c_str ())).text ());
-	else if (fields[i + 1] == "created")
-	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::created (os_file.name.c_str ())).text ()); 
-	else if (fields[i + 1] == "modified")
- 	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::modified (os_file.name.c_str ())).text ());       
-	else if (fields[i + 1] == "mode")
-	{
-
-	    struct stat info;
-	    std::string str = "---------";
-	    if (lstat (os_file.name.c_str (), &info) == 0)
-	    {
-
-		(info.st_mode & S_IRUSR) ? str[0] = 'r' : str[0] = '-';
-		(info.st_mode & S_IWUSR) ? str[1] = 'w' : str[1] = '-';
-		(info.st_mode & S_IXUSR) ? str[2] = 'x' : str[2] = '-';
-		(info.st_mode & S_IRGRP) ? str[3] = 'r' : str[3] = '-';
-		(info.st_mode & S_IWGRP) ? str[4] = 'w' : str[4] = '-';
-		(info.st_mode & S_IXGRP) ? str[5] = 'x' : str[5] = '-';
-		(info.st_mode & S_IROTH) ? str[6] = 'r' : str[6] = '-';
-		(info.st_mode & S_IWOTH) ? str[7] = 'w' : str[7] = '-';
-		(info.st_mode & S_IXOTH) ? str[8] = 'x' : str[8] = '-';
-
-	    }
-
-
-	    os_file.attrib.push_back(str);
-
-	}
-
-    }
-
-
-
-    return os_file;
-
-
-}
-
-
-int filelist_local::osopendir (std::string dir)
-{
-    this->dir = dir;
-
-#ifndef WIN32
-    std::string line;
-    std::ifstream infile ("/etc/fstab");
-
-    while (std::getline (infile, line))
-    {
-
-	std::stringstream parser (line);
-	std::string command;
-	std::string field;
-	std::string partition;
-	parser >> partition;
-
-	std::string type;
-
-	if (partition[0] != '#')
-	{
-
-	    parser >> command;
-
-	    if (command == dir)
-	    {
-
-		parser >> type;
-		parser >> field;
-		std::string::size_type pos = field.find ("noauto", 0);
-		if (pos != std::string::npos)
-		{
-
-		    if (mount (partition.c_str (), command.c_str (), type.c_str (), MS_RDONLY, "") == 0)
-			FXTRACE ((5, "MOUNT\n"));
-
-		}
-	    }
-
-	}
-    }
-
-#endif
-
-    dp = opendir (dir.c_str ());
-    if (dp == NULL)
-	return -1;
-
-    chdir (dir.c_str ());
-
-
-}
-
-int filelist_local::mkdir (std::string dir, int mode)
-{
-    FXTRACE ((5, "MKDIR\n"));
-    std::string d = this->dir + SEPARATOR + dir;
-
-    return FXFile::createDirectory (d.c_str (), mode);
-    return 0;
-}
-
-int filelist_local::copy ( OSThreadExec * te)
-{
-    copymove (te, true);
-}
-
-int filelist_local::move (OSThreadExec* te)
-{
-    copymove (te, false);
-}
-
-
-int filelist_local::remove (OSThreadExec* te)
-{
-
-    bool canc = false;
-
-    std::vector<std::string>::iterator iter;
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-  
-	if (!canc)
-	{
-
-	    std::string sr = (*iter);
-	    if (FXFile::isDirectory (sr.c_str ()))
-		sr.append (SEPARATOR);
-	    FXTRACE ((5, "REMOVE: %s", sr.c_str ()));
-
-	    if (OSFXFile::remove (sr.c_str (), te) == FALSE)
-		canc = true;
-		
-	}
-
-
-    }
-    if(canc)
-    {
-    te->error=true;
-    te->msg="operation failed";
-    }
-    
-
-
-}
-
-int filelist_local::rename (std::string orgname, std::string newname)
-{
-
-    FXString newfile = newname.c_str ();
-    FXString oldfile = orgname.c_str ();
-
-#ifndef WIN32
-    if (!FXFile::exists (oldfile))
-	return false;
-    if (FXFile::exists (newfile))
-    {
-	return false;
-
-    }
-
-    if (::rename (oldfile.text (), newfile.text ()) == 0)
-	return true;
-    if (errno != EXDEV)
-	return false;
-	
-#else
-    if (!FXFile::exists (oldfile))
-	return false;
-    if (FXFile::exists (newfile))
-    {
-	return false;
-
-    }
-
-    if (::MoveFile (oldfile.text (), newfile.text ()) != 0)
-	return true;
-#endif
-}
-
-
-int filelist_local::copymove (OSThreadExec* te, bool copy)
-{
-
-    unsigned long size = 0;
-
- 
-     std::vector < std::string >::iterator iter;
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-	std::string sr = (*iter);
-	if (FXFile::isDirectory (sr.c_str ()))
-	    sr.append (SEPARATOR);
-	totalsize (sr, size);
-
-    }
-
-    te->total_size = size;
-
-    bool canc = false;
-
-
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-	if (!canc)
-	{
-	    std::string ds = te->dst;
-	    ds.append (SEPARATOR);
-	    ds.append (FXFile::name (iter->c_str ()).text ());
-
-
-	    std::string sr = (*iter);
-	    if (FXFile::isDirectory (sr.c_str ()))
-		sr.append (SEPARATOR);
-
-
-
-	    if (copy)
-	    {
-		if (OSFXFile::copy (sr.c_str (), ds.c_str (), te) == FALSE)
-		    canc = true;
-	    }
-	    else
-	    {
-		FXTRACE ((5, "MOVE;]"));
-		if (OSFXFile::move (sr.c_str (), ds.c_str (), te) == FALSE)
-		    canc = true;
-	    }
-
-	}
-
-    }
-    if(canc)
-    {
-    te->error=true;
-    te->msg="operation failed";
-    }
-
-}
-
-
-
-void filelist_local::totalsize (std::string path, unsigned long &size)
-{
-
-    if (FXFile::isDirectory (path.c_str ()))
-    {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
-
-
-	dirp = opendir (path.c_str ());
-
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-	    {
-
-		std::string file = path;
-		file.append (dp->d_name);
-#ifndef WIN32
-		lstat (file.c_str (), &status);
-#else
-		stat (file.c_str (), &status);
-#endif
-		if (S_ISDIR (status.st_mode))
-		{
-		    size = size + (unsigned int) status.st_size;
-		    file.append ("/");
-		    totalsize (file, size);
-
-		}
-		else
-		{
-		    size = size + status.st_size;
-		}
-	    }
-	}
-
-	closedir (dirp);
-    }
-    else
-    {
-	size += FXFile::size (path.c_str ());
-
-    }
-
-}
-
-std::string filelist_local::info (void)
-{
-    return "";
-}
-
-
-int filelist_local::mode (std::string file)
-{
-    struct stat status;
-    return !file.empty () && (::stat (file.c_str (), &status) == 0) ? status.st_mode : 0;
-}
-
-bool filelist_local::mode (std::string file, unsigned int mod, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-	return FXFile::mode (file.c_str (), mod);
-    }
-    else
-    {
-	FXFile::mode (file.c_str (), mod);
-	std::string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    std::string file = path;
-		    file.append (dp->d_name);
-		    mode (file, mod, true);
-
-		}
-	    }
-
-	    closedir (dirp);
-	}
-
-
-    }
-}
-
-std::string filelist_local::owner (std::string file)
-{
-    return FXFile::owner (file.c_str ()).text ();
-}
-std::string filelist_local::group (std::string file)
-{
-    return FXFile::group (file.c_str ()).text ();
-}
-
-bool filelist_local::owner (std::string file, std::string ownername, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-	passwd *p = getpwnam( ownername.c_str() );
-	return chown (file.c_str(), p->pw_uid, (gid_t)-1);
-
-    }
-    else
-    {
-	passwd *p = getpwnam(ownername.c_str ());
-	chown (file.c_str(), p->pw_uid, (gid_t)-1);
-
-	std::string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    std::string file = path;
-		    file.append (dp->d_name);
-		    owner (file, ownername, true);
-		}
-	    }
-
-	    closedir (dirp);
-	}
-    }
-}
-
-bool filelist_local::group (std::string file, std::string groupname, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-	::group * grp = getgrnam (groupname.c_str ());
-	return chown (file.c_str(), (uid_t)-1, grp->gr_gid);
-    }
-    else
-    {
-	::group * grp = getgrnam (groupname.c_str ());
-	chown (file.c_str(), (uid_t)-1, grp->gr_gid);
-	std::string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    std::string file = path;
-		    file.append (dp->d_name);
-		    group (file, groupname, true);
-		}
-	    }
-
-	    closedir (dirp);
-	}
-    }
-}
-
-std::string filelist_local::symlink (std::string path)
-{
-    return FXFile::symlink (path.c_str ()).text ();
-}
-bool filelist_local::symlink (std::string src, std::string dst)
-{
-    return FXFile::symlink (src.c_str (), dst.c_str ());
-}
-bool filelist_local::hardlink (std::string src, std::string dst)
-{
-    return FXFile::link (src.c_str (), dst.c_str ());
-}
-
-
-int filelist_local::quit (void)
-{
-    return 0;
-}
-
-EXPORTFUNCTION OSVirtualFileSystemBase* get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_local ();
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.h	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_local.h	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,90 +0,0 @@
-// $Id$
-/////////////////////////////////////////////////////////////////////////////
-// This file is part of OpenSpace project.
-//
-// OpenSpace is free software; you can redistribute it and/or modify
-// it under the terms of the GNU General Public License as published by
-// the Free Software Foundation; either version 2 of the License, or
-// (at your option) any later version.
-//
-// OpenSpace is distributed in the hope that it will be useful,
-// but WITHOUT ANY WARRANTY; without even the implied warranty of
-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-// GNU General Public License for more details.
-//
-// You should have received a copy of the GNU General Public License
-// along with OpenSpace; if not, write to the Free Software
-// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-/////////////////////////////////////////////////////////////////////////////
-//
-// C++ Interface: $MODULE$
-//
-// Author: Mateusz Dworak <http://openspace.linux.pl>, (C) 2005
-//
-// Description: 
-//
-/////////////////////////////////////////////////////////////////////////////
-#ifndef FILELIST_LOCAL
-#define FILELIST_LOCAL
-
-#include"../../OSVirtualFileSystemBase.h"
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <dirent.h>
-#include <string>
-#include <vector>
-
-// Forward declarations
-class OSConfigure;
-class OSFile;
-class OSPathType;
-class OSThreadExec;
-
-/**
- * Local file list plugin class.
- * 
- * @todo This plugin will be reorganized/renamed.
- */
-class filelist_local: public OSVirtualFileSystemBase
-{
-private:
-
-    DIR *dp;
-    dirent *dirrec;
-    struct stat status;
-    std::string dir;
-    std::string display_size;
-    int fieldsnum;
-    std::vector<std::string> fields;
-
-    int copymove( OSThreadExec * te, bool copy = true );
-
-public:
-
-    int osopendir ( std::string dir );
-    OSFile osreaddir ( void );
-    int mkdir ( std::string dir, int mode );
-    int copy ( OSThreadExec * te );
-    int move ( OSThreadExec * te );
-    int remove ( OSThreadExec * te );
-    int rename ( std::string orgname, std::string newname );
-    int init ( std::vector<std::string> *vector_name, OSPathType pt, OSConfigure* conf );
-    int mode ( std::string file );
-    std::string owner ( std::string file );
-    std::string group ( std::string file );
-    bool mode ( std::string file, unsigned int, bool recursive = false );
-    bool owner ( std::string file, std::string ownername, bool recursive = false );
-    bool group ( std::string file, std::string groupname, bool recursive = false );
-    std::string info ( void );
-    int quit ( void );
-    std::string symlink ( std::string path );
-    bool symlink ( std::string src, std::string dst );
-    bool hardlink ( std::string src, std::string dst );
-    OSVirtualFileSystemInfo setup ( void );
-    void totalsize ( std::string path, unsigned long &size );
-
-};
-
-#endif
-

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.cpp	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,189 +0,0 @@
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-#include "filelist_search.h"
-
-#include "../../OSVirtualFileSystemBase.h"
-#include "../../OSVirtualFileSystemInfo.h"
-#include "../../OSFile.h"
-#include "../../OSPathType.h"
-#include "../../OSConfigure.h"
-#include "../../OSThreadExec.h"
-
-#include <string>
-#include <vector>
-
-OSVirtualFileSystemInfo filelist_search::setup (void)
-{
-	OSVirtualFileSystemInfo v;
-	
-	v.vfsheaders.push_back(OSVirtualFileSystemHeader("name"));
-	v.information="search vfs - default plugin";
-	v.version="1";
-	v.type="search";
-return v;	
-	
-}
-
-
-int filelist_search::osopendir (std::string dir)
-{
-
-  iter=files.begin(); 
-
-}
-OSFile filelist_search::osreaddir (void)
-{
-    OSFile os_file;
-
-if(iter!=files.end())
-{
-
-	    os_file.type = 0;
-	    os_file.name = *iter;
-	    os_file.size = 300;
-	
-	    iter++;
-	 
-	    return os_file;
-}		    
-
-
-    
-    os_file.name = "";
-    return os_file;
-    
-
-
-}
-int filelist_search::mkdir (std::string dir, int mode)
-{
-}
-int filelist_search::copy (OSThreadExec * te)
-{
-
-	std::string::size_type pos = te->options.find ("download");
-	if (pos == std::string::npos) //upload only supported
-	{
-	return fil_local->copy(te);
-	}
-	else
-	{
-	 te->error=true;
-         te->msg="operation not allowed";
-	}
-
-}
-int filelist_search::move (OSThreadExec * te)
-{
-
-	std::string::size_type pos = te->options.find ("download");
-	if (pos == std::string::npos) //upload only supported
-	{
-	return fil_local->move(te);
-	}
-	else
-	{
-	 te->error=true;
-         te->msg="operation not allowed";
-	}
-
-}
-int filelist_search::remove (OSThreadExec * te)
-{
-return fil_local->remove(te);
-}
-int filelist_search::rename (std::string orgname, std::string newname)
-{
-
-	int ret=fil_local->rename(orgname,newname);
-	if(ret)
-	{
-		std::vector < std::string >::iterator iter = find(files.begin(), files.end(), orgname.substr(1,orgname.length()-1)); // Search the list.
-		if (iter != files.end())
-		{
-  		(*iter)=newname.substr(1,newname.length()-1);
-		}
-	}
-
-	return ret;
-}
-int filelist_search::init(std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf)
-{
-    fil_local=new filelist_local();
-
-    pipe = popen (pt.server.c_str(), "r");
-
-    if (pipe != NULL)
-    {
-	std::string line;
-	while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-	{
-
-
-	    std::string path = readbuf;
-	    path = path.substr (1, path.length () - 2);
-	    files.push_back(path);
-	   
-	}
-
-	pclose (pipe);
-    }
-    
-iter=files.begin();
-    
-
-}
-int filelist_search::mode (std::string file)
-{
-return fil_local->mode(file);
-}
-std::string filelist_search::owner (std::string file)
-{
-return fil_local->owner(file);
-}
-std::string filelist_search::group (std::string file)
-{
-return fil_local->group(file);
-}
-bool filelist_search::mode (std::string file, unsigned int mod, bool recursive)
-{
-return fil_local->mode(file,mod,recursive);
-}
-bool filelist_search::owner (std::string file, std::string ow, bool recursive)
-{
-return fil_local->owner(file,ow,recursive);
-}
-bool filelist_search::group (std::string file, std::string gr, bool recursive)
-{
-return fil_local->group(file,gr,recursive);
-}
-std::string filelist_search::info (void)
-{
-return "";
-}
-void filelist_search::totalsize (std::string path, unsigned long &size)
-{
-}
-std::string filelist_search::symlink (std::string path)
-{
-}
-bool filelist_search::symlink (std::string src, std::string dst)
-{
-}
-bool filelist_search::hardlink (std::string src, std::string dst)
-{
-}
-
-int filelist_search::quit (void)
-{
-}
-
-EXPORTFUNCTION OSVirtualFileSystemBase *get_filelist(void)
-{
-    FXTRACE ((5, "PLUGIN SEARCH LOAD\n"));
-    return new filelist_search ();
-}

Deleted: branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h	2006-02-11 21:32:58 UTC (rev 240)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/filelist_search.h	2006-02-11 21:53:06 UTC (rev 241)
@@ -1,56 +0,0 @@
-#ifndef FILELIST_search
-#define FILELIST_search
-
-#include "../../OSVirtualFileSystemBase.h"
-#include "../../OSPathType.h"
-#include "filelist_local.h"
-
-#include <string>
-#include <vector>
-
-// Forward declarations
-class OSThreadClass;
-class OSConfigure;
-
-/**
- * Search plugin class
- *
- * @todo To rename.
- */
-class filelist_search : public OSVirtualFileSystemBase
-{
-  
-private:
-  
-  FILE *pipe;
-  char readbuf[1024];
-  std::vector<std::string> files;
-  std::vector<std::string>::iterator iter;
-
-  filelist_local *fil_local;
-  
-public:
-  
-    int osopendir (std::string dir);
-    OSFile osreaddir (void);
-    int mkdir (std::string dir, int mode = 0);
-    int copy (OSThreadExec * te);
-    int move (OSThreadExec * te);
-    int remove (OSThreadExec * te);
-    int rename (std::string orgname, std::string newname);
-    int init (std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf);
-    int mode (std::string file);
-    std::string owner (std::string file);
-    std::string group (std::string file);
-    bool mode (std::string file, unsigned int, bool recursive);
-    bool owner (std::string file, std::string, bool recursive);
-    bool group (std::string file, std::string, bool recursive);
-    std::string info (void);
-    void totalsize (std::string path, unsigned long &size);
-    std::string symlink (std::string path);
-    bool symlink (std::string src, std::string dst);
-    bool hardlink (std::string src, std::string dst);
-    OSVirtualFileSystemInfo setup(void);
-    int quit (void);
-};
-#endif



From compbatant at berlios.de  Sun Feb 12 00:06:33 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 00:06:33 +0100
Subject: [Openspace-svn] r242 - in branches/mloskot-style-refactoring/src: . plugins/filelist
Message-ID: <200602112306.k1BN6XFS028874@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 00:06:27 +0100 (Sun, 12 Feb 2006)
New Revision: 242

Modified:
   branches/mloskot-style-refactoring/src/OSFileList.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp
   branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h
Log:
code refactoring cd


Modified: branches/mloskot-style-refactoring/src/OSFileList.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/OSFileList.cpp	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/OSFileList.cpp	2006-02-11 23:06:27 UTC (rev 242)
@@ -254,13 +254,14 @@
     }
   }
 
+    string firstLetter=this->type.substr(0,1);
+    transform (firstLetter.begin(),firstLetter.end(), firstLetter.begin(), ::toupper);
 
-    
+    string pluginName="libOSVfs"+firstLetter+this->type.substr(1,this->type.length()-1);
 
+    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/filelist/" +pluginName;
 
-    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/filelist/libfilelist" + this->type;
 
-
 #ifdef WIN32
     plugin_path += ".dll";
 #else
@@ -269,7 +270,7 @@
 
     if(!FXFile::exists(plugin_path.c_str()))
     {
-    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libfilelist")+ this->type;
+    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libVfs")+ pluginName;
     #ifdef WIN32
     plugin_path += ".dll";
     #else

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/Makefile.in	2006-02-11 23:06:27 UTC (rev 242)
@@ -14,7 +14,7 @@
 
 @SET_MAKE@
 
-SOURCES = $(libfilelistlocal_la_SOURCES)
+SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) $(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -48,17 +48,30 @@
 am__installdirs = "$(DESTDIR)$(pkglibdir)"
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
-libfilelistlocal_la_LIBADD =
-am_libfilelistlocal_la_OBJECTS = filelist_local.lo OSFXFile.lo \
+libOSVfsArchive_la_LIBADD =
+am_libOSVfsArchive_la_OBJECTS = OSVfsArchive.lo OSThreadExec.lo
+libOSVfsArchive_la_OBJECTS = $(am_libOSVfsArchive_la_OBJECTS)
+libOSVfsFtp_la_LIBADD =
+am_libOSVfsFtp_la_OBJECTS = OSVfsFtp.lo pftp.lo OSThreadExec.lo
+libOSVfsFtp_la_OBJECTS = $(am_libOSVfsFtp_la_OBJECTS)
+libOSVfsLocal_la_LIBADD =
+am_libOSVfsLocal_la_OBJECTS = OSVfsLocal.lo OSFXFile.lo \
 	OSThreadExec.lo OSUtils.lo
-libfilelistlocal_la_OBJECTS = $(am_libfilelistlocal_la_OBJECTS)
+libOSVfsLocal_la_OBJECTS = $(am_libOSVfsLocal_la_OBJECTS)
+libOSVfsSearch_la_LIBADD =
+am_libOSVfsSearch_la_OBJECTS = OSVfsSearch.lo OSFXFile.lo \
+	OSThreadExec.lo
+libOSVfsSearch_la_OBJECTS = $(am_libOSVfsSearch_la_OBJECTS)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 @AMDEP_TRUE at DEP_FILES = ./$(DEPDIR)/OSFXFile.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/OSUtils.Plo \
- at AMDEP_TRUE@	./$(DEPDIR)/filelist_local.Plo
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsArchive.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsFtp.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsLocal.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsSearch.Plo ./$(DEPDIR)/pftp.Plo
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
 LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
@@ -75,12 +88,13 @@
 CCLD = $(CC)
 LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libfilelistlocal_la_SOURCES)
-DIST_SOURCES = $(libfilelistlocal_la_SOURCES)
+SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) \
+	$(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
+DIST_SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) \
+	$(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-#libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
 pkglibdir = $(libdir)/openspace/plugins/filelist
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
@@ -178,10 +192,16 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-pkglib_LTLIBRARIES = libfilelistlocal.la  
+pkglib_LTLIBRARIES = libOSVfsLocal.la libOSVfsSearch.la libOSVfsArchive.la libOSVfsFtp.la   
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
-libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-libfilelistlocal_la_SOURCES = filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+libOSVfsLocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSVfsLocal_la_SOURCES = OSVfsLocal.cpp OSVfsLocal.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+libOSVfsSearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsSearch_la_SOURCES = OSVfsSearch.cpp OSVfsSearch.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsArchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsArchive_la_SOURCES = OSVfsArchive.cpp OSVfsArchive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsFtp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsFtp_la_SOURCES = OSVfsFtp.cpp OSVfsFtp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 all: all-am
 
 .SUFFIXES:
@@ -242,8 +262,14 @@
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
-libfilelistlocal.la: $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistlocal_la_LDFLAGS) $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_LIBADD) $(LIBS)
+libOSVfsArchive.la: $(libOSVfsArchive_la_OBJECTS) $(libOSVfsArchive_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsArchive_la_LDFLAGS) $(libOSVfsArchive_la_OBJECTS) $(libOSVfsArchive_la_LIBADD) $(LIBS)
+libOSVfsFtp.la: $(libOSVfsFtp_la_OBJECTS) $(libOSVfsFtp_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsFtp_la_LDFLAGS) $(libOSVfsFtp_la_OBJECTS) $(libOSVfsFtp_la_LIBADD) $(LIBS)
+libOSVfsLocal.la: $(libOSVfsLocal_la_OBJECTS) $(libOSVfsLocal_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsLocal_la_LDFLAGS) $(libOSVfsLocal_la_OBJECTS) $(libOSVfsLocal_la_LIBADD) $(LIBS)
+libOSVfsSearch.la: $(libOSVfsSearch_la_OBJECTS) $(libOSVfsSearch_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsSearch_la_LDFLAGS) $(libOSVfsSearch_la_OBJECTS) $(libOSVfsSearch_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
@@ -254,7 +280,11 @@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFXFile.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSUtils.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_local.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsArchive.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsFtp.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsLocal.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsSearch.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/pftp.Plo at am__quote@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
@@ -509,14 +539,8 @@
 	uninstall-pkglibLTLIBRARIES
 
 
-#libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
 #libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
 #libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
-#libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-#libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp	2006-02-11 23:06:27 UTC (rev 242)
@@ -3,14 +3,16 @@
 #else
 #define EXPORTFUNCTION extern "C"
 #endif
-#include "filelist_archive.h"
+#include "OSVfsArchive.h"
+#include "../../OSThreadExec.h"
 
+using namespace std;
 
-vfs filelist_archive::setup (void)
+OSVirtualFileSystemInfo OSVfsArchive::setup (void)
 {
-	vfs v;
+	OSVirtualFileSystemInfo v;
 	
-	v.vfsheaders.push_back(vfsheader_container("name"));
+	v.vfsheaders.push_back(OSVirtualFileSystemHeader("name"));
 	v.information="tar.bz2 and tar.gz archive - default plugin";
 	v.version="1";
 	v.type="vfs";
@@ -18,17 +20,16 @@
 	
 }
 
-
-int filelist_archive::osopendir (string dir)
+int OSVfsArchive::osopendir (string dir)
 {
-
 this->dir=dir;
 iter=files.begin();
 }
-osfile filelist_archive::osreaddir (void)
+
+OSFile OSVfsArchive::osreaddir (void)
 {
 
-osfile os_file;
+OSFile os_file;
 
 while(iter!=files.end())
 {
@@ -83,24 +84,24 @@
     return os_file;
 
 }
-int filelist_archive::mkdir (string dir, int mode)
+int OSVfsArchive::mkdir (string dir, int mode)
 {
 }
-int filelist_archive::copy (thread_elem * te)
+int OSVfsArchive::copy (OSThreadExec * te)
 {
 filesoperation("copy",te);
 }
 
-int filelist_archive::move (thread_elem * te)
+int OSVfsArchive::move (OSThreadExec * te)
 {
 filesoperation("move",te);
 }
-int filelist_archive::remove (thread_elem * te)
+int OSVfsArchive::remove (OSThreadExec * te)
 {
 filesoperation("remove",te);
 }
 
-int filelist_archive::filesoperation(string typeoperation,thread_elem * te)
+int OSVfsArchive::filesoperation(string typeoperation,OSThreadExec * te)
 {
 
  vector < string >::iterator iter;
@@ -153,7 +154,7 @@
 		if(typeoperation=="move")
 		{
 		
-		thread_elem *el2 = new thread_elem (this, "remove", "", file_list_vec);
+		OSThreadExec *el2 = new OSThreadExec (this, "remove", "", file_list_vec);
 		this->remove(el2);
 		delete el2;
 		
@@ -308,10 +309,10 @@
 }
 
 
-int filelist_archive::rename (string orgname, string newname)
+int OSVfsArchive::rename (string orgname, string newname)
 {
 }
-int filelist_archive::init (vector < string > *vector_name, pathtype pt, configure * conf)
+int OSVfsArchive::init (vector < string > *vector_name, OSPathType pt, OSConfigure * conf)
 {
 archive_filename = pt.server;
 
@@ -347,49 +348,49 @@
 iter=files.begin();
 
 }
-int filelist_archive::mode (string file)
+int OSVfsArchive::mode (string file)
 {
 }
-string filelist_archive::owner (string file)
+string OSVfsArchive::owner (string file)
 {
 return "";
 }
-string filelist_archive::group (string file)
+string OSVfsArchive::group (string file)
 {
 return "";
 }
-bool filelist_archive::mode (string file, unsigned int, bool recursive)
+bool OSVfsArchive::mode (string file, unsigned int, bool recursive)
 {
 }
-bool filelist_archive::owner (string file, string, bool recursive)
+bool OSVfsArchive::owner (string file, string, bool recursive)
 {
 }
-bool filelist_archive::group (string file, string, bool recursive)
+bool OSVfsArchive::group (string file, string, bool recursive)
 {
 }
-string filelist_archive::info (void)
+string OSVfsArchive::info (void)
 {
 return "";
 }
-void filelist_archive::totalsize (string path, unsigned long &size)
+void OSVfsArchive::totalsize (string path, unsigned long &size)
 {
 }
-string filelist_archive::symlink (string path)
+string OSVfsArchive::symlink (string path)
 {
 return "";
 }
-bool filelist_archive::symlink (string src, string dst)
+bool OSVfsArchive::symlink (string src, string dst)
 {
 }
-bool filelist_archive::hardlink (string src, string dst)
+bool OSVfsArchive::hardlink (string src, string dst)
 {
 }
 
-int filelist_archive::quit (void)
+int OSVfsArchive::quit (void)
 {
 }
-EXPORTFUNCTION filelist_base *get_filelist (void)
+EXPORTFUNCTION OSVirtualFileSystemBase *get_filelist (void)
 {
     FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_archive ();
+    return new OSVfsArchive ();
 }

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h	2006-02-11 23:06:27 UTC (rev 242)
@@ -18,7 +18,7 @@
  *
  * @todo Why all filelist_* plugins redeclare the same interface?
  */
-class filelist_archive : public OSVirtualFileSystemBase
+class OSVfsArchive : public OSVirtualFileSystemBase
 {
  
 private:  

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp	2006-02-11 23:06:27 UTC (rev 242)
@@ -33,8 +33,12 @@
 #define EXPORTFUNCTION extern "C"
 #endif
 
-#include "filelist_ftp.h"
+#include "OSVfsFtp.h"
 #include "../../OSVirtualFileSystemBase.h"
+#include "../../OSFile.h"
+#include "../../OSPathType.h"
+#include "../../OSConfigure.h"
+#include "../../OSThreadExec.h"
 
 #include <sstream>
 #include <sys/types.h>
@@ -46,7 +50,9 @@
 #include <string>
 #include <vector>
 #include <map>
+using namespace std;
 
+
 SimpleLogger::SimpleLogger()
 {
     te = NULL;
@@ -92,14 +98,14 @@
     fxmessage( "ERROR=%s\n", error.text() );
 }
 
-vfs filelist_ftp::setup ( void )
+OSVirtualFileSystemInfo OSVfsFtp::setup ( void )
 {
-    OSVirtualFileSystemBase v;
+    OSVirtualFileSystemInfo v;
 
-    v.vfsheaders.push_back( vfsheader_container( "name" ) );
-    v.vfsheaders.push_back( vfsheader_container( "size", "size" ) );
-    v.vfsheaders.push_back( vfsheader_container( "owner" ) );
-    v.vfsheaders.push_back( vfsheader_container( "group" ) );
+    v.vfsheaders.push_back( OSVirtualFileSystemHeader( "name" ) );
+    v.vfsheaders.push_back( OSVirtualFileSystemHeader( "size", "size" ) );
+    v.vfsheaders.push_back( OSVirtualFileSystemHeader( "owner" ) );
+    v.vfsheaders.push_back( OSVirtualFileSystemHeader( "group" ) );
     v.information = "FTP - default plugin";
     v.version = "1";
     v.type = "network";
@@ -108,7 +114,7 @@
 }
 
 
-int filelist_ftp::priv_osopendir ( std::string dir, std::string prefix, std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter )
+int OSVfsFtp::priv_osopendir ( std::string dir, std::string prefix, std::map <std::string, OSFile> & filesMap, std::map <std::string, OSFile>::iterator & iter )
 {
 
     filesMap.clear();
@@ -162,7 +168,7 @@
 
 
 
-        osfile os_file;
+        OSFile os_file;
         os_file.type = 0;
         if ( ptr[ 0 ] == 'd' )
             os_file.type = os_file.type | FOLDER;
@@ -170,7 +176,7 @@
             os_file.type = 0;
 
         std::stringstream parser ( ptr );
-        std::std::string field;
+        std::string field;
 
         std::string user;
         std::string group;
@@ -252,7 +258,7 @@
 
 
 
-int filelist_ftp::osopendir ( std::string dir )
+int OSVfsFtp::osopendir ( std::string dir )
 {
 
 
@@ -264,9 +270,9 @@
 
 }
 
-osfile filelist_ftp::priv_osreaddir ( std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter )
+OSFile OSVfsFtp::priv_osreaddir ( std::map <std::string, OSFile> & filesMap, std::map <std::string, OSFile>::iterator & iter )
 {
-    osfile os_file;
+    OSFile os_file;
 
     if ( iter != filesMap.end() )
     {
@@ -284,12 +290,12 @@
 }
 
 
-osfile filelist_ftp::osreaddir ( void )
+OSFile OSVfsFtp::osreaddir ( void )
 {
 
     return priv_osreaddir( filesMap, iter );
 }
-int filelist_ftp::mkdir ( std::string dir, int mode )
+int OSVfsFtp::mkdir ( std::string dir, int mode )
 {
     pftp->mkDir( dir.c_str() );
 }
@@ -308,7 +314,7 @@
 
 
 
-void filelist_ftp::local_totalsize ( std::string path, unsigned long &size )
+void OSVfsFtp::local_totalsize ( std::string path, unsigned long &size )
 {
 
     if ( FXFile::isDirectory ( path.c_str () ) )
@@ -362,7 +368,7 @@
 
 
 
-int filelist_ftp::copy ( thread_elem * te )
+int OSVfsFtp::copy ( OSThreadExec * te )
 {
     log->te = te;
     unsigned long size = 0;
@@ -440,7 +446,7 @@
 }
 
 
-void filelist_ftp::goLocalRecursive ( std::string path, std::string prefix, thread_elem *te )
+void OSVfsFtp::goLocalRecursive ( std::string path, std::string prefix, OSThreadExec *te )
 {
 
     if ( te->cancel == true )
@@ -499,23 +505,23 @@
 
 
 
-int filelist_ftp::move ( thread_elem * te )
+int OSVfsFtp::move ( OSThreadExec * te )
 {}
 
 
-void filelist_ftp::gorecursive( std::string file, unsigned long &size )
+void OSVfsFtp::gorecursive( std::string file, unsigned long &size )
 {
 
 
-    std::map <std::string, osfile> filesMap;
-    std::map <std::string, osfile>::iterator iter;
+    std::map <std::string, OSFile> filesMap;
+    std::map <std::string, OSFile>::iterator iter;
 
     if ( priv_osopendir( file, file + "/", filesMap, iter ) != -1 )
     {
 
         while ( 1 )
         {
-            osfile os_file = priv_osreaddir ( filesMap, iter );
+            OSFile os_file = priv_osreaddir ( filesMap, iter );
             if ( os_file.name == "" )
                 break;
 
@@ -532,7 +538,7 @@
 
 }
 
-void filelist_ftp::getRecursiveFiles( std::vector < std::string >src, unsigned long &size )
+void OSVfsFtp::getRecursiveFiles( std::vector < std::string >src, unsigned long &size )
 {
 
     filesMapGlobal.clear();
@@ -544,7 +550,7 @@
     {
 
         std::string name = FXFile::name( iter_files->c_str() ).text();
-        osfile os_file;
+        OSFile os_file;
         os_file.name = name;
         os_file.type = filesMap[ name ].type;
         os_file.size = filesMap[ name ].size;
@@ -572,7 +578,7 @@
     }
 }
 
-int filelist_ftp::remove ( thread_elem * te )
+int OSVfsFtp::remove ( OSThreadExec * te )
 {
     unsigned long size;
     getRecursiveFiles( te->src, size );
@@ -594,7 +600,7 @@
 
 
 }
-int filelist_ftp::rename ( std::string orgname, std::string newname )
+int OSVfsFtp::rename ( std::string orgname, std::string newname )
 {
 
     FXString tmp;
@@ -602,7 +608,7 @@
     pftp->sendCmd( "RNTO ", FXFile::name( newname.c_str() ), tmp );
 
 }
-int filelist_ftp::init ( std::vector < std::string > *vector_name, pathtype pt, configure * conf )
+int OSVfsFtp::init ( std::vector < std::string > *vector_name, OSPathType pt, OSConfigure * conf )
 {
 
     fieldsnum = vector_name->size ();
@@ -616,7 +622,7 @@
     else return -1;
 }
 
-int filelist_ftp::str_mode_int( std::string per )
+int OSVfsFtp::str_mode_int( std::string per )
 {
     unsigned int mode = 0;
     if ( per[ 0 ] == 'r' )
@@ -640,7 +646,7 @@
     return mode;
 }
 
-int filelist_ftp::mode ( std::string file )
+int OSVfsFtp::mode ( std::string file )
 {
 
     std::string per = filesMap[ FXFile::name( file.c_str() ).text() ].mode;
@@ -648,15 +654,15 @@
     return str_mode_int( per );
 
 }
-std::string filelist_ftp::owner ( std::string file )
+std::string OSVfsFtp::owner ( std::string file )
 {
     return filesMap[ FXFile::name( file.c_str() ).text() ].user;
 }
-std::string filelist_ftp::group ( std::string file )
+std::string OSVfsFtp::group ( std::string file )
 {
     return filesMap[ FXFile::name( file.c_str() ).text() ].group;
 }
-bool filelist_ftp::mode ( std::string file, unsigned int per, bool recursive )
+bool OSVfsFtp::mode ( std::string file, unsigned int per, bool recursive )
 {
 
     unsigned int mode = per;
@@ -701,15 +707,15 @@
 
 
 }
-bool filelist_ftp::owner ( std::string file, std::string, bool recursive )
+bool OSVfsFtp::owner ( std::string file, std::string, bool recursive )
 {}
-bool filelist_ftp::group ( std::string file, std::string, bool recursive )
+bool OSVfsFtp::group ( std::string file, std::string, bool recursive )
 {}
-std::string filelist_ftp::info ( void )
+std::string OSVfsFtp::info ( void )
 {
     return "";
 }
-void filelist_ftp::totalsize ( std::string path, unsigned long &size )
+void OSVfsFtp::totalsize ( std::string path, unsigned long &size )
 {
     size = 0;
 
@@ -731,21 +737,21 @@
 
 
 }
-std::string filelist_ftp::symlink ( std::string path )
+std::string OSVfsFtp::symlink ( std::string path )
 {
     return "";
 }
-bool filelist_ftp::symlink ( std::string src, std::string dst )
+bool OSVfsFtp::symlink ( std::string src, std::string dst )
 {}
-bool filelist_ftp::hardlink ( std::string src, std::string dst )
+bool OSVfsFtp::hardlink ( std::string src, std::string dst )
 {}
 
-int filelist_ftp::quit ( void )
+int OSVfsFtp::quit ( void )
 {
     pftp->logout();
 }
 
-std::string filelist_ftp::getinitialdir( void )
+std::string OSVfsFtp::getinitialdir( void )
 {
     FXString base;
     pftp->pwd( base );
@@ -755,8 +761,8 @@
 
 
 
-EXPORTFUNCTION filelist_base *get_filelist ( void )
+EXPORTFUNCTION OSVirtualFileSystemBase *get_filelist ( void )
 {
     FXTRACE ( ( 5, "PLUGIN LOAD\n" ) );
-    return new filelist_ftp ();
+    return new OSVfsFtp ();
 }

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h	2006-02-11 23:06:27 UTC (rev 242)
@@ -73,7 +73,7 @@
  * 
  * @todo Pass "big" vectors through by-reference not by-value!
  */
-class filelist_ftp : public OSVirtualFileSystemBase
+class OSVfsFtp : public OSVirtualFileSystemBase
 {
 
 private:
@@ -90,9 +90,9 @@
     int fieldsnum;
     std::vector<std::string> fields;
 
-    int priv_osopendir( std::string dir, std::string prefix, std::map <std::string, osfile> & filesMap, std::map <std::string, osfile>::iterator & iter );
+    int priv_osopendir( std::string dir, std::string prefix, std::map <std::string, OSFile> & filesMap, std::map <std::string, OSFile>::iterator & iter );
     void gorecursive( std::string file, unsigned long &size );
-    OSFile priv_osreaddir( std::map <std::string, osfile> & filesMap, std::map <std::string, OSFile>::iterator & iter2 );
+    OSFile priv_osreaddir( std::map <std::string, OSFile> & filesMap, std::map <std::string, OSFile>::iterator & iter2 );
     void getRecursiveFiles( std::vector<std::string> src, unsigned long &size );
     void goLocalRecursive( std::string path, std::string prefix, OSThreadExec* te );
     void local_totalsize( std::string path, unsigned long &size );

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp	2006-02-11 23:06:27 UTC (rev 242)
@@ -5,7 +5,7 @@
 #define EXPORTFUNCTION extern "C"
 #endif
 
-#include "filelist_local.h"
+#include "OSVfsLocal.h"
 #include "OSFXFile.h"
 #include "../../OSVirtualFileSystemHeader.h"
 #include "../../OSVirtualFileSystemInfo.h"
@@ -33,10 +33,8 @@
 #include <string>
 #include <vector>
 
-// XXX - What this global is for?
-std::vector<std::string> name;
 
-OSVirtualFileSystemInfo filelist_local::setup (void)
+OSVirtualFileSystemInfo OSVfsLocal::setup (void)
 {
 	OSVirtualFileSystemInfo v;
 	
@@ -52,7 +50,7 @@
     return v;	
 }
 
-int filelist_local::init (std::vector<std::string> *vector_name, OSPathType pt, OSConfigure * conf)
+int OSVfsLocal::init (std::vector<std::string> *vector_name, OSPathType pt, OSConfigure * conf)
 {
 
     fieldsnum = vector_name->size ();
@@ -62,7 +60,7 @@
 }
 
 
-OSFile filelist_local::osreaddir ()
+OSFile OSVfsLocal::osreaddir ()
 {
 
     OSFile os_file;
@@ -182,7 +180,7 @@
 }
 
 
-int filelist_local::osopendir (std::string dir)
+int OSVfsLocal::osopendir (std::string dir)
 {
     this->dir = dir;
 
@@ -235,7 +233,7 @@
 
 }
 
-int filelist_local::mkdir (std::string dir, int mode)
+int OSVfsLocal::mkdir (std::string dir, int mode)
 {
     FXTRACE ((5, "MKDIR\n"));
     std::string d = this->dir + SEPARATOR + dir;
@@ -244,18 +242,18 @@
     return 0;
 }
 
-int filelist_local::copy ( OSThreadExec * te)
+int OSVfsLocal::copy ( OSThreadExec * te)
 {
     copymove (te, true);
 }
 
-int filelist_local::move (OSThreadExec* te)
+int OSVfsLocal::move (OSThreadExec* te)
 {
     copymove (te, false);
 }
 
 
-int filelist_local::remove (OSThreadExec* te)
+int OSVfsLocal::remove (OSThreadExec* te)
 {
 
     bool canc = false;
@@ -290,7 +288,7 @@
 
 }
 
-int filelist_local::rename (std::string orgname, std::string newname)
+int OSVfsLocal::rename (std::string orgname, std::string newname)
 {
 
     FXString newfile = newname.c_str ();
@@ -325,7 +323,7 @@
 }
 
 
-int filelist_local::copymove (OSThreadExec* te, bool copy)
+int OSVfsLocal::copymove (OSThreadExec* te, bool copy)
 {
 
     unsigned long size = 0;
@@ -388,7 +386,7 @@
 
 
 
-void filelist_local::totalsize (std::string path, unsigned long &size)
+void OSVfsLocal::totalsize (std::string path, unsigned long &size)
 {
 
     if (FXFile::isDirectory (path.c_str ()))
@@ -436,19 +434,19 @@
 
 }
 
-std::string filelist_local::info (void)
+std::string OSVfsLocal::info (void)
 {
     return "";
 }
 
 
-int filelist_local::mode (std::string file)
+int OSVfsLocal::mode (std::string file)
 {
     struct stat status;
     return !file.empty () && (::stat (file.c_str (), &status) == 0) ? status.st_mode : 0;
 }
 
-bool filelist_local::mode (std::string file, unsigned int mod, bool recursive)
+bool OSVfsLocal::mode (std::string file, unsigned int mod, bool recursive)
 {
     FXTRACE ((5, "MODE"));
     if (!recursive)
@@ -489,16 +487,16 @@
     }
 }
 
-std::string filelist_local::owner (std::string file)
+std::string OSVfsLocal::owner (std::string file)
 {
     return FXFile::owner (file.c_str ()).text ();
 }
-std::string filelist_local::group (std::string file)
+std::string OSVfsLocal::group (std::string file)
 {
     return FXFile::group (file.c_str ()).text ();
 }
 
-bool filelist_local::owner (std::string file, std::string ownername, bool recursive)
+bool OSVfsLocal::owner (std::string file, std::string ownername, bool recursive)
 {
     FXTRACE ((5, "MODE"));
     if (!recursive)
@@ -538,7 +536,7 @@
     }
 }
 
-bool filelist_local::group (std::string file, std::string groupname, bool recursive)
+bool OSVfsLocal::group (std::string file, std::string groupname, bool recursive)
 {
     FXTRACE ((5, "MODE"));
     if (!recursive)
@@ -576,21 +574,21 @@
     }
 }
 
-std::string filelist_local::symlink (std::string path)
+std::string OSVfsLocal::symlink (std::string path)
 {
     return FXFile::symlink (path.c_str ()).text ();
 }
-bool filelist_local::symlink (std::string src, std::string dst)
+bool OSVfsLocal::symlink (std::string src, std::string dst)
 {
     return FXFile::symlink (src.c_str (), dst.c_str ());
 }
-bool filelist_local::hardlink (std::string src, std::string dst)
+bool OSVfsLocal::hardlink (std::string src, std::string dst)
 {
     return FXFile::link (src.c_str (), dst.c_str ());
 }
 
 
-int filelist_local::quit (void)
+int OSVfsLocal::quit (void)
 {
     return 0;
 }
@@ -598,5 +596,5 @@
 EXPORTFUNCTION OSVirtualFileSystemBase* get_filelist (void)
 {
     FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_local ();
+    return new OSVfsLocal ();
 }

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h	2006-02-11 23:06:27 UTC (rev 242)
@@ -46,7 +46,7 @@
  * 
  * @todo This plugin will be reorganized/renamed.
  */
-class filelist_local: public OSVirtualFileSystemBase
+class OSVfsLocal: public OSVirtualFileSystemBase
 {
 private:
 

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp	2006-02-11 23:06:27 UTC (rev 242)
@@ -4,7 +4,7 @@
 #define EXPORTFUNCTION extern "C"
 #endif
 
-#include "filelist_search.h"
+#include "OSVfsSearch.h"
 
 #include "../../OSVirtualFileSystemBase.h"
 #include "../../OSVirtualFileSystemInfo.h"
@@ -16,7 +16,7 @@
 #include <string>
 #include <vector>
 
-OSVirtualFileSystemInfo filelist_search::setup (void)
+OSVirtualFileSystemInfo OSVfsSearch::setup (void)
 {
 	OSVirtualFileSystemInfo v;
 	
@@ -29,13 +29,13 @@
 }
 
 
-int filelist_search::osopendir (std::string dir)
+int OSVfsSearch::osopendir (std::string dir)
 {
 
   iter=files.begin(); 
 
 }
-OSFile filelist_search::osreaddir (void)
+OSFile OSVfsSearch::osreaddir (void)
 {
     OSFile os_file;
 
@@ -59,10 +59,10 @@
 
 
 }
-int filelist_search::mkdir (std::string dir, int mode)
+int OSVfsSearch::mkdir (std::string dir, int mode)
 {
 }
-int filelist_search::copy (OSThreadExec * te)
+int OSVfsSearch::copy (OSThreadExec * te)
 {
 
 	std::string::size_type pos = te->options.find ("download");
@@ -77,7 +77,7 @@
 	}
 
 }
-int filelist_search::move (OSThreadExec * te)
+int OSVfsSearch::move (OSThreadExec * te)
 {
 
 	std::string::size_type pos = te->options.find ("download");
@@ -92,11 +92,11 @@
 	}
 
 }
-int filelist_search::remove (OSThreadExec * te)
+int OSVfsSearch::remove (OSThreadExec * te)
 {
 return fil_local->remove(te);
 }
-int filelist_search::rename (std::string orgname, std::string newname)
+int OSVfsSearch::rename (std::string orgname, std::string newname)
 {
 
 	int ret=fil_local->rename(orgname,newname);
@@ -111,9 +111,9 @@
 
 	return ret;
 }
-int filelist_search::init(std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf)
+int OSVfsSearch::init(std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf)
 {
-    fil_local=new filelist_local();
+    fil_local=new OSVfsLocal();
 
     pipe = popen (pt.server.c_str(), "r");
 
@@ -137,53 +137,53 @@
     
 
 }
-int filelist_search::mode (std::string file)
+int OSVfsSearch::mode (std::string file)
 {
 return fil_local->mode(file);
 }
-std::string filelist_search::owner (std::string file)
+std::string OSVfsSearch::owner (std::string file)
 {
 return fil_local->owner(file);
 }
-std::string filelist_search::group (std::string file)
+std::string OSVfsSearch::group (std::string file)
 {
 return fil_local->group(file);
 }
-bool filelist_search::mode (std::string file, unsigned int mod, bool recursive)
+bool OSVfsSearch::mode (std::string file, unsigned int mod, bool recursive)
 {
 return fil_local->mode(file,mod,recursive);
 }
-bool filelist_search::owner (std::string file, std::string ow, bool recursive)
+bool OSVfsSearch::owner (std::string file, std::string ow, bool recursive)
 {
 return fil_local->owner(file,ow,recursive);
 }
-bool filelist_search::group (std::string file, std::string gr, bool recursive)
+bool OSVfsSearch::group (std::string file, std::string gr, bool recursive)
 {
 return fil_local->group(file,gr,recursive);
 }
-std::string filelist_search::info (void)
+std::string OSVfsSearch::info (void)
 {
 return "";
 }
-void filelist_search::totalsize (std::string path, unsigned long &size)
+void OSVfsSearch::totalsize (std::string path, unsigned long &size)
 {
 }
-std::string filelist_search::symlink (std::string path)
+std::string OSVfsSearch::symlink (std::string path)
 {
 }
-bool filelist_search::symlink (std::string src, std::string dst)
+bool OSVfsSearch::symlink (std::string src, std::string dst)
 {
 }
-bool filelist_search::hardlink (std::string src, std::string dst)
+bool OSVfsSearch::hardlink (std::string src, std::string dst)
 {
 }
 
-int filelist_search::quit (void)
+int OSVfsSearch::quit (void)
 {
 }
 
 EXPORTFUNCTION OSVirtualFileSystemBase *get_filelist(void)
 {
     FXTRACE ((5, "PLUGIN SEARCH LOAD\n"));
-    return new filelist_search ();
+    return new OSVfsSearch ();
 }

Modified: branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h
===================================================================
--- branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h	2006-02-11 21:53:06 UTC (rev 241)
+++ branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h	2006-02-11 23:06:27 UTC (rev 242)
@@ -3,7 +3,7 @@
 
 #include "../../OSVirtualFileSystemBase.h"
 #include "../../OSPathType.h"
-#include "filelist_local.h"
+#include "OSVfsLocal.h"
 
 #include <string>
 #include <vector>
@@ -17,7 +17,7 @@
  *
  * @todo To rename.
  */
-class filelist_search : public OSVirtualFileSystemBase
+class OSVfsSearch : public OSVirtualFileSystemBase
 {
   
 private:
@@ -27,7 +27,7 @@
   std::vector<std::string> files;
   std::vector<std::string>::iterator iter;
 
-  filelist_local *fil_local;
+  OSVfsLocal *fil_local;
   
 public:
   



From compbatant at berlios.de  Sun Feb 12 00:47:00 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 00:47:00 +0100
Subject: [Openspace-svn] r243 - branches/mloskot-style-refactoring/src
Message-ID: <200602112347.k1BNl0FY006943@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 00:46:26 +0100 (Sun, 12 Feb 2006)
New Revision: 243

Modified:
   branches/mloskot-style-refactoring/src/OSFileList.cpp
Log:
cos tu popieprzone ciagle jest


Modified: branches/mloskot-style-refactoring/src/OSFileList.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/OSFileList.cpp	2006-02-11 23:06:27 UTC (rev 242)
+++ branches/mloskot-style-refactoring/src/OSFileList.cpp	2006-02-11 23:46:26 UTC (rev 243)
@@ -1052,7 +1052,7 @@
                  
                  if(simple_command==true)
                  {
-                 OSThreadExec *el = new OSThreadExec (fb, "execute", options,fullname,exec);
+		 OSThreadExec *el = new OSThreadExec (fb, "execute", options,fullname,exec);
                  start_thread (el);
                  }
                  else           
@@ -1067,7 +1067,7 @@
          {
            OSThreadExec *el = new OSThreadExec (fb, "execute", options,src,exec);
            start_thread (el);
-         }
+	 }
         
         }
 
@@ -1956,7 +1956,8 @@
     }
     else
     {
-    num = ((int)*((int*)ptr));
+    //num = ((int)*((int*)ptr));
+    num = (int)ptr;
     }
 
     if (num == sort_nr)



From compbatant at berlios.de  Sun Feb 12 01:18:45 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 01:18:45 +0100
Subject: [Openspace-svn] r244 - branches/mloskot-style-refactoring/src
Message-ID: <200602120018.k1C0IjJw022911@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 01:18:38 +0100 (Sun, 12 Feb 2006)
New Revision: 244

Modified:
   branches/mloskot-style-refactoring/src/OSMimeApp.cpp
Log:
przywrocone poprawne dzialanie automatycznej konfiguracji mime


Modified: branches/mloskot-style-refactoring/src/OSMimeApp.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/OSMimeApp.cpp	2006-02-11 23:46:26 UTC (rev 243)
+++ branches/mloskot-style-refactoring/src/OSMimeApp.cpp	2006-02-12 00:18:38 UTC (rev 244)
@@ -227,6 +227,6 @@
         }
     }
 
-    OSFileTypeInfo cm = OSFileTypeInfo( command_name, command_exec );
+    OSCommandTypeInfo cm = OSCommandTypeInfo( command_name, command_exec );
     cm.save();
 }



From compbatant at berlios.de  Sun Feb 12 14:43:33 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 14:43:33 +0100
Subject: [Openspace-svn] r245 - branches/mloskot-style-refactoring/src
Message-ID: <200602121343.k1CDhXlj008820@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 14:43:28 +0100 (Sun, 12 Feb 2006)
New Revision: 245

Modified:
   branches/mloskot-style-refactoring/src/OSMainWindow.cpp
Log:
test


Modified: branches/mloskot-style-refactoring/src/OSMainWindow.cpp
===================================================================
--- branches/mloskot-style-refactoring/src/OSMainWindow.cpp	2006-02-12 00:18:38 UTC (rev 244)
+++ branches/mloskot-style-refactoring/src/OSMainWindow.cpp	2006-02-12 13:43:28 UTC (rev 245)
@@ -1215,15 +1215,14 @@
     string path = pathdir;
     hf = new FXHorizontalFrame ( cp, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
     pathdir = path;
-
-    //generate_menu(path,tgt);
-    int z = 0;
+    firstbutton=NULL;
+    
+    
     FXButton *prebutton = NULL;
     FXButton *nextbutton = NULL;
 
     OSObjectManager*objmanager = OSObjectManager::instance( cp->getApp() );
 
-
     toleft = new FXButton ( hf, "", objmanager->osicons[ "left" ], tgt, OSMainWindow::ID_TOLEFT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
     toleft->setUserData ( new box ( this, NULL, NULL, NULL ) );
     toclose = new FXButton ( hf, "", objmanager->osicons[ "close" ], tgt, OSMainWindow::ID_TOCLOSE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
@@ -1236,39 +1235,15 @@
         new FXLabel( hf, lab.c_str() );
     }
 
-    //new FXLabel (hf," ");
     if ( position != 0 )
     {
         toleft->hide ();
         toclose->hide ();
         toright->hide ();
     }
-    while ( z != -1 )
-    {
-        string path_element = "";
-        z = path.find ( SEPARATOR, 1 );
-        if ( z == -1 )
-            path_element.append ( path );
+   
+    generate_menu(pathdir,tgt);
 
-        else
-            path_element.append ( path.substr ( 0, z ) );
-        path.erase ( 0, z );
-        FXButton *bt = new FXButton ( hf, path_element.c_str (), NULL, tgt,
-                                      OSMainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
-                                      0, 0 );
-        bt->setBackColor ( objmanager->maincolor );
-        if ( prebutton != NULL )
-        {
-            box * boxel = ( box * ) prebutton->getUserData ();
-            boxel->nextbutton = bt;
-        }
-
-        else
-            firstbutton = bt;
-        bt->setUserData ( new box ( this, prebutton, bt, NULL ) );
-        prebutton = bt;
-    }
-
     frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
     f = new OSFileList ( frame, pt );
     if ( position == 0 )
@@ -1284,24 +1259,28 @@
 
     OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
 
-    FXTRACE ( ( 5, "GENERATE MENU path %s ", path.c_str () ) );
-    if ( path[ 0 ] == '/' && path[ 1 ] == '/' )
+    if (path.length()>1 && path[ 0 ] == '/' && path[ 1 ] == '/' )
         path.erase ( 0, 1 );
-    box *boxel = ( box * ) firstbutton->getUserData ();
-    box *boxbackup = boxel;
-    while ( boxel )
-    {
-        box * boxel_del = boxel;
-        if ( boxel->nextbutton != NULL )
-            boxel = ( box * ) boxel->nextbutton->getUserData ();
-
-        else
-            boxel = NULL;
-        delete boxel_del->bt;
-        delete boxel_del;
-        boxel_del->bt = NULL;
-        boxel_del = NULL;
-    }
+	
+    	if(firstbutton!=NULL)
+	{	
+    	box *boxel = ( box * ) firstbutton->getUserData ();
+    	box *boxbackup = boxel;
+    		while ( boxel )
+    		{
+        		box * boxel_del = boxel;
+       			if ( boxel->nextbutton != NULL )
+            		boxel = ( box * ) boxel->nextbutton->getUserData ();
+        		else
+            		boxel = NULL;
+			
+       		delete boxel_del->bt;
+        	delete boxel_del;
+       		boxel_del->bt = NULL;
+        	boxel_del = NULL;
+    		}
+    	}
+	
     this->pathdir = path;
     int z = 0;
     FXButton *prebutton = NULL;



From compbatant at berlios.de  Sun Feb 12 16:38:45 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 16:38:45 +0100
Subject: [Openspace-svn] r246 - in trunk: . doc doc/dev icons icons/default src src/plugins src/plugins/cmddialog src/plugins/filelist templates
Message-ID: <200602121538.k1CFcjPD020041@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 16:36:06 +0100 (Sun, 12 Feb 2006)
New Revision: 246

Added:
   trunk/doc/
   trunk/doc/dev/
   trunk/doxygen.conf
   trunk/src/Makefile
   trunk/src/OSCMDDialogBox.cpp
   trunk/src/OSCMDDialogBox.h
   trunk/src/OSCommandTypeInfo.cpp
   trunk/src/OSCommandTypeInfo.h
   trunk/src/OSConfigure.cpp
   trunk/src/OSConfigure.h
   trunk/src/OSFile.h
   trunk/src/OSFileList.cpp
   trunk/src/OSFileList.h
   trunk/src/OSFileListItem.cpp
   trunk/src/OSFileListItem.h
   trunk/src/OSFileTypeInfo.cpp
   trunk/src/OSFileTypeInfo.h
   trunk/src/OSFileTypeSymbol.cpp
   trunk/src/OSFileTypeSymbol.h
   trunk/src/OSFirstRunDialogBox.cpp
   trunk/src/OSFirstRunDialogBox.h
   trunk/src/OSInfoPanel.cpp
   trunk/src/OSInfoPanel.h
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
   trunk/src/OSMimeApp.cpp
   trunk/src/OSMimeApp.h
   trunk/src/OSMimeType.cpp
   trunk/src/OSMimeType.h
   trunk/src/OSObjectManager.cpp
   trunk/src/OSObjectManager.h
   trunk/src/OSPathType.cpp
   trunk/src/OSPathType.h
   trunk/src/OSPreferences.cpp
   trunk/src/OSPreferences.h
   trunk/src/OSShutter.cpp
   trunk/src/OSShutter.h
   trunk/src/OSThreadExec.cpp
   trunk/src/OSThreadExec.h
   trunk/src/OSUtils.cpp
   trunk/src/OSUtils.h
   trunk/src/OSVirtualFileSystemBase.h
   trunk/src/OSVirtualFileSystemHeader.h
   trunk/src/OSVirtualFileSystemInfo.h
   trunk/src/config.h
   trunk/src/main.cpp
   trunk/src/plugins/cmddialog/OSAccess.cpp
   trunk/src/plugins/cmddialog/OSClone.cpp
   trunk/src/plugins/cmddialog/OSCompress.cpp
   trunk/src/plugins/cmddialog/OSEditSymlink.cpp
   trunk/src/plugins/cmddialog/OSMd5sum.cpp
   trunk/src/plugins/cmddialog/OSMkdir.cpp
   trunk/src/plugins/cmddialog/OSRename.cpp
   trunk/src/plugins/cmddialog/OSSymlink.cpp
   trunk/src/plugins/filelist/OSVfsArchive.cpp
   trunk/src/plugins/filelist/OSVfsArchive.h
   trunk/src/plugins/filelist/OSVfsFtp.cpp
   trunk/src/plugins/filelist/OSVfsFtp.h
   trunk/src/plugins/filelist/OSVfsLocal.cpp
   trunk/src/plugins/filelist/OSVfsLocal.h
   trunk/src/plugins/filelist/OSVfsSearch.cpp
   trunk/src/plugins/filelist/OSVfsSearch.h
   trunk/svnignore
   trunk/templates/
   trunk/templates/cpp
   trunk/templates/h
Removed:
   trunk/doc/dev/
   trunk/src/CommandsFileTypesContainers.cpp
   trunk/src/CommandsFileTypesContainers.h
   trunk/src/FirstRun.cpp
   trunk/src/FirstRun.h
   trunk/src/MimeApp.cpp
   trunk/src/MimeApp.h
   trunk/src/MimeType.cpp
   trunk/src/MimeType.h
   trunk/src/cmddialog.cpp
   trunk/src/cmddialog.h
   trunk/src/configure.cpp
   trunk/src/configure.h
   trunk/src/filelist.cpp
   trunk/src/filelist.h
   trunk/src/filelist_base.h
   trunk/src/filetype.cpp
   trunk/src/filetype.h
   trunk/src/informationpanel.cpp
   trunk/src/informationpanel.h
   trunk/src/mainwindow.cpp
   trunk/src/mainwindow.h
   trunk/src/openspace.cpp
   trunk/src/osfile.h
   trunk/src/oslistitem.cpp
   trunk/src/oslistitem.h
   trunk/src/pathtype.cpp
   trunk/src/pathtype.h
   trunk/src/plugins/cmddialog/access.cpp
   trunk/src/plugins/cmddialog/clone.cpp
   trunk/src/plugins/cmddialog/compress.cpp
   trunk/src/plugins/cmddialog/editsymlink.cpp
   trunk/src/plugins/cmddialog/md5sum.cpp
   trunk/src/plugins/cmddialog/mkdir.cpp
   trunk/src/plugins/cmddialog/rename.cpp
   trunk/src/plugins/cmddialog/symlink.cpp
   trunk/src/plugins/filelist/filelist_archive.cpp
   trunk/src/plugins/filelist/filelist_archive.h
   trunk/src/plugins/filelist/filelist_ftp.cpp
   trunk/src/plugins/filelist/filelist_ftp.h
   trunk/src/plugins/filelist/filelist_local.cpp
   trunk/src/plugins/filelist/filelist_local.h
   trunk/src/plugins/filelist/filelist_search.cpp
   trunk/src/plugins/filelist/filelist_search.h
   trunk/src/preferences.cpp
   trunk/src/preferences.h
   trunk/src/sharedFunctions.cpp
   trunk/src/sharedFunctions.h
   trunk/src/sharedobjects.cpp
   trunk/src/sharedobjects.h
   trunk/src/shutter.cpp
   trunk/src/shutter.h
   trunk/src/thread_elem.cpp
   trunk/src/thread_elem.h
   trunk/templates/cpp
   trunk/templates/h
Modified:
   trunk/
   trunk/INSTALL
   trunk/Makefile.in
   trunk/aclocal.m4
   trunk/configure
   trunk/configure.ac
   trunk/depcomp
   trunk/icons/
   trunk/icons/Makefile.in
   trunk/icons/default/
   trunk/icons/default/Makefile.in
   trunk/install-sh
   trunk/missing
   trunk/openspacerc.in
   trunk/src/
   trunk/src/Makefile.am
   trunk/src/Makefile.in
   trunk/src/config.h.in
   trunk/src/plugins/
   trunk/src/plugins/Makefile.am
   trunk/src/plugins/Makefile.in
   trunk/src/plugins/cmddialog/
   trunk/src/plugins/cmddialog/Makefile.am
   trunk/src/plugins/cmddialog/Makefile.in
   trunk/src/plugins/filelist/
   trunk/src/plugins/filelist/Makefile.am
   trunk/src/plugins/filelist/Makefile.in
   trunk/src/plugins/filelist/OSFXFile.cpp
   trunk/src/plugins/filelist/OSFXFile.h
   trunk/src/plugins/filelist/filelist_scp.cpp
   trunk/src/plugins/filelist/filelist_scp.h
   trunk/src/plugins/filelist/filelist_sftp.cpp
   trunk/src/plugins/filelist/filelist_sftp.h
   trunk/src/plugins/filelist/pftp.cpp
   trunk/src/plugins/filelist/pftp.h
Log:
refactoring


Property changes on: trunk
___________________________________________________________________
Name: svn:ignore
   - autom4*
Makefile
config.log
config.status
openspacerc
libtool
*.tar.bz2
*.tar.gz

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Modified: trunk/INSTALL
===================================================================
--- trunk/INSTALL	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/INSTALL	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,16 +1,13 @@
-Installation Instructions
-*************************
+Copyright (C) 1994, 1995, 1996, 1999, 2000, 2001, 2002 Free Software
+Foundation, Inc.
 
-Copyright (C) 1994, 1995, 1996, 1999, 2000, 2001, 2002, 2004, 2005 Free
-Software Foundation, Inc.
-
-This file is free documentation; the Free Software Foundation gives
+   This file is free documentation; the Free Software Foundation gives
 unlimited permission to copy, distribute and modify it.
 
 Basic Installation
 ==================
 
-These are generic installation instructions.
+   These are generic installation instructions.
 
    The `configure' shell script attempts to guess correct values for
 various system-dependent variables used during compilation.  It uses
@@ -70,9 +67,9 @@
 Compilers and Options
 =====================
 
-Some systems require unusual options for compilation or linking that the
-`configure' script does not know about.  Run `./configure --help' for
-details on some of the pertinent environment variables.
+   Some systems require unusual options for compilation or linking that
+the `configure' script does not know about.  Run `./configure --help'
+for details on some of the pertinent environment variables.
 
    You can give `configure' initial values for configuration parameters
 by setting variables in the command line or in the environment.  Here
@@ -85,7 +82,7 @@
 Compiling For Multiple Architectures
 ====================================
 
-You can compile the package for more than one kind of computer at the
+   You can compile the package for more than one kind of computer at the
 same time, by placing the object files for each architecture in their
 own directory.  To do this, you must use a version of `make' that
 supports the `VPATH' variable, such as GNU `make'.  `cd' to the
@@ -102,19 +99,19 @@
 Installation Names
 ==================
 
-By default, `make install' will install the package's files in
+   By default, `make install' will install the package's files in
 `/usr/local/bin', `/usr/local/man', etc.  You can specify an
 installation prefix other than `/usr/local' by giving `configure' the
-option `--prefix=PREFIX'.
+option `--prefix=PATH'.
 
    You can specify separate installation prefixes for
 architecture-specific files and architecture-independent files.  If you
-give `configure' the option `--exec-prefix=PREFIX', the package will
-use PREFIX as the prefix for installing programs and libraries.
+give `configure' the option `--exec-prefix=PATH', the package will use
+PATH as the prefix for installing programs and libraries.
 Documentation and other data files will still use the regular prefix.
 
    In addition, if you use an unusual directory layout you can give
-options like `--bindir=DIR' to specify different values for particular
+options like `--bindir=PATH' to specify different values for particular
 kinds of files.  Run `configure --help' for a list of the directories
 you can set and what kinds of files go in them.
 
@@ -125,7 +122,7 @@
 Optional Features
 =================
 
-Some packages pay attention to `--enable-FEATURE' options to
+   Some packages pay attention to `--enable-FEATURE' options to
 `configure', where FEATURE indicates an optional part of the package.
 They may also pay attention to `--with-PACKAGE' options, where PACKAGE
 is something like `gnu-as' or `x' (for the X Window System).  The
@@ -140,11 +137,11 @@
 Specifying the System Type
 ==========================
 
-There may be some features `configure' cannot figure out automatically,
-but needs to determine by the type of machine the package will run on.
-Usually, assuming the package is built to be run on the _same_
-architectures, `configure' can figure that out, but if it prints a
-message saying it cannot guess the machine type, give it the
+   There may be some features `configure' cannot figure out
+automatically, but needs to determine by the type of machine the package
+will run on.  Usually, assuming the package is built to be run on the
+_same_ architectures, `configure' can figure that out, but if it prints
+a message saying it cannot guess the machine type, give it the
 `--build=TYPE' option.  TYPE can either be a short name for the system
 type, such as `sun4', or a canonical name which has the form:
 
@@ -170,9 +167,9 @@
 Sharing Defaults
 ================
 
-If you want to set default values for `configure' scripts to share, you
-can create a site shell script called `config.site' that gives default
-values for variables like `CC', `cache_file', and `prefix'.
+   If you want to set default values for `configure' scripts to share,
+you can create a site shell script called `config.site' that gives
+default values for variables like `CC', `cache_file', and `prefix'.
 `configure' looks for `PREFIX/share/config.site' if it exists, then
 `PREFIX/etc/config.site' if it exists.  Or, you can set the
 `CONFIG_SITE' environment variable to the location of the site script.
@@ -181,7 +178,7 @@
 Defining Variables
 ==================
 
-Variables not defined in a site shell script can be set in the
+   Variables not defined in a site shell script can be set in the
 environment passed to `configure'.  However, some packages may run
 configure again during the build, and the customized values of these
 variables may be lost.  In order to avoid this problem, you should set
@@ -189,18 +186,14 @@
 
      ./configure CC=/usr/local2/bin/gcc
 
-causes the specified `gcc' to be used as the C compiler (unless it is
-overridden in the site shell script).  Here is a another example:
+will cause the specified gcc to be used as the C compiler (unless it is
+overridden in the site shell script).
 
-     /bin/bash ./configure CONFIG_SHELL=/bin/bash
-
-Here the `CONFIG_SHELL=/bin/bash' operand causes subsequent
-configuration-related scripts to be executed by `/bin/bash'.
-
 `configure' Invocation
 ======================
 
-`configure' recognizes the following options to control how it operates.
+   `configure' recognizes the following options to control how it
+operates.
 
 `--help'
 `-h'

Modified: trunk/Makefile.in
===================================================================
--- trunk/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -34,7 +34,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 DIST_COMMON = README $(am__configure_deps) $(srcdir)/Makefile.am \
 	$(srcdir)/Makefile.in $(srcdir)/openspacerc.in \
@@ -47,7 +46,7 @@
 	$(ACLOCAL_M4)
 am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
  configure.lineno configure.status.lineno
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES = openspacerc
 SOURCES =
@@ -58,12 +57,6 @@
 	install-recursive installcheck-recursive installdirs-recursive \
 	pdf-recursive ps-recursive uninstall-info-recursive \
 	uninstall-recursive
-am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
-am__vpath_adj = case $$p in \
-    $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
-    *) f=$$p;; \
-  esac;
-am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
 am__installdirs = "$(DESTDIR)$(sysconfdir)"
 sysconfDATA_INSTALL = $(INSTALL_DATA)
 DATA = $(sysconf_DATA)
@@ -149,8 +142,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -235,7 +226,7 @@
 	test -z "$(sysconfdir)" || $(mkdir_p) "$(DESTDIR)$(sysconfdir)"
 	@list='$(sysconf_DATA)'; for p in $$list; do \
 	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
-	  f=$(am__strip_dir) \
+	  f="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " $(sysconfDATA_INSTALL) '$$d$$p' '$(DESTDIR)$(sysconfdir)/$$f'"; \
 	  $(sysconfDATA_INSTALL) "$$d$$p" "$(DESTDIR)$(sysconfdir)/$$f"; \
 	done
@@ -243,7 +234,7 @@
 uninstall-sysconfDATA:
 	@$(NORMAL_UNINSTALL)
 	@list='$(sysconf_DATA)'; for p in $$list; do \
-	  f=$(am__strip_dir) \
+	  f="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " rm -f '$(DESTDIR)$(sysconfdir)/$$f'"; \
 	  rm -f "$(DESTDIR)$(sysconfdir)/$$f"; \
 	done
@@ -255,13 +246,7 @@
 #     (which will cause the Makefiles to be regenerated when you run `make');
 # (2) otherwise, pass the desired values on the `make' command line.
 $(RECURSIVE_TARGETS):
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	target=`echo $@ | sed s/-recursive//`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -273,7 +258,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done; \
 	if test "$$dot_seen" = "no"; then \
 	  $(MAKE) $(AM_MAKEFLAGS) "$$target-am" || exit 1; \
@@ -281,13 +266,7 @@
 
 mostlyclean-recursive clean-recursive distclean-recursive \
 maintainer-clean-recursive:
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	case "$@" in \
 	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
@@ -308,7 +287,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done && test -z "$$fail"
 tags-recursive:
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -410,17 +389,15 @@
 	    || exit 1; \
 	  fi; \
 	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
 	  if test "$$subdir" = .; then :; else \
 	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
+	    || mkdir "$(distdir)/$$subdir" \
 	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
 	    (cd $$subdir && \
 	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
+	        top_distdir="../$(top_distdir)" \
+	        distdir="../$(distdir)/$$subdir" \
 	        distdir) \
 	      || exit 1; \
 	  fi; \
@@ -431,15 +408,15 @@
 	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
 	|| chmod -R a+r $(distdir)
 dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
+	$(AMTAR) chof - $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
 	$(am__remove_distdir)
 
 dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
+	$(AMTAR) chof - $(distdir) | bzip2 -9 -c >$(distdir).tar.bz2
 	$(am__remove_distdir)
 
 dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
+	$(AMTAR) chof - $(distdir) | compress -c >$(distdir).tar.Z
 	$(am__remove_distdir)
 
 dist-shar: distdir
@@ -452,7 +429,7 @@
 	$(am__remove_distdir)
 
 dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
+	$(AMTAR) chof - $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
 	$(am__remove_distdir)
 
 # This target untars the dist file and tries a VPATH configuration.  Then
@@ -461,11 +438,11 @@
 distcheck: dist
 	case '$(DIST_ARCHIVES)' in \
 	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
+	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(AMTAR) xf - ;;\
 	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
+	  bunzip2 -c $(distdir).tar.bz2 | $(AMTAR) xf - ;;\
 	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
+	  uncompress -c $(distdir).tar.Z | $(AMTAR) xf - ;;\
 	*.shar.gz*) \
 	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
 	*.zip*) \
@@ -549,7 +526,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"

Modified: trunk/aclocal.m4
===================================================================
--- trunk/aclocal.m4	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/aclocal.m4	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,7 +1,7 @@
-# generated automatically by aclocal 1.9.5 -*- Autoconf -*-
+# generated automatically by aclocal 1.8.5 -*- Autoconf -*-
 
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
-# 2005  Free Software Foundation, Inc.
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004
+# Free Software Foundation, Inc.
 # This file is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -6267,33 +6267,56 @@
 AC_MSG_RESULT([$SED])
 ])
 
-# Copyright (C) 2002, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+#                                                        -*- Autoconf -*-
+# Copyright (C) 2002, 2003  Free Software Foundation, Inc.
+# Generated from amversion.in; do not edit by hand.
 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+
 # AM_AUTOMAKE_VERSION(VERSION)
 # ----------------------------
 # Automake X.Y traces this macro to ensure aclocal.m4 has been
 # generated from the m4 files accompanying Automake X.Y.
-AC_DEFUN([AM_AUTOMAKE_VERSION], [am__api_version="1.9"])
+AC_DEFUN([AM_AUTOMAKE_VERSION], [am__api_version="1.8"])
 
 # AM_SET_CURRENT_AUTOMAKE_VERSION
 # -------------------------------
 # Call AM_AUTOMAKE_VERSION so it can be traced.
 # This function is AC_REQUIREd by AC_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-	 [AM_AUTOMAKE_VERSION([1.9.5])])
+	 [AM_AUTOMAKE_VERSION([1.8.5])])
 
-# AM_AUX_DIR_EXPAND                                         -*- Autoconf -*-
+# AM_AUX_DIR_EXPAND
 
-# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Copyright (C) 2001, 2003 Free Software Foundation, Inc.
 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
 # For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets
 # $ac_aux_dir to `$srcdir/foo'.  In other projects, it is set to
 # `$srcdir', `$srcdir/..', or `$srcdir/../..'.
@@ -6339,17 +6362,27 @@
 am_aux_dir=`cd $ac_aux_dir && pwd`
 ])
 
-# AM_CONDITIONAL                                            -*- Autoconf -*-
+# AM_CONDITIONAL                                              -*- Autoconf -*-
 
-# Copyright (C) 1997, 2000, 2001, 2003, 2004, 2005
-# Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Copyright (C) 1997, 2000, 2001, 2003 Free Software Foundation, Inc.
 
-# serial 7
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 6
+
 # AM_CONDITIONAL(NAME, SHELL-CONDITION)
 # -------------------------------------
 # Define a conditional.
@@ -6368,20 +6401,31 @@
 fi
 AC_CONFIG_COMMANDS_PRE(
 [if test -z "${$1_TRUE}" && test -z "${$1_FALSE}"; then
-  AC_MSG_ERROR([[conditional "$1" was never defined.
-Usually this means the macro was only invoked conditionally.]])
+  AC_MSG_ERROR([conditional "$1" was never defined.
+Usually this means the macro was only invoked conditionally.])
 fi])])
 
+# serial 7						-*- Autoconf -*-
 
-# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005
+# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004
 # Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
 
-# serial 8
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+
 # There are a few dirty hacks below to avoid letting `AC_PROG_CC' be
 # written in clear, in which case automake, when reading aclocal.m4,
 # will think it sees a *use*, and therefore will trigger all it's
@@ -6389,6 +6433,7 @@
 # CC etc. in the Makefile, will ask for an AC_PROG_CC use...
 
 
+
 # _AM_DEPENDENCIES(NAME)
 # ----------------------
 # See how the compiler implements dependency checking.
@@ -6528,17 +6573,27 @@
 AC_SUBST([AMDEPBACKSLASH])
 ])
 
-# Generate code to set up dependency tracking.              -*- Autoconf -*-
+# Generate code to set up dependency tracking.   -*- Autoconf -*-
 
-# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005
-# Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004 Free Software Foundation, Inc.
 
-#serial 3
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+#serial 2
+
 # _AM_OUTPUT_DEPENDENCY_COMMANDS
 # ------------------------------
 AC_DEFUN([_AM_OUTPUT_DEPENDENCY_COMMANDS],
@@ -6556,21 +6611,27 @@
   else
     continue
   fi
-  # Extract the definition of DEPDIR, am__include, and am__quote
-  # from the Makefile without running `make'.
+  grep '^DEP_FILES *= *[[^ @%:@]]' < "$mf" > /dev/null || continue
+  # Extract the definition of DEP_FILES from the Makefile without
+  # running `make'.
   DEPDIR=`sed -n 's/^DEPDIR = //p' < "$mf"`
   test -z "$DEPDIR" && continue
-  am__include=`sed -n 's/^am__include = //p' < "$mf"`
-  test -z "am__include" && continue
-  am__quote=`sed -n 's/^am__quote = //p' < "$mf"`
   # When using ansi2knr, U may be empty or an underscore; expand it
   U=`sed -n 's/^U = //p' < "$mf"`
-  # Find all dependency output files, they are included files with
-  # $(DEPDIR) in their names.  We invoke sed twice because it is the
-  # simplest approach to changing $(DEPDIR) to its actual value in the
-  # expansion.
-  for file in `sed -n "
-    s/^$am__include $am__quote\(.*(DEPDIR).*\)$am__quote"'$/\1/p' <"$mf" | \
+  test -d "$dirpart/$DEPDIR" || mkdir "$dirpart/$DEPDIR"
+  # We invoke sed twice because it is the simplest approach to
+  # changing $(DEPDIR) to its actual value in the expansion.
+  for file in `sed -n '
+    /^DEP_FILES = .*\\\\$/ {
+      s/^DEP_FILES = //
+      :loop
+	s/\\\\$//
+	p
+	n
+	/\\\\$/ b loop
+      p
+    }
+    /^DEP_FILES = / s/^DEP_FILES = //p' < "$mf" | \
        sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
     # Make sure the directory exists.
     test -f "$dirpart/$file" && continue
@@ -6596,20 +6657,31 @@
      [AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"])
 ])
 
-# Do all the work for Automake.                             -*- Autoconf -*-
+# Do all the work for Automake.                            -*- Autoconf -*-
 
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005
+# This macro actually does too much some checks are only needed if
+# your package does certain things.  But this isn't really a big deal.
+
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003
 # Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
 
-# serial 12
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
-# This macro actually does too much.  Some checks are only needed if
-# your package does certain things.  But this isn't really a big deal.
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
 
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 11
+
 # AM_INIT_AUTOMAKE(PACKAGE, VERSION, [NO-DEFINE])
 # AM_INIT_AUTOMAKE([OPTIONS])
 # -----------------------------------------------
@@ -6666,6 +6738,7 @@
 AM_MISSING_PROG(AUTOMAKE, automake-${am__api_version})
 AM_MISSING_PROG(AUTOHEADER, autoheader)
 AM_MISSING_PROG(MAKEINFO, makeinfo)
+AM_MISSING_PROG(AMTAR, tar)
 AM_PROG_INSTALL_SH
 AM_PROG_INSTALL_STRIP
 AC_REQUIRE([AM_PROG_MKDIR_P])dnl
@@ -6674,9 +6747,7 @@
 AC_REQUIRE([AC_PROG_AWK])dnl
 AC_REQUIRE([AC_PROG_MAKE_SET])dnl
 AC_REQUIRE([AM_SET_LEADING_DOT])dnl
-_AM_IF_OPTION([tar-ustar], [_AM_PROG_TAR([ustar])],
-              [_AM_IF_OPTION([tar-pax], [_AM_PROG_TAR([pax])],
-	      		     [_AM_PROG_TAR([v7])])])
+
 _AM_IF_OPTION([no-dependencies],,
 [AC_PROVIDE_IFELSE([AC_PROG_CC],
                   [_AM_DEPENDENCIES(CC)],
@@ -6710,28 +6781,52 @@
 done
 echo "timestamp for $1" >`AS_DIRNAME([$1])`/stamp-h[]$_am_stamp_count])
 
-# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
-
 # AM_PROG_INSTALL_SH
 # ------------------
 # Define $install_sh.
+
+# Copyright (C) 2001, 2003 Free Software Foundation, Inc.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
 AC_DEFUN([AM_PROG_INSTALL_SH],
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 install_sh=${install_sh-"$am_aux_dir/install-sh"}
 AC_SUBST(install_sh)])
 
-# Copyright (C) 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+#                                                          -*- Autoconf -*-
+# Copyright (C) 2003  Free Software Foundation, Inc.
 
-# serial 2
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 1
+
 # Check whether the underlying file-system supports filenames
 # with a leading dot.  For instance MS-DOS doesn't.
 AC_DEFUN([AM_SET_LEADING_DOT],
@@ -6745,16 +6840,27 @@
 rmdir .tst 2>/dev/null
 AC_SUBST([am__leading_dot])])
 
-# Check to see how 'make' treats includes.	            -*- Autoconf -*-
+# Check to see how 'make' treats includes.	-*- Autoconf -*-
 
-# Copyright (C) 2001, 2002, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Copyright (C) 2001, 2002, 2003 Free Software Foundation, Inc.
 
-# serial 3
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 2
+
 # AM_MAKE_INCLUDE()
 # -----------------
 # Check to see how make treats includes.
@@ -6797,17 +6903,28 @@
 rm -f confinc confmf
 ])
 
-# Fake the existence of programs that GNU maintainers use.  -*- Autoconf -*-
+#  -*- Autoconf -*-
 
-# Copyright (C) 1997, 1999, 2000, 2001, 2003, 2005
-# Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
 
-# serial 4
+# Copyright (C) 1997, 1999, 2000, 2001, 2003 Free Software Foundation, Inc.
 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 3
+
 # AM_MISSING_PROG(NAME, PROGRAM)
 # ------------------------------
 AC_DEFUN([AM_MISSING_PROG],
@@ -6832,16 +6949,27 @@
 fi
 ])
 
-# Copyright (C) 2003, 2004, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
-
 # AM_PROG_MKDIR_P
 # ---------------
 # Check whether `mkdir -p' is supported, fallback to mkinstalldirs otherwise.
-#
+
+# Copyright (C) 2003, 2004 Free Software Foundation, Inc.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
 # Automake 1.8 used `mkdir -m 0755 -p --' to ensure that directories
 # created by `make install' are always world readable, even if the
 # installer happens to have an overly restrictive umask (e.g. 077).
@@ -6862,21 +6990,13 @@
 # this.)
 AC_DEFUN([AM_PROG_MKDIR_P],
 [if mkdir -p --version . >/dev/null 2>&1 && test ! -d ./--version; then
-  # We used to keeping the `.' as first argument, in order to
-  # allow $(mkdir_p) to be used without argument.  As in
+  # Keeping the `.' argument allows $(mkdir_p) to be used without
+  # argument.  Indeed, we sometimes output rules like
   #   $(mkdir_p) $(somedir)
-  # where $(somedir) is conditionally defined.  However this is wrong
-  # for two reasons:
-  #  1. if the package is installed by a user who cannot write `.'
-  #     make install will fail,
-  #  2. the above comment should most certainly read
-  #     $(mkdir_p) $(DESTDIR)$(somedir)
-  #     so it does not work when $(somedir) is undefined and
-  #     $(DESTDIR) is not.
-  #  To support the latter case, we have to write
-  #     test -z "$(somedir)" || $(mkdir_p) $(DESTDIR)$(somedir),
-  #  so the `.' trick is pointless.
-  mkdir_p='mkdir -p --'
+  # where $(somedir) is conditionally defined.
+  # (`test -n '$(somedir)' && $(mkdir_p) $(somedir)' is a more
+  # expensive solution, as it forces Make to start a sub-shell.)
+  mkdir_p='mkdir -p -- .'
 else
   # On NextStep and OpenStep, the `mkdir' command does not
   # recognize any option.  It will interpret all options as
@@ -6895,16 +7015,27 @@
 fi
 AC_SUBST([mkdir_p])])
 
-# Helper functions for option handling.                     -*- Autoconf -*-
+# Helper functions for option handling.                    -*- Autoconf -*-
 
-# Copyright (C) 2001, 2002, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Copyright (C) 2001, 2002, 2003  Free Software Foundation, Inc.
 
-# serial 3
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 2
+
 # _AM_MANGLE_OPTION(NAME)
 # -----------------------
 AC_DEFUN([_AM_MANGLE_OPTION],
@@ -6928,17 +7059,29 @@
 AC_DEFUN([_AM_IF_OPTION],
 [m4_ifset(_AM_MANGLE_OPTION([$1]), [$2], [$3])])
 
-# Check to make sure that the build environment is sane.    -*- Autoconf -*-
-
-# Copyright (C) 1996, 1997, 2000, 2001, 2003, 2005
-# Free Software Foundation, Inc.
 #
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# Check to make sure that the build environment is sane.
+#
 
-# serial 4
+# Copyright (C) 1996, 1997, 2000, 2001, 2003 Free Software Foundation, Inc.
 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# serial 3
+
 # AM_SANITY_CHECK
 # ---------------
 AC_DEFUN([AM_SANITY_CHECK],
@@ -6980,14 +7123,25 @@
 fi
 AC_MSG_RESULT(yes)])
 
-# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
+# AM_PROG_INSTALL_STRIP
 
-# AM_PROG_INSTALL_STRIP
-# ---------------------
+# Copyright (C) 2001, 2003 Free Software Foundation, Inc.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
 # One issue with vendor `install' (even GNU) is that you can't
 # specify the program used to strip binaries.  This is especially
 # annoying in cross-compiling environments, where the build's strip
@@ -7008,99 +7162,3 @@
 INSTALL_STRIP_PROGRAM="\${SHELL} \$(install_sh) -c -s"
 AC_SUBST([INSTALL_STRIP_PROGRAM])])
 
-# Check how to create a tarball.                            -*- Autoconf -*-
-
-# Copyright (C) 2004, 2005  Free Software Foundation, Inc.
-#
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
-
-# serial 2
-
-# _AM_PROG_TAR(FORMAT)
-# --------------------
-# Check how to create a tarball in format FORMAT.
-# FORMAT should be one of `v7', `ustar', or `pax'.
-#
-# Substitute a variable $(am__tar) that is a command
-# writing to stdout a FORMAT-tarball containing the directory
-# $tardir.
-#     tardir=directory && $(am__tar) > result.tar
-#
-# Substitute a variable $(am__untar) that extract such
-# a tarball read from stdin.
-#     $(am__untar) < result.tar
-AC_DEFUN([_AM_PROG_TAR],
-[# Always define AMTAR for backward compatibility.
-AM_MISSING_PROG([AMTAR], [tar])
-m4_if([$1], [v7],
-     [am__tar='${AMTAR} chof - "$$tardir"'; am__untar='${AMTAR} xf -'],
-     [m4_case([$1], [ustar],, [pax],,
-              [m4_fatal([Unknown tar format])])
-AC_MSG_CHECKING([how to create a $1 tar archive])
-# Loop over all known methods to create a tar archive until one works.
-_am_tools='gnutar m4_if([$1], [ustar], [plaintar]) pax cpio none'
-_am_tools=${am_cv_prog_tar_$1-$_am_tools}
-# Do not fold the above two line into one, because Tru64 sh and
-# Solaris sh will not grok spaces in the rhs of `-'.
-for _am_tool in $_am_tools
-do
-  case $_am_tool in
-  gnutar)
-    for _am_tar in tar gnutar gtar;
-    do
-      AM_RUN_LOG([$_am_tar --version]) && break
-    done
-    am__tar="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$$tardir"'
-    am__tar_="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$tardir"'
-    am__untar="$_am_tar -xf -"
-    ;;
-  plaintar)
-    # Must skip GNU tar: if it does not support --format= it doesn't create
-    # ustar tarball either.
-    (tar --version) >/dev/null 2>&1 && continue
-    am__tar='tar chf - "$$tardir"'
-    am__tar_='tar chf - "$tardir"'
-    am__untar='tar xf -'
-    ;;
-  pax)
-    am__tar='pax -L -x $1 -w "$$tardir"'
-    am__tar_='pax -L -x $1 -w "$tardir"'
-    am__untar='pax -r'
-    ;;
-  cpio)
-    am__tar='find "$$tardir" -print | cpio -o -H $1 -L'
-    am__tar_='find "$tardir" -print | cpio -o -H $1 -L'
-    am__untar='cpio -i -H $1 -d'
-    ;;
-  none)
-    am__tar=false
-    am__tar_=false
-    am__untar=false
-    ;;
-  esac
-
-  # If the value was cached, stop now.  We just wanted to have am__tar
-  # and am__untar set.
-  test -n "${am_cv_prog_tar_$1}" && break
-
-  # tar/untar a dummy directory, and stop if the command works
-  rm -rf conftest.dir
-  mkdir conftest.dir
-  echo GrepMe > conftest.dir/file
-  AM_RUN_LOG([tardir=conftest.dir && eval $am__tar_ >conftest.tar])
-  rm -rf conftest.dir
-  if test -s conftest.tar; then
-    AM_RUN_LOG([$am__untar <conftest.tar])
-    grep GrepMe conftest.dir/file >/dev/null 2>&1 && break
-  fi
-done
-rm -rf conftest.dir
-
-AC_CACHE_VAL([am_cv_prog_tar_$1], [am_cv_prog_tar_$1=$_am_tool])
-AC_MSG_RESULT([$am_cv_prog_tar_$1])])
-AC_SUBST([am__tar])
-AC_SUBST([am__untar])
-]) # _AM_PROG_TAR
-

Modified: trunk/configure
===================================================================
--- trunk/configure	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/configure	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.59 for openspace 0.1.1.
+# Generated by GNU Autoconf 2.59 for openspace 0.2.0.
 #
 # Report bugs to <http://openspace.linux.pl>.
 #
@@ -423,11 +423,11 @@
 # Identity of this package.
 PACKAGE_NAME='openspace'
 PACKAGE_TARNAME='openspace'
-PACKAGE_VERSION='0.1.1'
-PACKAGE_STRING='openspace 0.1.1'
+PACKAGE_VERSION='0.2.0'
+PACKAGE_STRING='openspace 0.2.0'
 PACKAGE_BUGREPORT='http://openspace.linux.pl'
 
-ac_unique_file="src/openspace.cpp"
+ac_unique_file="src/main.cpp"
 # Factoring default headers for most tests.
 ac_includes_default="\
 #include <stdio.h>
@@ -465,7 +465,7 @@
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar CXX CXXFLAGS LDFLAGS CPPFLAGS ac_ct_CXX EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CC CFLAGS ac_ct_CC CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CPP build build_cpu build_vendor build_os host host_cpu host_vendor host_os EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL LIBOBJS FOX_CON!
 FIG XML2_CONFIG LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO AMTAR install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot CXX CXXFLAGS LDFLAGS CPPFLAGS ac_ct_CXX EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CC CFLAGS ac_ct_CC CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CPP build build_cpu build_vendor build_os host host_cpu host_vendor host_os EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL LIBOBJS FOX_CONFIG XML2_CONFIG LT!
 LIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -954,7 +954,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures openspace 0.1.1 to adapt to many kinds of systems.
+\`configure' configures openspace 0.2.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1020,7 +1020,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of openspace 0.1.1:";;
+     short | recursive ) echo "Configuration of openspace 0.2.0:";;
    esac
   cat <<\_ACEOF
 
@@ -1159,7 +1159,7 @@
 test -n "$ac_init_help" && exit 0
 if $ac_init_version; then
   cat <<\_ACEOF
-openspace configure 0.1.1
+openspace configure 0.2.0
 generated by GNU Autoconf 2.59
 
 Copyright (C) 2003 Free Software Foundation, Inc.
@@ -1173,7 +1173,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by openspace $as_me 0.1.1, which was
+It was created by openspace $as_me 0.2.0, which was
 generated by GNU Autoconf 2.59.  Invocation command line was
 
   $ $0 $@
@@ -1512,7 +1512,7 @@
 
           ac_config_headers="$ac_config_headers src/config.h"
 
-am__api_version="1.9"
+am__api_version="1.8"
 ac_aux_dir=
 for ac_dir in $srcdir $srcdir/.. $srcdir/../..; do
   if test -f $ac_dir/install-sh; then
@@ -1689,21 +1689,13 @@
 fi
 
 if mkdir -p --version . >/dev/null 2>&1 && test ! -d ./--version; then
-  # We used to keeping the `.' as first argument, in order to
-  # allow $(mkdir_p) to be used without argument.  As in
+  # Keeping the `.' argument allows $(mkdir_p) to be used without
+  # argument.  Indeed, we sometimes output rules like
   #   $(mkdir_p) $(somedir)
-  # where $(somedir) is conditionally defined.  However this is wrong
-  # for two reasons:
-  #  1. if the package is installed by a user who cannot write `.'
-  #     make install will fail,
-  #  2. the above comment should most certainly read
-  #     $(mkdir_p) $(DESTDIR)$(somedir)
-  #     so it does not work when $(somedir) is undefined and
-  #     $(DESTDIR) is not.
-  #  To support the latter case, we have to write
-  #     test -z "$(somedir)" || $(mkdir_p) $(DESTDIR)$(somedir),
-  #  so the `.' trick is pointless.
-  mkdir_p='mkdir -p --'
+  # where $(somedir) is conditionally defined.
+  # (`test -n '$(somedir)' && $(mkdir_p) $(somedir)' is a more
+  # expensive solution, as it forces Make to start a sub-shell.)
+  mkdir_p='mkdir -p -- .'
 else
   # On NextStep and OpenStep, the `mkdir' command does not
   # recognize any option.  It will interpret all options as
@@ -1819,7 +1811,7 @@
 
 # Define the identity of the package.
  PACKAGE='openspace'
- VERSION='0.1.1'
+ VERSION='0.2.0'
 
 
 cat >>confdefs.h <<_ACEOF
@@ -1847,6 +1839,9 @@
 
 MAKEINFO=${MAKEINFO-"${am_missing_run}makeinfo"}
 
+
+AMTAR=${AMTAR-"${am_missing_run}tar"}
+
 install_sh=${install_sh-"$am_aux_dir/install-sh"}
 
 # Installed binaries are usually stripped using `strip' when the user
@@ -1939,16 +1934,9 @@
 
 # We need awk for the "check" target.  The system "awk" is bad on
 # some platforms.
-# Always define AMTAR for backward compatibility.
 
-AMTAR=${AMTAR-"${am_missing_run}tar"}
 
-am__tar='${AMTAR} chof - "$$tardir"'; am__untar='${AMTAR} xf -'
 
-
-
-
-
 # Checks for programs.
 ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
@@ -4360,7 +4348,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 4363 "configure"' > conftest.$ac_ext
+  echo '#line 4351 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -5259,7 +5247,7 @@
 
 
 # Provide some information about the compiler.
-echo "$as_me:5262:" \
+echo "$as_me:5250:" \
      "checking for Fortran 77 compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
 { (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
@@ -6398,11 +6386,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6401: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6389: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:6405: \$? = $ac_status" >&5
+   echo "$as_me:6393: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -6660,11 +6648,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6663: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6651: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:6667: \$? = $ac_status" >&5
+   echo "$as_me:6655: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -6722,11 +6710,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6725: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6713: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:6729: \$? = $ac_status" >&5
+   echo "$as_me:6717: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -8153,7 +8141,7 @@
   libsuff=
   case "$host_cpu" in
   x86_64*)
-    echo '#line 8156 "configure"' > conftest.$ac_ext
+    echo '#line 8144 "configure"' > conftest.$ac_ext
     if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -9017,7 +9005,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 9020 "configure"
+#line 9008 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -9115,7 +9103,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 9118 "configure"
+#line 9106 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11363,11 +11351,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:11366: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:11354: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:11370: \$? = $ac_status" >&5
+   echo "$as_me:11358: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -11425,11 +11413,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:11428: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:11416: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:11432: \$? = $ac_status" >&5
+   echo "$as_me:11420: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -11985,7 +11973,7 @@
   libsuff=
   case "$host_cpu" in
   x86_64*)
-    echo '#line 11988 "configure"' > conftest.$ac_ext
+    echo '#line 11976 "configure"' > conftest.$ac_ext
     if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -12849,7 +12837,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 12852 "configure"
+#line 12840 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12947,7 +12935,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 12950 "configure"
+#line 12938 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -13832,11 +13820,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13835: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13823: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:13839: \$? = $ac_status" >&5
+   echo "$as_me:13827: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -13894,11 +13882,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13897: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13885: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:13901: \$? = $ac_status" >&5
+   echo "$as_me:13889: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -15305,7 +15293,7 @@
   libsuff=
   case "$host_cpu" in
   x86_64*)
-    echo '#line 15308 "configure"' > conftest.$ac_ext
+    echo '#line 15296 "configure"' > conftest.$ac_ext
     if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -16071,11 +16059,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16074: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16062: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16078: \$? = $ac_status" >&5
+   echo "$as_me:16066: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -16333,11 +16321,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16336: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16324: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16340: \$? = $ac_status" >&5
+   echo "$as_me:16328: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -16395,11 +16383,11 @@
    -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16398: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16386: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:16402: \$? = $ac_status" >&5
+   echo "$as_me:16390: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -17826,7 +17814,7 @@
   libsuff=
   case "$host_cpu" in
   x86_64*)
-    echo '#line 17829 "configure"' > conftest.$ac_ext
+    echo '#line 17817 "configure"' > conftest.$ac_ext
     if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -18690,7 +18678,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 18693 "configure"
+#line 18681 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -18788,7 +18776,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 18791 "configure"
+#line 18779 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -22883,7 +22871,7 @@
 } >&5
 cat >&5 <<_CSEOF
 
-This file was extended by openspace $as_me 0.1.1, which was
+This file was extended by openspace $as_me 0.2.0, which was
 generated by GNU Autoconf 2.59.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -22946,7 +22934,7 @@
 
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-openspace config.status 0.1.1
+openspace config.status 0.2.0
 configured by $0, generated by GNU Autoconf 2.59,
   with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
 
@@ -23162,6 +23150,7 @@
 s, at AUTOMAKE@,$AUTOMAKE,;t t
 s, at AUTOHEADER@,$AUTOHEADER,;t t
 s, at MAKEINFO@,$MAKEINFO,;t t
+s, at AMTAR@,$AMTAR,;t t
 s, at install_sh@,$install_sh,;t t
 s, at STRIP@,$STRIP,;t t
 s, at ac_ct_STRIP@,$ac_ct_STRIP,;t t
@@ -23170,9 +23159,6 @@
 s, at AWK@,$AWK,;t t
 s, at SET_MAKE@,$SET_MAKE,;t t
 s, at am__leading_dot@,$am__leading_dot,;t t
-s, at AMTAR@,$AMTAR,;t t
-s, at am__tar@,$am__tar,;t t
-s, at am__untar@,$am__untar,;t t
 s, at CXX@,$CXX,;t t
 s, at CXXFLAGS@,$CXXFLAGS,;t t
 s, at LDFLAGS@,$LDFLAGS,;t t
@@ -23842,21 +23828,27 @@
   else
     continue
   fi
-  # Extract the definition of DEPDIR, am__include, and am__quote
-  # from the Makefile without running `make'.
+  grep '^DEP_FILES *= *[^ #]' < "$mf" > /dev/null || continue
+  # Extract the definition of DEP_FILES from the Makefile without
+  # running `make'.
   DEPDIR=`sed -n 's/^DEPDIR = //p' < "$mf"`
   test -z "$DEPDIR" && continue
-  am__include=`sed -n 's/^am__include = //p' < "$mf"`
-  test -z "am__include" && continue
-  am__quote=`sed -n 's/^am__quote = //p' < "$mf"`
   # When using ansi2knr, U may be empty or an underscore; expand it
   U=`sed -n 's/^U = //p' < "$mf"`
-  # Find all dependency output files, they are included files with
-  # $(DEPDIR) in their names.  We invoke sed twice because it is the
-  # simplest approach to changing $(DEPDIR) to its actual value in the
-  # expansion.
-  for file in `sed -n "
-    s/^$am__include $am__quote\(.*(DEPDIR).*\)$am__quote"'$/\1/p' <"$mf" | \
+  test -d "$dirpart/$DEPDIR" || mkdir "$dirpart/$DEPDIR"
+  # We invoke sed twice because it is the simplest approach to
+  # changing $(DEPDIR) to its actual value in the expansion.
+  for file in `sed -n '
+    /^DEP_FILES = .*\\\\$/ {
+      s/^DEP_FILES = //
+      :loop
+	s/\\\\$//
+	p
+	n
+	/\\\\$/ b loop
+      p
+    }
+    /^DEP_FILES = / s/^DEP_FILES = //p' < "$mf" | \
        sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
     # Make sure the directory exists.
     test -f "$dirpart/$file" && continue

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/configure.ac	2006-02-12 15:36:06 UTC (rev 246)
@@ -2,8 +2,8 @@
 # Process this file with autoconf to produce a configure script.
 
 AC_PREREQ(2.59)
-AC_INIT(openspace, 0.1.1, http://openspace.linux.pl)
-AC_CONFIG_SRCDIR(src/openspace.cpp)
+AC_INIT(openspace, 0.2.0, http://openspace.linux.pl)
+AC_CONFIG_SRCDIR(src/main.cpp)
 AC_CONFIG_HEADER(src/config.h)
 AM_INIT_AUTOMAKE
 # Checks for programs.

Modified: trunk/depcomp
===================================================================
--- trunk/depcomp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/depcomp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # depcomp - compile a program generating dependencies as side-effects
 
-scriptversion=2005-02-09.22
+scriptversion=2004-04-25.13
 
-# Copyright (C) 1999, 2000, 2003, 2004, 2005 Free Software Foundation, Inc.
+# Copyright (C) 1999, 2000, 2003, 2004 Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -43,18 +43,17 @@
   depmode     Dependency tracking mode.
   source      Source file read by `PROGRAMS ARGS'.
   object      Object file output by `PROGRAMS ARGS'.
-  DEPDIR      directory where to store dependencies.
   depfile     Dependency file to output.
   tmpdepfile  Temporary file to use when outputing dependencies.
   libtool     Whether libtool is used (yes/no).
 
 Report bugs to <bug-automake at gnu.org>.
 EOF
-    exit $?
+    exit 0
     ;;
   -v | --v*)
     echo "depcomp $scriptversion"
-    exit $?
+    exit 0
     ;;
 esac
 
@@ -62,10 +61,18 @@
   echo "depcomp: Variables source, object and depmode must be set" 1>&2
   exit 1
 fi
+# `libtool' can also be set to `yes' or `no'.
 
-# Dependencies for sub/bar.o or sub/bar.obj go into sub/.deps/bar.Po.
-depfile=${depfile-`echo "$object" |
-  sed 's|[^\\/]*$|'${DEPDIR-.deps}'/&|;s|\.\([^.]*\)$|.P\1|;s|Pobj$|Po|'`}
+if test -z "$depfile"; then
+   base=`echo "$object" | sed -e 's,^.*/,,' -e 's,\.\([^.]*\)$,.P\1,'`
+   dir=`echo "$object" | sed 's,/.*$,/,'`
+   if test "$dir" = "$object"; then
+      dir=
+   fi
+   # FIXME: should be _deps on DOS.
+   depfile="$dir.deps/$base"
+fi
+
 tmpdepfile=${tmpdepfile-`echo "$depfile" | sed 's/\.\([^.]*\)$/.T\1/'`}
 
 rm -f "$tmpdepfile"
@@ -287,43 +294,33 @@
    base=`echo "$object" | sed -e 's|^.*/||' -e 's/\.o$//' -e 's/\.lo$//'`
 
    if test "$libtool" = yes; then
-      # With Tru64 cc, shared objects can also be used to make a
-      # static library.  This mecanism is used in libtool 1.4 series to
-      # handle both shared and static libraries in a single compilation.
-      # With libtool 1.4, dependencies were output in $dir.libs/$base.lo.d.
-      #
-      # With libtool 1.5 this exception was removed, and libtool now
-      # generates 2 separate objects for the 2 libraries.  These two
-      # compilations output dependencies in in $dir.libs/$base.o.d and
-      # in $dir$base.o.d.  We have to check for both files, because
-      # one of the two compilations can be disabled.  We should prefer
-      # $dir$base.o.d over $dir.libs/$base.o.d because the latter is
-      # automatically cleaned when .libs/ is deleted, while ignoring
-      # the former would cause a distcleancheck panic.
-      tmpdepfile1=$dir.libs/$base.lo.d   # libtool 1.4
-      tmpdepfile2=$dir$base.o.d          # libtool 1.5
-      tmpdepfile3=$dir.libs/$base.o.d    # libtool 1.5
-      tmpdepfile4=$dir.libs/$base.d      # Compaq CCC V6.2-504
+      # Dependencies are output in .lo.d with libtool 1.4.
+      # They are output in .o.d with libtool 1.5.
+      tmpdepfile1="$dir.libs/$base.lo.d"
+      tmpdepfile2="$dir.libs/$base.o.d"
+      tmpdepfile3="$dir.libs/$base.d"
       "$@" -Wc,-MD
    else
-      tmpdepfile1=$dir$base.o.d
-      tmpdepfile2=$dir$base.d
-      tmpdepfile3=$dir$base.d
-      tmpdepfile4=$dir$base.d
+      tmpdepfile1="$dir$base.o.d"
+      tmpdepfile2="$dir$base.d"
+      tmpdepfile3="$dir$base.d"
       "$@" -MD
    fi
 
    stat=$?
    if test $stat -eq 0; then :
    else
-      rm -f "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3" "$tmpdepfile4"
+      rm -f "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3"
       exit $stat
    fi
 
-   for tmpdepfile in "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3" "$tmpdepfile4"
-   do
-     test -f "$tmpdepfile" && break
-   done
+   if test -f "$tmpdepfile1"; then
+      tmpdepfile="$tmpdepfile1"
+   elif test -f "$tmpdepfile2"; then
+      tmpdepfile="$tmpdepfile2"
+   else
+      tmpdepfile="$tmpdepfile3"
+   fi
    if test -f "$tmpdepfile"; then
       sed -e "s,^.*\.[a-z]*:,$object:," < "$tmpdepfile" > "$depfile"
       # That's a tab and a space in the [].

Copied: trunk/doc (from rev 245, branches/mloskot-style-refactoring/doc)


Property changes on: trunk/doc
___________________________________________________________________
Name: svn:ignore
   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Copied: trunk/doc/dev (from rev 245, branches/mloskot-style-refactoring/doc/dev)


Property changes on: trunk/doc/dev
___________________________________________________________________
Name: svn:ignore
   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Copied: trunk/doxygen.conf (from rev 245, branches/mloskot-style-refactoring/doxygen.conf)


Property changes on: trunk/icons
___________________________________________________________________
Name: svn:ignore
   - Makefile

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Modified: trunk/icons/Makefile.in
===================================================================
--- trunk/icons/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/icons/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -33,7 +33,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 subdir = icons
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
@@ -41,7 +40,7 @@
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
 SOURCES =
@@ -124,8 +123,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -205,13 +202,7 @@
 #     (which will cause the Makefiles to be regenerated when you run `make');
 # (2) otherwise, pass the desired values on the `make' command line.
 $(RECURSIVE_TARGETS):
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	target=`echo $@ | sed s/-recursive//`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -223,7 +214,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done; \
 	if test "$$dot_seen" = "no"; then \
 	  $(MAKE) $(AM_MAKEFLAGS) "$$target-am" || exit 1; \
@@ -231,13 +222,7 @@
 
 mostlyclean-recursive clean-recursive distclean-recursive \
 maintainer-clean-recursive:
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	case "$@" in \
 	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
@@ -258,7 +243,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done && test -z "$$fail"
 tags-recursive:
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -357,17 +342,15 @@
 	    || exit 1; \
 	  fi; \
 	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
 	  if test "$$subdir" = .; then :; else \
 	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
+	    || mkdir "$(distdir)/$$subdir" \
 	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
 	    (cd $$subdir && \
 	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
+	        top_distdir="../$(top_distdir)" \
+	        distdir="../$(distdir)/$$subdir" \
 	        distdir) \
 	      || exit 1; \
 	  fi; \
@@ -396,7 +379,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"


Property changes on: trunk/icons/default
___________________________________________________________________
Name: svn:ignore
   - Makefile

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Modified: trunk/icons/default/Makefile.in
===================================================================
--- trunk/icons/default/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/icons/default/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -34,7 +34,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 subdir = icons/default
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
@@ -42,17 +41,11 @@
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
 SOURCES =
 DIST_SOURCES =
-am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
-am__vpath_adj = case $$p in \
-    $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
-    *) f=$$p;; \
-  esac;
-am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
 am__installdirs = "$(DESTDIR)$(iconsdir)"
 iconsDATA_INSTALL = $(INSTALL_DATA)
 DATA = $(icons_DATA)
@@ -125,8 +118,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -205,7 +196,7 @@
 	test -z "$(iconsdir)" || $(mkdir_p) "$(DESTDIR)$(iconsdir)"
 	@list='$(icons_DATA)'; for p in $$list; do \
 	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
-	  f=$(am__strip_dir) \
+	  f="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " $(iconsDATA_INSTALL) '$$d$$p' '$(DESTDIR)$(iconsdir)/$$f'"; \
 	  $(iconsDATA_INSTALL) "$$d$$p" "$(DESTDIR)$(iconsdir)/$$f"; \
 	done
@@ -213,7 +204,7 @@
 uninstall-iconsDATA:
 	@$(NORMAL_UNINSTALL)
 	@list='$(icons_DATA)'; for p in $$list; do \
-	  f=$(am__strip_dir) \
+	  f="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " rm -f '$(DESTDIR)$(iconsdir)/$$f'"; \
 	  rm -f "$(DESTDIR)$(iconsdir)/$$f"; \
 	done
@@ -277,7 +268,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"

Modified: trunk/install-sh
===================================================================
--- trunk/install-sh	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/install-sh	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,7 +1,7 @@
 #!/bin/sh
 # install - install a program, script, or datafile
 
-scriptversion=2005-02-02.21
+scriptversion=2004-04-01.17
 
 # This originates from X11R5 (mit/util/scripts/install.sh), which was
 # later released in X11R6 (xc/config/util/install.sh) with the
@@ -58,6 +58,9 @@
 rmprog="${RMPROG-rm}"
 mkdirprog="${MKDIRPROG-mkdir}"
 
+transformbasename=
+transform_arg=
+instcmd="$mvprog"
 chmodcmd="$chmodprog 0755"
 chowncmd=
 chgrpcmd=
@@ -67,27 +70,23 @@
 src=
 dst=
 dir_arg=
-dstarg=
-no_target_directory=
 
-usage="Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
+usage="Usage: $0 [OPTION]... SRCFILE DSTFILE
    or: $0 [OPTION]... SRCFILES... DIRECTORY
-   or: $0 [OPTION]... -t DIRECTORY SRCFILES...
-   or: $0 [OPTION]... -d DIRECTORIES...
+   or: $0 -d DIRECTORIES...
 
-In the 1st form, copy SRCFILE to DSTFILE.
-In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.
-In the 4th, create DIRECTORIES.
+In the first form, install SRCFILE to DSTFILE, removing SRCFILE by default.
+In the second, create the directory path DIR.
 
 Options:
--c         (ignored)
+-b=TRANSFORMBASENAME
+-c         copy source (using $cpprog) instead of moving (using $mvprog).
 -d         create directories instead of installing files.
--g GROUP   $chgrpprog installed files to GROUP.
--m MODE    $chmodprog installed files to MODE.
--o USER    $chownprog installed files to USER.
--s         $stripprog installed files.
--t DIRECTORY  install into DIRECTORY.
--T         report an error if DSTFILE is a directory.
+-g GROUP   $chgrp installed files to GROUP.
+-m MODE    $chmod installed files to MODE.
+-o USER    $chown installed files to USER.
+-s         strip installed files (using $stripprog).
+-t=TRANSFORM
 --help     display this help and exit.
 --version  display version info and exit.
 
@@ -97,9 +96,14 @@
 
 while test -n "$1"; do
   case $1 in
-    -c) shift
+    -b=*) transformbasename=`echo $1 | sed 's/-b=//'`
+        shift
         continue;;
 
+    -c) instcmd=$cpprog
+        shift
+        continue;;
+
     -d) dir_arg=true
         shift
         continue;;
@@ -109,7 +113,7 @@
         shift
         continue;;
 
-    --help) echo "$usage"; exit $?;;
+    --help) echo "$usage"; exit 0;;
 
     -m) chmodcmd="$chmodprog $2"
         shift
@@ -125,20 +129,14 @@
         shift
         continue;;
 
-    -t) dstarg=$2
-	shift
-	shift
-	continue;;
+    -t=*) transformarg=`echo $1 | sed 's/-t=//'`
+        shift
+        continue;;
 
-    -T) no_target_directory=true
-	shift
-	continue;;
+    --version) echo "$0 $scriptversion"; exit 0;;
 
-    --version) echo "$0 $scriptversion"; exit $?;;
-
     *)  # When -d is used, all remaining arguments are directories to create.
-	# When -t is used, the destination is already specified.
-	test -n "$dir_arg$dstarg" && break
+	test -n "$dir_arg" && break
         # Otherwise, the last argument is the destination.  Remove it from $@.
 	for arg
 	do
@@ -176,13 +174,13 @@
     src=
 
     if test -d "$dst"; then
-      mkdircmd=:
+      instcmd=:
       chmodcmd=
     else
-      mkdircmd=$mkdirprog
+      instcmd=$mkdirprog
     fi
   else
-    # Waiting for this to be detected by the "$cpprog $src $dsttmp" command
+    # Waiting for this to be detected by the "$instcmd $src $dsttmp" command
     # might cause directories to be created, which would be especially bad
     # if $src (and thus $dsttmp) contains '*'.
     if test ! -f "$src" && test ! -d "$src"; then
@@ -204,16 +202,12 @@
     # If destination is a directory, append the input filename; won't work
     # if double slashes aren't ignored.
     if test -d "$dst"; then
-      if test -n "$no_target_directory"; then
-	echo "$0: $dstarg: Is a directory" >&2
-	exit 1
-      fi
       dst=$dst/`basename "$src"`
     fi
   fi
 
   # This sed command emulates the dirname command.
-  dstdir=`echo "$dst" | sed -e 's,/*$,,;s,[^/]*$,,;s,/*$,,;s,^$,.,'`
+  dstdir=`echo "$dst" | sed -e 's,[^/]*$,,;s,/$,,;s,^$,.,'`
 
   # Make sure that the destination directory exists.
 
@@ -226,8 +220,7 @@
     oIFS=$IFS
     # Some sh's can't handle IFS=/ for some reason.
     IFS='%'
-    set x `echo "$dstdir" | sed -e 's@/@%@g' -e 's@^%@/@'`
-    shift
+    set - `echo "$dstdir" | sed -e 's@/@%@g' -e 's@^%@/@'`
     IFS=$oIFS
 
     pathcomp=
@@ -236,42 +229,51 @@
       pathcomp=$pathcomp$1
       shift
       if test ! -d "$pathcomp"; then
-        $mkdirprog "$pathcomp"
+        $mkdirprog "$pathcomp" || lasterr=$?
 	# mkdir can fail with a `File exist' error in case several
 	# install-sh are creating the directory concurrently.  This
 	# is OK.
-	test -d "$pathcomp" || exit
+	test ! -d "$pathcomp" && { (exit ${lasterr-1}); exit; }
       fi
       pathcomp=$pathcomp/
     done
   fi
 
   if test -n "$dir_arg"; then
-    $doit $mkdircmd "$dst" \
+    $doit $instcmd "$dst" \
       && { test -z "$chowncmd" || $doit $chowncmd "$dst"; } \
       && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dst"; } \
       && { test -z "$stripcmd" || $doit $stripcmd "$dst"; } \
       && { test -z "$chmodcmd" || $doit $chmodcmd "$dst"; }
 
   else
-    dstfile=`basename "$dst"`
+    # If we're going to rename the final executable, determine the name now.
+    if test -z "$transformarg"; then
+      dstfile=`basename "$dst"`
+    else
+      dstfile=`basename "$dst" $transformbasename \
+               | sed $transformarg`$transformbasename
+    fi
 
+    # don't allow the sed command to completely eliminate the filename.
+    test -z "$dstfile" && dstfile=`basename "$dst"`
+
     # Make a couple of temp file names in the proper directory.
     dsttmp=$dstdir/_inst.$$_
     rmtmp=$dstdir/_rm.$$_
 
     # Trap to clean up those temp files at exit.
-    trap 'ret=$?; rm -f "$dsttmp" "$rmtmp" && exit $ret' 0
+    trap 'status=$?; rm -f "$dsttmp" "$rmtmp" && exit $status' 0
     trap '(exit $?); exit' 1 2 13 15
 
-    # Copy the file name to the temp name.
-    $doit $cpprog "$src" "$dsttmp" &&
+    # Move or copy the file name to the temp name
+    $doit $instcmd "$src" "$dsttmp" &&
 
     # and set any options; do chmod last to preserve setuid bits.
     #
     # If any of these fail, we abort the whole thing.  If we want to
     # ignore errors from any of these, just make sure not to ignore
-    # errors from the above "$doit $cpprog $src $dsttmp" command.
+    # errors from the above "$doit $instcmd $src $dsttmp" command.
     #
     { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } \
       && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } \
@@ -296,7 +298,7 @@
 	       || $doit $mvcmd -f "$dstdir/$dstfile" "$rmtmp" 2>/dev/null \
 	       || {
 		 echo "$0: cannot unlink or rename $dstdir/$dstfile" >&2
-		 (exit 1); exit 1
+		 (exit 1); exit
 	       }
 	     else
 	       :
@@ -307,12 +309,12 @@
 	   $doit $mvcmd "$dsttmp" "$dstdir/$dstfile"
 	 }
     }
-  fi || { (exit 1); exit 1; }
+  fi || { (exit 1); exit; }
 done
 
 # The final little trick to "correctly" pass the exit status to the exit trap.
 {
-  (exit 0); exit 0
+  (exit 0); exit
 }
 
 # Local variables:

Modified: trunk/missing
===================================================================
--- trunk/missing	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/missing	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Common stub for a few missing GNU programs while installing.
 
-scriptversion=2005-02-08.22
+scriptversion=2003-09-02.23
 
-# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004, 2005
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003 
 #   Free Software Foundation, Inc.
 # Originally by Fran,cois Pinard <pinard at iro.umontreal.ca>, 1996.
 
@@ -60,7 +60,12 @@
     msg="probably too old"
   fi
   ;;
+esac
 
+# If it does not exist, or fails to run (possibly an outdated version),
+# try to emulate it.
+case "$1" in
+
   -h|--h|--he|--hel|--help)
     echo "\
 $0 [OPTION]... PROGRAM [ARGUMENT]...
@@ -87,12 +92,10 @@
   yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
 
 Send bug reports to <bug-automake at gnu.org>."
-    exit $?
     ;;
 
   -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
     echo "missing $scriptversion (GNU Automake)"
-    exit $?
     ;;
 
   -*)
@@ -101,42 +104,12 @@
     exit 1
     ;;
 
-esac
-
-# Now exit if we have it, but it failed.  Also exit now if we
-# don't have it and --version was passed (most likely to detect
-# the program).
-case "$1" in
-  lex|yacc)
-    # Not GNU programs, they don't have --version.
-    ;;
-
-  tar)
-    if test -n "$run"; then
-       echo 1>&2 "ERROR: \`tar' requires --run"
-       exit 1
-    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
-       exit 1
-    fi
-    ;;
-
-  *)
+  aclocal*)
     if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
        # We have it, but it failed.
        exit 1
-    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
-       # Could not run --version or --help.  This is probably someone
-       # running `$TOOL --version' or `$TOOL --help' to check whether
-       # $TOOL exists and not knowing $TOOL uses missing.
-       exit 1
     fi
-    ;;
-esac
 
-# If it does not exist, or fails to run (possibly an outdated version),
-# try to emulate it.
-case "$1" in
-  aclocal*)
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
          you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
@@ -146,6 +119,11 @@
     ;;
 
   autoconf)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
          you modified \`${configure_ac}'.  You might want to install the
@@ -155,6 +133,11 @@
     ;;
 
   autoheader)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
          you modified \`acconfig.h' or \`${configure_ac}'.  You might want
@@ -174,6 +157,11 @@
     ;;
 
   automake*)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
          you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
@@ -185,6 +173,11 @@
     ;;
 
   autom4te)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is needed, but is $msg.
          You might have modified some files without having the
@@ -261,6 +254,11 @@
     ;;
 
   help2man)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
 	 you modified a dependency of a manual page.  You may need the
@@ -281,6 +279,11 @@
     ;;
 
   makeinfo)
+    if test -z "$run" && (makeinfo --version) > /dev/null 2>&1; then
+       # We have makeinfo, but it failed.
+       exit 1
+    fi
+
     echo 1>&2 "\
 WARNING: \`$1' is $msg.  You should only need it if
          you modified a \`.texi' or \`.texinfo' file, or any other file
@@ -288,20 +291,20 @@
          call might also be the consequence of using a buggy \`make' (AIX,
          DU, IRIX).  You might want to install the \`Texinfo' package or
          the \`GNU make' package.  Grab either from any GNU archive site."
-    # The file to touch is that specified with -o ...
     file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
     if test -z "$file"; then
-      # ... or it is the one specified with @setfilename ...
-      infile=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
-      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $infile`
-      # ... or it is derived from the source name (dir/f.texi becomes f.info)
-      test -z "$file" && file=`echo "$infile" | sed 's,.*/,,;s,.[^.]*$,,'`.info
+      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
     fi
     touch $file
     ;;
 
   tar)
     shift
+    if test -n "$run"; then
+      echo 1>&2 "ERROR: \`tar' requires --run"
+      exit 1
+    fi
 
     # We have already tried tar in the generic part.
     # Look for gnutar/gtar before invocation to avoid ugly error

Modified: trunk/openspacerc.in
===================================================================
--- trunk/openspacerc.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/openspacerc.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -213,31 +213,38 @@
 		</filter_files>
 		
 		
-		<mkdir>
+		<OSMkdir>
 			<type>PLUGIN</type>
-		</mkdir>
-		<access>
+			<text>mkdir</text>
+		</OSMkdir>
+		<OSAccess>
 			<type>PLUGIN</type>
-		</access>
+			<text>access</text>
+		</OSAccess>
 		<remove>
 			<type>INTERNAL</type>
 			<key>Delete</key>
 		</remove>
-		<rename>
+		<OSRename>
 			<type>PLUGIN</type>
-		</rename>
-		<clone>
+			<text>rename</text>
+		</OSRename>
+		<OSClone>
 			<type>PLUGIN</type>
-		</clone>
-		<symlink>
+			<text>clone</text>
+		</OSClone>
+		<OSSymlink>
 			<type>PLUGIN</type>
-		</symlink>
-		<compress>
+			<text>symlink</text>
+		</OSSymlink>
+		<OSCompress>
 			<type>PLUGIN</type>
-		</compress>
-		<editsymlink>
+			<text>compress</text>
+		</OSCompress>
+		<OSEditSymlink>
 			<type>PLUGIN</type>
-		</editsymlink>
+			<text>edit symlink</text>
+		</OSEditSymlink>
 		<other>
 			<type>INTERNAL</type>
 			<icon>other</icon>
@@ -426,20 +433,20 @@
 		<common>
 			<command>copy</command>
 			<command>move</command>
-			<command>mkdir</command>
-			<command>access</command>
+			<command>OSMkdir</command>
+			<command>OSAccess</command>
 			<command>remove</command>
-			<command>rename</command>
-			<command>clone</command>
-			<command>symlink</command>
-			<command>editsymlink</command>
+			<command>OSRename</command>
+			<command>OSClone</command>
+			<command>OSSymlink</command>
+			<command>OSEditSymlink</command>
 			<command>special</command>
 			<command>totalsize</command>
 			<command>new_file</command>
 			<command>ls</command>
 		</common>
 		<compress>
-			<command>compress</command>
+			<command>OSCompress</command>
 		</compress>
 		
 		<panel>


Property changes on: trunk/src
___________________________________________________________________
Name: svn:ignore
   - Makefile
config.h
stamp-h1
.deps
.libs
openspace

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Deleted: trunk/src/CommandsFileTypesContainers.cpp
===================================================================
--- trunk/src/CommandsFileTypesContainers.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/CommandsFileTypesContainers.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,217 +0,0 @@
-#include "CommandsFileTypesContainers.h"
-#include "sharedobjects.h"
-
-
-filetype_container::filetype_container(string name,string command):name(name),command(command)
-{
-}
-
-bool filetype_container::load(string name)
-{
-this->name=name;
-
-string::size_type pos=name.find("/");
-	string path;
-	string mime_major;
-	string mime_minor;
-	if (pos != string::npos)
-	{
-		mime_major=name.substr(0,pos);	
-		mime_minor=name.substr(pos+1);
-	path="/OpenspaceConfig/file_types/" + mime_major + "/types/"+mime_minor;
-	}
-	else
-	{
-	path="/OpenspaceConfig/file_types/" + name;
-	}
-
-	    command = conf->readonestring (path + "/default");
-	    icon=conf->readonestring(path +"/icon") ;
-	    color=conf->readonestring(path +"/color") ;
-	    backcolor=conf->readonestring(path +"/backcolor") ;
-	    
-	    configure conflocal2 = *conf;
-	    if(conflocal2.openxpath(path + "/commands/command")!=-1)
-	       {
-	       string commandstr;
-	      	 while(conflocal2.getnextstring(commandstr))
-	      	 {     	 
-	     	  commands.push_back(commandstr.c_str());
-	     	 }
-	       }    
-
-}
-void filetype_container::save(void)
-{
-//fxmessage("\nNAME=%s COMMAND=%s\n",name.c_str(),command.c_str());
-
-if(name=="")
-return;
-
-	string::size_type pos=name.find("/");
-	string path;
-	string mime_major;
-	string mime_minor;
-	if (pos != string::npos)
-	{
-		mime_major=name.substr(0,pos);	
-		mime_minor=name.substr(pos+1);
-		string ret;
-				if(conf->readonestring ("/OpenspaceConfig/file_types/"+ mime_major,ret)==false)
-				conf->addstring ("/OpenspaceConfig/file_types", mime_major,"");
-				
-				if(conf->readonestring ("/OpenspaceConfig/file_types/"+ mime_major+"/types",ret)==false)
-				conf->addstring ("/OpenspaceConfig/file_types/" + mime_major ,"types","");	
-		
-		if(conf->readonestring ("/OpenspaceConfig/file_types/"+ mime_major+"/types/"+mime_minor,ret)==false)
-				conf->addstring ("/OpenspaceConfig/file_types/" + mime_major+"/types" ,mime_minor,"");	
-		
-		path="/OpenspaceConfig/file_types/" + mime_major + "/types/"+mime_minor;
-		
-	
-
-			
-	}
-	else  // major mime type: audio,video,etc
-	{
-	string ret;
-	if(conf->readonestring ("/OpenspaceConfig/file_types/"+ name,ret)==false)
-			conf->addstring ("/OpenspaceConfig/file_types/" ,name,"");	
-	
-	path="/OpenspaceConfig/file_types/" + name;
-	}
-	
-	if(command!="")
-	{
-	  if(!conf->saveonestring (path+"/default",command))
-			{
-			conf->addstring(path ,"default",command);
-			}
-	}
-	else
-	{
-	conf->removestring (path+"/default");
-	}
-	
-		
-	
-	if(commands.size()>0)
-	{
-	conf->removestring(path+"/commands");
-	vector <string>::iterator iter;
-	conf->addstring(path,"commands","");
-		for(iter=commands.begin();iter!=commands.end();iter++)
-		{
-		conf->addstring(path+"/commands","command",iter->c_str());
-		}
-	
-	}
-	
-	if(!conf->saveonestring (path+"/color",color))
-			{
-			conf->addstring(path ,"color",color);
-			}
-	if(!conf->saveonestring (path+"/backcolor",backcolor))
-			{
-			conf->addstring(path ,"backcolor",backcolor);
-			}
-	if(icon!="")
-	{		
-	if(!conf->saveonestring (path+"/icon",icon))
-			{
-			conf->addstring(path ,"icon",icon);
-			}
-	}
-	else
-	{
-	conf->removestring (path+"/icon");
-	}
-
-}
-
-command_container::command_container(string name, string exec):name(name),exec(exec)
-{
-capture=false;
-rescan=false;
-}
-
-void command_container::save(void)
-{
-
-string com = name;
-string value = exec;
-	
-	
-	
-	
-	if(type!="INTERNAL" && type!="PLUGIN")
-	{
-	
-		if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/exec", value))
-		{
-		
-	   	 conf->addstring ("/OpenspaceConfig/commands", com, "");
-		 
-	   	    if(exec!="")
-		    { 
-	   	    conf->addstring ("/OpenspaceConfig/commands/" + com, "exec", value);
-		    }
-		}
-	}
-	else
-	{
-	if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/type", type))
-		{
-		conf->addstring ("/OpenspaceConfig/commands", com, "");
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "type", type);
-		}
-	}
-	
-	string options;
-	if (capture)
-	    options += " capture";
-	if (rescan)
-	    options += " rescan";
-
-	if (options != "")
-	{
-	    if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/options", options))
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "options", options);
-	}
-	else
-	conf->removestring ("/OpenspaceConfig/commands/" + com+ "/options");
-
-	if (text != "")
-	{
-	    if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/text", text))
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "text", text);
-	}
-	else
-	conf->removestring ("/OpenspaceConfig/commands/" + com+ "/text");
-
-	if (icon != "")
-	{
-	    if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/icon", icon))
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "icon", icon);
-	}
-	else
-	conf->removestring ("/OpenspaceConfig/commands/" + com+ "/icon");
-	
-	if (key != "")
-	{
-	    if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/key", key))
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "key", key);
-	}
-	else
-	conf->removestring ("/OpenspaceConfig/commands/" + com+ "/key");
-	
-	if (key_mask != "")
-	{
-	    if (!conf->saveonestring ("/OpenspaceConfig/commands/" + com + "/key_mask", key))
-		conf->addstring ("/OpenspaceConfig/commands/" + com, "key_mask", key);
-	}
-	else
-	conf->removestring ("/OpenspaceConfig/commands/" + com+ "/key_mask");
-
-}
-

Deleted: trunk/src/CommandsFileTypesContainers.h
===================================================================
--- trunk/src/CommandsFileTypesContainers.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/CommandsFileTypesContainers.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,48 +0,0 @@
-#ifndef CFTC_H
-#define CFTC_H
-
-#include <vector>
-#include <string>
-#include <map>
-using namespace std;
-
-
-
-class filetype_container
-{
-  public:
-    string name;
-    string command;
-    string icon;
-    vector <string> commands;
-    string color;
-    string backcolor;
-    filetype_container(string name,string command);
-    filetype_container(){}
-    void save(void);
-    bool load(string name);
-};
-
-class command_container
-{
-  public:
-    string name;
-    string exec;
-    bool rescan;
-    bool capture;
-    string text;
-    string type;
-    string icon;
-    string key;
-    string key_mask;
-    command_container(string name,string exec);
-    command_container(){}
-    void save(void);
-    
-
-};
-
-
-
-
-#endif

Deleted: trunk/src/FirstRun.cpp
===================================================================
--- trunk/src/FirstRun.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/FirstRun.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,68 +0,0 @@
-#include "fx.h"
-#include "FirstRun.h"
-#include "MimeApp.h"
-#include "preferences.h"
-
-using namespace std;
-
-FXDEFMAP (FirstRun) FirstRunMap[] =
-{
-    //________Message_Type_____________________ID____________Message_Handler_______  
-	FXMAPFUNCS (SEL_COMMAND, FirstRun::ID_CONF_MANUAL,FirstRun::ID_CONF_AUTOMATIC, FirstRun::onConfigure),
-};
-
-
-FXIMPLEMENT (FirstRun, FXDialogBox, FirstRunMap, ARRAYNUMBER (FirstRunMap)) FirstRun::FirstRun (FXWindow * owner):FXDialogBox (owner, "FirstRun", DECOR_ALL, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4)
-{
-
-
-    FXVerticalFrame *vertical = new FXVerticalFrame (this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X | LAYOUT_FILL_Y);    
-    
-    FXGroupBox *vv = new FXGroupBox (vertical, "", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0);
-    new FXLabel(vv,"Best for newbie and first run");	
-    FXButton *but3 = new FXButton (vv, "full automatic configuration", NULL, this,ID_CONF_AUTOMATIC);
-     	
-    vv = new FXGroupBox (vertical, "", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0);
-    new FXLabel(vv,"Choose which program will open given file type");	
-    FXButton *but2 = new FXButton (vv, "semiautomatic configuration", NULL, this,ID_CONF_SEMI);    
-    
-    vv = new FXGroupBox (vertical, "", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0);
-    new FXLabel(vv,"Not recomended - try better semi-auto configuration\n and then manual rather than only manual"); 
-    FXButton *but1 = new FXButton (vv, "manual configuration", NULL, this,ID_CONF_MANUAL);
-	
-	
-}
-
-
-
-FirstRun::~FirstRun ()
-{
-}
-
-
-
-long FirstRun::onConfigure(FXObject * sender, FXSelector sel, void *)
-{
-	FXushort id = FXSELID(sel);
-	if(id==ID_CONF_MANUAL)
-	{
-	preferences *prefer=new preferences(this);
-	prefer->create();
-	prefer->execute(PLACEMENT_OWNER);
-	}
-	else if(id==ID_CONF_SEMI)
-	{
-	MimeApp *mimeapp=new MimeApp(this);
-	mimeapp->create();
-	mimeapp->execute(PLACEMENT_OWNER);
-	}
-	else if(id==ID_CONF_AUTOMATIC)
-	{
-		MimeApp *mimeapp=new MimeApp(this);
-		mimeapp->doAutomaticConfiguration();
-	
-	}
-	FXMessageBox about (this, "restart", "restart openspace to apply changes", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-   	about.execute ();
-
-}

Deleted: trunk/src/FirstRun.h
===================================================================
--- trunk/src/FirstRun.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/FirstRun.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,37 +0,0 @@
-#ifndef FirstRun_H
-#define FirstRun_H
-
-
-#include <string>
-
-using namespace std;
-
-class FirstRun:public FXDialogBox
-{
-  FXDECLARE (FirstRun) protected:
-
-  private:
-    FirstRun ()
-    {
-    }
-
-  public:
-  
-  
-
-    enum
-    {
-	ID_CONF_MANUAL = FXDialogBox::ID_LAST,
-	ID_CONF_SEMI,
-	ID_CONF_AUTOMATIC,
-	ID_LAST,
-    };
-
-    FirstRun (FXWindow * owner);
- 
-    long FirstRun::onConfigure(FXObject * sender, FXSelector sel, void *);
-    
-    virtual ~ FirstRun ();
-};
-
-#endif

Copied: trunk/src/Makefile (from rev 245, branches/mloskot-style-refactoring/src/Makefile)
===================================================================
--- branches/mloskot-style-refactoring/src/Makefile	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/Makefile	2006-02-12 15:36:06 UTC (rev 246)
@@ -0,0 +1,634 @@
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
+# src/Makefile.  Generated from Makefile.in by configure.
+
+# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
+# 2003, 2004  Free Software Foundation, Inc.
+# This Makefile.in is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
+# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+# PARTICULAR PURPOSE.
+
+
+
+
+SOURCES = $(openspace_SOURCES)
+
+srcdir = .
+top_srcdir = ..
+
+pkgdatadir = $(datadir)/openspace
+pkglibdir = $(libdir)/openspace
+pkgincludedir = $(includedir)/openspace
+top_builddir = ..
+am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
+INSTALL = /bin/install -c
+install_sh_DATA = $(install_sh) -c -m 644
+install_sh_PROGRAM = $(install_sh) -c
+install_sh_SCRIPT = $(install_sh) -c
+INSTALL_HEADER = $(INSTALL_DATA)
+transform = $(program_transform_name)
+NORMAL_INSTALL = :
+PRE_INSTALL = :
+POST_INSTALL = :
+NORMAL_UNINSTALL = :
+PRE_UNINSTALL = :
+POST_UNINSTALL = :
+host_triplet = i686-pc-linux-gnu
+bin_PROGRAMS = openspace$(EXEEXT)
+subdir = src
+DIST_COMMON = $(noinst_HEADERS) $(srcdir)/Makefile.am \
+	$(srcdir)/Makefile.in $(srcdir)/config.h.in
+ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
+am__aclocal_m4_deps = $(top_srcdir)/configure.ac
+am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
+	$(ACLOCAL_M4)
+mkinstalldirs = $(mkdir_p)
+CONFIG_HEADER = config.h
+CONFIG_CLEAN_FILES =
+am__installdirs = "$(DESTDIR)$(bindir)"
+binPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
+PROGRAMS = $(bin_PROGRAMS)
+am_openspace_OBJECTS = main.$(OBJEXT) OSCMDDialogBox.$(OBJEXT) \
+	OSCommandTypeInfo.$(OBJEXT) OSConfigure.$(OBJEXT) \
+	OSFileList.$(OBJEXT) OSFileListItem.$(OBJEXT) \
+	OSFileTypeInfo.$(OBJEXT) OSFileTypeSymbol.$(OBJEXT) \
+	OSFirstRunDialogBox.$(OBJEXT) OSInfoPanel.$(OBJEXT) \
+	OSMainWindow.$(OBJEXT) OSMimeApp.$(OBJEXT) \
+	OSMimeType.$(OBJEXT) OSObjectManager.$(OBJEXT) \
+	OSPathType.$(OBJEXT) OSPreferences.$(OBJEXT) \
+	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT)
+openspace_OBJECTS = $(am_openspace_OBJECTS)
+openspace_LDADD = $(LDADD)
+DEFAULT_INCLUDES = -I. -I$(srcdir) -I.
+depcomp = $(SHELL) $(top_srcdir)/depcomp
+am__depfiles_maybe = depfiles
+DEP_FILES = ./$(DEPDIR)/OSCMDDialogBox.Po \
+	./$(DEPDIR)/OSCommandTypeInfo.Po \
+	./$(DEPDIR)/OSConfigure.Po \
+	./$(DEPDIR)/OSFileList.Po \
+	./$(DEPDIR)/OSFileListItem.Po \
+	./$(DEPDIR)/OSFileTypeInfo.Po \
+	./$(DEPDIR)/OSFileTypeSymbol.Po \
+	./$(DEPDIR)/OSFirstRunDialogBox.Po \
+	./$(DEPDIR)/OSInfoPanel.Po \
+	./$(DEPDIR)/OSMainWindow.Po \
+	./$(DEPDIR)/OSMimeApp.Po ./$(DEPDIR)/OSMimeType.Po \
+	./$(DEPDIR)/OSObjectManager.Po \
+	./$(DEPDIR)/OSPathType.Po \
+	./$(DEPDIR)/OSPreferences.Po \
+	./$(DEPDIR)/OSShutter.Po \
+	./$(DEPDIR)/OSThreadExec.Po ./$(DEPDIR)/OSUtils.Po \
+	./$(DEPDIR)/main.Po
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
+	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CFLAGS) $(CFLAGS)
+CCLD = $(CC)
+LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(openspace_SOURCES)
+DIST_SOURCES = $(openspace_SOURCES)
+RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
+	html-recursive info-recursive install-data-recursive \
+	install-exec-recursive install-info-recursive \
+	install-recursive installcheck-recursive installdirs-recursive \
+	pdf-recursive ps-recursive uninstall-info-recursive \
+	uninstall-recursive
+HEADERS = $(noinst_HEADERS)
+ETAGS = etags
+CTAGS = ctags
+DIST_SUBDIRS = $(SUBDIRS)
+DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+ACLOCAL = ${SHELL} /root/opentrunk2/missing --run aclocal-1.8
+AMDEP_FALSE = #
+AMDEP_TRUE = 
+AMTAR = ${SHELL} /root/opentrunk2/missing --run tar
+AR = ar
+AUTOCONF = ${SHELL} /root/opentrunk2/missing --run autoconf
+AUTOHEADER = ${SHELL} /root/opentrunk2/missing --run autoheader
+AUTOMAKE = ${SHELL} /root/opentrunk2/missing --run automake-1.8
+AWK = gawk
+CC = gcc
+CCDEPMODE = depmode=gcc3
+CFLAGS = -g -O2
+CPP = gcc -E
+CPPFLAGS = 
+CXX = g++
+CXXCPP = g++ -E
+CXXDEPMODE = depmode=gcc3
+CXXFLAGS = -g -O2
+CYGPATH_W = echo
+DEFS = -DHAVE_CONFIG_H
+DEPDIR = .deps
+ECHO = echo
+ECHO_C = 
+ECHO_N = -n
+ECHO_T = 
+EGREP = grep -E
+EXEEXT = 
+F77 = 
+FFLAGS = 
+FOX_CONFIG = yes
+INSTALL_DATA = ${INSTALL} -m 644
+INSTALL_PROGRAM = ${INSTALL}
+INSTALL_SCRIPT = ${INSTALL}
+INSTALL_STRIP_PROGRAM = ${SHELL} $(install_sh) -c -s
+LDFLAGS = 
+LIBOBJS = 
+LIBS = -lFOX-1.4 
+LIBTOOL = $(SHELL) $(top_builddir)/libtool
+LN_S = ln -s
+LTLIBOBJS = 
+MAKEINFO = ${SHELL} /root/opentrunk2/missing --run makeinfo
+OBJEXT = o
+PACKAGE = openspace
+PACKAGE_BUGREPORT = http://openspace.linux.pl
+PACKAGE_NAME = openspace
+PACKAGE_STRING = openspace 0.2.0
+PACKAGE_TARNAME = openspace
+PACKAGE_VERSION = 0.2.0
+PATH_SEPARATOR = :
+RANLIB = ranlib
+SET_MAKE = 
+SHELL = /bin/sh
+STRIP = strip
+VERSION = 0.2.0
+XML2_CONFIG = yes
+ac_ct_AR = ar
+ac_ct_CC = gcc
+ac_ct_CXX = g++
+ac_ct_F77 = 
+ac_ct_RANLIB = ranlib
+ac_ct_STRIP = strip
+am__fastdepCC_FALSE = #
+am__fastdepCC_TRUE = 
+am__fastdepCXX_FALSE = #
+am__fastdepCXX_TRUE = 
+am__include = include
+am__leading_dot = .
+am__quote = 
+bindir = ${exec_prefix}/bin
+build = i686-pc-linux-gnu
+build_alias = 
+build_cpu = i686
+build_os = linux-gnu
+build_vendor = pc
+datadir = ${prefix}/share
+exec_prefix = ${prefix}
+host = i686-pc-linux-gnu
+host_alias = 
+host_cpu = i686
+host_os = linux-gnu
+host_vendor = pc
+includedir = ${prefix}/include
+infodir = ${prefix}/info
+install_sh = /root/opentrunk2/install-sh
+libdir = ${exec_prefix}/lib
+libexecdir = ${exec_prefix}/libexec
+localstatedir = ${prefix}/var
+mandir = ${prefix}/man
+mkdir_p = mkdir -p -- .
+oldincludedir = /usr/include
+prefix = /usr
+program_transform_name = s,x,x,
+sbindir = ${exec_prefix}/sbin
+sharedstatedir = ${prefix}/com
+sysconfdir = /etc
+target_alias = 
+openspace_SOURCES = main.cpp OSCMDDialogBox.cpp OSCMDDialogBox.h \
+	OSCommandTypeInfo.cpp OSCommandTypeInfo.h OSConfigure.cpp OSConfigure.h OSFile.h \
+	OSFileList.cpp OSFileList.h OSFileListItem.cpp OSFileListItem.h OSFileTypeInfo.cpp \
+	OSFileTypeInfo.h OSFileTypeSymbol.cpp OSFileTypeSymbol.h OSFirstRunDialogBox.cpp \
+	OSFirstRunDialogBox.h OSInfoPanel.cpp OSInfoPanel.h OSMainWindow.cpp OSMainWindow.h \
+	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
+	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
+	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
+
+SUBDIRS = plugins
+INCLUDES = -I$(top_srcdir)/src `WANT_FOX="1.4" fox-config --cflags`  `xml2-config  --cflags`  \
+	-DPATH_CFG=\"$(sysconfdir)\" \
+	-DPATH_LIBDIR=\"$(libdir)\"
+
+openspace_LDFLAGS = `WANT_FOX="1.4" fox-config --libs`  `xml2-config  --libs`  
+noinst_HEADERS = OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFileTypeInfo.h
+
+all: config.h
+	$(MAKE) $(AM_MAKEFLAGS) all-recursive
+
+.SUFFIXES:
+.SUFFIXES: .cpp .lo .o .obj
+$(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
+	@for dep in $?; do \
+	  case '$(am__configure_deps)' in \
+	    *$$dep*) \
+	      cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh \
+		&& exit 0; \
+	      exit 1;; \
+	  esac; \
+	done; \
+	echo ' cd $(top_srcdir) && $(AUTOMAKE) --gnu  src/Makefile'; \
+	cd $(top_srcdir) && \
+	  $(AUTOMAKE) --gnu  src/Makefile
+.PRECIOUS: Makefile
+Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
+	@case '$?' in \
+	  *config.status*) \
+	    cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh;; \
+	  *) \
+	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe)'; \
+	    cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe);; \
+	esac;
+
+$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+
+$(top_srcdir)/configure:  $(am__configure_deps)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+$(ACLOCAL_M4):  $(am__aclocal_m4_deps)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+
+config.h: stamp-h1
+	@if test ! -f $@; then \
+	  rm -f stamp-h1; \
+	  $(MAKE) stamp-h1; \
+	else :; fi
+
+stamp-h1: $(srcdir)/config.h.in $(top_builddir)/config.status
+	@rm -f stamp-h1
+	cd $(top_builddir) && $(SHELL) ./config.status src/config.h
+$(srcdir)/config.h.in:  $(am__configure_deps) 
+	cd $(top_srcdir) && $(AUTOHEADER)
+	rm -f stamp-h1
+	touch $@
+
+distclean-hdr:
+	-rm -f config.h stamp-h1
+install-binPROGRAMS: $(bin_PROGRAMS)
+	@$(NORMAL_INSTALL)
+	test -z "$(bindir)" || $(mkdir_p) "$(DESTDIR)$(bindir)"
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  p1=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  if test -f $$p \
+	     || test -f $$p1 \
+	  ; then \
+	    f=`echo "$$p1" | sed 's,^.*/,,;$(transform);s/$$/$(EXEEXT)/'`; \
+	   echo " $(INSTALL_PROGRAM_ENV) $(LIBTOOL) --mode=install $(binPROGRAMS_INSTALL) '$$p' '$(DESTDIR)$(bindir)/$$f'"; \
+	   $(INSTALL_PROGRAM_ENV) $(LIBTOOL) --mode=install $(binPROGRAMS_INSTALL) "$$p" "$(DESTDIR)$(bindir)/$$f" || exit 1; \
+	  else :; fi; \
+	done
+
+uninstall-binPROGRAMS:
+	@$(NORMAL_UNINSTALL)
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  f=`echo "$$p" | sed 's,^.*/,,;s/$(EXEEXT)$$//;$(transform);s/$$/$(EXEEXT)/'`; \
+	  echo " rm -f '$(DESTDIR)$(bindir)/$$f'"; \
+	  rm -f "$(DESTDIR)$(bindir)/$$f"; \
+	done
+
+clean-binPROGRAMS:
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  echo " rm -f $$p $$f"; \
+	  rm -f $$p $$f ; \
+	done
+openspace$(EXEEXT): $(openspace_OBJECTS) $(openspace_DEPENDENCIES) 
+	@rm -f openspace$(EXEEXT)
+	$(CXXLINK) $(openspace_LDFLAGS) $(openspace_OBJECTS) $(openspace_LDADD) $(LIBS)
+
+mostlyclean-compile:
+	-rm -f *.$(OBJEXT)
+
+distclean-compile:
+	-rm -f *.tab.c
+
+include ./$(DEPDIR)/OSCMDDialogBox.Po
+include ./$(DEPDIR)/OSCommandTypeInfo.Po
+include ./$(DEPDIR)/OSConfigure.Po
+include ./$(DEPDIR)/OSFileList.Po
+include ./$(DEPDIR)/OSFileListItem.Po
+include ./$(DEPDIR)/OSFileTypeInfo.Po
+include ./$(DEPDIR)/OSFileTypeSymbol.Po
+include ./$(DEPDIR)/OSFirstRunDialogBox.Po
+include ./$(DEPDIR)/OSInfoPanel.Po
+include ./$(DEPDIR)/OSMainWindow.Po
+include ./$(DEPDIR)/OSMimeApp.Po
+include ./$(DEPDIR)/OSMimeType.Po
+include ./$(DEPDIR)/OSObjectManager.Po
+include ./$(DEPDIR)/OSPathType.Po
+include ./$(DEPDIR)/OSPreferences.Po
+include ./$(DEPDIR)/OSShutter.Po
+include ./$(DEPDIR)/OSThreadExec.Po
+include ./$(DEPDIR)/OSUtils.Po
+include ./$(DEPDIR)/main.Po
+
+.cpp.o:
+	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+#	source='$<' object='$@' libtool=no \
+#	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' \
+#	$(CXXDEPMODE) $(depcomp) \
+#	$(CXXCOMPILE) -c -o $@ $<
+
+.cpp.obj:
+	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+#	source='$<' object='$@' libtool=no \
+#	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' \
+#	$(CXXDEPMODE) $(depcomp) \
+#	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.cpp.lo:
+	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+#	source='$<' object='$@' libtool=yes \
+#	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' \
+#	$(CXXDEPMODE) $(depcomp) \
+#	$(LTCXXCOMPILE) -c -o $@ $<
+
+mostlyclean-libtool:
+	-rm -f *.lo
+
+clean-libtool:
+	-rm -rf .libs _libs
+
+distclean-libtool:
+	-rm -f libtool
+uninstall-info-am:
+
+# This directory's subdirectories are mostly independent; you can cd
+# into them and run `make' without going through this Makefile.
+# To change the values of `make' variables: instead of editing Makefiles,
+# (1) if the variable is set in `config.status', edit `config.status'
+#     (which will cause the Makefiles to be regenerated when you run `make');
+# (2) otherwise, pass the desired values on the `make' command line.
+$(RECURSIVE_TARGETS):
+	@set fnord $$MAKEFLAGS; amf=$$2; \
+	dot_seen=no; \
+	target=`echo $@ | sed s/-recursive//`; \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
+	  echo "Making $$target in $$subdir"; \
+	  if test "$$subdir" = "."; then \
+	    dot_seen=yes; \
+	    local_target="$$target-am"; \
+	  else \
+	    local_target="$$target"; \
+	  fi; \
+	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
+	done; \
+	if test "$$dot_seen" = "no"; then \
+	  $(MAKE) $(AM_MAKEFLAGS) "$$target-am" || exit 1; \
+	fi; test -z "$$fail"
+
+mostlyclean-recursive clean-recursive distclean-recursive \
+maintainer-clean-recursive:
+	@set fnord $$MAKEFLAGS; amf=$$2; \
+	dot_seen=no; \
+	case "$@" in \
+	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
+	  *) list='$(SUBDIRS)' ;; \
+	esac; \
+	rev=''; for subdir in $$list; do \
+	  if test "$$subdir" = "."; then :; else \
+	    rev="$$subdir $$rev"; \
+	  fi; \
+	done; \
+	rev="$$rev ."; \
+	target=`echo $@ | sed s/-recursive//`; \
+	for subdir in $$rev; do \
+	  echo "Making $$target in $$subdir"; \
+	  if test "$$subdir" = "."; then \
+	    local_target="$$target-am"; \
+	  else \
+	    local_target="$$target"; \
+	  fi; \
+	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
+	done && test -z "$$fail"
+tags-recursive:
+	list='$(SUBDIRS)'; for subdir in $$list; do \
+	  test "$$subdir" = . || (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) tags); \
+	done
+ctags-recursive:
+	list='$(SUBDIRS)'; for subdir in $$list; do \
+	  test "$$subdir" = . || (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) ctags); \
+	done
+
+ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
+	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	mkid -fID $$unique
+tags: TAGS
+
+TAGS: tags-recursive $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	if ($(ETAGS) --etags-include --version) >/dev/null 2>&1; then \
+	  include_option=--etags-include; \
+	  empty_fix=.; \
+	else \
+	  include_option=--include; \
+	  empty_fix=; \
+	fi; \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
+	  if test "$$subdir" = .; then :; else \
+	    test ! -f $$subdir/TAGS || \
+	      tags="$$tags $$include_option=$$here/$$subdir/TAGS"; \
+	  fi; \
+	done; \
+	list='$(SOURCES) $(HEADERS) config.h.in $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
+	  test -n "$$unique" || unique=$$empty_fix; \
+	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
+	    $$tags $$unique; \
+	fi
+ctags: CTAGS
+CTAGS: ctags-recursive $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	list='$(SOURCES) $(HEADERS) config.h.in $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	test -z "$(CTAGS_ARGS)$$tags$$unique" \
+	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
+	     $$tags $$unique
+
+GTAGS:
+	here=`$(am__cd) $(top_builddir) && pwd` \
+	  && cd $(top_srcdir) \
+	  && gtags -i $(GTAGS_ARGS) $$here
+
+distclean-tags:
+	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
+
+distdir: $(DISTFILES)
+	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
+	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
+	list='$(DISTFILES)'; for file in $$list; do \
+	  case $$file in \
+	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
+	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
+	  esac; \
+	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
+	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
+	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
+	    dir="/$$dir"; \
+	    $(mkdir_p) "$(distdir)$$dir"; \
+	  else \
+	    dir=''; \
+	  fi; \
+	  if test -d $$d/$$file; then \
+	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
+	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
+	    fi; \
+	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
+	  else \
+	    test -f $(distdir)/$$file \
+	    || cp -p $$d/$$file $(distdir)/$$file \
+	    || exit 1; \
+	  fi; \
+	done
+	list='$(SUBDIRS)'; for subdir in $$list; do \
+	  if test "$$subdir" = .; then :; else \
+	    test -d "$(distdir)/$$subdir" \
+	    || mkdir "$(distdir)/$$subdir" \
+	    || exit 1; \
+	    (cd $$subdir && \
+	      $(MAKE) $(AM_MAKEFLAGS) \
+	        top_distdir="../$(top_distdir)" \
+	        distdir="../$(distdir)/$$subdir" \
+	        distdir) \
+	      || exit 1; \
+	  fi; \
+	done
+check-am: all-am
+check: check-recursive
+all-am: Makefile $(PROGRAMS) $(HEADERS) config.h
+installdirs: installdirs-recursive
+installdirs-am:
+	for dir in "$(DESTDIR)$(bindir)"; do \
+	  test -z "$$dir" || $(mkdir_p) "$$dir"; \
+	done
+install: install-recursive
+install-exec: install-exec-recursive
+install-data: install-data-recursive
+uninstall: uninstall-recursive
+
+install-am: all-am
+	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am
+
+installcheck: installcheck-recursive
+install-strip:
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
+	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
+	  `test -z '$(STRIP)' || \
+	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
+mostlyclean-generic:
+
+clean-generic:
+
+distclean-generic:
+	-rm -f $(CONFIG_CLEAN_FILES)
+
+maintainer-clean-generic:
+	@echo "This command is intended for maintainers to use"
+	@echo "it deletes files that may require special tools to rebuild."
+clean: clean-recursive
+
+clean-am: clean-binPROGRAMS clean-generic clean-libtool mostlyclean-am
+
+distclean: distclean-recursive
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+distclean-am: clean-am distclean-compile distclean-generic \
+	distclean-hdr distclean-libtool distclean-tags
+
+dvi: dvi-recursive
+
+dvi-am:
+
+html: html-recursive
+
+info: info-recursive
+
+info-am:
+
+install-data-am:
+
+install-exec-am: install-binPROGRAMS
+
+install-info: install-info-recursive
+
+install-man:
+
+installcheck-am:
+
+maintainer-clean: maintainer-clean-recursive
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+maintainer-clean-am: distclean-am maintainer-clean-generic
+
+mostlyclean: mostlyclean-recursive
+
+mostlyclean-am: mostlyclean-compile mostlyclean-generic \
+	mostlyclean-libtool
+
+pdf: pdf-recursive
+
+pdf-am:
+
+ps: ps-recursive
+
+ps-am:
+
+uninstall-am: uninstall-binPROGRAMS uninstall-info-am
+
+uninstall-info: uninstall-info-recursive
+
+.PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am check check-am \
+	clean clean-binPROGRAMS clean-generic clean-libtool \
+	clean-recursive ctags ctags-recursive distclean \
+	distclean-compile distclean-generic distclean-hdr \
+	distclean-libtool distclean-recursive distclean-tags distdir \
+	dvi dvi-am html html-am info info-am install install-am \
+	install-binPROGRAMS install-data install-data-am install-exec \
+	install-exec-am install-info install-info-am install-man \
+	install-strip installcheck installcheck-am installdirs \
+	installdirs-am maintainer-clean maintainer-clean-generic \
+	maintainer-clean-recursive mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool mostlyclean-recursive \
+	pdf pdf-am ps ps-am tags tags-recursive uninstall uninstall-am \
+	uninstall-binPROGRAMS uninstall-info-am
+
+# Tell versions [3.59,3.63) of GNU make to not export all variables.
+# Otherwise a system limit (for SysV at least) may be exceeded.
+.NOEXPORT:

Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/Makefile.am	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,42 +1,14 @@
 bin_PROGRAMS = openspace
 
-openspace_SOURCES = cmddialog.cpp \
-	filetype.cpp \
-	openspace.cpp \
-	preferences.cpp \
-	configure.cpp \
-	informationpanel.cpp \
-	oslistitem.cpp \
-	shutter.cpp \
-	filelist.cpp \
-	mainwindow.cpp \
-	pathtype.cpp \
-	thread_elem.cpp \
-	cmddialog.h \
-	filetype.h \
-	oslistitem.h \
-	shutter.h \
-	configure.h \
-	informationpanel.h \
-	pathtype.h \
-	thread_elem.h \
-	filelist_base.h \
-	mainwindow.h \
-	preferences.h \
-	filelist.h \
-	osfile.h \
-	sharedobjects.h \
-	sharedobjects.cpp \
-	MimeType.h \
-	MimeType.cpp \
-	MimeApp.h \
-	MimeApp.cpp \
-	FirstRun.cpp \
-	FirstRun.h \
-	CommandsFileTypesContainers.h \
-	CommandsFileTypesContainers.cpp \
-	sharedFunctions.h \
-	sharedFunctions.cpp
+openspace_SOURCES = main.cpp OSCMDDialogBox.cpp OSCMDDialogBox.h \
+	OSCommandTypeInfo.cpp OSCommandTypeInfo.h OSConfigure.cpp OSConfigure.h OSFile.h \
+	OSFileList.cpp OSFileList.h OSFileListItem.cpp OSFileListItem.h OSFileTypeInfo.cpp \
+	OSFileTypeInfo.h OSFileTypeSymbol.cpp OSFileTypeSymbol.h OSFirstRunDialogBox.cpp \
+	OSFirstRunDialogBox.h OSInfoPanel.cpp OSInfoPanel.h OSMainWindow.cpp OSMainWindow.h \
+	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
+	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
+	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
 
 SUBDIRS = plugins
 
@@ -46,3 +18,5 @@
 
 openspace_LDFLAGS = `WANT_FOX="1.4" fox-config --libs`  `xml2-config  --libs`  
 
+noinst_HEADERS = OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFileTypeInfo.h


Property changes on: trunk/src/Makefile.am
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/Makefile.in
===================================================================
--- trunk/src/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -14,6 +14,7 @@
 
 @SET_MAKE@
 
+
 SOURCES = $(openspace_SOURCES)
 
 srcdir = @srcdir@
@@ -36,50 +37,67 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 bin_PROGRAMS = openspace$(EXEEXT)
 subdir = src
-DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(srcdir)/config.h.in
+DIST_COMMON = $(noinst_HEADERS) $(srcdir)/Makefile.am \
+	$(srcdir)/Makefile.in $(srcdir)/config.h.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = config.h
 CONFIG_CLEAN_FILES =
 am__installdirs = "$(DESTDIR)$(bindir)"
 binPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
 PROGRAMS = $(bin_PROGRAMS)
-am_openspace_OBJECTS = cmddialog.$(OBJEXT) filetype.$(OBJEXT) \
-	openspace.$(OBJEXT) preferences.$(OBJEXT) configure.$(OBJEXT) \
-	informationpanel.$(OBJEXT) oslistitem.$(OBJEXT) \
-	shutter.$(OBJEXT) filelist.$(OBJEXT) mainwindow.$(OBJEXT) \
-	pathtype.$(OBJEXT) thread_elem.$(OBJEXT) \
-	sharedobjects.$(OBJEXT) MimeType.$(OBJEXT) MimeApp.$(OBJEXT) \
-	FirstRun.$(OBJEXT) CommandsFileTypesContainers.$(OBJEXT) \
-	sharedFunctions.$(OBJEXT)
+am_openspace_OBJECTS = main.$(OBJEXT) OSCMDDialogBox.$(OBJEXT) \
+	OSCommandTypeInfo.$(OBJEXT) OSConfigure.$(OBJEXT) \
+	OSFileList.$(OBJEXT) OSFileListItem.$(OBJEXT) \
+	OSFileTypeInfo.$(OBJEXT) OSFileTypeSymbol.$(OBJEXT) \
+	OSFirstRunDialogBox.$(OBJEXT) OSInfoPanel.$(OBJEXT) \
+	OSMainWindow.$(OBJEXT) OSMimeApp.$(OBJEXT) \
+	OSMimeType.$(OBJEXT) OSObjectManager.$(OBJEXT) \
+	OSPathType.$(OBJEXT) OSPreferences.$(OBJEXT) \
+	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT)
 openspace_OBJECTS = $(am_openspace_OBJECTS)
 openspace_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I.
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
+ at AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/OSCMDDialogBox.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSCommandTypeInfo.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSConfigure.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFileList.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFileListItem.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFileTypeInfo.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFileTypeSymbol.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFirstRunDialogBox.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSInfoPanel.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSMainWindow.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSMimeApp.Po ./$(DEPDIR)/OSMimeType.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSObjectManager.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSPathType.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSPreferences.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSShutter.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Po ./$(DEPDIR)/OSUtils.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/main.Po
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CXXFLAGS) $(CXXFLAGS)
 CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
+LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
-LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
+LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(openspace_SOURCES)
 DIST_SOURCES = $(openspace_SOURCES)
@@ -89,6 +107,7 @@
 	install-recursive installcheck-recursive installdirs-recursive \
 	pdf-recursive ps-recursive uninstall-info-recursive \
 	uninstall-recursive
+HEADERS = $(noinst_HEADERS)
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
@@ -161,8 +180,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -191,43 +208,15 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-openspace_SOURCES = cmddialog.cpp \
-	filetype.cpp \
-	openspace.cpp \
-	preferences.cpp \
-	configure.cpp \
-	informationpanel.cpp \
-	oslistitem.cpp \
-	shutter.cpp \
-	filelist.cpp \
-	mainwindow.cpp \
-	pathtype.cpp \
-	thread_elem.cpp \
-	cmddialog.h \
-	filetype.h \
-	oslistitem.h \
-	shutter.h \
-	configure.h \
-	informationpanel.h \
-	pathtype.h \
-	thread_elem.h \
-	filelist_base.h \
-	mainwindow.h \
-	preferences.h \
-	filelist.h \
-	osfile.h \
-	sharedobjects.h \
-	sharedobjects.cpp \
-	MimeType.h \
-	MimeType.cpp \
-	MimeApp.h \
-	MimeApp.cpp \
-	FirstRun.cpp \
-	FirstRun.h \
-	CommandsFileTypesContainers.h \
-	CommandsFileTypesContainers.cpp \
-	sharedFunctions.h \
-	sharedFunctions.cpp
+openspace_SOURCES = main.cpp OSCMDDialogBox.cpp OSCMDDialogBox.h \
+	OSCommandTypeInfo.cpp OSCommandTypeInfo.h OSConfigure.cpp OSConfigure.h OSFile.h \
+	OSFileList.cpp OSFileList.h OSFileListItem.cpp OSFileListItem.h OSFileTypeInfo.cpp \
+	OSFileTypeInfo.h OSFileTypeSymbol.cpp OSFileTypeSymbol.h OSFirstRunDialogBox.cpp \
+	OSFirstRunDialogBox.h OSInfoPanel.cpp OSInfoPanel.h OSMainWindow.cpp OSMainWindow.h \
+	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
+	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
+	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
 
 SUBDIRS = plugins
 INCLUDES = -I$(top_srcdir)/src `WANT_FOX="1.4" fox-config --cflags`  `xml2-config  --cflags`  \
@@ -235,6 +224,9 @@
 	-DPATH_LIBDIR=\"$(libdir)\"
 
 openspace_LDFLAGS = `WANT_FOX="1.4" fox-config --libs`  `xml2-config  --libs`  
+noinst_HEADERS = OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFileTypeInfo.h
+
 all: config.h
 	$(MAKE) $(AM_MAKEFLAGS) all-recursive
 
@@ -324,44 +316,48 @@
 distclean-compile:
 	-rm -f *.tab.c
 
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/CommandsFileTypesContainers.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/FirstRun.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/MimeApp.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/MimeType.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/cmddialog.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/configure.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filetype.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/informationpanel.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/mainwindow.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/openspace.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/oslistitem.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/pathtype.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/preferences.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/sharedFunctions.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/sharedobjects.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/shutter.Po at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/thread_elem.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCMDDialogBox.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCommandTypeInfo.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSConfigure.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileList.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileListItem.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileTypeInfo.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileTypeSymbol.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFirstRunDialogBox.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSInfoPanel.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMainWindow.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMimeApp.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMimeType.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSObjectManager.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSPathType.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSPreferences.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSShutter.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSUtils.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/main.Po at am__quote@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ $<
 
 .cpp.obj:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
 
 .cpp.lo:
 @am__fastdepCXX_TRUE@	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LTCXXCOMPILE) -c -o $@ $<
 
 mostlyclean-libtool:
@@ -381,13 +377,7 @@
 #     (which will cause the Makefiles to be regenerated when you run `make');
 # (2) otherwise, pass the desired values on the `make' command line.
 $(RECURSIVE_TARGETS):
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	target=`echo $@ | sed s/-recursive//`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -399,7 +389,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done; \
 	if test "$$dot_seen" = "no"; then \
 	  $(MAKE) $(AM_MAKEFLAGS) "$$target-am" || exit 1; \
@@ -407,13 +397,7 @@
 
 mostlyclean-recursive clean-recursive distclean-recursive \
 maintainer-clean-recursive:
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	case "$@" in \
 	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
@@ -434,7 +418,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done && test -z "$$fail"
 tags-recursive:
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -533,24 +517,22 @@
 	    || exit 1; \
 	  fi; \
 	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
 	  if test "$$subdir" = .; then :; else \
 	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
+	    || mkdir "$(distdir)/$$subdir" \
 	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
 	    (cd $$subdir && \
 	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
+	        top_distdir="../$(top_distdir)" \
+	        distdir="../$(distdir)/$$subdir" \
 	        distdir) \
 	      || exit 1; \
 	  fi; \
 	done
 check-am: all-am
 check: check-recursive
-all-am: Makefile $(PROGRAMS) config.h
+all-am: Makefile $(PROGRAMS) $(HEADERS) config.h
 installdirs: installdirs-recursive
 installdirs-am:
 	for dir in "$(DESTDIR)$(bindir)"; do \
@@ -575,7 +557,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"


Property changes on: trunk/src/Makefile.in
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/MimeApp.cpp
===================================================================
--- trunk/src/MimeApp.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/MimeApp.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,198 +0,0 @@
-#include "fx.h"
-#include "MimeApp.h"
-#include "sharedobjects.h"
-#include "sharedFunctions.h"
-
-#include "CommandsFileTypesContainers.h"
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-#ifndef PATH_CFG
-#define PATH_CFG        "/usr/local/etc/"
-#endif
-
-using namespace std;
-
-FXDEFMAP (MimeApp) MimeAppMap[] =
-{
-    //________Message_Type_____________________ID____________Message_Handler_______  
-	FXMAPFUNCS (SEL_COMMAND, MimeApp::ID_NEXT,MimeApp::ID_PREVIOUS, MimeApp::onNextPrevious),
-	FXMAPFUNC (SEL_CLOSE,0, MimeApp::onClose),
-};
-
-
-FXIMPLEMENT (MimeApp, FXDialogBox, MimeAppMap, ARRAYNUMBER (MimeAppMap)) MimeApp::MimeApp (FXWindow * owner):FXDialogBox (owner, "MimeApp", DECOR_TITLE | DECOR_BORDER | DECOR_RESIZE, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4)
-{
-
-
-    FXVerticalFrame *vertical = new FXVerticalFrame (this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    
-    mime_label=new FXLabel(vertical,"");
-    programsbox= new FXComboBox (vertical, 20, NULL, 0, FRAME_THICK | LAYOUT_SIDE_TOP | COMBOBOX_STATIC);
-    programsbox->setNumVisible(10);
-    
-    FXHorizontalFrame *hori = new FXHorizontalFrame (vertical, LAYOUT_SIDE_TOP | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXButton *but1 = new FXButton (hori, "PREVIOUS", NULL, this,ID_PREVIOUS);
-    FXButton *but3 = new FXButton (hori, "NEXT", NULL, this,ID_NEXT);
-
- string file = string(PATH_CFG) + string(SEPARATOR) + string("mimeapp");
- ifstream ifs (file.c_str(), ios::in);
-
-    while (!ifs.eof ())
-    {
-	string tmp;
-	getline (ifs, tmp);
-
-	if (tmp == "" || tmp[0] == '#')
-	    continue;
-	mime_vector.push_back(mime2xml(tmp));
-    }
-    ifs.close ();
- iter = mime_vector.begin ();
- fill(*iter);
-
-}
-
-
-long MimeApp::onClose (FXObject * sender, FXSelector sel, void *ptr)
-{
-string program=programsbox->getText().text();
-string mime=mime_label->getText().text();	
-save(mime,program);
-
-FXDialogBox::onCmdAccept(sender,sel,ptr);
-
-}
-
-
-MimeApp::~MimeApp ()
-{
-}
-
-void MimeApp::doAutomaticConfiguration(void)
-{
-vector <string>::iterator iter;
-			
-		for (iter=mime_vector.begin(); iter != mime_vector.end(); iter++)
-    		{
-			fill(*iter);
-			save(mime_label->getText().text(),programsbox->getText().text());
-		}
-	
-
-}
-
-long MimeApp::onNextPrevious(FXObject * sender, FXSelector sel, void *)
-{
-
-	FXushort id = FXSELID(sel);
-
-	if(id==ID_NEXT && iter+1 != mime_vector.end())
-	{
-	iter++;
-	}
-	else if(id==ID_PREVIOUS && iter != mime_vector.begin())
-	{
-		iter--;
-	}
-	
-	string program=programsbox->getText().text();
-	string mime=mime_label->getText().text();	
-	save(mime,program);
-	
-	
-	fill(*iter);
-
-
-}
-void MimeApp::fill(string tmp)
-{
-	string mime, program;
-	mime = tmp.substr (0, tmp.rfind (":"));
-	program = tmp.substr (tmp.rfind (":") + 1);
-
-	mime_label->setText(mime.c_str());
-	
-	programsbox->clearItems();
-	
-	std::stringstream parser (program);
-	string prog;
-	while(parser >> prog)
-	{
-	
-	string command="which " + prog + " >/dev/null 2>/dev/null";
-		if(system(command.c_str())==0)
-		{
-		programsbox->appendItem(prog.c_str());
-		}
-
-	
-	}
-	programsbox->appendItem("");
-
-
-}
-
-void MimeApp::save(string mime, string program)
-{
-
-if(program=="")
-return;
-
-	string::size_type pos=mime.find("/");
-	
-	string mime_major;
-	string mime_minor;
-	string command_name="open_";
-	string command_exec=program + " {f}" ;
-	
-	string reg2;
-	
-	if (pos != string::npos)
-	{
-		mime_major=mime.substr(0,pos);	
-		mime_minor=mime.substr(pos+1);
-			
-		command_name+=mime_major+"_"+mime_minor;
-	
-		reg2 = conf->readonestring ("/OpenspaceConfig/file_types/" + mime_major + "/default");
-		string command_major = conf->readonestring ("/OpenspaceConfig/commands/" + reg2 + "/exec");
-		
-		if(reg2=="" || (command_major!=command_exec && reg2!=command_name))
-		{
-		filetype_container ct=filetype_container();
-		ct.load(mime);
-		ct.command=command_name;
-		ct.save();	
-			
-		}
-		else
-		return;
-	}
-	else // major mime type: audio,video,etc
-	{
-		command_name+=mime;
-		string reg = conf->readonestring ("/OpenspaceConfig/file_types/" + mime + "/default");
-		string cmd = conf->readonestring ("/OpenspaceConfig/commands/" + reg + "/exec"); 
-		
-		if(reg=="" || cmd!=command_exec)
-		{
-		
-		filetype_container ct=filetype_container();
-		ct.load(mime);
-		ct.command=command_name;
-		ct.save();			
-		}
-		else
-		return;
-	}
-
-	command_container cm=command_container(command_name,command_exec);
-	cm.save();
-
-}

Deleted: trunk/src/MimeApp.h
===================================================================
--- trunk/src/MimeApp.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/MimeApp.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,51 +0,0 @@
-#ifndef MIMEAPP_H
-#define MIMEAPP_H
-
-
-#include <vector>
-#include <string>
-#include <fstream>
-#include <sstream>
-using namespace std;
-
-class MimeApp:public FXDialogBox
-{
-  FXDECLARE (MimeApp) protected:
-
-  private:
-    MimeApp ()
-    {
-    }
-
- 
-
-  
-   
-    FXComboBox *programsbox;
-    FXLabel *mime_label;  
-  
-    vector <string> mime_vector;
-    vector <string>::iterator iter;
- public:
-    enum
-    {	 
-	ID_NEXT=FXDialogBox::ID_LAST,
-	ID_PREVIOUS,
-	ID_LAST,
-    };
-
-    MimeApp (FXWindow * owner);
-
-    long MimeApp::onNextPrevious(FXObject * sender, FXSelector sel, void *);
-    long MimeApp::onClose (FXObject * sender, FXSelector sel, void *ptr);
-    
-    void MimeApp::fill(string tmp);
-    static void MimeApp::save(string mime, string program);
-    void MimeApp::doAutomaticConfiguration(void);
-    
-    
-
-    virtual ~ MimeApp ();
-};
-
-#endif

Deleted: trunk/src/MimeType.cpp
===================================================================
--- trunk/src/MimeType.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/MimeType.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,156 +0,0 @@
-#include <string>
-#include <map>
-#include <iostream>
-#include <fstream>
-#include <list>
-#include <algorithm>
-#include <cctype>
-
-using namespace std;
-
-#include "MimeType.h"
-#include "sharedFunctions.h"
-
-bool MimeType::isInitialized = false;
-map < string, string > MimeType::mimeMap;
-map < string, string > MimeType::mimeCache;
-
-bool MimeType::_matches (string pattern, string ext)
-{
-
-    if (pattern[0] == '*')
-    {
-	pattern = pattern.substr (1);
-	unsigned int pos = ext.rfind (pattern);
-	if (pos == string::npos)
-	    return false;
-	return ext.length () - pos == pattern.length ();
-    }
-
-    if (pattern[pattern.length () - 1] == '*')
-    {
-	pattern = pattern.substr (0, pattern.length () - 1);
-	return ext.find (pattern) == 0;
-    }
-
-    return ext == pattern;
-
-}
-
-string MimeType::getMimeFromName (string name)
-{
-
-transform (name.begin (), name.end (), name.begin (), ::tolower);
-
-    if (!isInitialized)
-	__initialize ();
-
-    if (mimeCache[name] != "")
-	return mime2xml(mimeCache[name]);
-
-    string ext;
-
-    if (name.find (".") == string::npos)
-    {
-
-	ext = name;
-
-    }
-    else
-    {
-
-	ext = name.substr (name.rfind ("."));
-
-	if (name.length () >= 6 && name.substr (name.length () - 6, 6) == "tar.gz")
-	    return "application/x-compressed-tar";	//ext="tar.gz";
-
-	if (name.length () >= 7 && name.substr (name.length () - 7, 7) == "tar.bz2")
-	    return "application/x-bzip-compressed-tar";	//ext="tar.bz2";
-
-
-    }
-
-    string rv = "application/octet-stream";
-
-    for (map < string, string >::iterator it = mimeMap.begin (); it != mimeMap.end (); ++it)
-    {
-
-	if (_matches (it->first, ext))
-	{
-	    rv = it->second;
-	    break;
-	}
-
-    }
-
-    mimeCache[name] = rv;
-
-    return mime2xml(rv);
-
-}
-
-void MimeType::__initialize (void)
-{
-
-    if (isInitialized)
-	return;
-
-#ifndef WIN32
-    ifstream ifs ("/usr/share/mime/globs", ios::in);
-
-    if (!ifs)
-    {
-	cerr << "ifs() failed" << endl;
-	return;
-    }
-
-    mimeMap.clear ();
-    mimeCache.clear ();
-
-    while (!ifs.eof ())
-    {
-
-	string tmp;
-	getline (ifs, tmp);
-
-	if (tmp == "" || tmp[0] == '#')
-	    continue;
-
-	string mime, pattern;
-	mime = tmp.substr (0, tmp.find (":"));
-	pattern = tmp.substr (tmp.find (":") + 1);
-
-	mimeMap[pattern] = mime;
-
-    }
-
-    ifs.close ();
-#else
-    _NOT_IMPLEMENTED_;
-#endif
-
-    // Some missing globs:
-    mimeMap["*.asc"] = "application/pgp-encrypted";
-    mimeMap["*.com"] = "application/x-ms-dos-executable";
-    mimeMap["*.conf"] = "text/x-config";
-    mimeMap["*.dll"] = "application/x-ms-dos-executable";
-    mimeMap["*.ebuild"] = "text/ebuild";
-    mimeMap["*.eclass"] = "text/eclass";
-    mimeMap["*.gpg"] = "application/pgp-keys";
-    mimeMap["*.h++"] = "text/x-c++hdr";
-    mimeMap["*.hpp"] = "text/x-c++hdr";
-    mimeMap["*.ini"] = "text/x-config";
-    mimeMap["*.jsp"] = "text/x-jsp";
-    mimeMap["*.key"] = "application/pgp-keys";
-    mimeMap["*.l"] = "text/x-lex";
-    mimeMap["*.latex"] = "text/x-tex";
-    mimeMap["*.mak"] = "text/x-makefile";
-    mimeMap["*.ogm"] = "video/vorbis";
-    mimeMap["*.tbz2"] = "application/x-bzip-compresses-tar";
-    mimeMap["*.wma"] = "application/x-ms-wma";
-    mimeMap["*.y"] = "text/x-yacc";
-    mimeMap["*rc"] = "text/x-config";
-
-    isInitialized = true;
-
-}

Deleted: trunk/src/MimeType.h
===================================================================
--- trunk/src/MimeType.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/MimeType.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,29 +0,0 @@
-
-#ifndef __MimeType_h__
-#define __MimeType_h__
-
-class MimeType
-{
-
- private:   
-    static map < string, string > mimeCache;
-    static bool isInitialized;
-
-  private:
-     MimeType ()
-    {
-    }
-    ~MimeType ()
-    {
-    }
-
-   
-    static bool _matches (string pattern, string fname);
-
-  public:
-    static string getMimeFromName (string name);
-    static map < string, string > mimeMap;
-    static void __initialize (void);
-};
-
-#endif

Copied: trunk/src/OSCMDDialogBox.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSCMDDialogBox.cpp)


Property changes on: trunk/src/OSCMDDialogBox.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSCMDDialogBox.h (from rev 245, branches/mloskot-style-refactoring/src/OSCMDDialogBox.h)


Property changes on: trunk/src/OSCMDDialogBox.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSCommandTypeInfo.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSCommandTypeInfo.cpp)


Property changes on: trunk/src/OSCommandTypeInfo.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSCommandTypeInfo.h (from rev 245, branches/mloskot-style-refactoring/src/OSCommandTypeInfo.h)


Property changes on: trunk/src/OSCommandTypeInfo.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSConfigure.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSConfigure.cpp)


Property changes on: trunk/src/OSConfigure.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSConfigure.h (from rev 245, branches/mloskot-style-refactoring/src/OSConfigure.h)


Property changes on: trunk/src/OSConfigure.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFile.h (from rev 245, branches/mloskot-style-refactoring/src/OSFile.h)


Property changes on: trunk/src/OSFile.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileList.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSFileList.cpp)


Property changes on: trunk/src/OSFileList.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileList.h (from rev 245, branches/mloskot-style-refactoring/src/OSFileList.h)


Property changes on: trunk/src/OSFileList.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileListItem.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSFileListItem.cpp)


Property changes on: trunk/src/OSFileListItem.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileListItem.h (from rev 245, branches/mloskot-style-refactoring/src/OSFileListItem.h)


Property changes on: trunk/src/OSFileListItem.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileTypeInfo.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSFileTypeInfo.cpp)


Property changes on: trunk/src/OSFileTypeInfo.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileTypeInfo.h (from rev 245, branches/mloskot-style-refactoring/src/OSFileTypeInfo.h)


Property changes on: trunk/src/OSFileTypeInfo.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileTypeSymbol.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSFileTypeSymbol.cpp)


Property changes on: trunk/src/OSFileTypeSymbol.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFileTypeSymbol.h (from rev 245, branches/mloskot-style-refactoring/src/OSFileTypeSymbol.h)


Property changes on: trunk/src/OSFileTypeSymbol.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFirstRunDialogBox.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSFirstRunDialogBox.cpp)


Property changes on: trunk/src/OSFirstRunDialogBox.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSFirstRunDialogBox.h (from rev 245, branches/mloskot-style-refactoring/src/OSFirstRunDialogBox.h)


Property changes on: trunk/src/OSFirstRunDialogBox.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSInfoPanel.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSInfoPanel.cpp)


Property changes on: trunk/src/OSInfoPanel.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSInfoPanel.h (from rev 245, branches/mloskot-style-refactoring/src/OSInfoPanel.h)


Property changes on: trunk/src/OSInfoPanel.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMainWindow.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSMainWindow.cpp)
===================================================================
--- branches/mloskot-style-refactoring/src/OSMainWindow.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -0,0 +1,1317 @@
+#include "config.h"
+#include <string>
+#include <vector>
+#include <map>
+using namespace std;
+
+#include "fx.h" 
+// #include "FXPNGIcon.h"
+#include "OSThreadExec.h"
+#include "OSFileList.h"
+#include "OSObjectManager.h"
+#include "OSMainWindow.h"
+#include "OSInfoPanel.h"
+#include "OSConfigure.h"
+#include "OSFileListItem.h"
+
+#include "OSFirstRunDialogBox.h"
+
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <unistd.h>
+#include <dirent.h>
+
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else /*  */
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif /*  */
+using namespace FX;
+FXDEFMAP ( OSMainWindow ) OSMainWindowMap[] =
+    {
+
+        //________Message_Type_____________________ID____________Message_Handler_______
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_DIRCH, OSMainWindow::onChangeDir ),
+        // FXMAPFUNC(SEL_ENTER, OSMainWindow::ID_DIRCH,   OSMainWindow::onListNextDir),
+        // FXMAPFUNC(SEL_LEAVE, OSMainWindow::ID_DIRCH,   OSMainWindow::onListNextDir),
+        FXMAPFUNC ( SEL_RIGHTBUTTONRELEASE, OSMainWindow::ID_DIR, OSMainWindow::onListDirs ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_DIR, OSMainWindow::onOpenDir ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_CONFIGURE, OSMainWindow::onOpenConfigure ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_ABOUT, OSMainWindow::onAbout ),
+        FXMAPFUNCS ( SEL_LEFTBUTTONRELEASE, OSMainWindow::ID_TOLEFT, OSMainWindow::ID_TORIGHT, OSMainWindow::onChangeList ),
+        FXMAPFUNCS ( SEL_COMMAND, OSMainWindow::ID_OVERWRITE, OSMainWindow::ID_SKIP_ALL, OSMainWindow::onOverwrite ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEWFRAME, OSMainWindow::onNewFrame ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEW_NETWORK, OSMainWindow::onNewNetworkFrame ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEW_SEARCH, OSMainWindow::onNewSearchFrame ),
+        FXMAPFUNCS ( SEL_COMMAND, 666, 668, OSMainWindow::onNotify ),
+        FXMAPFUNC ( SEL_TIMEOUT, OSMainWindow::ID_TIMER, OSMainWindow::onTimer ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_COMMANDS_SHOW, OSMainWindow::commandsShow ),
+        FXMAPFUNC ( SEL_CONFIGURE, 0, OSMainWindow::onConfigure ),
+        FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_CANCEL, OSMainWindow::cancel ),
+        FXMAPFUNC ( SEL_UPDATE, 0, OSMainWindow::onUpdate ) };
+
+FXIMPLEMENT ( OSMainWindow, FXMainWindow, OSMainWindowMap, ARRAYNUMBER ( OSMainWindowMap ) )
+
+
+//-----MAIN WINDOW---------------------------------------------------------------------------------------------------------------------------
+OSMainWindow::OSMainWindow ( FXApp * a ) : FXMainWindow ( a, "openspace", NULL, NULL, DECOR_ALL | LAYOUT_FIX_WIDTH, 0, 0, 600, 400, 0, 0 )
+{
+    conf = new OSConfigure ();
+
+    if ( conf->loadconfig() )
+    {
+        if ( conf->readonestring ( "/OpenspaceConfig/version" ) == PACKAGE_VERSION )
+        {
+
+
+            objmanager = OSObjectManager::instance( getApp() );
+
+            new FXToolTip ( getApp (), TOOLTIP_NORMAL );
+            pane = NULL;
+            filemenu = NULL;
+            pref = NULL;
+
+            string fontdesc = conf->readonestring ( "/OpenspaceConfig/fonts/normalfont" );
+            FXFont *font = new FXFont( getApp(), fontdesc.c_str() );
+            font->create();
+            getApp() ->setNormalFont( font );
+
+
+            getApp() ->setTypingSpeed( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/typing_speed" ).c_str () ) );
+            getApp() ->setClickSpeed( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/click_speed" ).c_str () ) );
+            getApp() ->setScrollSpeed( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/scroll_speed" ).c_str () ) );
+            getApp() ->setScrollDelay( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/scroll_delay" ).c_str () ) );
+            getApp() ->setBlinkSpeed( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/blink_speed" ).c_str () ) );
+            getApp() ->setAnimSpeed( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/anim_speed" ).c_str () ) );
+            getApp() ->setMenuPause( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/menu_pause" ).c_str () ) );
+            getApp() ->setTooltipPause( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/tooltip_pause" ).c_str () ) );
+            getApp() ->setTooltipTime( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/tooltip_time" ).c_str () ) );
+            getApp() ->setDragDelta( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/drag_delta" ).c_str () ) );
+            getApp() ->setWheelLines( FXIntVal( conf->readonestring ( "/OpenspaceConfig/speed_delay/wheel_lines" ).c_str () ) );
+
+            getApp() ->setBaseColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/base" ).c_str() ) );
+            getApp() ->setBorderColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/border" ).c_str() ) );
+            getApp() ->setForeColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/fore" ).c_str() ) );
+            getApp() ->setHiliteColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/hilite" ).c_str() ) );
+            getApp() ->setShadowColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/shadow" ).c_str() ) );
+            getApp() ->setSelforeColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/selfore" ).c_str() ) );
+            getApp() ->setSelbackColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/selback" ).c_str() ) );
+            getApp() ->setTipforeColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/tipfore" ).c_str() ) );
+            getApp() ->setTipbackColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/tipback" ).c_str() ) );
+            getApp() ->setSelMenuTextColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/selmenutext" ).c_str() ) );
+            getApp() ->setSelMenuBackColor( fxcolorfromname( conf->readonestring ( "/OpenspaceConfig/colors/selmenuback" ).c_str() ) );
+
+            string iconsdir = conf->readonestring ( "/OpenspaceConfig/path" ) + "icons/" + conf->readonestring ( "/OpenspaceConfig/icons_theme" );
+
+            if ( !FXFile::exists( iconsdir.c_str() ) )
+                iconsdir = FXFile::getUserDirectory ( "" ).text () + string( "/.openspace/icons/" ) + conf->readonestring ( "/OpenspaceConfig/icons_theme" );
+
+            iconsdir += string( "/" );
+
+            loadicons( iconsdir );
+
+
+            string res = conf->readonestring ( "/OpenspaceConfig/version" );
+            FXTRACE ( ( 1, "\n openspace version %s\n\n", res.c_str () ) );
+            int w = atoi ( conf->readonestring ( "/OpenspaceConfig/mainwindow/width" ).c_str () );
+            int h = atoi ( conf->readonestring ( "/OpenspaceConfig/mainwindow/height" ).c_str () );
+            resize ( w, h );
+
+            // read icons for file types
+            if ( conf->openxpath ( "/OpenspaceConfig/file_types" ) != -1 )
+            {
+                string res;
+                while ( conf->getnextnode ( res ) )
+                {
+                    loadMimeSettings ( "/OpenspaceConfig/file_types/" + res, res );
+                    OSConfigure conflocal = *conf;
+                    if ( conflocal.openxpath ( "/OpenspaceConfig/file_types/" + res + "/types" ) != -1 )
+                    {
+                        string res2;
+                        while ( conflocal.getnextnode ( res2 ) )
+                        {
+                            loadMimeSettings ( "/OpenspaceConfig/file_types/" + res + "/types/" + res2, res + "/" + res2 );
+                        }
+                    }
+                }
+            }
+
+
+
+
+            topdock = new FXDockSite ( this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X );
+            bottomdock = new FXDockSite ( this, LAYOUT_SIDE_BOTTOM | LAYOUT_FILL_X );
+            leftdock = new FXDockSite ( this, LAYOUT_SIDE_LEFT | LAYOUT_FILL_Y );
+            rightdock = new FXDockSite ( this, LAYOUT_SIDE_RIGHT | LAYOUT_FILL_Y );
+
+
+
+            FXToolBarShell *dragshell1 = new FXToolBarShell ( this, FRAME_RAISED );
+            FXToolBar *toolbar = new FXToolBar ( topdock, dragshell1, LAYOUT_DOCK_NEXT | LAYOUT_SIDE_TOP | FRAME_RAISED );
+            new FXToolBarGrip ( toolbar, toolbar, FXToolBar::ID_TOOLBARGRIP, TOOLBARGRIP_SINGLE );
+
+
+
+
+            FXVerticalFrame *ff = new FXVerticalFrame ( this, LAYOUT_FILL_X | LAYOUT_FILL_Y );
+            controlframe = new FXVerticalFrame ( ff, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            splitter = new FXSplitter ( ff, LAYOUT_FILL_X | SPLITTER_TRACKING | LAYOUT_FILL_Y );
+            left = new FXVerticalFrame ( splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0 );
+            right = new FXVerticalFrame ( splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0 );
+            if ( conf->readonestring ( "/OpenspaceConfig/panels" ) == "single" )
+                ratio = 0;
+
+            else
+                ratio = 1.0 / 2.0;
+            leftcontrolframe = new FXVerticalFrame ( left, LAYOUT_FILL_X );
+            leftframe = new FXVerticalFrame ( left, LAYOUT_FILL_X | LAYOUT_FILL_Y );
+            rightcontrolframe = new FXVerticalFrame ( right, LAYOUT_FILL_X );
+            rightframe = new FXVerticalFrame ( right, LAYOUT_FILL_X | LAYOUT_FILL_Y );
+            //   FXHorizontalFrame * buttonsframe = new FXHorizontalFrame (toolbar, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
+            new FXButton ( toolbar, "\thide/show copy/move progress", objmanager->osicons[ "plus" ], this, OSMainWindow::ID_COMMANDS_SHOW, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            new FXButton ( toolbar, "\topen new panel", objmanager->osicons[ "directory" ], this, OSMainWindow::ID_NEWFRAME, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            new FXButton ( toolbar, "\tconnect", objmanager->osicons[ "network" ], this, OSMainWindow::ID_NEW_NETWORK, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            new FXButton ( toolbar, "\tsearch", objmanager->osicons[ "search" ], this, OSMainWindow::ID_NEW_SEARCH, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+
+            new FXSeparator ( toolbar, SEPARATOR_NONE );
+            new FXSeparator ( toolbar, SEPARATOR_GROOVE );
+            new FXSeparator ( toolbar, SEPARATOR_NONE );
+
+            new FXButton ( toolbar, "\tconfiguration", objmanager->osicons[ "configure" ], this, OSMainWindow::ID_CONFIGURE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            new FXButton ( toolbar, "\tabout", objmanager->osicons[ "foxmini" ], this, OSMainWindow::ID_ABOUT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+            toolbar->dock( rightdock );
+
+            string dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/leftdir/dir" ) );
+            string type = conf->readonestring ( "/OpenspaceConfig/leftdir/type" );
+            OSPathType pt ( dir, type );
+            left_frame = new Frame ( leftcontrolframe, leftframe, pt, this, -1 );
+            left_frame->f->toolbar->dock( topdock );
+            left_frame->f->toolbar->hide();
+            left_frame->f->toolbar2->dock( rightdock );
+            left_frame->f->toolbar2->hide();
+
+            dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
+            type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
+            OSPathType pt2 ( dir, type );
+            right_frame = new Frame ( rightcontrolframe, rightframe, pt2, this, -1 );
+
+            right_frame->f->toolbar->dock( topdock );
+            right_frame->f->toolbar2->dock( rightdock );
+
+            left_frame->f->filelist_opposite = right_frame->f;
+            right_frame->f->filelist_opposite = left_frame->f;
+            infoframe = new FXVerticalFrame ( ff, LAYOUT_FILL_X );
+            networkframe = NULL;
+            searchframe = NULL;
+            getApp () ->addTimeout ( this, ID_TIMER, 200 );
+
+            if ( conf->readonestring ( "/OpenspaceConfig/first_run" ) == "true" )
+            {
+                conf->saveonestring ( "/OpenspaceConfig/first_run", "false" );
+
+                OSFirstRunDialogBox* first_run;
+                first_run = new OSFirstRunDialogBox( this );
+                first_run->show ( PLACEMENT_SCREEN );
+            }
+        }
+        else
+        {
+            new FXLabel( this, "Configuration file version mismatch" );
+            new FXLabel( this, "Please remove .openspace/openspacerc file in your home directory" );
+            conf->loadconfig( true );
+            delete conf;
+            conf = NULL;
+        }
+    }
+    else //configuration file broken
+    {
+
+        new FXLabel( this, "Configuration file is broken :|" );
+        new FXLabel( this, "Restoring last good configuation file, restart program to apply changes" );
+
+        conf->loadconfig( true );
+        delete conf;
+        conf = NULL;
+    }
+
+}
+
+
+//----------------------------------------------------
+// open configure window
+long OSMainWindow::onOpenConfigure ( FXObject * sender, FXSelector sel, void * )
+{
+    if ( pref == NULL )
+    {
+        pref = new OSPreferences ( this );
+        pref->create();
+    }
+    pref->show ( PLACEMENT_OWNER );
+}
+
+
+//about
+long OSMainWindow::onAbout ( FXObject * sender, FXSelector sel, void * )
+{
+
+    string msg = "Openspace File Browser " + string( PACKAGE_VERSION ) + "\n\nby Mateusz Dworak (http://openspace.linux.pl)\n\nUsing the FOX C++ GUI Library (http://www.fox-tookit.org) \n\n icons by Dawn Simon";
+
+    FXMessageBox about ( this, "About Openspace", msg.c_str(), objmanager->osicons[ "foxbig" ], MBOX_OK | DECOR_TITLE | DECOR_BORDER );
+    about.execute ();
+}
+
+
+
+
+//new frame
+long OSMainWindow::onNewFrame ( FXObject * sender, FXSelector, void *ptr )
+{
+    string dir;
+    string type;
+    string str_server;
+    string str_user;
+    string str_pass;
+    string str_port;
+    if ( networkframe == NULL && searchframe == NULL )
+    {
+        dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/defaultdir/dir" ) );
+        type = conf->readonestring ( "/OpenspaceConfig/defaultdir/type" );
+    }
+    else
+    {
+
+
+        if ( networkframe == NULL )  //search
+        {
+
+
+            string s_size_greater = search_size_greater->getText().text();
+            string s_size_less = search_size_less->getText().text();
+            string s_dir = search_path->getText().text();
+            string s_filter = search_filefilter->getText().text();
+
+            str_server = "find " + s_dir;
+
+            if ( s_filter != "" )
+                str_server += " -name \"" + s_filter + "\"" ;
+            if ( s_size_greater != "" )
+                str_server += " -size +" + s_size_greater + "k" ;
+            if ( s_size_less != "" )
+                str_server += " -size -" + s_size_less + "k" ;
+
+
+            dir = "/";
+            type = "search";
+
+            searchframe->hide ();
+            delete searchframe;
+            searchframe = NULL;
+        }
+        else            //network
+        {
+            dir = "/";
+            type = filelisttypecombobox->getText().text();
+            str_server = server->getText ().text ();
+            str_user = user->getText ().text ();
+            str_pass = password->getText ().text ();
+            str_port = port->getText().text();
+            networkframe->hide ();
+            delete networkframe;
+            networkframe = NULL;
+        }
+
+
+        controlframe->recalc ();
+    }
+    OSPathType pt ( dir, type, str_server, str_user, str_pass, str_port );
+    Frame *fr = new Frame ( controlframe, leftframe, pt, this, 0 );
+
+    fr->frame->create ();
+    fr->hf->create ();
+    fr->f->toolbar->dock( topdock );
+    fr->f->toolbar->hide();
+    fr->f->toolbar2->dock( rightdock );
+    fr->f->toolbar2->hide();
+
+
+    this->handle ( fr->toleft, FXSEL ( SEL_LEFTBUTTONRELEASE, ID_TOLEFT ), NULL );
+
+    controlframe->recalc ();
+}
+
+
+//show or hide frame where we can set login/pass/etc for connecting do remote filesystem
+long OSMainWindow::onNewNetworkFrame ( FXObject * sender, FXSelector, void * )
+{
+    if ( networkframe == NULL )
+    {
+        networkframe = new FXHorizontalFrame ( controlframe, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+        new FXLabel ( networkframe, "server:" );
+        server = new FXTextField ( networkframe, 20 );
+        new FXLabel ( networkframe, "user:", objmanager->osicons[ "user" ] );
+        user = new FXTextField ( networkframe, 20 );
+        new FXLabel ( networkframe, "pass:", objmanager->osicons[ "password" ] );
+        password = new FXTextField ( networkframe, 20, NULL, 0, TEXTFIELD_PASSWD | FRAME_SUNKEN | FRAME_THICK );
+        new FXLabel ( networkframe, "port:", NULL, 0, TEXTFIELD_INTEGER );
+        port = new FXTextField ( networkframe, 5 );
+
+        filelisttypecombobox = new FXComboBox ( networkframe, 4, NULL, 0,
+                                                FRAME_THICK | LAYOUT_SIDE_TOP | COMBOBOX_STATIC );
+
+        int count = 0;
+        if ( conf->openxpath ( "/OpenspaceConfig/filelist" ) != -1 )
+        {
+            string res;
+            while ( conf->getnextnode ( res ) )
+            {
+                string filelist_type = conf->readonestring ( "/OpenspaceConfig/filelist/" + res + "/type" );
+
+                if ( filelist_type == "network" )
+                {
+                    filelisttypecombobox->appendItem ( res.c_str() );
+                    count++;
+                }
+            }
+        }
+
+
+        filelisttypecombobox->setNumVisible ( count );
+
+        new FXButton ( networkframe, "connect", NULL, this, OSMainWindow::ID_NEWFRAME, FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0 );
+        networkframe->create ();
+        networkframe->recalc ();
+    }
+
+    else
+    {
+        networkframe->hide ();
+        delete networkframe;
+        networkframe = NULL;
+        controlframe->recalc ();
+    }
+}
+
+
+long OSMainWindow::onNewSearchFrame ( FXObject * sender, FXSelector, void * )
+{
+    if ( searchframe == NULL )
+    {
+        searchframe = new FXHorizontalFrame ( controlframe, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+        new FXLabel ( searchframe, "path: " );
+        search_path = new FXTextField ( searchframe, 20 );
+        if ( left_frame->f->active )
+            search_path->setText( left_frame->f->path.c_str() );
+        else
+            search_path->setText( right_frame->f->path.c_str() );
+        new FXLabel ( searchframe, "size" );
+        new FXLabel ( searchframe, "greater than(KB):" );
+        search_size_greater = new FXTextField ( searchframe, 10 );
+        new FXLabel ( searchframe, "less than(KB):" );
+        search_size_less = new FXTextField ( searchframe, 10 );
+
+
+        new FXLabel ( searchframe, "file filter: " );
+        search_filefilter = new FXTextField ( searchframe, 20 );
+        search_filefilter->setText( "*" );
+        new FXButton ( searchframe, "search", NULL, this, OSMainWindow::ID_NEWFRAME, FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0 );
+        searchframe->create ();
+        searchframe->recalc ();
+    }
+
+    else
+    {
+        searchframe->hide ();
+        delete searchframe;
+        searchframe = NULL;
+        controlframe->recalc ();
+    }
+}
+
+
+//----------------------------------------------------
+OSMainWindow::~OSMainWindow ()
+{
+    delete pref;
+    delete conf;
+}
+
+
+//----------------------------------------------------
+void OSMainWindow::create ()
+{
+    FXMainWindow::create ();
+    string position;
+    if ( conf )
+        position = conf->readonestring ( "/OpenspaceConfig/position" );
+
+    if ( position == "cursor" )
+        show ( PLACEMENT_CURSOR );
+    else
+        show ( PLACEMENT_SCREEN );
+}
+
+//----------------------------------------------------
+//show or hide frame containing informaitions about copying/moving files
+long OSMainWindow::commandsShow ( FXObject * sender, FXSelector, void *ptr )
+{
+    if ( infoframe->shown () )
+        infoframe->hide ();
+
+    else
+        infoframe->show ();
+}
+
+
+//executed when we change directory clicking directory name in popoup window
+long OSMainWindow::onChangeDir ( FXObject * sender, FXSelector, void *ptr )
+{
+    OSFileList * fil = current_frame->f;
+    FXTRACE ( ( 5, "CHANGE DIR\n", fil->path.c_str () ) );
+    FXMenuCommand *mc = ( FXMenuCommand * ) sender;
+    FXEvent *event = ( FXEvent * ) ptr;
+    FXWindow *win = ( FXWindow * ) mc->getParent ();
+    int x = win->getX ();
+    int y = win->getY ();
+    string p = fil->path;
+    string current_path = p;
+
+    if ( current_path != "/" )
+        current_path.append ( SEPARATOR );
+
+    current_path.append ( mc->getText ().text () );
+    current_frame->f->path = current_path;
+    current_frame->f->opendir ( current_path );
+    current_frame->generate_menu ( current_path, this );
+    popupDir ( current_frame->f, current_path, x, y );
+}
+
+//popup with dir names when we click right button in dir path
+int OSMainWindow::popupDir ( OSFileList * current_filelist, string path, int x, int y )
+{
+    vector < string > vec;
+    for ( int i = 0; i < current_filelist->getNumItems (); i++ )
+    {
+        OSFileListItem *oslistitem = ( OSFileListItem * ) current_filelist->getItem ( i );
+        if ( oslistitem->osf.type & FOLDER )
+        {
+            string name = oslistitem->osf.name;
+            if ( name != "." && name != ".." && name[ 0 ] != '.' )
+                vec.push_back ( name );
+        }
+    }
+
+    /*
+     
+        if(current_filelist->fb->osopendir(path)==-1)
+        {
+        return 0;
+        }
+     
+     
+     
+     
+     
+        while(1)
+        {
+        osfile os_file=current_filelist->fb->osreaddir();
+            if(os_file.name=="")
+            break;
+        
+            if(os_file.type&FOLDER && os_file.name!="." && os_file.name!="..")
+            vec.push_back (os_file.name);       
+        }
+     
+    */
+    unsigned int indx;
+    if ( vec.size () > 0 )
+    {
+        sort ( vec.begin (), vec.end () );
+        if ( filemenu )
+        {
+            filemenu->popdown ();
+            delete filemenu;
+            filemenu = NULL;
+        }
+        filemenu = new FXMenuPane ( this );
+        for ( indx = 0; indx < vec.size (); indx++ )
+        {
+            new FXMenuCommand ( filemenu, vec[ indx ].c_str (), objmanager->osicons[ "directory" ], this, OSMainWindow::ID_DIRCH );
+        }
+        filemenu->create ();
+        filemenu->popup ( NULL, x, y, 0, 0 );
+    }
+}
+
+
+//currently nothing ;p
+long OSMainWindow::onListNextDir ( FXObject * sender, FXSelector sel, void *ptr )
+{}
+
+//popup with directory names when we click right button in path
+long OSMainWindow::onListDirs ( FXObject * sender, FXSelector, void *ptr )
+{
+    FXTRACE ( ( 5, "LIST DIRS\n" ) );
+    FXButton *bt = ( FXButton * ) sender;
+    box *boxel = ( box * ) bt->getUserData ();
+    box *boxbackup = boxel;
+    current_frame = boxel->fr;
+    if ( boxel->fr != right_frame && boxel->fr != left_frame )
+        return 0;
+    string path = "";
+    while ( boxel->prebutton != NULL )
+    {
+        boxel = ( box * ) boxel->prebutton->getUserData ();
+    }
+    while ( boxel != NULL )
+    {
+        if ( boxel == boxbackup )
+        {
+            path.append ( boxel->bt->getText ().text () );
+            break;
+        }
+        path.append ( boxel->bt->getText ().text () );
+        boxel = ( box * ) boxel->nextbutton->getUserData ();
+    }
+    current_frame->f->path = path;
+    current_frame->f->opendir ( path );
+    FXEvent *event = ( FXEvent * ) ptr;
+    int x = event->root_x;
+    int y = event->root_y;
+    popupDir ( current_frame->f, path, x, y );
+}
+
+//change position or close frame
+long OSMainWindow::onChangeList ( FXObject * sender, FXSelector sel, void *ptr )
+{
+    FXButton * bt = ( FXButton * ) sender;
+    box *boxel = ( box * ) bt->getUserData ();
+    FXushort id = FXSELID ( sel );
+    int pos = -1;
+    if ( id == ID_TOCLOSE )
+    {
+        bool canclose = true;
+
+        vector < OSThreadExec * >::iterator iter;
+        for ( iter = objmanager->thread_vec.begin (); iter != objmanager->thread_vec.end (); iter++ )
+        {
+            OSThreadExec *telem = *iter;
+            if ( telem->fb == boxel->fr->f->fb )
+            {
+                canclose = false;
+            }
+        }
+        if ( canclose )
+        {
+
+            boxel->fr->f->fb->quit ();
+            delete boxel->fr->hf;
+            delete boxel->fr->f->toolbar;
+            delete boxel->fr->f->toolbar2;
+            delete boxel->fr->frame;
+            sender = NULL;
+
+        }
+        else
+        {
+            FXMessageBox about ( this, "error", "There are some processes connected with this filelist,\n finish them all and then you can close this filelist\n(this behavior will change in the next release of program)", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER );
+            about.execute ();
+
+        }
+
+        return 1;
+
+    }
+
+    else
+    {
+        if ( id == ID_TORIGHT )
+        {
+            pos = 1;
+        }
+
+        if ( left_frame->f->getWidth() == 0 )
+            pos = 1;
+
+        if ( right_frame->f->getWidth() == 0 )
+            pos = -1;
+
+
+    }
+    if ( pos == -1 )
+    {
+        boxel->fr->frame->reparent ( leftframe );
+        boxel->fr->hf->reparent ( leftcontrolframe );
+        left_frame->hf->reparent ( controlframe );
+        left_frame->f->toolbar->hide();
+        left_frame->f->toolbar2->hide();
+        left_frame->toleft->show ();
+        left_frame->toright->show ();
+        left_frame->toclose->show ();
+        left_frame->frame->hide ();
+        left_frame = boxel->fr;
+        left_frame->frame->show ();
+
+    }
+
+    else
+    {
+        boxel->fr->frame->reparent ( rightframe );
+        boxel->fr->hf->reparent ( rightcontrolframe );
+        right_frame->hf->reparent ( controlframe );
+        right_frame->f->toolbar->hide();
+        right_frame->f->toolbar2->hide();
+        right_frame->toleft->show ();
+        right_frame->toright->show ();
+        right_frame->toclose->show ();
+        right_frame->frame->hide ();
+        right_frame = boxel->fr;
+        right_frame->frame->show ();
+    }
+    left_frame->f->filelist_opposite = right_frame->f;
+    right_frame->f->filelist_opposite = left_frame->f;
+    boxel->fr->toleft->hide ();
+    boxel->fr->toright->hide ();
+    boxel->fr->toclose->hide ();
+    boxel->fr->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
+
+    rightframe->recalc ();
+    leftframe->recalc ();
+}
+
+
+//notify from filelist
+long OSMainWindow::onNotify ( FXObject * sender, FXSelector sel, void *ptr )
+{
+    FXTRACE ( ( 5, "NOTIFY\n" ) );
+    FXushort id = FXSELID ( sel );
+    if ( id == 667 )
+    {
+        string * file_ptr = ( string * ) ptr;
+        string file = *file_ptr;
+        FXTRACE ( ( 5, "change to directory %s\n", file.c_str () ) );
+        delete file_ptr;
+        string dir;
+        string type;
+        string str_server = file;
+        dir = "/";
+        type = "archive";
+        OSPathType pt ( dir, type, str_server );
+        Frame *fr;
+        if ( left_frame->f->active )
+            fr = new Frame ( leftcontrolframe, leftframe, pt, this, -1 );
+
+        else
+            fr = new Frame ( rightcontrolframe, rightframe, pt, this, -1 );
+        if ( left_frame->f->active )
+        {
+            left_frame->hf->reparent ( controlframe );
+            left_frame->toleft->show ();
+            left_frame->toright->show ();
+            left_frame->toclose->show ();
+            left_frame->frame->hide ();
+            left_frame->f->toolbar->hide();
+            left_frame->f->toolbar2->hide();
+            left_frame = fr;
+
+        }
+
+        else
+        {
+            right_frame->hf->reparent ( controlframe );
+            right_frame->toleft->show ();
+            right_frame->toright->show ();
+            right_frame->toclose->show ();
+            right_frame->frame->hide ();
+            right_frame->f->toolbar->hide();
+            right_frame->f->toolbar2->hide();
+            right_frame = fr;
+
+
+        }
+        controlframe->recalc ();
+        fr->frame->create ();
+        fr->hf->create ();
+        fr->frame->show ();
+        fr->f->toolbar->dock( topdock );
+        fr->f->toolbar2->dock( rightdock );
+
+        left_frame->f->filelist_opposite = right_frame->f;
+        right_frame->f->filelist_opposite = left_frame->f;
+
+        if ( left_frame->f->active )
+            left_frame->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
+        else
+            right_frame->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
+
+        rightframe->recalc ();
+        leftframe->recalc ();
+    }
+
+    else if ( id == 666 )       //directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
+    {
+        if ( left_frame->f->active )
+            left_frame->generate_menu ( left_frame->f->path, this );
+
+        else
+            right_frame->generate_menu ( right_frame->f->path, this );
+    }
+
+    else if ( id == 668 )
+    {
+        if ( left->getWidth () == 0 || right->getWidth () == 0 )
+            left->setWidth ( getWidth () / 2 );
+
+        else
+        {
+            if ( left_frame->f == ( OSFileList * ) sender )
+                left->setWidth ( right->getWidth () + left->getWidth () );
+
+            else
+                left->setWidth ( 0 );
+        }
+    }
+}
+
+
+//pressed button in path
+long OSMainWindow::onOpenDir ( FXObject * sender, FXSelector, void *ptr )
+{
+    FXTRACE ( ( 5, "OPEN DIR\n" ) );
+    FXButton *bt = ( FXButton * ) sender;
+    box *boxel = ( box * ) bt->getUserData ();
+    box *boxbackup = boxel;
+    if ( boxel->fr != right_frame && boxel->fr != left_frame )
+        return 0;
+    string path = "";
+    while ( boxel->prebutton != NULL )
+    {
+        boxel = ( box * ) boxel->prebutton->getUserData ();
+    }
+    while ( boxel != NULL )
+    {
+        if ( boxel == boxbackup )
+        {
+            break;
+        }
+        path.append ( boxel->bt->getText ().text () );
+        boxel = ( box * ) boxel->nextbutton->getUserData ();
+    }
+    if ( path == "" )
+        path = "/";
+    boxbackup->fr->f->path = path;
+    boxbackup->fr->f->opendir ( path );
+    boxbackup->fr->generate_menu ( path, this );
+}
+
+
+//executed cyclically to update informations about progress of copying/moving/deleteing files
+//using vector of special objects OSThreadExec to read from them information and to write request
+//for example stoping copying.
+long OSMainWindow::onTimer ( FXObject *, FXSelector, void * )
+{
+    vector < OSThreadExec * >::iterator iter;
+    unsigned int indx;
+    for ( iter = objmanager->thread_vec.begin (); iter != objmanager->thread_vec.end (); iter++ )
+    {
+        bool end = false;
+        OSInfoPanel *infp;
+        OSThreadExec *telem = *iter;
+        if ( telem->mutex.trylock () )
+        {
+            if ( telem->gui == NULL )
+            {
+                infp = new OSInfoPanel ( infoframe, telem->command );
+                telem->gui = ( void * ) infp;
+                if ( telem->command == "copy" || telem->command == "move" || telem->command == "remove" )
+                {
+                    infp->bu->setUserData ( telem );
+                    infp->bu->setSelector ( OSMainWindow::ID_CANCEL );
+                    infp->bu->setTarget ( this );
+                }
+
+                else if ( telem->command == "execute" )
+                {
+                    string show_commands = conf->readonestring ( "/OpenspaceConfig/show_commands" );
+                    if ( show_commands == "true" )
+                    {
+                        FXFont * font = new FXFont ( getApp (), "Arial", 8 );
+                        if ( font )
+                        {
+                            font->create ();
+                            infp->lab0->setFont ( font );
+                        }
+                        infp->lab0->setText ( telem->src[ 0 ].c_str () );
+                        infp->frame->recalc ();
+                    }
+
+                    else
+                        infp->frame->hide ();
+                }
+
+                else if ( telem->command == "init" )
+                {
+                    string text = "connecting ... ";
+                    infp->lab0->setText ( text.c_str () );
+                    infp->frame->recalc ();
+                }
+            }
+            //popup with question about skipping or overwriting file
+            if ( telem->question == true )
+            {
+                telem->question = false;
+                telem->pane = new FXMenuPane ( this );
+                FXButton *but = new FXButton ( telem->pane, "overwrite", NULL, this,
+                                               ID_OVERWRITE );
+                but->setUserData ( telem );
+                but = new FXButton ( telem->pane, "skip", NULL, this, ID_SKIP );
+                but->setUserData ( telem );
+                but = new FXButton ( telem->pane, "skip all", NULL, this, ID_SKIP_ALL );
+                but->setUserData ( telem );
+                but = new FXButton ( telem->pane, "overwrite all", NULL, this, ID_OVERWRITE_ALL );
+                but->setUserData ( telem );
+                telem->pane->create ();
+                telem->pane->popup ( NULL, this->getX () + 300, this->getY () + 300, but->getWidth (), 100 );
+            }
+            //when command is copy or move update information about progress
+            if ( telem->command == "copy" || telem->command == "move" )
+            {
+                infp = ( OSInfoPanel * ) telem->gui;
+                string info = "total size: " + numtostring ( telem->total_size );
+                infp->lab0->setText ( info.c_str () );
+                info = "Current file: " + telem->act_file_name + " size: " + numtostring ( telem->file_size );
+                infp->lab1->setText ( info.c_str () );
+                double pct2 = 100 * ( double ) telem->act_total_size / ( double ) telem->total_size;
+                infp->pbar2->setProgress ( ( int ) pct2 );
+                double pct = 100 * ( double ) telem->act_file_size / ( double ) telem->file_size;
+                infp->pbar->setProgress ( ( int ) pct );
+                double diff = difftime ( time ( NULL ), *telem->tim );
+                info = "time elapsed: " + ntos ( ( unsigned int ) diff ) + " copied size: ";
+                info.append ( numtostring ( telem->act_file_size ) );
+                if ( diff == 0 )
+                    diff = 0.001;
+                double speed = ( double ) telem->act_total_size / diff;
+                info.append ( " Speed: " + numtostring ( ( unsigned int ) speed ) + "/s" );
+                unsigned int eta = ( unsigned int ) ( ( diff * ( double ) telem->total_size ) / ( double ) telem->act_total_size );
+                eta = eta - ( unsigned int ) diff;
+                info.append ( " ETA: " + ntos ( eta ) );
+                infp->lab2->setText ( info.c_str () );
+            }
+
+            else if ( telem->command == "remove" )
+            {
+                infp = ( OSInfoPanel * ) telem->gui;
+                string info = "Removing: " + telem->act_file_name;
+                //FXTRACE ((5, "remove file %s\n", telem->act_file_name.c_str ()));
+                infp->lab0->setText ( info.c_str () );
+                infp->frame->recalc ();
+            }
+
+            else if ( telem->command == "execute" )
+            {
+                string::size_type pos = telem->options.find ( "capture" );
+                if ( pos != string::npos )
+                {
+                    char readbuf[ 80 ];
+                    int k = 0;
+                    while ( read ( telem->p[ 0 ], readbuf, 1 ) > 0 && k++ < 2000 )
+                    {
+                        string s = "";
+                        s = s + readbuf[ 0 ];
+                        if ( s == "!" )
+                            telem->end = true;
+
+                        else
+                            telem->dst = telem->dst + readbuf[ 0 ];
+                    }
+                }
+            }
+            end = telem->end;
+            telem->mutex.unlock ();
+            if ( end )      //when telem ended
+            {
+
+                if ( telem->error )
+                {
+                    FXMessageBox about ( this, "error", telem->msg.c_str(), NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER );
+                    about.execute ();
+                }
+                OSFileList *fil = ( OSFileList* ) telem->filel;
+
+                string::size_type pos = telem->options.find ( "download" );
+                bool download = false;
+                if ( pos != string::npos )
+                {
+                    download = true;
+
+                }
+
+                if ( telem->command == "init" )
+                {
+                    FXTRACE ( ( 5, "INIT \n" ) );
+                    if ( fil->init () != false )
+                    {
+                        if ( left_frame->f->active )
+                            left_frame->generate_menu ( fil->path, this );
+                        else
+                            right_frame->generate_menu ( fil->path, this );
+                    }
+                    else
+                    {
+                        FXMessageBox box( getApp (), "error", "Can't connect :|", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER );
+                        box.execute ();
+
+
+                    }
+                }
+                if ( telem->command == "copy" )
+                {
+                    if ( ( left_frame->f->fb == telem->fb && download == true ) || ( download == false && right_frame->f->fb == telem->fb ) )
+                        left_frame->f->refresh ();
+
+                    else
+                        right_frame->f->refresh ();
+                }
+
+                else if ( telem->command == "remove" )
+                {
+                    fil->refresh ();
+                }
+
+                else if ( telem->command == "move" )
+                {
+                    right_frame->f->refresh ();
+                    left_frame->f->refresh ();
+                }
+                string options = telem->options;    // get special options
+                pos = options.find ( "rescan" );    // when we need to rescan directory after command finish
+                if ( pos != string::npos )
+                {
+
+                    fil->refresh ();
+
+                }
+                pos = telem->options.find ( "capture" );    // when we need to capture data from standard output from executed program
+                if ( pos != string::npos )
+                {
+                    telem->pane = new FXMenuPane ( this );
+                    FXLabel *lab = new FXLabel ( telem->pane, telem->dst.c_str () );
+                    telem->pane->create ();
+                    telem->pane->popup ( NULL, this->getX (), this->getY (), lab->getWidth (), lab->getHeight () );
+                }
+                //cleanup
+                delete ( ( OSInfoPanel * ) telem->gui );
+                telem->gui = NULL;
+                infoframe->recalc ();
+
+                //erase from vector and delete telem;
+                objmanager->thread_vec.erase ( iter );
+                delete telem;
+                break;
+            }
+        }
+    }               //end for
+    getApp () ->addTimeout ( this, ID_TIMER, 200 );
+    return 1;
+}
+
+
+//when we choose in popup if we want overwrite or skip
+//notify about this filelist plugin using telem
+long OSMainWindow::onOverwrite ( FXObject * sender, FXSelector sel, void * )
+{
+    FXushort id = FXSELID ( sel );
+    FXButton *but = ( FXButton * ) sender;
+    OSThreadExec *te = ( OSThreadExec * ) but->getUserData ();
+    te->mutex.lock ();
+    if ( id == ID_OVERWRITE )
+    {
+        te->overwrite = true;
+    }
+
+    else if ( id == ID_SKIP )
+    {
+        te->overwrite = false;
+    }
+
+    else if ( ID_OVERWRITE_ALL )
+    {
+        te->overwrite = true;
+        te->all = true;
+    }
+
+    else if ( id == ID_SKIP_ALL )
+    {
+        te->overwrite = false;
+        te->all = true;
+    }
+    te->pane->hide ();
+    delete te->pane;
+    te->answer = true;
+    te->mutex.unlock ();
+}
+
+
+//NEED TO CHANGE THIS
+long OSMainWindow::onConfigure ( FXObject * sender, FXSelector sel, void *ptr )
+{
+    if ( !conf ) return 0;
+
+    FXMainWindow::onConfigure ( sender, sel, ptr );
+    float widthpanel = this->getWidth () * ratio;
+    left->setWidth ( ( int ) widthpanel );
+
+}
+long OSMainWindow::onUpdate ( FXObject * sender, FXSelector sel, void *ptr )
+{
+    if ( !conf ) return 0;
+
+    FXMainWindow::onUpdate ( sender, sel, ptr );
+    float l = left->getWidth ();
+    float r = right->getWidth ();
+    float w = getWidth ();
+    ratio = ( float ) l / ( float ) w;
+
+}
+
+//telem is canceled
+long OSMainWindow::cancel ( FXObject * sender, FXSelector, void * )
+{
+    FXButton * but = ( FXButton * ) sender;
+    OSThreadExec *te = ( OSThreadExec * ) but->getUserData ();
+    te->mutex.lock ();
+    te->cancel = true;
+    te->mutex.unlock ();
+}
+
+
+
+
+//load icon from file and put in the array
+void OSMainWindow::loadicons ( string icondir )
+{
+
+    objmanager = OSObjectManager::instance( getApp() );
+
+
+    FXIconSource *source = new FXIconSource ( getApp () );
+    FXString fil = icondir.c_str();
+    FXString name = fil + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/dir/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 0 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 0 ] )
+        objmanager->specialicons[ 0 ] ->create();
+    name = fil + "big_" + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/dir/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 1 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 1 ] )
+        objmanager->specialicons[ 1 ] ->create();
+    name = fil + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/all/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 2 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 2 ] )
+        objmanager->specialicons[ 2 ] ->create();
+    name = fil + "big_" + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/all/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 3 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 3 ] )
+        objmanager->specialicons[ 3 ] ->create();
+    name = fil + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/executable/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 4 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 4 ] )
+        objmanager->specialicons[ 4 ] ->create();
+    name = fil + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/symlink/icon" ).c_str() + ".png";
+    objmanager->specialicons[ 5 ] = source->loadIcon ( name );
+    if ( objmanager->specialicons[ 5 ] )
+        objmanager->specialicons[ 5 ] ->create();
+
+
+    struct stat status;
+    struct dirent *dp;
+    DIR *dirp;
+
+    dirp = opendir ( icondir.c_str () );
+
+    if ( dirp )
+        while ( ( dp = readdir ( dirp ) ) != NULL )
+        {
+
+            if ( dp->d_name[ 0 ] != '.' || ( dp->d_name[ 1 ] != '\0' && ( dp->d_name[ 1 ] != '.' || dp->d_name[ 2 ] != '\0' ) ) )
+            {
+                string name = dp->d_name;
+
+                //if (name.length () >= 3 && (name.substr (name.length () - 3, 3) == "gif" || name.substr (name.length () - 3, 3) == "png"))
+                {
+
+                    string file = icondir;
+                    file.append ( name );
+                    string shortname = name.substr ( 0, name.length () - 4 );
+
+                    FXString fil_name = file.c_str();
+
+                    objmanager->osicons[ shortname ] = source->loadIcon ( fil_name );
+
+                    objmanager->osicons[ shortname ] ->create ();
+
+
+                }
+
+            }
+        }
+
+    closedir ( dirp );
+
+
+}
+
+
+// read color definied as FF FF FF and return FXColor
+FXColor readcolor ( string col )
+{
+    if ( col == "" )
+        return FXRGB ( 0, 0, 0 );
+
+    return fxcolorfromname( col.c_str() );
+
+}
+
+
+//the same as above but defualt color is white
+FXColor readcolor2 ( string col )
+{
+    if ( col == "" )
+        return FXRGB ( 255, 255, 255 );
+    return fxcolorfromname( col.c_str() );
+}
+
+string OSMainWindow::parseDir ( string dir )
+{
+    if ( dir == "{homedir}" )
+        return FXFile::getHomeDirectory ().text ();
+
+    else
+        return dir;
+}
+
+bool OSMainWindow::loadMimeSettings ( string path, string type )
+{
+
+    string res2 = conf->readonestring ( path + "/icon" );
+    string colorstr = conf->readonestring ( path + "/color" );
+    FXColor color = readcolor ( colorstr );
+    string backcolorstr = conf->readonestring ( path + "/backcolor" );
+    FXColor backcolor = readcolor2 ( backcolorstr );
+    if ( res2 != "" )
+        objmanager->file_type_settings[ type ] = new OSFileTypeSymbol ( objmanager->osicons[ res2 ], objmanager->osicons[ "big_" + res2 ], color, backcolor );
+    else
+        return false;
+
+}
+
+
+
+
+//-----FRAME---------------------------------------------------------------------------------------------------------------------------
+Frame::Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position = 0 )
+{
+    this->pathdir = pt.dir;
+    this->type = pt.type;
+    string path = pathdir;
+    hf = new FXHorizontalFrame ( cp, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
+    pathdir = path;
+    firstbutton=NULL;
+    
+    
+    FXButton *prebutton = NULL;
+    FXButton *nextbutton = NULL;
+
+    OSObjectManager*objmanager = OSObjectManager::instance( cp->getApp() );
+
+    toleft = new FXButton ( hf, "", objmanager->osicons[ "left" ], tgt, OSMainWindow::ID_TOLEFT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toleft->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    toclose = new FXButton ( hf, "", objmanager->osicons[ "close" ], tgt, OSMainWindow::ID_TOCLOSE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toclose->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    toright = new FXButton ( hf, "", objmanager->osicons[ "right" ], tgt, OSMainWindow::ID_TORIGHT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toright->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    if ( pt.server != "" )
+    {
+        string lab = pt.server + ": ";
+        new FXLabel( hf, lab.c_str() );
+    }
+
+    if ( position != 0 )
+    {
+        toleft->hide ();
+        toclose->hide ();
+        toright->hide ();
+    }
+   
+    generate_menu(pathdir,tgt);
+
+    frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
+    f = new OSFileList ( frame, pt );
+    if ( position == 0 )
+    {
+        frame->hide ();
+    }
+}
+
+
+//generate buttons path for given path
+void Frame::generate_menu ( string path, FXObject * tgt )
+{
+
+    OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
+
+    if (path.length()>1 && path[ 0 ] == '/' && path[ 1 ] == '/' )
+        path.erase ( 0, 1 );
+	
+    	if(firstbutton!=NULL)
+	{	
+    	box *boxel = ( box * ) firstbutton->getUserData ();
+    	box *boxbackup = boxel;
+    		while ( boxel )
+    		{
+        		box * boxel_del = boxel;
+       			if ( boxel->nextbutton != NULL )
+            		boxel = ( box * ) boxel->nextbutton->getUserData ();
+        		else
+            		boxel = NULL;
+			
+       		delete boxel_del->bt;
+        	delete boxel_del;
+       		boxel_del->bt = NULL;
+        	boxel_del = NULL;
+    		}
+    	}
+	
+    this->pathdir = path;
+    int z = 0;
+    FXButton *prebutton = NULL;
+    FXButton *nextbutton = NULL;
+    while ( z != -1 )
+    {
+        string path_element = "";
+        z = path.find ( SEPARATOR, 1 );
+        if ( z == -1 )
+            path_element.append ( path );
+
+        else
+            path_element.append ( path.substr ( 0, z ) );
+        path.erase ( 0, z );
+        FXButton *bt = new FXButton ( hf, path_element.c_str (), NULL, tgt,
+                                      OSMainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
+                                      0, 0 );
+        bt->setBackColor ( objmanager->maincolor );
+	
+	if(firstbutton!=NULL)
+        bt->create ();
+	
+        if ( prebutton != NULL )
+        {
+            box * boxel = ( box * ) prebutton->getUserData ();
+            boxel->nextbutton = bt;
+        }
+
+        else
+            firstbutton = bt;
+        bt->setUserData ( new box ( this, prebutton, bt, NULL ) );
+        prebutton = bt;
+    }
+}


Property changes on: trunk/src/OSMainWindow.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMainWindow.h (from rev 245, branches/mloskot-style-refactoring/src/OSMainWindow.h)


Property changes on: trunk/src/OSMainWindow.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMimeApp.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSMimeApp.cpp)


Property changes on: trunk/src/OSMimeApp.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMimeApp.h (from rev 245, branches/mloskot-style-refactoring/src/OSMimeApp.h)


Property changes on: trunk/src/OSMimeApp.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMimeType.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSMimeType.cpp)


Property changes on: trunk/src/OSMimeType.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSMimeType.h (from rev 245, branches/mloskot-style-refactoring/src/OSMimeType.h)


Property changes on: trunk/src/OSMimeType.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSObjectManager.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSObjectManager.cpp)


Property changes on: trunk/src/OSObjectManager.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSObjectManager.h (from rev 245, branches/mloskot-style-refactoring/src/OSObjectManager.h)


Property changes on: trunk/src/OSObjectManager.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSPathType.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSPathType.cpp)


Property changes on: trunk/src/OSPathType.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSPathType.h (from rev 245, branches/mloskot-style-refactoring/src/OSPathType.h)


Property changes on: trunk/src/OSPathType.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSPreferences.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSPreferences.cpp)


Property changes on: trunk/src/OSPreferences.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSPreferences.h (from rev 245, branches/mloskot-style-refactoring/src/OSPreferences.h)


Property changes on: trunk/src/OSPreferences.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSShutter.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSShutter.cpp)


Property changes on: trunk/src/OSShutter.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSShutter.h (from rev 245, branches/mloskot-style-refactoring/src/OSShutter.h)


Property changes on: trunk/src/OSShutter.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSThreadExec.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSThreadExec.cpp)


Property changes on: trunk/src/OSThreadExec.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSThreadExec.h (from rev 245, branches/mloskot-style-refactoring/src/OSThreadExec.h)


Property changes on: trunk/src/OSThreadExec.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSUtils.cpp (from rev 245, branches/mloskot-style-refactoring/src/OSUtils.cpp)


Property changes on: trunk/src/OSUtils.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSUtils.h (from rev 245, branches/mloskot-style-refactoring/src/OSUtils.h)


Property changes on: trunk/src/OSUtils.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSVirtualFileSystemBase.h (from rev 245, branches/mloskot-style-refactoring/src/OSVirtualFileSystemBase.h)


Property changes on: trunk/src/OSVirtualFileSystemBase.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSVirtualFileSystemHeader.h (from rev 245, branches/mloskot-style-refactoring/src/OSVirtualFileSystemHeader.h)


Property changes on: trunk/src/OSVirtualFileSystemHeader.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/OSVirtualFileSystemInfo.h (from rev 245, branches/mloskot-style-refactoring/src/OSVirtualFileSystemInfo.h)


Property changes on: trunk/src/OSVirtualFileSystemInfo.h
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/cmddialog.cpp
===================================================================
--- trunk/src/cmddialog.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/cmddialog.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,33 +0,0 @@
-#include "fx.h"
-
-#include "cmddialog.h"
-
-
-FXIMPLEMENT (cmddialog, FXDialogBox, NULL, 0) 
-cmddialog::cmddialog (FXWindow * owner, filelist_base * fb, vector < string > src):
-FXDialogBox (owner, "command", DECOR_TITLE | DECOR_BORDER)
-{
-
-    this->src = src;
-    this->fb = fb;
-    FXObject *tgt = (FXObject *) owner;
-    contents = new FXVerticalFrame (this, LAYOUT_SIDE_TOP | FRAME_NONE | LAYOUT_FILL_X | PACK_UNIFORM_WIDTH);
-
-    buttons = new FXHorizontalFrame (this, LAYOUT_SIDE_TOP | FRAME_NONE | LAYOUT_FILL_X | LAYOUT_FILL_Y | PACK_UNIFORM_WIDTH);
-    ok = new FXButton (buttons, "OK", NULL, owner, ID_COMMAND, BUTTON_INITIAL | FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0);
-    cancel = new FXButton (buttons, "CANCEL", NULL, tgt, ID_CANCEL_COMMAND, FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0);
-
-
-}
-
-
-
-
-
-
-cmddialog::~cmddialog ()
-{
-    
-    delete contents;
-    delete buttons;
-}

Deleted: trunk/src/cmddialog.h
===================================================================
--- trunk/src/cmddialog.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/cmddialog.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,39 +0,0 @@
-#ifndef CMDDIALOG
-#define CMDDIALOG
-
-#include "filelist_base.h"
-
-class cmddialog:public FXDialogBox
-{
-  FXDECLARE (cmddialog) 
-
-    
-  protected:
-     cmddialog ()
-    {
-    }
-    FXVerticalFrame * contents;
-    FXHorizontalFrame *buttons;
-    FXButton *ok;
-    FXButton *cancel;
-    filelist_base *fb;
-    vector < string > src;
-    
-  public:
-     cmddialog (FXWindow * owner, filelist_base * fb = NULL, vector < string > src=vector < string >());
-    virtual int exec (void)
-    {
-    };
-
-    virtual ~ cmddialog ();
-
-    enum
-    {
-	ID_EXEC = FXDialogBox::ID_LAST + 666,
-	ID_COMMAND,
-	ID_CANCEL_COMMAND,
-	ID_LAST,
-    };
-
-};
-#endif

Copied: trunk/src/config.h (from rev 245, branches/mloskot-style-refactoring/src/config.h)


Property changes on: trunk/src/config.h
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/src/config.h.in
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/configure.cpp
===================================================================
--- trunk/src/configure.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/configure.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,434 +0,0 @@
-#include "configure.h"
-
-#include "fx.h"
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-#ifndef PATH_CFG
-#define PATH_CFG        "/usr/local/etc"
-#endif
-
-configure *conf;
-
-configure::configure ()
-{
-
-    doc=NULL;
-}
-
-configure::configure (configure & conf)
-{
-
-    doc = conf.doc;
-    copy = true;
-}
-
-
-configure::~configure ()
-{
-    if (!copy)
-    {
-	FXTRACE ((5, "CONFIGURATION SAVING\n"));
-
-	
-	if(doc)
-	{
-	xmlSaveFormatFileEnc(file.c_str(), doc, "UTF-8", 1);
-	string cmd="xmllint --format " +file+ " -o "+file;
-	system(cmd.c_str());
-	xmlFreeDoc (doc);
-	xmlCleanupParser ();
-	}
-
-    }
-
-}
-
-bool configure::loadconfig(bool restore)
-{
-
-string dir = FXFile::getUserDirectory ("").text ();
-    file = dir +  "/.openspace/openspacerc";
-    
-    if (!FXFile::exists (file.c_str ()))
-    {
-	file = "";
-	file = file + PATH_CFG + SEPARATOR + "openspacerc";
-    }
-    FXTRACE ((5, "OPENING CONFIGRATION FILE %s\n", file.c_str ()));
-
-    doc = xmlParseFile (file.c_str ());
-    copy = false;
-    
-    
-
-	if(!doc)
-	{	
-		if(restore)
-		{
-		fxmessage("restore");
-		doc = xmlParseFile (string(file+".backup").c_str());
-			if(doc)
-			return true;
-		}
-	return false;
-	}
-	else
-	{
-	FXFile::copy(file.c_str(),string(file+".backup").c_str(),true);
-	return true;
-	}
-
-}
-
-
-
-bool configure::readonestring (string path,string &ret)
-{
-
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlNodeSetPtr nodeset;
-    xmlXPathContextPtr context;
-    xmlXPathObjectPtr result;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return false;
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return false;
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return false;
-    }
-
-
-    nodeset = result->nodesetval;
-    keyword = xmlNodeListGetString (doc, nodeset->nodeTab[0]->xmlChildrenNode, 1);
-    if(keyword!=NULL)
-    retstring = string ((char *) keyword);
-    xmlFree (keyword);
-
-
-
-
-    xmlXPathFreeObject (result);
-    ret=retstring;
-    return true;
-
-}
-
-string configure::readonestring (string path)
-{
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlNodeSetPtr nodeset;
-    xmlXPathContextPtr context;
-    xmlXPathObjectPtr result;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return "";
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return "";
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return "";
-    }
-
-
-    nodeset = result->nodesetval;
-    keyword = xmlNodeListGetString (doc, nodeset->nodeTab[0]->xmlChildrenNode, 1);
-    if(keyword!=NULL)
-    retstring = string ((char *) keyword);
-    xmlFree (keyword);
-
-
-
-
-    xmlXPathFreeObject (result);
-
-    return retstring;
-
-}
-
-
-bool configure::removestring (string path)
-{
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlNodeSetPtr nodeset;
-    xmlXPathContextPtr context;
-    xmlXPathObjectPtr result;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return false;
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return false;
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return false;
-    }
-
-
-    nodeset = result->nodesetval;
-    /*keyword = xmlNodeListGetString(doc, nodeset->nodeTab[0]->xmlChildrenNode, 1);
-       retstring=string((char*)keyword);
-       xmlFree(keyword);
-     */
-    //delete nodeset->nodeTab[0]; 
-    //nodeset->nodeTab[0] = NULL;
-
-    //xmlXPathFreeNodeSet(nodeset->nodeTab[0]);
-
-    xmlUnlinkNode (nodeset->nodeTab[0]);
-    xmlFreeNode (nodeset->nodeTab[0]);
-
-
-
-
-
-    xmlXPathFreeObject (result);
-
-    return true;
-
-}
-
-
-bool configure::saveonestring (string path, string value)
-{
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlNodeSetPtr nodeset;
-    xmlXPathContextPtr context;
-    xmlXPathObjectPtr result;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return "";
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return false;
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return false;
-    }
-
-
-    nodeset = result->nodesetval;
-
-
-
-
-    int size;
-    int i;
-    size = (nodeset) ? nodeset->nodeNr : 0;
-
-
-    for (i = size - 1; i >= 0; i--)
-    {
-
-	xmlNodeSetContent (nodeset->nodeTab[i], (xmlChar *) value.c_str ());
-
-
-
-	if (nodeset->nodeTab[i]->type != XML_NAMESPACE_DECL)
-	    nodeset->nodeTab[i] = NULL;
-    }
-
-
-
-
-
-    xmlXPathFreeObject (result);
-
-    return true;
-
-}
-
-
-bool configure::addstring (string path, string node, string value)
-{
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlNodeSetPtr nodeset;
-    xmlXPathContextPtr context;
-    xmlXPathObjectPtr result;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return false;
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return false;
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return false;
-    }
-
-
-    nodeset = result->nodesetval;
-
-   xmlNewChild (nodeset->nodeTab[0], NULL, (xmlChar *) node.c_str (), (xmlChar *) value.c_str ());
-
-
-
-
-    xmlXPathFreeObject (result);
-
-    return true;
-
-}
-
-
-
-int configure::openxpath (string path)
-{
-
-    xmlChar *xpath = (xmlChar *) path.c_str ();
-    xmlChar *keyword;
-    string retstring;
-
-
-    xmlXPathContextPtr context;
-
-    context = xmlXPathNewContext (doc);
-    if (context == NULL)
-	return -1;
-
-    result = xmlXPathEvalExpression (xpath, context);
-    xmlXPathFreeContext (context);
-    if (result == NULL)
-	return -1;
-
-
-    if (xmlXPathNodeSetIsEmpty (result->nodesetval))
-    {
-	return -1;
-    }
-    nodeset = result->nodesetval;
-
-    cur = nodeset->nodeTab[0]->xmlChildrenNode;
-    pos = 0;
-    return 0;
-
-}
-
-bool configure::getnextnode (string &ret)
-{
-
-    string retstring;
-    if (cur)
-    {
-	if (cur->next)
-	{
-	    retstring = string ((char *) cur->next->name);
-	    
-	}
-	else
-	    return false;
-    }
-    else
-	return false;
-
-    if(cur->next!=NULL)
-    cur = cur->next->next;
-    else
-    return false;
-
-    ret=retstring;	
-    return true;
-
-
-
-}
-
-
-bool configure::getnextstring (string &ret)
-{
-
-
-    xmlChar *keyword;
-
-    if (nodeset->nodeNr == pos)
-    {
-	xmlXPathFreeObject (result);
-	return false;
-    }
-
-
-
-    keyword = xmlNodeListGetString (doc, nodeset->nodeTab[pos]->xmlChildrenNode, 1);
-    string retstring = string ((char *) keyword);
-
-    xmlFree (keyword);
-    pos++;
-    ret=retstring;
-    return true;
-
-
-
-}
-
-int configure::countxpath (string path)
-{
-    int counter = 0;
-    openxpath (path);
-    string res;
-    while (getnextstring (res))
-    {
-	counter++;
-    }
-    return counter;
-}
-

Deleted: trunk/src/configure.h
===================================================================
--- trunk/src/configure.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/configure.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,42 +0,0 @@
-#ifndef CONFIGURE
-#define CONFIGURE
-
-
-#include <libxml/parser.h>
-#include <libxml/xpath.h>
-
-#include <string>
-using namespace std;
-
-//read and save to XML config file
-class configure
-{
-  public:
-    configure::configure ();
-    configure::configure (configure & conf);
-    configure::~configure ();
-    
-
-    bool loadconfig(bool restore=false);
-    string readonestring (string path);
-    bool configure::readonestring (string path,string &ret);
-    bool configure::saveonestring (string path, string value);
-    bool configure::addstring (string path, string node, string value);
-    int configure::openxpath (string path);
-    bool configure::getnextstring (string &ret);
-    bool configure::getnextnode (string &ret);
-    int configure::countxpath (string path);
-    bool configure::removestring (string path);
-    
-  private:  
-    string file;
-    xmlDocPtr doc;
-
-    bool copy;
-
-    int pos;
-    xmlXPathObjectPtr result;
-    xmlNodeSetPtr nodeset;
-    xmlNodePtr cur;
-};
-#endif

Deleted: trunk/src/filelist.cpp
===================================================================
--- trunk/src/filelist.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/filelist.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,2328 +0,0 @@
-
-#include <string>
-#include <map>
-#include <vector>
-#include <list>
-
-
-using namespace std;
-
-#include "MimeType.h"
-
-#include "pathtype.h"
-#include "fx.h"
-#include "osfile.h"
-#include "FXDLL.h"
-#include "filelist.h"
-#include "cmddialog.h"
-#include <fcntl.h>
-#include <sys/vfs.h>
-#include <fxkeys.h>
-
-
-#include <time.h>
-
-
-#include "sharedobjects.h"
-
-#include "oslistitem.h"
-#include "shutter.h"
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-#include <sys/mount.h>
-
-FXDEFMAP (filelist) filelistMap[] =
-{
-FXMAPFUNC (SEL_FOCUSIN, filelist::ID_ICO, filelist::setFocus),
-	FXMAPFUNC (SEL_FOCUSOUT, filelist::ID_ICO, filelist::lostFocus),
-	FXMAPFUNC (SEL_DOUBLECLICKED, filelist::ID_ICO, filelist::openfile),
-	FXMAPFUNC (SEL_CLICKED, filelist::ID_ICO, filelist::click),
-	FXMAPFUNC (SEL_MIDDLEBUTTONPRESS, filelist::ID_ICO, filelist::gotoparentdir),
-	FXMAPFUNC (SEL_RIGHTBUTTONRELEASE, filelist::ID_ICO, filelist::onPopup),
-	FXMAPFUNCS (SEL_COMMAND, filelist::ID_LAST, filelist::ID_LAST + 50, filelist::file_operation),
-	FXMAPFUNCS (SEL_COMMAND, filelist::ID_LAST+51, filelist::ID_LAST + 100, filelist::key_shortcut),
-	FXMAPFUNC (SEL_COMMAND, filelist::ID_TEXTFIELD_RUN, filelist::texfield_run),	
-	FXMAPFUNC (SEL_COMMAND, filelist::ID_HEADER_CHANGE, filelist::onCmdHeader),
-	FXMAPFUNC (SEL_COMMAND, filelist::ID_SORT_CHANGE, filelist::onCmdHeader),
-	FXMAPFUNC (SEL_LEAVE, filelist::ID_HEADER_CHANGE, filelist::onCmdResize),	
-	FXMAPFUNC (SEL_COMMAND, cmddialog::ID_COMMAND, filelist::onCommand),
-	FXMAPFUNC (SEL_COMMAND, cmddialog::ID_CANCEL_COMMAND, filelist::onCommandCancel),
-	FXMAPFUNC (SEL_DRAGGED, 0, filelist::onDragged),
-	FXMAPFUNC (SEL_DND_ENTER, 0, filelist::onDNDEnter),
-	FXMAPFUNC (SEL_DND_LEAVE, 0, filelist::onDNDLeave),
-	FXMAPFUNC (SEL_DND_DROP, 0, filelist::onDNDDrop),
-	FXMAPFUNC (SEL_DND_MOTION, 0, filelist::onDNDMotion),
-	FXMAPFUNC (SEL_DND_REQUEST, 0, filelist::onDNDRequest),
-	FXMAPFUNC (SEL_BEGINDRAG, 0, filelist::onBeginDrag),
-	FXMAPFUNC (SEL_ENDDRAG, 0, filelist::onEndDrag),
-	//FXMAPFUNC (SEL_CLIPBOARD_LOST, 0, filelist::onClipboardLost), 
-	//FXMAPFUNC (SEL_CLIPBOARD_GAINED, 0, filelist::onClipboardGained), 
-	FXMAPFUNC (SEL_CLIPBOARD_REQUEST, 0, filelist::onClipboardRequest),
-		
-	};
-
-FXIMPLEMENT (filelist, FXIconList, filelistMap, ARRAYNUMBER (filelistMap))
-     bool filelist::ascend = true;
-     bool filelist::strcase = false;
-
-
-
-
-//-----FILELIST----------------------------------------------------------------------------------------------------------------------------------------- 
-
-
-
-
-
-
-filelist::filelist (FXComposite * p, pathtype pt):
-FXIconList (p, this, ID_ICO, LAYOUT_FILL_X | LAYOUT_FILL_Y | ICONLIST_EXTENDEDSELECT | ICONLIST_COLUMNS)
-{
-objmanager=objectmanager::instance(getApp());
- 
-FXScrollArea::vertical->setArrowColor(FXRGB(255, 255, 255));
-FXScrollArea::vertical->setShadowColor(objmanager->maincolor);
-FXScrollArea::vertical->setHiliteColor(FXRGB(255, 255, 255));
-FXScrollArea::vertical->setBorderColor(FXRGB(255, 255, 255));
-FXScrollArea::vertical->setBackColor(objmanager->maincolor);
-
-FXScrollArea::horizontal->setArrowColor(FXRGB(255, 255, 255));
-FXScrollArea::horizontal->setShadowColor(objmanager->maincolor);
-FXScrollArea::horizontal->setHiliteColor(FXRGB(255, 255, 255));
-FXScrollArea::horizontal->setBorderColor(FXRGB(255, 255, 255));
-FXScrollArea::horizontal->setBackColor(objmanager->maincolor);
-
-    flags |= FLAG_ENABLED | FLAG_DROPTARGET;
-    popupmenu = NULL;
-    sortpop = NULL;
-
-    icons_size=atoi(conf->readonestring ("/OpenspaceConfig/icon_size").c_str());   
-    if(conf->readonestring ("/OpenspaceConfig/show_hidden_files")=="true")
-    show_hidden_files=true;
-    else
-    show_hidden_files=false;
-
-    dropaction = DRAG_MOVE;   
-
-   
-    setKeys();
-    setFont (objmanager->captionfont3);
-    specialicons = objmanager->specialicons;
-
-
-    thumb_size = 0;
-    this->path = pt.dir;
-    this->type = pt.type;
-
-    if (type == "local")
-    {
-	string size = conf->readonestring ("/OpenspaceConfig/filelist/local/thumbs/size");
-	thumb_size = atoi (size.c_str ());
-    }
-
-    string style = conf->readonestring ("/OpenspaceConfig/filelist/" + this->type + "/style");
-    if (style == "big icons")
-    {
-	this->setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_BIG_ICONS | ICONLIST_COLUMNS);
-	setFont (objmanager->captionfont1);
-    }
-    else if (style == "small icons")
-	this->setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_MINI_ICONS | ICONLIST_COLUMNS);
-    else if (style == "detailed")
-	this->setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_DETAILED | ICONLIST_COLUMNS);
-
-
-    sort_nr = 0;
-
-
-    notifyparent = getShell ();
-
-    active = false;
-
-	FXDockSite *docksite = new FXDockSite (p, LAYOUT_SIDE_TOP | LAYOUT_FILL_X);
-	FXToolBarShell *dragshell1 = new FXToolBarShell (this, FRAME_RAISED);
-	toolbar = new FXToolBar (docksite, dragshell1, LAYOUT_DOCK_NEXT | LAYOUT_SIDE_TOP | LAYOUT_FILL_X | FRAME_RAISED);
-	new FXToolBarGrip (toolbar, toolbar, FXToolBar::ID_TOOLBARGRIP, TOOLBARGRIP_DOUBLE);
-
-
-        toolbar2 = new FXToolBar (docksite, dragshell1,LAYOUT_DOCK_NEXT | LAYOUT_SIDE_TOP | FRAME_RAISED);
-        new FXToolBarGrip (toolbar2, toolbar2, FXToolBar::ID_TOOLBARGRIP, TOOLBARGRIP_SINGLE);
-
-
-int command_num=0;
-
-
- if(conf->openxpath("/OpenspaceConfig/toolbars")!=-1)
-	       {
-	       string commandstr;
-	      	 while(conf->getnextnode(commandstr))
-	      	 {     	 
-	     	 
-
-		 
-		 configure conflocal=*conf;		 
-		 
-		  if(conflocal.openxpath("/OpenspaceConfig/toolbars/"+commandstr+"/command")!=-1)
-	     	  {
-	      	 string res;
-	      		 while(conflocal.getnextstring(res))
-	      		 {     	 
-				
-		
-			FXToolBar *toolb;
-			if(commandstr=="toolbar1")
-			toolb=toolbar;
-			else
-			toolb=toolbar2;
-			
-			if(res=="SEPARATOR")
-			{
-			 new FXSeparator (toolb, SEPARATOR_NONE);
-   			 new FXSeparator (toolb, SEPARATOR_GROOVE);
-   			 new FXSeparator (toolb, SEPARATOR_NONE);
-			}
-			else
-			{
-			string name=conf->readonestring ("/OpenspaceConfig/commands/"+res+"/icon");
-				if(name=="")
-				new FXButton (toolb, res.c_str (), NULL, this, ID_LAST + command_num, FRAME_RAISED | LAYOUT_TOP | LAYOUT_LEFT | BUTTON_TOOLBAR, 0, 0, 0, 0, 0, 0, 0, 0);
-				else
-				{
-				string cmd_txt=conf->readonestring ("/OpenspaceConfig/commands/"+res+"/text");
-				if(cmd_txt=="")
-				cmd_txt=res;
-				cmd_txt="\t"+cmd_txt;
-			
-				new FXButton (toolb, cmd_txt.c_str(), objmanager->osicons[name], this, ID_LAST + command_num, FRAME_RAISED | LAYOUT_TOP | LAYOUT_LEFT | BUTTON_TOOLBAR, 0, 0, 0, 0, 0, 0, 0, 0);
-				}
-			
-				button_commands_tab.push_back(res);
-		       		command_num++;
-			 }	
-			 }
-	     	  }
-		 
-		 
-	     	 }
-	       }	 
-
-
-if (conf->openxpath ("/OpenspaceConfig/button_commands/command") != -1)
-    {
-
-    string res;
-	while (conf->getnextstring (res))
-	{
-		   	
-
-	    
-	}
-  }
-
-
-	
-
-
-    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/filelist/libfilelist" + this->type;
-
-
-#ifdef WIN32
-    plugin_path += ".dll";
-#else
-    plugin_path += ".so";
-#endif
-
-    if(!FXFile::exists(plugin_path.c_str()))
-	{
-	plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libfilelist")+ this->type;
-	#ifdef WIN32
-	plugin_path += ".dll";
-	#else
-	plugin_path += ".so";
-	#endif
-	}
-    
-    void *dllhandle = fxdllOpen (plugin_path.c_str ());
-    if (dllhandle)
-    {
-	
-	filelist_base *(*gg) (void);
-	gg = (filelist_base * (*)(void)) fxdllSymbol (dllhandle, "get_filelist");
-	fb = gg ();
-
-	FXIconListSortFunc sortfunc = filelist::cmp;
-	setSortFunc (sortfunc);
-
-//label=new FXLabel (p,this->path.c_str());
-	info = new FXLabel (p, fb->info ().c_str ());
-	
-
-	//bottomframe = new FXHorizontalFrame (toolbar, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-	textfield = new FXTextField (toolbar, 30, this, filelist::ID_TEXTFIELD_RUN);
-
-	dial = NULL;
-	processing = false;
-	this->pt = new pathtype (pt);
-	
-	
-    vector_name.push_back ("name");
-    string wi;
-
-    if ((wi = conf->readonestring ("/OpenspaceConfig/filelist/"+type+"/properties/name/width")) != "")
-	vector_width.push_back (atoi (wi.c_str ()));
-    else
-	vector_width.push_back (100);
-
-    vector_type.push_back (0);
-
-
-    int counter = 1;
-
-   // display_size = conf->readonestring ("/OpenspaceConfig/filelist/"+type+"/properties/name/display");
-
-    if (conf->openxpath ("/OpenspaceConfig/filelist/"+type+"/headers/header") != -1)
-    {
-    string res;
-	while (conf->getnextstring (res))
-	{
-
-
-	    if ((wi = conf->readonestring ("/OpenspaceConfig/filelist/"+type+"/properties/" + res + "/width")) != "")
-		vector_width.push_back (atoi (wi.c_str ()));
-	    else
-		vector_width.push_back (40);
-
-
-	    vector_name.push_back (res);
-
-	    string fieldtype=conf->readonestring ("/OpenspaceConfig/filelist/"+type+"/properties/" + res + "/type");
-	    	    
-	    if (fieldtype == "size")
-		vector_type.push_back (1);
-	    else if(fieldtype == "date")
-	    	vector_type.push_back (2);	
-	    else
-		vector_type.push_back (0);
-
-	    counter++;
-	}
-    }
-	
-	
-	
-	//if(type!="local")
-	if (1)
-	{
-	    processing = true;
-	    thread_elem *el = new thread_elem (fb, "init", "none");
-	    start_thread (el);
-	}
-	else
-	    init ();
-
-
-    }
-}
-
-long filelist::texfield_run (FXObject * obj, FXSelector sel, void *ptr)
-{
-
-system(textfield->getText ().text());
-
-}
-
-filelist::~filelist ()
-{
-	
-
-
-
-    delete sortpop;
-    FXTRACE ((5, "destruct\n"));
-
-}
-
-//--------------------------------------------------------------------
-//initializing fuction, get availible headers from filelist plugin
-bool filelist::init ()
-{
-
-
-
-    if (!processing)
-	fb->init (&vector_name,*pt, conf);
-
-    for (int i = 0; i < vector_name.size (); i++)
-    {
-
-	appendHeader (vector_name[i].c_str (), NULL, vector_width[i]);
-	unsigned int test = vector_type[i];
-	header_vec.push_back (vector_name[i]);
-    }
-
-
-    sortpop = new FXPopup (this);
-
-    int indx;
-
-    for (indx = 0; indx < header_vec.size (); indx++)
-    {
-	new FXOption (sortpop, header_vec[indx].c_str (), NULL, this, ID_SORT_CHANGE, FRAME_THICK | JUSTIFY_HZ_APART | ICON_AFTER_TEXT);
-    }
-
-    new FXOption (sortpop, "file type", NULL, this, ID_SORT_CHANGE, FRAME_THICK | JUSTIFY_HZ_APART | ICON_AFTER_TEXT);
-
-    sortmenu = new FXOptionMenu (toolbar, sortpop, LAYOUT_TOP |FRAME_THICK | JUSTIFY_HZ_APART | ICON_AFTER_TEXT);
-
-    if (processing)
-	sortmenu->create ();
-
-    toolbar->recalc ();
-    processing = false;
-    
-    string initialdir=fb->getinitialdir();
-    if(this->path=="/" && initialdir!="/")
-    {
-    this->path=initialdir;
-    //notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-    
-    }
-    
-    return opendir (this->path);
-    
-
-}
-
-
-//return default command for given filename
-
-string filelist::getdefaultcommand (string name)
-{
-
-    string ext = getfiletype (name);
-    string key = "";
-    if (ext != "")
-    {
-	string str = "/types/";
-	ext = ext.replace (ext.find ("/"), 1, str);
-	key = conf->readonestring ("/OpenspaceConfig/file_types/" + ext + "/default");
-    }
-
-    if (key == "")
-    {
-	ext = ext.substr (0, ext.find ("/"));
-	key = conf->readonestring ("/OpenspaceConfig/file_types/" + ext + "/default");
-    }
-
-
-   
-	return key;
-}
-
-//return file type for given name
-string filelist::getfiletype (string name)
-{
-
-    //std::transform (name.begin (), name.end (), name.begin (), std::tolower);
-
-    string r = MimeType::getMimeFromName (name);
-
-    //printf("Name: '%s' MimeType: '%s'\n", name.c_str(), r.c_str());
-
-    return r;
-
-}
-
-	 
- 
-
-//return command with replaced {f} with valid path
-string filelist::resolvecommand(string command,string name)
-{
-string res;
-	if (command != "")
-	    res = conf->readonestring ("/OpenspaceConfig/commands/" + command + "/exec");
-	else
-	    return "";
-
-	if (res == "INTERNAL")
-	{
-	    FXTRACE ((5, "INTERNAL"));
-	    return "INTERNAL";
-	}
-	else if(res == "VFS")
-	{
-	 FXTRACE ((5, "VFS"));
-	    return "VFS";
-	}
-	
-	string fullname;
-	
-	if(this->type=="local")
-		fullname = "\"" + returnpath(name) + "\"";
-	else
-	{
-		fullname = "\"/tmp/openspace/" + name + "\"";
-	}	
-	
-	int pos = res.find ("{f}");
-	res.replace (pos, fullname.length (), fullname);
-	return res;
-
-
-}
-
-
-
-void filelist::create ()
-{
-
-    FXIconList::create ();
-    if (!deleteType)
-    {
-	deleteType = getApp ()->registerDragType (deleteTypeName);
-    }
-    if (!urilistType)
-    {
-	urilistType = getApp ()->registerDragType (urilistTypeName);
-    }
-
-}
-
-long filelist::key_shortcut (FXObject * obj, FXSelector sel, void *ptr)
-{
-
-    FXushort id = FXSELID (sel);
-    
-    string com_name;
-
-    com_name = key_commands_tab[id - ID_LAST-51];
-
-    runCommand(com_name);
-
-}
-
-//--------------------------------------------------------------------------------
-//bind keys
-long filelist::setKeys (void)
-{
-FXAccelTable *table = getShell ()->getAccelTable ();
-int counter=0;
-	if (conf->openxpath ("/OpenspaceConfig/commands") != -1)
-  	  {
-		string res;
-		while (conf->getnextnode (res))
-		{
-		configure conflocal = *conf;
-	   	string key = conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/key");
-		string key_mask = conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/key_mask");
-			if(key!="")
-			{
-			unsigned int mask=0;
-			
-			if(key_mask=="control")
-				mask=CONTROLMASK;
-			else if(key_mask=="alt")
-				mask=ALTMASK;
-			
-			table->addAccel (MKUINT ((FXushort)objmanager->key_map[key],mask ), this, FXSEL (SEL_COMMAND, ID_LAST+51+counter));
-			key_commands_tab.push_back(res);
-			counter++;
-			}
-		}
-	  }	
-	    
-	    
-
-
-/*    
-    table->addAccel (MKUINT (KEY_a, CONTROLMASK), this, FXSEL (SEL_COMMAND, filelist::ID_SELECT_ALL));
-    table->addAccel (MKUINT (KEY_c, CONTROLMASK), this, FXSEL (SEL_COMMAND, filelist::ID_CLIP_COPY));
-    table->addAccel (MKUINT (KEY_x, CONTROLMASK), this, FXSEL (SEL_COMMAND, filelist::ID_CLIP_CUT));
-    table->addAccel (MKUINT (KEY_v, CONTROLMASK), this, FXSEL (SEL_COMMAND, filelist::ID_CLIP_PASTE));
-    table->addAccel (MKUINT (KEY_F5, 0), this, FXSEL (SEL_COMMAND, filelist::ID_REFRESH));
-    table->addAccel (MKUINT (KEY_Delete, 0), this, FXSEL (SEL_COMMAND, filelist::ID_REMOVE));
-*/
-}
-
-//copy/move/remove function
-void filelist::copymoveremove (string com_name)
-{
-
-	if(com_name=="remove")
-	{
-	FXMessageBox about (this, "?", "Are you sure to remove selected files?", NULL, MBOX_YES_NO | DECOR_TITLE | DECOR_BORDER);
-    
-		if(about.execute ()==MBOX_CLICKED_NO)
-		return;
-	}
-	
-	
-    int selit = 0;
-
-    for (int c = 0; c < getNumItems (); c++)
-    {
-	if (isItemSelected (c))
-	    selit++;
-    }
-
-
-    vector<string> src;
-    for (int c = 0; c < getNumItems (); c++)
-    {
-	if (isItemSelected (c))
-	{
-	    src.push_back( returnpath(getItemText (c).text ()));
-	}
-
-
-    }
-
-    string options;
-    filelist_base *fil = fb;
-
-
-    if (this->type == "local" && com_name != "remove")
-    {
-	options = "download";
-	fil = filelist_opposite->fb;
-    }
-    else  //type other than local
-	options = "upload";
-
-
-
-    if(this->type=="local" || filelist_opposite->type=="local" || com_name=="remove")
-    {
-    FXTRACE ((5, "copy/move/remove"));
-    thread_elem *el = new thread_elem (fil, com_name, options, src,filelist_opposite->path);
-    start_thread (el);
-    }
-    else
-    {
-    FXMessageBox about (this, "error", "copying/moving beetwen VFS not implemented (yet ;p)", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-    about.execute ();
-    }	
-
-  
-}
-
-//opendir
-bool filelist::opendir (string dir)
-{
-
-
-//label->setText(dir.c_str());
-    
-
-
-    if (fb->osopendir (dir) == -1)
-    {
-    return false;
-    }	
-clearItems ();
-
-
-    for (int indx = 0; indx < icon_vec.size (); indx++)
-    {
-	icon_vec[indx]->detach ();
-	delete icon_vec[indx];
-    }
-
-    icon_vec.erase (icon_vec.begin (), icon_vec.end ());
-
-
-
-    int count = 0;
-    while (1)
-    {
-
-	count++;
-	osfile os_file = fb->osreaddir ();
-
-	if (os_file.name == "")
-	    break;
-
-	if(os_file.name[0]=='.' && show_hidden_files==false)
-	continue;
-	
-	FXColor color;
-	FXColor backcolor;
-	FXIcon *icon = NULL;
-	FXIcon *icon2 = NULL;
-
-	
-	if (os_file.type & FOLDER)
-	{
-	    color = readcolor (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/dir/color"));
-	    backcolor = readcolor2 (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/dir/backcolor"));
-	    icon = specialicons[1];
-	    icon2 = specialicons[0];
-	}
-	else
-	{
-
-	    string ext = getfiletype (os_file.name);
-	    file_type *filet = NULL;
-	    if (ext != "")
-	    {
-		filet = objmanager->file_type_settings[ext];
-		if (filet == NULL)
-		{
-		    ext = ext.substr (0, ext.find ("/"));
-
-		    filet = objmanager->file_type_settings[ext];
-		}
-
-	    }
-
-
-
-
-	    if (filet)
-	    {
-		icon2 = filet->icon;
-		icon = filet->bigicon;
-		color = filet->color;
-		backcolor = filet->backcolor;
-	    }
-	    else
-	    {
-	  
-		icon = specialicons[3];
-		icon2 = specialicons[2];
-		color = readcolor (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/all/color"));
-		backcolor = readcolor2 (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/all/backcolor"));
-	    }
-		
-	    string graphtype=ext.substr(0,5);
-			
-	    if ((type == "local" || type == "search") && graphtype=="image" && os_file.size < thumb_size && (this->getListStyle () & ICONLIST_BIG_ICONS) )
-	    {
-
-		string file = dir+"/" +os_file.name;
-		FXString fil = file.c_str ();
-		FXIconSource *source = new FXIconSource (getApp ());
-		FXIcon *ico = NULL;
-
-		ico = source->loadScaledIcon (fil, icons_size);
-
-		if (ico)
-		{
-		
-		    ico->create ();
-		    icon_vec.push_back (ico);
-		    icon = ico;
-		    icon2 = ico;
-		}
-	
-		
-	    }
-
-
-	}
-
-	if (os_file.type & EXECUTABLE && !(os_file.type & FOLDER))
-	{
-	    color = readcolor (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/executable/color"));
-	    backcolor = readcolor2 (conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/executable/backcolor"));
-	}
-
-
-	appendItem (new os_ListItem (this, os_file, color, backcolor, icon, icon2));
-
-
-    }
-
-    sortItems ();
-
-    struct statfs stats;
-
-    string siz;
-    if (statfs (dir.c_str (), &stats) != -1)
-    {
-
-
-	unsigned long size = stats.f_bsize / 1024 * stats.f_bavail * 1024;
-	siz = numtostring (size);
-
-
-    }
-
-
-    string inf = "files: " + ntos (count) + "   free: " + siz;
-    info->setText (inf.c_str ());
- return true;
-}
-
-
-long filelist::setFocus (FXObject * obj, FXSelector sel, void *ptr)
-{
-
-setKeys();
-    active = true;
-    filelist_opposite->active = false;
-    filelist_opposite->toolbar->hide();
-    filelist_opposite->toolbar2->hide();		
-    toolbar->show();
-    toolbar->recalc();	
-    toolbar2->show();
-    toolbar2->recalc();
-    setBackColor (FXRGB (255, 255, 255));
-    chdir (path.c_str ());
-}
-
-long filelist::lostFocus (FXObject * obj, FXSelector sel, void *ptr)
-{
-//active=false;
-    setBackColor (FXRGB (220, 220, 220));
-
-
-}
-
-
-
-
-void *filelist::thread_func (void *data)
-{
-
-    thread_elem *el = (thread_elem *) data;
-    filelist_base *fb = (filelist_base *) el->fb;
-
-    FXASSERT ((5, "THREAD :) %s\n", el->command.c_str ()));
-
-    filelist *filel = (filelist *) el->filel;
-
-    if (el->command == "copy")
-    {
-	fb->copy (el);
-    }
-    else if (el->command == "move")
-    {
-	fb->move (el);
-    }
-    else if (el->command == "remove")
-    {
-	fb->remove (el);
-    }
-    else if (el->command == "mkdir")
-    {
-	//fb->mkdir(el->src,0); 
-	sleep (5);
-    }
-    else if (el->command == "execute")
-    {
-    string command=el->dst;
-    	if(command=="")//command don't need files as parametr
-	{
-	system (el->src[0].c_str ());
-	}
-	else
-	{
-	
-		bool exportfile=false;
-		
-		if( ((filelist*)el->filel)->type!="local" && ((filelist*)el->filel)->type!="search")
-		exportfile=true;
-			
-		bool simple_command=true;
-		string::size_type pos = command.find ("{F}");
-		if (pos != string::npos)
-		{
-		simple_command=false;
-		}
-		else
-		{
-		pos = command.find ("{f}");
-		}
-
-		string tmpdir;
-		string destdir;
-		string fbdir;
-		if(((filelist*)el->filel)->type!="local")
-		{
-		tmpdir=FXFile::time ("%S%H%M%d%m%y", FXFile::now()).text ();
-		destdir=string("/tmp/openspace/") + tmpdir;
-		FXFile::createDirectory(destdir.c_str(),0);
-		}
-		
-		string Flist;
-		vector <string> Flist_vector;
-		vector <FXTime> Flist_vector_time;
-		vector <FXTime>::iterator time_iter;
-		
-		
-	 	 vector <string>::iterator iter;
-		 for (iter = el->src.begin (); iter != el->src.end (); iter++)
- 		 {
-		 	
-			string tmpfile=*iter;
-				if(exportfile)
-				{
-				string name=FXFile::name(iter->c_str()).text();
-				fbdir=FXFile::directory(iter->c_str()).text();
-				tmpfile=destdir+"/"+name;
-			
-				thread_elem *el2 = new thread_elem (fb, "copy", "upload", *iter,destdir);
-				fb->copy (el2);
-				delete el2;
-				}
-			if(simple_command)
-			{	
-				FXTime t1=FXFile::modified(tmpfile.c_str());
-				string f="\""+tmpfile+"\"";
-				string exec=command.replace (pos, f.length (),f );	
-				system (exec.c_str ());
-				if(exportfile)
-				{	
-				FXTime t2=FXFile::modified(tmpfile.c_str());
-					if(t1!=t2)
-					{
-					thread_elem *el2 = new thread_elem (fb, "copy", "download", tmpfile,fbdir);
-					fb->copy (el2);
-					delete el2;
-					}
-				
-				}
-				
-				
-			}
-			else
-			{
-			Flist=Flist+ " \""+tmpfile+"\" ";
-				if(exportfile)
-				{
-				Flist_vector.push_back(tmpfile);
-				FXTime t1=FXFile::modified(tmpfile.c_str());
-				Flist_vector_time.push_back(t1);
-				}
-			}
-		 
-		 }
-			if(!simple_command)
-			{
-			string exec=command.replace (pos, Flist.length (), Flist);	
-				system (exec.c_str ());	
-				
-				time_iter=Flist_vector_time.begin();
-				vector <string> copysrc;
-				
-				for (iter = Flist_vector.begin (); iter != Flist_vector.end (); iter++)
- 		 		{
-					FXTime t2=FXFile::modified(iter->c_str());
-					if(t2!=*time_iter)
-					{
-					copysrc.push_back(*iter);
-					
-					}
-					time_iter++;
-				}
-				
-				
-				if(copysrc.size()>0)
-				{
-				thread_elem *el2 = new thread_elem (fb, "copy", "download",copysrc,fbdir);
-				fb->copy (el2);
-				delete el2;
-				
-				}
-				
-				
-			}
-		 
-		 
-		if(exportfile)
-		{
-		FXFile::remove(destdir.c_str());
-		}
-		
-		
-	
-	
-	}
-   				
-	
-
-    }
-    else if (el->command == "init")
-    {
-
-	fb->init (&filel->vector_name, (*(filel->pt)), conf);
-
-    }
-
-
-    el->end = true;
-}
-
-
-int filelist::runCommand(string command)
-{
-
-
-string command_type=conf->readonestring ("/OpenspaceConfig/commands/" + command + "/type");
-
-
-/*
-    int k = getCurrentItem ();
-    os_ListItem *oslistitem = (os_ListItem *) getItem (k);
-    string dir=returnpath(getItemText(k).text());
-    string name = oslistitem->osf.name;	
-*/
-
-    if (command_type == "VFS")	//internal command, open new window for virtual file system
-    {
-		int c = getCurrentItem ();
-		string *file = new string (returnpath(getItemText (c).text ()));
-		notifyparent->handle (this, FXSEL (SEL_COMMAND, 667), (void *) file);
-		return 0;
-    }
-    else if (command_type == "EXTERNAL" || command_type=="")
-    {
-
-
-	string res = conf->readonestring ("/OpenspaceConfig/commands/" + command + "/exec");
-	string options = conf->readonestring ("/OpenspaceConfig/commands/" + command + "/options");
-	if (res == "")
-	    return 0;
-	    
-       string exec=res;
-    
-  		bool simple_command=true;
-		int pos = exec.find ("{F}");
-		if (pos != -1)
-		simple_command=false;
-		else
-		pos = exec.find ("{f}");
-		
-	    if (pos == -1)//command don't need any selected files
-	    {
-	
-		thread_elem *el = new thread_elem (fb, "execute", options, res);
-		start_thread (el);
-	    }
-	    else
-	    {
-	    	vector<string> src;
-	
-		
-	    	for (int i = 0; i < getNumItems (); i++)
-		{
-	    		if (isItemSelected (i))
-	   		 {
-		 		 os_ListItem *oslistitem = (os_ListItem *) getItem (i);
-				 string name = oslistitem->osf.name;
-				 string fullname = returnpath(name);
-				 
-				 if(simple_command==true)
-				 {
-				 thread_elem *el = new thread_elem (fb, "execute", options,fullname,exec);
-	  	 		 start_thread (el);
-				 }
-				 else			
-				 src.push_back(fullname);
-				 
-				 				 
-			 }
-	
-		 }
-		 
-		 if(simple_command==false && src.size()>0) 
-		 {
-	   	   thread_elem *el = new thread_elem (fb, "execute", options,src,exec);
-	  	   start_thread (el);
-		 }
-	    
-	    }
-
-
-    }
-
-    else if (command_type == "INTERNAL")
-    {
-
-
-	if (command == "other")
-	{
-	    path = filelist_opposite->path;
-	    //label->setText(path.c_str());
-	    notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-	    opendir (filelist_opposite->path);
-	}
-	else if (command == "copy" || command == "move" || command == "remove")
-	{
-	    copymoveremove (command);
-	}
-	else if (command == "new_file")
-	{
-
-	    string sr = "touch " + returnpath("newfile");
-	    system (sr.c_str ());
-	    refresh ();
-	}
-	else if (command == "totalsize")
-	{
-
-	    unsigned long size = 0;
-	    for (int c = 0; c < getNumItems (); c++)
-	    {
-		if (isItemSelected (c))
-		{
-		    string sr = returnpath(getItemText (c).text ());
-		    if (FXFile::isDirectory (sr.c_str ()))
-			sr.append (SEPARATOR);
-		    fb->totalsize (sr, size);
-
-		}
-
-
-	    }
-
-
-	    string inf = "total size: " + numtostring (size);
-	    info->setText (inf.c_str ());
-	}
-	else if (command == "umount")
-	{
-	    int c = getCurrentItem ();
-	    string sr = returnpath(getItemText (c).text ());
-	    umount2 (sr.c_str (), MNT_FORCE);
-	}
-	else if (command == "refresh")
-	{
-		refresh ();
-	} 
-	else if (command == "select_all")
-	{
-		for (int i = 0; i < getNumItems (); i++)
-		{
-	  	  string name = getItem (i)->getText ().text ();
-	   		 if (name != "." && name != "..")
-			 selectItem (i);
-		}
-	}    
-	else if (command == "home")
-	{
-		 opendir(FXFile::getHomeDirectory ().text ());
-   		 path=FXFile::getHomeDirectory ().text ();
-  		 notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-	} 
-	else if (command == "dirup")
-	{
-		 this->handle (this, FXSEL (SEL_MIDDLEBUTTONPRESS, ID_ICO), NULL);
-	} 
-	else if (command == "change_view_mini_icons")
-	{
-	setFont (objmanager->captionfont3);
-	setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_MINI_ICONS | ICONLIST_COLUMNS);
-	refresh ();
-	conf->saveonestring ("/OpenspaceConfig/filelist/" + this->type + "/style","small icons");
-    	}
-    	else if (command == "change_view_big_icons")
-	{
-	setFont (objmanager->captionfont1);
-	setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_BIG_ICONS | ICONLIST_COLUMNS);
-	refresh ();
-	conf->saveonestring ("/OpenspaceConfig/filelist/" + this->type + "/style","big icons");
-   	}
-	else if (command == "change_view_detailed")
-	{
-	setFont (objmanager->captionfont3);
-	setListStyle (ICONLIST_EXTENDEDSELECT | ICONLIST_DETAILED | ICONLIST_COLUMNS);
-	refresh ();
-	conf->saveonestring ("/OpenspaceConfig/filelist/" + this->type + "/style","detailed");
-    	}
-	else if(command == "clipboard_copy" || command == "clipboard_cut")
-	{
-		  FXDragType types[1];
-   		  types[0] = urilistType;
-    
-  		  if (acquireClipboard (types, 1))
-    		  {
-   
-
-  			 if(command == "clipboard_copy")
-   			 {
-   			 dropaction=DRAG_COPY;
-   			 }
-   			 else if(command == "clipboard_cut")
-   			 {
-   			 dropaction=DRAG_MOVE;
-   			 }
-    
-    
-    			 //FXEvent *event = (FXEvent *) ptr;
-   			  //handleDrag (event->root_x, event->root_y, dropaction);
-     
-			filelist_opposite->dropaction=dropaction;
-
-			dragfiles = FXString::null;
-		for (int i = 0; i < getNumItems (); i++)
-		{
-	   	 if (isItemSelected (i))
-	  	  {
-			os_ListItem *oslistitem = (os_ListItem *) getItem (i);
-			string name = oslistitem->osf.name;
-			string fullname =returnpath(name);
-			if (name != "." && name != "..")
-			{
-			    if (!dragfiles.empty ())
-				dragfiles += "\r\n";
-			    dragfiles += FXURL::fileToURL (fullname.c_str ());
-		    
-			}
-	   	 }
-		}
-
-   	      }
- 
-	}
-	else if(command == "clipboard_paste")
-	{
-		dropData (true);
-	}
-	else if(command == "switch_on_or_two_panel_mode")
-	{
-	
-		if (filelist_opposite->getWidth () == 0)
-		maximize = true;
-
-  		 maximize = !maximize;
-
-  		 if (maximize)
-   		 {
-			conf->saveonestring ("/OpenspaceConfig/panels", "single");
-   		 }
-   		 else
-   		 {
-			conf->saveonestring ("/OpenspaceConfig/panels", "double");
-   		 }
-   	 notifyparent->handle (this, FXSEL (SEL_COMMAND, 668), NULL);
-	
-	}
-	else if(command == "filter_files")
-	{
-
-		for (int i = 0; i < getNumItems (); i++)
-		{
-	  	  deselectItem (i);
-		}
-
-
-		FXRex identifier (textfield->getText ());
-
-		for (int i = 0; i < getNumItems (); i++)
-		{
-	 	   os_ListItem *oslistitem = (os_ListItem *) getItem (i);
-	   	   string name = oslistitem->osf.name;
-	   	 	if (identifier.match (name.c_str ()))
-	   	 	{
-			selectItem (i);
-	   		}
-		}
-
-       }
-       else if(command == "goto_dir")
-       {
-	opendir (textfield->getText ().text ());
-	path = textfield->getText ().text ();
-	notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-       }
-       else if (command == "get_dir")
-       {
-	textfield->setText (path.c_str ());
-       }
-       else if(command=="show_hide_hidden_files")
-       {
-       show_hidden_files=!show_hidden_files;
-       refresh();
-       
-      	 if(show_hidden_files)
-	 conf->saveonestring ("/OpenspaceConfig/show_hidden_files","true");
-	 else
-	 conf->saveonestring ("/OpenspaceConfig/show_hidden_files","false");
-       
-       }
-
-	
-	
-	
-	
-    }
-
-    else if (command_type == "PLUGIN")
-    {
-	
-
-
-
-	string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/cmddialog/lib" + command;
-#ifdef WIN32
-	plugin_path += ".dll";
-#else
-	plugin_path += ".so";
-#endif
-
-	if(!FXFile::exists(plugin_path.c_str()))
-	{
-	plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/cmddialog")+"/lib" + command;
-	#ifdef WIN32
-	plugin_path += ".dll";
-	#else
-	plugin_path += ".so";
-	#endif
-	}
-
-
-	void *dllhandle = fxdllOpen (plugin_path.c_str ());
-
-	fxmessage (fxdllError ().text ());
-
-	if (dllhandle)
-	{
-
-	    int selit = 0;
-
-	    for (int c = 0; c < getNumItems (); c++)
-	    {
-		if (isItemSelected (c))
-		    selit++;
-	    }
-
-	
-	    vector < string > src;
-	    for (int c = 0; c < getNumItems (); c++)
-	    {
-		if (isItemSelected (c))
-		{
-		    src.push_back(returnpath(getItemText (c).text ()));
-		}
-	    }
-	
-	    cmddialog *(*gg) (FXWindow *, filelist_base * fb, vector < string > src);
-	    gg = (cmddialog * (*)(FXWindow *, filelist_base * fb, vector < string > src)) fxdllSymbol (dllhandle, "get_cmddialog");
-	    dial = gg (this, fb, src);
-	    dial->create ();
-
-	    dial->show (PLACEMENT_OWNER);
-
-	}
-
-
-    }
-    
-
-
-}
-
-//double click on file/direcotry in filelist
-long filelist::openfile (FXObject * sender, FXSelector, void *)
-{
-
-    if (processing)
-	return 0;
-
-    int k = getCurrentItem ();
-    os_ListItem *oslistitem = (os_ListItem *) getItem (k);
-  
-    if (oslistitem->osf.type & FOLDER)
-    {
-	string dir = this->path;
-
-	if (getItemText (k) == "..")
-	{
-	    dir = FXFile::upLevel (dir.c_str ()).text ();
-
-	}
-	else if (getItemText (k) == ".")
-	{
-	    dir = dir;
-	}
-	else
-	{
-	    dir=returnpath(getItemText(k).text());
-	}
-
-	;
-	//label->setText(path.c_str());
-	
-	if(opendir (dir))
-	{
-	path = dir;
-	notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-  	
-	}  
-    }
-    else
-    {    
-    	string name = oslistitem->osf.name;
-	string command = getdefaultcommand (name);
-	
-	if(command!="")
-	runCommand(command);	
-        else if (oslistitem->osf.type & EXECUTABLE)
-   	{
-    	    string command=returnpath(oslistitem->osf.name);
-	    command+=" &";
-	    system (command.c_str ());
-   	}
-	else
-	{
-	runCommand(conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/all/default"));
-	
-	}
-			
-    }
-
-}
-
-//----------------------------------------------------  
-// go up dir, 3rd button of mouse 
-long filelist::gotoparentdir (FXObject *, FXSelector, void *)
-{
-    if (processing)
-	return 0;
-
-   string pathnew = FXFile::upLevel (path.c_str ()).text ();
-    
-    if(opendir (pathnew));
-    {
-    this->path = pathnew;
-    notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-    
-    }
-}
-
-
-//----------------------------------------------------   
-//poup menu
-long filelist::onPopup (FXObject *, FXSelector, void *ptr)
-{
-
-    if (processing)
-	return 0;
-
-commands_tab.clear();
-
-    FXEvent *event = (FXEvent *) ptr;
-    selectitem ();
-
-    int k = getCurrentItem ();
-
-    if (popupmenu)
-    {
-	delete popupmenu;
-	popupmenu = NULL;
-    }
-
-    popupmenu = new FXMenuPane (this);
-
-
-
-    FXShutter *shutterFrame = new shutter (popupmenu, this);
-    FXShutterItem *shutterItem;
-
-
-
-    int command_num = 0;
-
-
-    if (conf->openxpath ("/OpenspaceConfig/shutter") != -1)
-    {
-	string res;
-	while (conf->getnextnode (res))
-	{
-
-
-	    configure conflocal = *conf;
-	    //shutterItem = new FXShutterItem(shutterFrame,res.c_str(),NULL,      FRAME_SUNKEN|LAYOUT_FILL_X|LAYOUT_FILL_Y|LAYOUT_TOP|LAYOUT_LEFT,0,0,0,0,0,0,0,0,0,0);
-	    // shutterItem = new FXShutterItem(shutterFrame,res.c_str(),osicons[8],FRAME_NONE|LAYOUT_FILL_X|LAYOUT_FILL_Y|LAYOUT_TOP|LAYOUT_LEFT,0,0,0,0,0,0,0,0,0,0);
-	    shutterItem = new FXShutterItem (shutterFrame, res.c_str (), objmanager->osicons["execute"], FRAME_NONE | LAYOUT_FILL_X | LAYOUT_FILL_Y | LAYOUT_TOP | LAYOUT_LEFT, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-
-	    FXButton *but = shutterItem->getButton ();
-	    FXVerticalFrame *content = shutterItem->getContent ();
-
-	    but->setButtonStyle (BUTTON_TOOLBAR);
-	    but->setIconPosition (ICON_BEFORE_TEXT);
-	    but->setJustify (JUSTIFY_LEFT);
-	    but->setBackColor (objmanager->maincolor);
-	    //but->setBackColor (readcolor (conf->readonestring ("/OpenspaceConfig/colors/maincolor")));
-	    content->setBackColor (getApp ()->getShadowColor ());
-	    if (conflocal.openxpath ("/OpenspaceConfig/shutter/" + res + "/command") != -1)
-	    {
-	    string res;
-		while (conflocal.getnextstring (res))
-		{
-	
-
-		    string comm_s;
-		    if (res == "special")
-		    {
-			int sp = 0;
-			list < string > supported_commands;
-			list < string >::iterator nums_iter;
-
-			for (int i = 0; i < getNumItems (); i++)
-			{
-			    if (isItemSelected (i))
-			    {
-				sp++;
-				os_ListItem *oslistitem = (os_ListItem *) getItem (i);
-				string ext = getfiletype (oslistitem->osf.name);
-				string rep;
-
-				string str = "/types/";
-				ext = ext.replace (ext.find ("/"), 1, str);
-				rep = "file_types/" + ext;
-
-				if (oslistitem->osf.type & FOLDER)
-				{
-				    rep = "file_types/COMMON/types/dir";
-				    ext = "dir";
-				}
-				configure conflocal3 = *conf;
-
-				int open = 0;
-
-				if (ext != "" && conflocal3.openxpath ("/OpenspaceConfig/" + rep + "/commands/command") != -1)
-				{
-				    open++;
-				       string res;
-					while (conflocal3.getnextstring (res))
-					{
-
-
-					if (sp == 1)
-					{
-					    supported_commands.push_back (res);
-					}
-					else	//sp >1
-					{
-					    nums_iter = find (supported_commands.begin (), supported_commands.end (), res);
-					    if (nums_iter == supported_commands.end ())
-					    {
-						supported_commands.remove (res);
-					    }
-					}
-
-
-				    }
-				}
-
-
-
-
-				ext = ext.substr (0, ext.find ("/"));
-				rep = "file_types/" + ext;
-
-				if (ext != "" && conflocal3.openxpath ("/OpenspaceConfig/" + rep + "/commands/command") != -1)
-				{
-				    open++;
-				        string res;
-				   while (conflocal3.getnextstring (res))
-				   {
-
-
-					if (sp == 1)
-					{
-					    supported_commands.push_back (res);
-					}
-					else	//sp >1
-					{
-					    nums_iter = find (supported_commands.begin (), supported_commands.end (), res);
-					    if (nums_iter == supported_commands.end ())
-					    {
-						supported_commands.remove (res);
-					    }
-					}
-
-
-				    }
-				}
-
-				if (open == 0)
-				{
-				    supported_commands.clear ();
-				}
-
-
-			    }
-			}
-
-
-
-
-
-			while (supported_commands.size () > 0)
-			{
-
-			    string res = supported_commands.front ();
-			    supported_commands.pop_front ();
-
-			    configure conflocal2 = conflocal;
-			    string command_text = conflocal2.readonestring ("/OpenspaceConfig/commands/" + res + "/text");
-			    if(command_text=="")command_text=res;
-		
-			    new FXButton (shutterItem->getContent (), command_text.c_str (), 0, this, ID_LAST + command_num, FRAME_RAISED | LAYOUT_FILL_X | LAYOUT_TOP | LAYOUT_LEFT | BUTTON_TOOLBAR, 0, 0, 0, 0, 0, 0, 0, 0);
-			    commands_tab.push_back(res.c_str ());
-			    command_num++;
-
-			}
-
-			continue;
-		    }
-
-		    configure conflocal2 = conflocal;
-		    string command_text = conflocal2.readonestring ("/OpenspaceConfig/commands/" + res + "/text");
-		    if(command_text=="")command_text=res;
-	
-		    new FXButton (shutterItem->getContent (), command_text.c_str (), 0, this, ID_LAST + command_num, FRAME_RAISED | LAYOUT_FILL_X | LAYOUT_TOP | LAYOUT_LEFT | BUTTON_TOOLBAR, 0, 0, 0, 0, 0, 0, 0, 0);
-		    commands_tab.push_back(res.c_str ());
-		    command_num++;
-
-		}
-
-	    }
-
-	}
-    }
-
-
-
-    int height_size = ((shutter *) shutterFrame)->getheight ();
-    popupmenu->create ();
-
-
-
-    popup_x = event->root_x - 5;
-    popup_y = event->root_y - 5;
-
-    popupmenu->popup (NULL, popup_x, popup_y, 90, height_size);
-    getApp ()->runModalWhileShown (popupmenu);
-    popupmenu->setFocus ();
-    return 1;
-
-
-}
-
-//----------------------------------------------------  
-// choose command from popoup menu
-long filelist::file_operation (FXObject * obj, FXSelector sel, void *ptr)
-{
-    if (processing)
-	return 0;
-	
-	
-
-    FXushort id = FXSELID (sel);
-    
-    string com_name;
-
-    if(((FXWindow*)obj)->getParent()==toolbar2 || ((FXWindow*)obj)->getParent()==toolbar)
-    {
-    com_name = button_commands_tab[id - ID_LAST];
-    }
-    
-    else
-    {   
-    com_name = commands_tab[id - ID_LAST];
-    }
-    
-    if(popupmenu)
-  	   popupmenu->popdown ();
-    
-    runCommand(com_name);
-
-}
-
-
-//execute function(copying files etc) as thread 
-void filelist::start_thread (thread_elem * te)
-{
-
-    te->filel = (void *) this;
-
-   objmanager->thread_vec.push_back (te);
-
-
-    if (te->command == "execute" && te->options == "capture")
-    {
-	pipe (te->p);
-	fcntl (te->p[0], O_NONBLOCK);
-
-	if (fork () == 0)	//child
-	{
-	    close (te->p[0]);
-	    dup2 (te->p[1], fileno (stdout));
-
-	    //close(te->p[1]);
-
-
-	    //if(execl("/bin/ls","ls",NULL)== -1)perror("execl");
-		
-	    system (te->src[0].c_str ());
-	    /*
-	       ;
-	     */
-	    string end = "!";
-	    write (te->p[1], end.c_str (), end.size ());
-	    _exit (0);
-	}
-	else
-	{
-	    close (te->p[1]);
-	}
-
-
-    }
-    else
-    {
-
-	pthread_t t;
-	pthread_attr_t attr;
-	pthread_attr_init (&attr);
-	pthread_create (&t, &attr, filelist::thread_func, (void *) te);
-	pthread_attr_destroy (&attr);
-    }
-
-}
-
-//thread function
-
-
-
-//----------------------------------------------------   
-
-void filelist::refresh (void)
-{
-    if (processing)
-	return;
-    opendir (path);
-}
-
-//----------------------------------------------------   
-//select item using right mouse button
-void filelist::selectitem ()
-{
-    if (processing)
-	return;
-
-    int num = 0;
-    for (int u = 0; u < getNumItems (); u++)
-	if (isItemSelected (u))
-	    num++;
-
-    if (num <= 1)
-    {
-	FXint x, y;
-	FXuint state;
-	getCursorPosition (x, y, state);
-
-	int item = getItemAt (x, y);
-
-	if (getCurrentItem () >= 0)
-	    deselectItem (getCurrentItem ());
-
-	if (item >= 0)
-	{
-	    setCurrentItem (item);
-	    if (!selectItem (item));
-	}
-
-    }
-
-
-}
-
-//----------------------------------------------------  
-//function for sorting files in filelist
-FXint filelist::cmp (const FXIconItem * pa, const FXIconItem * pb)
-{
-
-
-    os_ListItem *a = (os_ListItem *) pa;
-    os_ListItem *b = (os_ListItem *) pb;
-
-    filelist *fl = (filelist *) a->list;
-
-    if (b->osf.type & FOLDER && !(a->osf.type & FOLDER))
-	return 1;
-    else if (a->osf.type & FOLDER && !(b->osf.type & FOLDER))
-	return -1;
-
-/*
- register FXint diff=b->osf.type|FOLDER - a->osf.type|FOLDER;	
-	 if(diff) 
-		return diff;
-		*/
-    register const unsigned char *p;
-    register const unsigned char *q;
-
-    if (fl->sort_nr == 0)	//name
-    {
-	p = (const unsigned char *) a->getText ().text ();
-	q = (const unsigned char *) b->getText ().text ();
-    }
-    else if (fl->sort_nr == -1)	//extension sorting
-    {
-	string exta = filelist::getfiletype (a->getText ().text ());
-	if (exta == "")
-	    exta = "zzzzz";
-	string extb = filelist::getfiletype (b->getText ().text ());
-	if (exta == "")
-	    extb = "zzzzz";
-
-
-	p = (const unsigned char *) exta.c_str ();
-	q = (const unsigned char *) extb.c_str ();
-
-    }
-    else
-    {
-	p = (const unsigned char *) a->osf.attrib[fl->sort_nr-1].c_str ();
-	q = (const unsigned char *) b->osf.attrib[fl->sort_nr-1].c_str ();
-	
-    }
-    
-    
-    if (fl->vector_type[fl->sort_nr] == 1)	//size      
-    {
-
-	if (a->osf.size > b->osf.size)
-	    if (ascend)
-		return 1;
-	    else
-		return -1;
-	else if (ascend)
-	    return -1;
-	else
-	    return 1;
-
-    }
-    else if(fl->vector_type[fl->sort_nr] == 2)  //date
-    {
-    
-    
-       struct tm tm1;
-       struct tm tm2;
-
-       strptime((const char*)p, "%H:%M %d/%m/%y", &tm1);
-       strptime((const char*)q, "%H:%M %d/%m/%y", &tm2);
-    time_t t1=mktime(&tm1);
-    time_t t2=mktime(&tm2);
-   
-    
-      if(t1>t2) 
-      	if(ascend)
-      	  return 1;
-	else  
-	  return -1;
-      else  if(t1<t2)	
-      	if(ascend)
-      	  return -1;
-	else  
-	  return 1;
-      else 
-      	return 0;		      
-    } 
-    else			//string
-    {
-
-	while (1)
-	{
-
-	    if (!*p)
-		break;
-	    if (!*q)
-		break;
-
-	    if (strcase)
-	    {
-		if (*p > *q)
-		    if (ascend)
-			return 1;
-		    else
-			return -1;
-		if (*p < *q)
-		    if (ascend)
-			return -1;
-		    else
-			return 1;
-	    }
-	    else
-	    {
-		if (tolower (*p) > tolower (*q))
-		    if (ascend)
-			return 1;
-		    else
-			return -1;
-		if (tolower (*p) < tolower (*q))
-		    if (ascend)
-			return -1;
-		    else
-			return 1;
-	    }
-
-	    p++;
-	    q++;
-	}
-	return 0;
-
-    }
-
-
-
-
-}
-
-
-//--------------------------------------------------------------------
-
-long filelist::onCmdResize(FXObject * sender, FXSelector sel, void *ptr)
-{
-
-//FXIconList::onHeaderResize(sender, sel,ptr);
-
-for(int i=0;i<getNumHeaders();i++)
-	{
-	string header=getHeaderText(i).text();
-	int width=getHeaderSize(i);
-	conf->saveonestring("/OpenspaceConfig/filelist/"+this->type+"/properties/"+header+"/width",ntos(width));
-	
-	}
-}
-
-
-
-//--------------------------------------------------------------------
-//click on filelist header (change sorting)
-long filelist::onCmdHeader (FXObject *, FXSelector sel, void *ptr)
-{
-    if (processing)
-	return 0;
-
-
-    FXASSERT ((5, "CMDHEADER\n"));
-    FXushort id = FXSELID (sel);
-    int num;
-
-    if (id == ID_SORT_CHANGE)
-    {
-	FXOption *option = sortmenu->getCurrent ();
-	string sort = option->getText ().text ();
-	if (sort == "file type")
-	{
-
-	    num = -1;
-	}
-	else
-	    num = sortmenu->getCurrentNo ();
-    }
-    else
-    {
-	num = ((int)*((int*)ptr));
-    }
-
-    if (num == sort_nr)
-    {
-	ascend = !ascend;
-    }
-    else
-    {
-	sort_nr = num;
-    }
-
-
-    sortItems ();
-}
-
-//execute command from cmddialog plugin and hide this plugin window
-long filelist::onCommand (FXObject *, FXSelector, void *ptr)
-{
-
-    if (dial->exec () != -1)
-    {
-	dial->hide ();
-	//delete dial;
-    }
-    refresh ();
-
-
-}
-
-//cancel cmddialog
-long filelist::onCommandCancel (FXObject *, FXSelector, void *ptr)
-{
-    dial->hide ();
-    delete dial;
-}
-
-//update info about selected files
-long filelist::click (FXObject *, FXSelector, void *ptr)
-{
-    int count = 0;
-    long unsigned int size = 0;
-    os_ListItem *os;
-    for (int i = 0; i < getNumItems (); i++)
-    {
-	if (isItemSelected (i))
-	{
-
-	    count++;
-	    os = (os_ListItem *) getItem (i);
-	    size += os->osf.size;
-
-	}
-    }
-    string inf = "selected: " + ntos (count) + " size: " + numtostring (size);
-    if (count == 1)
-    {
-	inf = inf + " " + os->osf.name;
-    }
-
-
-    info->setText (inf.c_str ());
-
-}
-
-
-    
-
-
-//===================================================================================================
-//Below only drag and drop functions:
-
-// Handle drag-and-drop enter, remember current directory
-long filelist::onDNDEnter (FXObject * sender, FXSelector sel, void *ptr)
-{
-
-    FXIconList::onDNDEnter (sender, sel, ptr);
-    //orgdirectory=getDirectory();
-    return 1;
-}
-
-
-// Handle drag-and-drop leave, restore current directory prior to drag
-long filelist::onDNDLeave (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXIconList::onDNDLeave (sender, sel, ptr);
-    // getApp()->removeTimeout(this,ID_OPENTIMER);
-    stopAutoScroll ();
-    // setDirectory(orgdirectory);
-    return 1;
-}
-
-
-// Handle drag-and-drop motion
-long filelist::onDNDMotion (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXEvent *event = (FXEvent *) ptr;
-    FXint index = -1;
-
-    // Cancel open up timer
-    // getApp()->removeTimeout(this,ID_OPENTIMER);
-
-    // Start autoscrolling
-    if (startAutoScroll (event, FALSE))
-	return 1;
-
-    // Give base class a shot
-    if (FXIconList::onDNDMotion (sender, sel, ptr))
-	return 1;
-
-    // Dropping list of filenames
-    if (offeredDNDType (FROM_DRAGNDROP, urilistType))
-    {
-
-	// Drop in the background
-	//  dropdirectory=getDirectory();
-
-	// What is being done (move,copy,link)
-	dropaction = inquireDNDAction ();
-/*
-    // We will open up a folder if we can hover over it for a while
-    index=getItemAt(event->win_x,event->win_y);
-    if(0<=index && isItemDirectory(index)){
-
-      // Set open up timer
-      getApp()->addTimeout(this,ID_OPENTIMER,700);
-
-      // Directory where to drop, or directory to open up
-      dropdirectory=getItemPathname(index);
-      }
-*/
-	// See if dropdirectory is writable
-	// if(FXFile::isWritable(dropdirectory)){
-	//  FXTRACE((100,"accepting drop on %s\n",dropdirectory.text()));
-	acceptDrop (DRAG_ACCEPT);
-	//   }
-	return 1;
-    }
-    return 0;
-}
-
-
-// Handle drag-and-drop drop
-long filelist::onDNDDrop (FXObject * sender, FXSelector sel, void *ptr)
-{
-    // Cancel open up timer
-//  getApp()->removeTimeout(this,ID_OPENTIMER);
-
-    // Stop scrolling
-    stopAutoScroll ();
-
-
-    // Perhaps target wants to deal with it
-    if (FXIconList::onDNDDrop (sender, sel, ptr))
-	return 1;
-    dropData (false);
-
-
-    return 0;
-}
-
-
-// Somebody wants our dragged data
-long filelist::onDNDRequest (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXEvent *event = (FXEvent *) ptr;
-    FXuchar *data;
-    FXuint len;
-
-    // Perhaps the target wants to supply its own data
-    if (FXIconList::onDNDRequest (sender, sel, ptr))
-	return 1;
-
-    // Return list of filenames as a uri-list
-    if (event->target == urilistType)
-    {
-	if (!dragfiles.empty ())
-	{
-	    len = dragfiles.length ();
-	    FXMEMDUP (&data, dragfiles.text (), FXuchar, len);
-	    setDNDData (FROM_DRAGNDROP, event->target, data, len);
-	}
-	return 1;
-    }
-
-    // Delete selected files
-    if (event->target == deleteType)
-    {
-	FXTRACE ((100, "Delete files not yet implemented\n"));
-	return 1;
-    }
-
-    return 0;
-}
-
-string filelist::returnpath(string dirname)
-{
-	string ret;
-	if(path==SEPARATOR)
-	ret=SEPARATOR + dirname;
-	else
-	ret=path + SEPARATOR + dirname;
-	
-	return ret;
-}
-
-// Start a drag operation
-long filelist::onBeginDrag (FXObject * sender, FXSelector sel, void *ptr)
-{
-    register FXint i;
-    if (FXIconList::onBeginDrag (sender, sel, ptr))
-	return 1;
-    if (beginDrag (&urilistType, 1))
-    {
-	dragfiles = FXString::null;
-	for (i = 0; i < getNumItems (); i++)
-	{
-	    if (isItemSelected (i))
-	    {
-
-		os_ListItem *oslistitem = (os_ListItem *) getItem (i);
-		string name = oslistitem->osf.name;
-		string fullname = returnpath(name);
-		if (name != "." && name != "..")
-		{
-		    if (!dragfiles.empty ())
-			dragfiles += "\r\n";
-
-		    dragfiles += FXURL::fileToURL (fullname.c_str ());
-		}
-	    }
-	}
-	return 1;
-    }
-    return 0;
-}
-
-
-// End drag operation
-long filelist::onEndDrag (FXObject * sender, FXSelector sel, void *ptr)
-{
-    if (FXIconList::onEndDrag (sender, sel, ptr))
-	return 1;
-    endDrag ((didAccept () != DRAG_REJECT));
-    setDragCursor (getDefaultCursor ());
-    dragfiles = FXString::null;
-    return 1;
-}
-
-
-// Dragged stuff around
-long filelist::onDragged (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXEvent *event = (FXEvent *) ptr;
-    FXDragAction action;
-    if (FXIconList::onDragged (sender, sel, ptr))
-	return 1;
-    action = DRAG_MOVE;
-    if (event->state & CONTROLMASK)
-	action = DRAG_COPY;
-    if (event->state & SHIFTMASK)
-	action = DRAG_MOVE;
-    if (event->state & ALTMASK)
-	action = DRAG_LINK;
-    handleDrag (event->root_x, event->root_y, action);
-    if (didAccept () != DRAG_REJECT)
-    {
-	if (action == DRAG_MOVE)
-	    setDragCursor (getApp ()->getDefaultCursor (DEF_DNDMOVE_CURSOR));
-	else if (action == DRAG_LINK)
-	    setDragCursor (getApp ()->getDefaultCursor (DEF_DNDLINK_CURSOR));
-	else
-	    setDragCursor (getApp ()->getDefaultCursor (DEF_DNDCOPY_CURSOR));
-    }
-    else
-    {
-	setDragCursor (getApp ()->getDefaultCursor (DEF_DNDSTOP_CURSOR));
-    }
-    return 1;
-}
-
-
-
-
-
-//----------------------------------------------------  
-
-
-// We now really do have the clipboard, keep clipped text
-long filelist::onClipboardGained (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXIconList::onClipboardGained (sender, sel, ptr);
-    return 1;
-}
-
-
-// We lost the clipboard, free clipped text
-long filelist::onClipboardLost (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXIconList::onClipboardLost (sender, sel, ptr);
-    dragfiles=FXString::null;
-    //clipped.clear();
-    return 1;
-}
-
-
-// Somebody wants our clipped text
-long filelist::onClipboardRequest (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXEvent *event = (FXEvent *) ptr;
-    FXuchar *data;
-    FXuint len;
-    len = dragfiles.length ();
-    FXMEMDUP (&data, dragfiles.text (), FXuchar, len);
-    setDNDData (FROM_CLIPBOARD, event->target, data, len);
-    return 0;
-}
-
-
-void filelist::dropData (bool clipboard)
-{
-
-
-    FXuchar *data;
-    FXuint len;
-    FXDNDOrigin origin;
-    if (clipboard)
-	origin = FROM_CLIPBOARD;
-    else
-	origin = FROM_DRAGNDROP;
-
-    // Get uri-list of files being dropped
-    if (getDNDData (origin, urilistType, data, len))
-    {
-  
-	FXRESIZE (&data, FXuchar, len + 1);
-	data[len] = '\0';
-	FXchar *p, *q;
-	p = q = (FXchar *) data;
-
-	vector < string > src;
-
-	while (*p)
-	{
-	    while (*q && *q != '\r')
-		q++;
-	    FXString url (p, q - p);
-	    FXString filesrc (FXURL::fileFromURL (url));
-	    src.push_back (filesrc.text ());
-	    if (*q == '\r')
-		q += 2;
-	    p = q;
-	    
-	    if(FXFile::directory(filesrc.text ())==path.c_str())
-	    {
-	    FXFREE (&data);
-	    return;
-	    }
-	}
-
-
-	string com_name;
-	if (dropaction == DRAG_MOVE)
-	    com_name = "move";
-	else if (dropaction == DRAG_COPY)
-	    com_name = "copy";
-
-    filelist_base *fil = fb;
-    string options;
-    if (this->type == "local" && filelist_opposite->dragfiles!=FXString::null)
-    {
-     options = "upload";
-     fil = filelist_opposite->fb;
-
-    }
-    else 
-    {
-    options = "download";
-    }
-    
-    if(this->type=="local" || filelist_opposite->type=="local")
-    {
-	FXTRACE ((5, "copy/move/remove"));
-	thread_elem *el = new thread_elem (fil, com_name, options, src, path);
-	start_thread (el);
-    }
-    else
-    {
-    FXMessageBox about (this, "error", "copying/moving beetwen VFS not implemented (yet ;p)", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-    about.execute ();
-    }	
-
-
-	FXFREE (&data);
-
-    }
-dropaction=DRAG_MOVE;
-filelist_opposite->dropaction=dropaction=DRAG_MOVE;
-
-}
-

Deleted: trunk/src/filelist.h
===================================================================
--- trunk/src/filelist.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/filelist.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,157 +0,0 @@
-#ifndef FILELIST
-#define FILELIST
-
-#include "filelist_base.h"
-#include "pathtype.h"
-#include "thread_elem.h"
-#include "filetype.h"
-#include "cmddialog.h"
-#include <string>
-#include <map>
-#include "preferences.h"
-using namespace std;
-
-
-//filelist
-class filelist:public FXIconList
-{
-
-
-FXDECLARE (filelist) 
-  
-private:  
-
-    
-    string previous_path;
-    string type;
-    pathtype *pt;
-    
-    FXWindow *notifyparent;
-    FXLabel *label;
-    FXLabel *info;
-    FXMenuPane *popupmenu;
-    FXMenuPane *popupwindow;   
-    FXTextField *textfield;
-    FXOptionMenu *sortmenu;
-    FXPopup *sortpop;
-    FXHorizontalFrame *bottomframe;
-    
-    vector < string > commands_tab;
-    vector < string > key_commands_tab;
-    vector < string > button_commands_tab;
-    vector < FXIcon * >icon_vec;
-    vector < string > header_vec;
-    vector < string > vector_name;
-    vector < int >vector_type;
-    vector < int >vector_width;
-    
-    bool show_hidden_files;	
-    string *fields_name;
-    unsigned int *fields_type;
-    unsigned int *fields_width;
-    int sort_nr;
-    unsigned long thumb_size;
-
-    static bool ascend;
-    static bool strcase;
-
-    bool processing;
-    bool maximize;
-    int popup_x;
-    int popup_y;
-    
-    int icons_size;
-
-    cmddialog *dial;
-    
-    FXDragAction dropaction;	// Drop action
-    FXString dragfiles;		// Dragged files
-
-    void dropData (bool clipboard);
-    void filelist::selectitem (void);
-    void filelist::start_thread (thread_elem * te);
-    
-    void filelist::copymoveremove (string com_name);
-    static void *filelist::thread_func (void *data);
-    static FXint cmp (const FXIconItem * a, const FXIconItem * b);
-    
-    
-    string returnpath(string dirname);
-    string filelist::getdefaultcommand (string name);
-    string filelist::resolvecommand(string command,string name);
-    int filelist::runCommand(string name);
-    static string filelist::getfiletype (string name);
-    long filelist::setKeys (void);
-    
-public:  
-
-     filelist ()
-    {
-    }
-    virtual ~ filelist ();
-
-//==============================================
-    filelist (FXComposite * p, pathtype pt);
-//==============================================
-
-
-objectmanager *objmanager;
-FXIcon **specialicons;
-FXToolBar *toolbar,*toolbar2;
-
-string path;
-bool active;
-filelist_base * fb;
-filelist *filelist_opposite;
-
-enum
-    {
-	ID_ICO = FXIconList::ID_LAST,
-	ID_SORT_CHANGE,
-	ID_TEXTFIELD_RUN,
-	ID_LAST,
-    };
-
-
-    virtual void create ();
-
-    void filelist::refresh (void);
-    bool filelist::init (void);
-    bool filelist::opendir (string dir);
-       
-    long filelist::setFocus (FXObject * obj, FXSelector sel, void *ptr);
-    long filelist::lostFocus (FXObject * obj, FXSelector sel, void *ptr);
-    long filelist::openfile (FXObject *, FXSelector, void *);
-    long filelist::gotoparentdir (FXObject *, FXSelector, void *);
-    long filelist::onPopup (FXObject *, FXSelector, void *);
-    long filelist::file_operation (FXObject *, FXSelector, void *);
-    long filelist::onCmdHeader (FXObject *, FXSelector, void *ptr);
-    long filelist::onCommand (FXObject *, FXSelector, void *ptr);
-    long filelist::onCommandCancel (FXObject *, FXSelector, void *ptr);
-    long filelist::click (FXObject *, FXSelector, void *ptr);
-    long filelist::onCmdResize(FXObject * sender, FXSelector, void *);
-    long filelist::key_shortcut (FXObject * obj, FXSelector sel, void *ptr);
-    long filelist::texfield_run (FXObject * obj, FXSelector sel, void *ptr);
-    
-    long onDNDEnter (FXObject *, FXSelector, void *);
-    long onDNDLeave (FXObject *, FXSelector, void *);
-    long onDNDMotion (FXObject *, FXSelector, void *);
-    long onDNDDrop (FXObject *, FXSelector, void *);
-    long onDNDRequest (FXObject *, FXSelector, void *);
-    long onBeginDrag (FXObject *, FXSelector, void *);
-    long onEndDrag (FXObject *, FXSelector, void *);
-    long onDragged (FXObject *, FXSelector, void *);
-
-    long onClipboardLost (FXObject *, FXSelector, void *);
-    long onClipboardGained (FXObject *, FXSelector, void *);
-    long onClipboardRequest (FXObject *, FXSelector, void *);
-
-
-
-    
-    
-
-};
-
-
-#endif

Deleted: trunk/src/filelist_base.h
===================================================================
--- trunk/src/filelist_base.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/filelist_base.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,68 +0,0 @@
-#ifndef FILELIST_BASE
-#define FILELIST_BASE
-
-#include <string>
-#include <vector>
-using namespace std;
-
-#include "osfile.h"
-#include "configure.h"
-#include "thread_elem.h"
-#include "pathtype.h"
-
-
-class vfsheader_container
-{
-public:
-string name;
-string type;
-string width;
-vfsheader_container(){}
-vfsheader_container(string n,string t="",string w="100"):name(n),type(t),width(w){}
-
-};
-
-class vfs
-{
-public:
-vector <vfsheader_container> vfsheaders;
-string information;
-string version;
-string type;
-
-};
-
-//filelist plugins need to inherit from this class
-class filelist_base
-{
-  public:
-    virtual int osopendir (string dir) = 0;
-    virtual osfile osreaddir (void) = 0;
-    virtual int mkdir (string dir, int mode = 0) = 0;
-    virtual int copy (thread_elem * te) = 0;
-    virtual int move (thread_elem * te) = 0;
-    virtual int remove (thread_elem * te) = 0;
-    virtual int rename (string orgname, string newname) = 0;
-    virtual int init (vector < string > *vector_name, pathtype pt, configure * conf) = 0;
-    virtual int mode (string file) = 0;
-    virtual string owner (string file) = 0;
-    virtual string group (string file) = 0;
-    virtual bool mode (string file, unsigned int, bool recursive) = 0;
-    virtual bool owner (string file, string, bool recursive) = 0;
-    virtual bool group (string file, string, bool recursive) = 0;
-    virtual string info (void) = 0;
-    virtual void totalsize (string path, unsigned long &size) = 0;
-    virtual string symlink (string path) = 0;
-    virtual bool symlink (string src, string dst) = 0;
-    virtual bool hardlink (string src, string dst) = 0;    
-    virtual int quit (void) = 0;
-    virtual string getinitialdir(void)
-    {
-    return "/";
-    }
-    
-    virtual vfs setup (void) = 0;
-};
-
-
-#endif

Deleted: trunk/src/filetype.cpp
===================================================================
--- trunk/src/filetype.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/filetype.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,16 +0,0 @@
-#include <fx.h>
-#include "filetype.h"
-
-file_type::file_type (FXIcon * ic,FXIcon*ic2, FXColor col, FXColor backcol)
-{
-
-    icon = ic;
-   	 if(ic2!=NULL)
-   	 bigicon=ic2;
- 	 else
-	 bigicon=ic;
-    
-    color = col;
-    backcolor = backcol;
-
-}

Deleted: trunk/src/filetype.h
===================================================================
--- trunk/src/filetype.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/filetype.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,21 +0,0 @@
-#ifndef filetype
-#define filetype
-
-//icon and colors associated with filetype
-class file_type
-{
-
-  public:
-    FXIcon * icon;
-    FXIcon *bigicon;
-    FXColor color;
-    FXColor backcolor;
-
-     file_type::file_type (FXIcon * ic,FXIcon *ic2, FXColor col, FXColor backcol);
-     file_type::file_type ()
-    {
-    }
-
-};
-
-#endif

Deleted: trunk/src/informationpanel.cpp
===================================================================
--- trunk/src/informationpanel.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/informationpanel.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,41 +0,0 @@
-#include <fx.h>
-#include <string>
-using namespace std;
-#include "informationpanel.h"
-
-
-informationpanel::informationpanel (FXComposite * p, string command)
-{
-
-    frame = new FXVerticalFrame (p, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0);
-
-
-    lab0 = new FXLabel (frame, "NONE");
-
-    if (command == "copy" || command == "move")
-    {
-	lab1 = new FXLabel (frame, "NONE");
-	lab2 = new FXLabel (frame, "NONE");
-	pbar = new FXProgressBar (frame, NULL, 0, LAYOUT_FILL_X | FRAME_THICK | PROGRESSBAR_PERCENTAGE);
-	pbar2 = new FXProgressBar (frame, NULL, 0, LAYOUT_FILL_X | FRAME_THICK | PROGRESSBAR_PERCENTAGE);
-	bu = new FXButton (frame, "CANCEL", NULL, NULL, 999, BUTTON_TOOLBAR);
-	bu->setBackColor (FXRGB (145, 134, 201));
-	pbar->setBarColor (FXRGB (145, 134, 201));
-	pbar2->setBarColor (FXRGB (145, 134, 201));
-    }
-    else if (command == "remove")
-    {
-	lab1 = new FXLabel (frame, "NONE");
-	bu = new FXButton (frame, "CANCEL", NULL, NULL, 999, BUTTON_TOOLBAR);
-	bu->setBackColor (FXRGB (145, 134, 201));
-    }
-    frame->create ();
-    frame->recalc ();
-}
-
-informationpanel::~informationpanel ()
-{
-
-    delete frame;
-
-}

Deleted: trunk/src/informationpanel.h
===================================================================
--- trunk/src/informationpanel.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/informationpanel.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,23 +0,0 @@
-#ifndef INFORMATIONPANEL
-#define INFORMATIONPANEL
-
-//this is information panel, it is shown for example during copying files
-class informationpanel
-{
-
-  public:
-
-    FXVerticalFrame * frame;
-    FXLabel *lab0;
-    FXLabel *lab1;
-    FXLabel *lab2;
-    FXProgressBar *pbar;
-    FXProgressBar *pbar2;
-    FXButton *bu;
-
-     informationpanel::informationpanel (FXComposite * p, string command);
-     informationpanel::~informationpanel (void);
-
-};
-
-#endif

Copied: trunk/src/main.cpp (from rev 245, branches/mloskot-style-refactoring/src/main.cpp)


Property changes on: trunk/src/main.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/mainwindow.cpp
===================================================================
--- trunk/src/mainwindow.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/mainwindow.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,1336 +0,0 @@
-#include "config.h"
-#include <string>
-#include <vector>
-#include <map>
-using namespace std;
-
-#include "fx.h"
-// #include "FXPNGIcon.h"
-#include "thread_elem.h"
-#include "filelist.h"
-#include "sharedobjects.h"
-#include "mainwindow.h"
-#include "informationpanel.h"
-#include "configure.h"
-#include "oslistitem.h"
-
-#include "FirstRun.h"
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <dirent.h>
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else /*  */
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif /*  */
-using namespace FX;
-FXDEFMAP (MainWindow) MainWindowMap[] =
-{
-
-    //________Message_Type_____________________ID____________Message_Handler_______  
-   	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_DIRCH, MainWindow::onChangeDir),
-	// FXMAPFUNC(SEL_ENTER, MainWindow::ID_DIRCH,   MainWindow::onListNextDir),
-	// FXMAPFUNC(SEL_LEAVE, MainWindow::ID_DIRCH,   MainWindow::onListNextDir),
-	FXMAPFUNC (SEL_RIGHTBUTTONRELEASE, MainWindow::ID_DIR, MainWindow::onListDirs), 
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_DIR, MainWindow::onOpenDir),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_CONFIGURE, MainWindow::onOpenConfigure),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_ABOUT, MainWindow::onAbout),
-	FXMAPFUNCS (SEL_LEFTBUTTONRELEASE, MainWindow::ID_TOLEFT, MainWindow::ID_TORIGHT, MainWindow::onChangeList),
-	FXMAPFUNCS (SEL_COMMAND, MainWindow::ID_OVERWRITE, MainWindow::ID_SKIP_ALL, MainWindow::onOverwrite),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_NEWFRAME, MainWindow::onNewFrame),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_NEW_NETWORK, MainWindow::onNewNetworkFrame),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_NEW_SEARCH, MainWindow::onNewSearchFrame),
-	FXMAPFUNCS (SEL_COMMAND, 666, 668, MainWindow::onNotify),
-	FXMAPFUNC (SEL_TIMEOUT, MainWindow::ID_TIMER, MainWindow::onTimer),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_COMMANDS_SHOW, MainWindow::commandsShow),
-	FXMAPFUNC (SEL_CONFIGURE, 0, MainWindow::onConfigure),
-	FXMAPFUNC (SEL_COMMAND, MainWindow::ID_CANCEL, MainWindow::cancel), 
-	FXMAPFUNC (SEL_UPDATE, 0, MainWindow::onUpdate)};
-
-FXIMPLEMENT (MainWindow, FXMainWindow, MainWindowMap, ARRAYNUMBER (MainWindowMap))
-
-
-//-----MAIN WINDOW---------------------------------------------------------------------------------------------------------------------------         
-MainWindow::MainWindow (FXApp * a):FXMainWindow (a, "openspace", NULL, NULL, DECOR_ALL | LAYOUT_FIX_WIDTH, 0, 0, 600, 400, 0, 0)
-{
-    conf = new configure ();
-    
-if(conf->loadconfig())
-{
- if(conf->readonestring ("/OpenspaceConfig/version")==PACKAGE_VERSION)
- {
-
-
-    objmanager=objectmanager::instance(getApp());
-    
-    new FXToolTip (getApp (), TOOLTIP_NORMAL);
-    pane = NULL;
-    filemenu = NULL;
-    pref = NULL;
-   
-   string fontdesc=conf->readonestring ("/OpenspaceConfig/fonts/normalfont");
-   FXFont *font=new FXFont(getApp(),fontdesc.c_str());
-   font->create();
-   getApp()->setNormalFont(font);
-  
-   
-  getApp()->setTypingSpeed(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/typing_speed").c_str ()));
-  getApp()->setClickSpeed(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/click_speed").c_str ()));
-  getApp()->setScrollSpeed(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/scroll_speed").c_str ()));
-  getApp()->setScrollDelay(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/scroll_delay").c_str ()));
-  getApp()->setBlinkSpeed(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/blink_speed").c_str ()));
-  getApp()->setAnimSpeed(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/anim_speed").c_str ()));
-  getApp()->setMenuPause(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/menu_pause").c_str ()));
-  getApp()->setTooltipPause(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/tooltip_pause").c_str ()));
-  getApp()->setTooltipTime(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/tooltip_time").c_str ()));
-  getApp()->setDragDelta(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/drag_delta").c_str ()));
-  getApp()->setWheelLines(FXIntVal(conf->readonestring ("/OpenspaceConfig/speed_delay/wheel_lines").c_str ()));
-   
-   getApp()->setBaseColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/base").c_str()));
-   getApp()->setBorderColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/border").c_str()));
-   getApp()->setForeColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/fore").c_str()));
-   getApp()->setHiliteColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/hilite").c_str()));
-   getApp()->setShadowColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/shadow").c_str()));
-   getApp()->setSelforeColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/selfore").c_str()));
-   getApp()->setSelbackColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/selback").c_str()));
-   getApp()->setTipforeColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/tipfore").c_str()));
-   getApp()->setTipbackColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/tipback").c_str()));
-   getApp()->setSelMenuTextColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/selmenutext").c_str()));
-   getApp()->setSelMenuBackColor(fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/selmenuback").c_str()));
-   
-    string iconsdir=conf->readonestring ("/OpenspaceConfig/path") +"icons/"+conf->readonestring ("/OpenspaceConfig/icons_theme");
-    
-    if(!FXFile::exists(iconsdir.c_str()))
-   	 iconsdir=FXFile::getUserDirectory ("").text () +string("/.openspace/icons/")+conf->readonestring ("/OpenspaceConfig/icons_theme");
-    
-    iconsdir+=string("/");
-   
-    loadicons(iconsdir);
-   
-   
-    string res = conf->readonestring ("/OpenspaceConfig/version");
-    FXTRACE ((1, "\n openspace version %s\n\n", res.c_str ()));
-    int w = atoi (conf->readonestring ("/OpenspaceConfig/mainwindow/width").c_str ());
-    int h = atoi (conf->readonestring ("/OpenspaceConfig/mainwindow/height").c_str ());
-    resize (w, h);
-
-// read icons for file types
-    if (conf->openxpath ("/OpenspaceConfig/file_types") != -1)
-    {
-    string res;
-	while (conf->getnextnode (res))
-	{
-	    loadMimeSettings ("/OpenspaceConfig/file_types/" + res, res);
-	    configure conflocal = *conf;
-	    if (conflocal.openxpath ("/OpenspaceConfig/file_types/" + res + "/types") != -1)
-	    {
-	    string res2;
-		while (conflocal.getnextnode (res2))
-		{
-		      loadMimeSettings ("/OpenspaceConfig/file_types/" + res + "/types/" + res2, res + "/" + res2);
-		}
-	    }
-	}
-    }
-
-
-
-
-    topdock = new FXDockSite (this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X);
-    bottomdock = new FXDockSite (this, LAYOUT_SIDE_BOTTOM | LAYOUT_FILL_X);
-    leftdock = new FXDockSite (this, LAYOUT_SIDE_LEFT | LAYOUT_FILL_Y);
-    rightdock = new FXDockSite (this, LAYOUT_SIDE_RIGHT | LAYOUT_FILL_Y);
-
-
-
-    FXToolBarShell *dragshell1 = new FXToolBarShell (this, FRAME_RAISED);
-    FXToolBar *toolbar = new FXToolBar (topdock, dragshell1,LAYOUT_DOCK_NEXT | LAYOUT_SIDE_TOP | FRAME_RAISED);
-    new FXToolBarGrip (toolbar, toolbar, FXToolBar::ID_TOOLBARGRIP, TOOLBARGRIP_SINGLE);
-    
-    	
-
-
-    FXVerticalFrame *ff = new FXVerticalFrame (this, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    controlframe = new FXVerticalFrame (ff, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    splitter = new FXSplitter (ff, LAYOUT_FILL_X | SPLITTER_TRACKING | LAYOUT_FILL_Y);
-    left = new FXVerticalFrame (splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0);
-    right = new FXVerticalFrame (splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0);
-    if (conf->readonestring ("/OpenspaceConfig/panels") == "single")
-	ratio = 0;
-
-    else
-	ratio = 1.0 / 2.0;
-    leftcontrolframe = new FXVerticalFrame (left, LAYOUT_FILL_X);
-    leftframe = new FXVerticalFrame (left, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    rightcontrolframe = new FXVerticalFrame (right, LAYOUT_FILL_X);
-    rightframe = new FXVerticalFrame (right, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    //   FXHorizontalFrame * buttonsframe = new FXHorizontalFrame (toolbar, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (toolbar, "\thide/show copy/move progress", objmanager->osicons["plus"], this, MainWindow::ID_COMMANDS_SHOW, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (toolbar, "\topen new panel", objmanager->osicons["directory"], this, MainWindow::ID_NEWFRAME, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (toolbar, "\tconnect", objmanager->osicons["network"], this, MainWindow::ID_NEW_NETWORK, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (toolbar, "\tsearch", objmanager->osicons["search"], this, MainWindow::ID_NEW_SEARCH, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-   
-    new FXSeparator (toolbar, SEPARATOR_NONE);
-    new FXSeparator (toolbar, SEPARATOR_GROOVE);
-    new FXSeparator (toolbar, SEPARATOR_NONE);
-    
-    new FXButton (toolbar, "\tconfiguration", objmanager->osicons["configure"], this, MainWindow::ID_CONFIGURE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (toolbar, "\tabout", objmanager->osicons["foxmini"], this, MainWindow::ID_ABOUT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    toolbar->dock(rightdock);
-  
-    string dir = parseDir (conf->readonestring ("/OpenspaceConfig/leftdir/dir"));
-    string type = conf->readonestring ("/OpenspaceConfig/leftdir/type");
-    pathtype pt (dir, type);
-    left_frame = new Frame (leftcontrolframe, leftframe, pt, this, -1);
-    left_frame->f->toolbar->dock(topdock);	
-    left_frame->f->toolbar->hide();
-    left_frame->f->toolbar2->dock(rightdock);	
-    left_frame->f->toolbar2->hide();
-    
-    dir = parseDir (conf->readonestring ("/OpenspaceConfig/rightdir/dir"));
-    type = conf->readonestring ("/OpenspaceConfig/rightdir/type");
-    pathtype pt2 (dir, type);
-    right_frame = new Frame (rightcontrolframe, rightframe, pt2, this, -1);
-   
-    right_frame->f->toolbar->dock(topdock);  
-    right_frame->f->toolbar2->dock(rightdock); 
-    
-    left_frame->f->filelist_opposite = right_frame->f;
-    right_frame->f->filelist_opposite = left_frame->f;
-    infoframe = new FXVerticalFrame (ff, LAYOUT_FILL_X);
-    networkframe = NULL;
-    searchframe = NULL;
-    getApp ()->addTimeout (this, ID_TIMER, 200);
-
-	if(conf->readonestring ("/OpenspaceConfig/first_run")=="true")
-	{
-		conf->saveonestring ("/OpenspaceConfig/first_run","false");
-		
-		FirstRun* first_run;
-		first_run=new FirstRun(this);
-		first_run->show (PLACEMENT_SCREEN);
-	}
-  }
-  else
-  {
-  new FXLabel(this,"Configuration file version mismatch");
-  new FXLabel(this,"Please remove .openspace/openspacerc file in your home directory");
-  conf->loadconfig(true);
-  delete conf;
-  conf=NULL;
-  }
-}
-else//configuration file broken
-{
-
-new FXLabel(this,"Configuration file is broken :|");
-new FXLabel(this,"Restoring last good configuation file, restart program to apply changes");
-
-conf->loadconfig(true);
-delete conf;
-conf=NULL;
-}
-
-}
-
-
-//---------------------------------------------------- 
-// open configure window
-long MainWindow::onOpenConfigure (FXObject * sender, FXSelector sel, void *)
-{
-   if(pref==NULL)
-   {
-   pref = new preferences (this);
-   pref->create();
-   }  
-   pref->show (PLACEMENT_OWNER);
-}
-
-
-//about
-long MainWindow::onAbout (FXObject * sender, FXSelector sel, void *)
-{
-
-    string msg="Openspace File Browser " +string(PACKAGE_VERSION)+ "\n\nby Mateusz Dworak (http://openspace.linux.pl)\n\nUsing the FOX C++ GUI Library (http://www.fox-tookit.org) \n\n icons by Dawn Simon";
- 
-    FXMessageBox about (this, "About Openspace", msg.c_str(), objmanager->osicons["foxbig"], MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-    about.execute ();
-}
-
-
-
-
-//new frame
-long MainWindow::onNewFrame (FXObject * sender, FXSelector, void *ptr)
-{
-    string dir;
-    string type;
-    string str_server;
-    string str_user;
-    string str_pass;
-    string str_port;
-    if (networkframe == NULL && searchframe == NULL)
-    {
-	dir = parseDir (conf->readonestring ("/OpenspaceConfig/defaultdir/dir"));
-	type = conf->readonestring ("/OpenspaceConfig/defaultdir/type");
-    }
-    else
-    {
-	
-	
-	if (networkframe == NULL) //search
-	{
-	
-	
-	string s_size_greater=search_size_greater->getText().text();
-	string s_size_less=search_size_less->getText().text();
-	string s_dir=search_path->getText().text();
-	string s_filter=search_filefilter->getText().text();
-	
-	str_server = "find "+ s_dir;
-	
-	if(s_filter!="")
-	str_server+= " -name \"" + s_filter +"\"" ;
-	if(s_size_greater!="")
-	str_server+= " -size +" + s_size_greater +"k" ;
-	if(s_size_less!="")
-	str_server+= " -size -" + s_size_less +"k" ;
-	
-	 
-	dir = "/";
-	type= "search";
-	
-	searchframe->hide ();
-	delete searchframe;
-	searchframe = NULL;
-	}
-	else			//network
-	{
-	dir = "/";
-	type = filelisttypecombobox->getText().text();
-	str_server = server->getText ().text ();
-	str_user = user->getText ().text ();
-	str_pass = password->getText ().text ();
-	str_port=port->getText().text();
-	networkframe->hide ();
-	delete networkframe;
-	networkframe = NULL;
-	}
-	
-	
-	controlframe->recalc ();
-    }
-    pathtype pt (dir, type, str_server, str_user,str_pass,str_port);
-    Frame *fr = new Frame (controlframe, leftframe, pt, this, 0);
-			   			   
-    fr->frame->create ();
-    fr->hf->create ();
-    fr->f->toolbar->dock(topdock);	
-    fr->f->toolbar->hide();
-    fr->f->toolbar2->dock(rightdock);	
-    fr->f->toolbar2->hide();
-    
- 
- this->handle (fr->toleft, FXSEL (SEL_LEFTBUTTONRELEASE,ID_TOLEFT), NULL);
-    
-    controlframe->recalc ();
-}
-
-
-//show or hide frame where we can set login/pass/etc for connecting do remote filesystem
-long MainWindow::onNewNetworkFrame (FXObject * sender, FXSelector, void *)
-{
-    if (networkframe == NULL)
-    {
-	networkframe = new FXHorizontalFrame (controlframe, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel (networkframe, "server:");
-	server = new FXTextField (networkframe, 20);
-	new FXLabel (networkframe, "user:", objmanager->osicons["user"]);
-	user = new FXTextField (networkframe, 20);
-	new FXLabel (networkframe, "pass:", objmanager->osicons["password"]);
-	password = new FXTextField (networkframe, 20,NULL,0,TEXTFIELD_PASSWD|FRAME_SUNKEN|FRAME_THICK);
-	new FXLabel (networkframe, "port:", NULL,0,TEXTFIELD_INTEGER );
-	port = new FXTextField (networkframe, 5);
-
-	filelisttypecombobox = new FXComboBox (networkframe, 4, NULL, 0,
-					       FRAME_THICK | LAYOUT_SIDE_TOP | COMBOBOX_STATIC);
-					       
-	int count=0;				       
-	if (conf->openxpath ("/OpenspaceConfig/filelist") != -1)
-   	{
-	string res;
-	    while (conf->getnextnode (res))
-	    {
-	  	string filelist_type = conf->readonestring ("/OpenspaceConfig/filelist/"+res+"/type");
-		
-		if(filelist_type=="network")
-		{
-		filelisttypecombobox->appendItem (res.c_str());
-		count++;
-		}
-	    }				       
-	}				       
-					       
-					       
-	filelisttypecombobox->setNumVisible (count);
-
-	new FXButton (networkframe, "connect", NULL, this, MainWindow::ID_NEWFRAME, FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0);
-	networkframe->create ();
-	networkframe->recalc ();
-    }
-
-    else
-    {
-	networkframe->hide ();
-	delete networkframe;
-	networkframe = NULL;
-	controlframe->recalc ();
-    }
-}
-
-
-long MainWindow::onNewSearchFrame (FXObject * sender, FXSelector, void *)
-{
-    if (searchframe == NULL)
-    {
-	searchframe = new FXHorizontalFrame (controlframe, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel (searchframe, "path: ");
-	search_path=new FXTextField (searchframe, 20);
-		if (left_frame->f->active)
-		search_path->setText(left_frame->f->path.c_str());
-		else
-		search_path->setText(right_frame->f->path.c_str());
-	new FXLabel (searchframe, "size");
-	new FXLabel (searchframe, "greater than(KB):");
-	search_size_greater=new FXTextField (searchframe, 10);
-	new FXLabel (searchframe, "less than(KB):");
-	search_size_less=new FXTextField (searchframe, 10);
-		
-		
-	new FXLabel (searchframe, "file filter: ");
-	search_filefilter=new FXTextField (searchframe, 20);
-	search_filefilter->setText("*");
-	new FXButton (searchframe, "search", NULL, this, MainWindow::ID_NEWFRAME, FRAME_RAISED, 0, 0, 0, 0, 0, 0, 0, 0);
-	searchframe->create ();
-	searchframe->recalc ();
-    }
-
-    else
-    {
-	searchframe->hide ();
-	delete searchframe;
-	searchframe = NULL;
-	controlframe->recalc ();
-    }
-}
-
-
-//----------------------------------------------------   
-MainWindow::~MainWindow ()
-{
-    delete pref;
-    delete conf;
-}
-
-
-//----------------------------------------------------   
-void MainWindow::create ()
-{
-    FXMainWindow::create ();
-    string position;
-    if(conf)
-    position=conf->readonestring ("/OpenspaceConfig/position");
-    
-    if(position=="cursor")
-    show (PLACEMENT_CURSOR);
-    else
-    show (PLACEMENT_SCREEN);
-}
-
-//---------------------------------------------------- 
-//show or hide frame containing informaitions about copying/moving files
-long MainWindow::commandsShow (FXObject * sender, FXSelector, void *ptr)
-{
-    if (infoframe->shown ())
-	infoframe->hide ();
-
-    else
-	infoframe->show ();
-}
-
-
-//executed when we change directory clicking directory name in popoup window 
-long MainWindow::onChangeDir (FXObject * sender, FXSelector, void *ptr)
-{
-    filelist *fil = current_frame->f;
-    FXTRACE ((5, "CHANGE DIR\n", fil->path.c_str ()));
-    FXMenuCommand *mc = (FXMenuCommand *) sender;
-    FXEvent *event = (FXEvent *) ptr;
-    FXWindow *win = (FXWindow *) mc->getParent ();
-    int x = win->getX ();
-    int y = win->getY ();
-    string p = fil->path;
-    string current_path = p;
-    
-    if(current_path!="/")
-    current_path.append (SEPARATOR);
-       
-    current_path.append (mc->getText ().text ());
-    current_frame->f->path = current_path;
-    current_frame->f->opendir (current_path);
-    current_frame->generate_menu (current_path, this);
-    popupDir (current_frame->f, current_path, x, y);
-}
-
-//popup with dir names when we click right button in dir path
-int MainWindow::popupDir (filelist * current_filelist, string path, int x, int y)
-{
-    vector < string > vec;
-    for (int i = 0; i < current_filelist->getNumItems (); i++)
-    {
-	os_ListItem *oslistitem = (os_ListItem *) current_filelist->getItem (i);
-	if (oslistitem->osf.type & FOLDER)
-	{
-	    string name = oslistitem->osf.name;
-	    if (name != "." && name != ".." && name[0] != '.')
-		vec.push_back (name);
-	}
-    }
-
-/*
-
-	if(current_filelist->fb->osopendir(path)==-1)
-	{
-	return 0;
-	}
-
-
-
-
-
-	while(1)
-	{
-	osfile os_file=current_filelist->fb->osreaddir();
-		if(os_file.name=="")
-		break;
-	
-		if(os_file.type&FOLDER && os_file.name!="." && os_file.name!="..")
-		vec.push_back (os_file.name);		
-	}
-
-*/
-    unsigned int indx;
-    if (vec.size () > 0)
-    {
-	sort (vec.begin (), vec.end ());
-	if (filemenu)
-	{
-	    filemenu->popdown ();
-	    delete filemenu;
-	    filemenu = NULL;
-	}
-	filemenu = new FXMenuPane (this);
-	for (indx = 0; indx < vec.size (); indx++)
-	{
-	    new FXMenuCommand (filemenu, vec[indx].c_str (), objmanager->osicons["directory"], this, MainWindow::ID_DIRCH);
-	}
-	filemenu->create ();
-	filemenu->popup (NULL, x, y, 0, 0);
-    }
-}
-
-
-//currently nothing ;p
-long MainWindow::onListNextDir (FXObject * sender, FXSelector sel, void *ptr)
-{
-}
-
-//popup with directory names when we click right button in path
-long MainWindow::onListDirs (FXObject * sender, FXSelector, void *ptr)
-{
-    FXTRACE ((5, "LIST DIRS\n"));
-    FXButton *bt = (FXButton *) sender;
-    box *boxel = (box *) bt->getUserData ();
-    box *boxbackup = boxel;
-    current_frame = boxel->fr;
-    if (boxel->fr != right_frame && boxel->fr != left_frame)
-	return 0;
-    string path = "";
-    while (boxel->prebutton != NULL)
-    {
-	boxel = (box *) boxel->prebutton->getUserData ();
-    }
-    while (boxel != NULL)
-    {
-	if (boxel == boxbackup)
-	{
-	    path.append (boxel->bt->getText ().text ());
-	    break;
-	}
-	path.append (boxel->bt->getText ().text ());
-	boxel = (box *) boxel->nextbutton->getUserData ();
-    }
-    current_frame->f->path = path;
-    current_frame->f->opendir (path);
-    FXEvent *event = (FXEvent *) ptr;
-    int x = event->root_x;
-    int y = event->root_y;
-    popupDir (current_frame->f, path, x, y);
-}
-
-//change position or close frame
-long MainWindow::onChangeList (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXButton *bt = (FXButton *) sender;
-    box *boxel = (box *) bt->getUserData ();
-    FXushort id = FXSELID (sel);
-    int pos = -1;
-    if (id == ID_TOCLOSE)
-    {
-    bool canclose=true;
-    
-   	 vector < thread_elem * >::iterator iter;
-    	 for (iter = objmanager->thread_vec.begin (); iter != objmanager->thread_vec.end (); iter++)
-   	 {	
-		thread_elem *telem = *iter;
-		if(telem->fb==boxel->fr->f->fb)
-		{
-		canclose=false;
-		}
-   	 }	
-    		if(canclose)
-		{
-    
-		boxel->fr->f->fb->quit ();
-		delete boxel->fr->hf;
-		delete boxel->fr->f->toolbar;
-		delete boxel->fr->f->toolbar2;
-		delete boxel->fr->frame;
-		sender = NULL;
-		
-		}
-		else
-		{
-		FXMessageBox about (this, "error", "There are some processes connected with this filelist,\n finish them all and then you can close this filelist\n(this behavior will change in the next release of program)", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-  		about.execute ();
-		
-		}
-		
-	return 1;	
-		
-    }
-
-    else
-    {
-	if (id == ID_TORIGHT)
-	{
-	    pos = 1;
-	}
-	
-	if(left_frame->f->getWidth()==0)
-	pos=1;
-	
-	if(right_frame->f->getWidth()==0)
-	pos=-1;
-	
-	
-    }
-    if (pos == -1)
-    {
-	boxel->fr->frame->reparent (leftframe);
-	boxel->fr->hf->reparent (leftcontrolframe);
-	left_frame->hf->reparent (controlframe);
-	left_frame->f->toolbar->hide();
-	left_frame->f->toolbar2->hide();
-	left_frame->toleft->show ();
-	left_frame->toright->show ();
-	left_frame->toclose->show ();
-	left_frame->frame->hide ();
-	left_frame = boxel->fr;
-	left_frame->frame->show ();
-	
-    }
-
-    else
-    {
-	boxel->fr->frame->reparent (rightframe);
-	boxel->fr->hf->reparent (rightcontrolframe);
-	right_frame->hf->reparent (controlframe);
-	right_frame->f->toolbar->hide();
-	right_frame->f->toolbar2->hide();
-	right_frame->toleft->show ();
-	right_frame->toright->show ();
-	right_frame->toclose->show ();
-	right_frame->frame->hide ();
-	right_frame = boxel->fr;
-	right_frame->frame->show ();
-    }
-    left_frame->f->filelist_opposite = right_frame->f;
-    right_frame->f->filelist_opposite = left_frame->f;
-    boxel->fr->toleft->hide ();
-    boxel->fr->toright->hide ();
-    boxel->fr->toclose->hide ();
-    boxel->fr->f->handle (this, FXSEL (SEL_FOCUSIN, filelist::ID_ICO), NULL);
-    
-    rightframe->recalc ();
-    leftframe->recalc ();
-}
-
-
-//notify from filelist
-long MainWindow::onNotify (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXTRACE ((5, "NOTIFY\n"));
-    FXushort id = FXSELID (sel);
-    if (id == 667)
-    {
-	string *file_ptr = (string *) ptr;
-	string file = *file_ptr;
-	FXTRACE ((5, "change to directory %s\n", file.c_str ()));
-	delete file_ptr;
-	string dir;
-	string type;
-	string str_server = file;
-	dir = "/";
-	type = "archive";
-	pathtype pt (dir, type, str_server);
-	Frame *fr;
-	if (left_frame->f->active)
-	    fr = new Frame (leftcontrolframe, leftframe, pt, this, -1);
-
-	else
-	    fr = new Frame (rightcontrolframe, rightframe, pt, this, -1);
-	if (left_frame->f->active)
-	{
-	    left_frame->hf->reparent (controlframe);
-	    left_frame->toleft->show ();
-	    left_frame->toright->show ();
-	    left_frame->toclose->show ();
-	    left_frame->frame->hide ();
-	    left_frame->f->toolbar->hide();
-	    left_frame->f->toolbar2->hide();
-	    left_frame = fr;
- 
-	}
-
-	else
-	{
-	    right_frame->hf->reparent (controlframe);
-	    right_frame->toleft->show ();
-	    right_frame->toright->show ();
-	    right_frame->toclose->show ();
-	    right_frame->frame->hide ();
-	    right_frame->f->toolbar->hide();
-	    right_frame->f->toolbar2->hide();
-	    right_frame = fr;
-	
-	    
-	}
-	controlframe->recalc ();
-	fr->frame->create ();
-	fr->hf->create ();
-	fr->frame->show ();
-	fr->f->toolbar->dock(topdock);  
-        fr->f->toolbar2->dock(rightdock);
-	
-	left_frame->f->filelist_opposite = right_frame->f;
-	right_frame->f->filelist_opposite = left_frame->f;
-	
-	if(left_frame->f->active)
-	left_frame->f->handle (this, FXSEL (SEL_FOCUSIN, filelist::ID_ICO), NULL);
-	else
-	right_frame->f->handle (this, FXSEL (SEL_FOCUSIN, filelist::ID_ICO), NULL);
-	
-	rightframe->recalc ();
-	leftframe->recalc ();
-    }
-
-    else if (id == 666)		//directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
-    {
-	if (left_frame->f->active)
-	    left_frame->generate_menu (left_frame->f->path, this);
-
-	else
-	    right_frame->generate_menu (right_frame->f->path, this);
-    }
-
-    else if (id == 668)
-    {
-	if (left->getWidth () == 0 || right->getWidth () == 0)
-	    left->setWidth (getWidth () / 2);
-
-	else
-	{
-	    if (left_frame->f == (filelist *) sender)
-		left->setWidth (right->getWidth () + left->getWidth ());
-
-	    else
-		left->setWidth (0);
-	}
-    }
-}
-
-
-//pressed button in path
-long MainWindow::onOpenDir (FXObject * sender, FXSelector, void *ptr)
-{
-    FXTRACE ((5, "OPEN DIR\n"));
-    FXButton *bt = (FXButton *) sender;
-    box *boxel = (box *) bt->getUserData ();
-    box *boxbackup = boxel;
-    if (boxel->fr != right_frame && boxel->fr != left_frame)
-	return 0;
-    string path = "";
-    while (boxel->prebutton != NULL)
-    {
-	boxel = (box *) boxel->prebutton->getUserData ();
-    }
-    while (boxel != NULL)
-    {
-	if (boxel == boxbackup)
-	{
-	    break;
-	}
-	path.append (boxel->bt->getText ().text ());
-	boxel = (box *) boxel->nextbutton->getUserData ();
-    }
-    if (path == "")
-	path = "/";
-    boxbackup->fr->f->path = path;
-    boxbackup->fr->f->opendir (path);
-    boxbackup->fr->generate_menu (path, this);
-}
-
-
-//executed cyclically to update informations about progress of copying/moving/deleteing files
-//using vector of special objects thread_elem to read from them information and to write request
-//for example stoping copying.
-long MainWindow::onTimer (FXObject *, FXSelector, void *)
-{
-    vector < thread_elem * >::iterator iter;
-    unsigned int indx;
-    for (iter = objmanager->thread_vec.begin (); iter != objmanager->thread_vec.end (); iter++)
-    {
-	bool end = false;
-	informationpanel *infp;
-	thread_elem *telem = *iter;
-	if (telem->mutex.trylock ())
-	{
-	    if (telem->gui == NULL)
-	    {
-		infp = new informationpanel (infoframe, telem->command);
-		telem->gui = (void *) infp;
-		if (telem->command == "copy" || telem->command == "move" || telem->command == "remove")
-		{
-		    infp->bu->setUserData (telem);
-		    infp->bu->setSelector (MainWindow::ID_CANCEL);
-		    infp->bu->setTarget (this);
-		}
-
-		else if (telem->command == "execute")
-		{
-		    string show_commands = conf->readonestring ("/OpenspaceConfig/show_commands");
-		    if (show_commands == "true")
-		    {
-			FXFont *font = new FXFont (getApp (), "Arial", 8);
-			if (font)
-			{
-			    font->create ();
-			    infp->lab0->setFont (font);
-			}
-			infp->lab0->setText (telem->src[0].c_str ());
-			infp->frame->recalc ();
-		    }
-
-		    else
-			infp->frame->hide ();
-		}
-
-		else if (telem->command == "init")
-		{
-		    string text = "connecting ... ";
-		    infp->lab0->setText (text.c_str ());
-		    infp->frame->recalc ();
-		}
-	    }
-	    //popup with question about skipping or overwriting file
-	    if (telem->question == true)
-	    {
-		telem->question = false;
-		telem->pane = new FXMenuPane (this);
-		FXButton *but = new FXButton (telem->pane, "overwrite", NULL, this,
-					      ID_OVERWRITE);
-		but->setUserData (telem);
-		but = new FXButton (telem->pane, "skip", NULL, this, ID_SKIP);
-		but->setUserData (telem);
-		but = new FXButton (telem->pane, "skip all", NULL, this, ID_SKIP_ALL);
-		but->setUserData (telem);
-		but = new FXButton (telem->pane, "overwrite all", NULL, this, ID_OVERWRITE_ALL);
-		but->setUserData (telem);
-		telem->pane->create ();
-		telem->pane->popup (NULL, this->getX () + 300, this->getY () + 300, but->getWidth (), 100);
-	    }
-	    //when command is copy or move update information about progress
-	    if (telem->command == "copy" || telem->command == "move")
-	    {
-		infp = (informationpanel *) telem->gui;
-		string info = "total size: " + numtostring (telem->total_size);
-		infp->lab0->setText (info.c_str ());
-		info = "Current file: " + telem->act_file_name + " size: " + numtostring (telem->file_size);
-		infp->lab1->setText (info.c_str ());
-		double pct2 = 100 * (double) telem->act_total_size / (double) telem->total_size;
-		infp->pbar2->setProgress ((int) pct2);
-		double pct = 100 * (double) telem->act_file_size / (double) telem->file_size;
-		infp->pbar->setProgress ((int) pct);
-		double diff = difftime (time (NULL), *telem->tim);
-		info = "time elapsed: " + ntos ((unsigned int) diff) + " copied size: ";
-		info.append (numtostring (telem->act_file_size));
-		if (diff == 0)
-		    diff = 0.001;
-		double speed = (double) telem->act_total_size / diff;
-		info.append (" Speed: " + numtostring ((unsigned int) speed) + "/s");
-		unsigned int eta = (unsigned int) ((diff * (double) telem->total_size) / (double) telem->act_total_size);
-		eta = eta - (unsigned int) diff;
-		info.append (" ETA: " + ntos (eta));
-		infp->lab2->setText (info.c_str ());
-	    }
-
-	    else if (telem->command == "remove")
-	    {
-		infp = (informationpanel *) telem->gui;
-		string info = "Removing: " + telem->act_file_name;
-		//FXTRACE ((5, "remove file %s\n", telem->act_file_name.c_str ()));
-		infp->lab0->setText (info.c_str ());
-		infp->frame->recalc ();
-	    }
-
-	    else if (telem->command == "execute")
-	    {
-		string::size_type pos = telem->options.find ("capture");
-		if (pos != string::npos)
-		{
-		    char readbuf[80];
-		    int k = 0;
-		    while (read (telem->p[0], readbuf, 1) > 0 && k++ < 2000)
-		    {
-			string s = "";
-			s = s + readbuf[0];
-			if (s == "!")
-			    telem->end = true;
-
-			else
-			    telem->dst = telem->dst + readbuf[0];
-		    }
-		}
-	    }
-	    end = telem->end;
-	    telem->mutex.unlock ();
-	    if (end)		//when telem ended
-	    {
-	    
-		if(telem->error)
-		{
-		FXMessageBox about (this, "error", telem->msg.c_str(), NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-  		about.execute ();	    
-		}
-		filelist *fil = (filelist*) telem->filel;
-		
-		string::size_type pos = telem->options.find ("download");
-		bool download = false;
-		if (pos != string::npos)
-		{
-		    download = true;
-		
-		}
-
-		if (telem->command == "init")
-		{
-		    FXTRACE ((5, "INIT \n"));
-		    if(fil->init ()!=false)
-		    {
-		   	 if (left_frame->f->active)
-	  		  left_frame->generate_menu (fil->path, this);
-			  else
-			  right_frame->generate_menu (fil->path, this);
-		    }
-		    else
-		    {
-		        FXMessageBox box(getApp (), "error", "Can't connect :|", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-    			box.execute ();
-		    
-		    
-		    }	  
-		}
-		if (telem->command == "copy")
-		{
-		    if ((left_frame->f->fb == telem->fb && download == true) || (download == false && right_frame->f->fb == telem->fb))
-			left_frame->f->refresh ();
-
-		    else
-			right_frame->f->refresh ();
-		}
-
-		else if (telem->command == "remove")
-		{
-		    fil->refresh ();
-		}
-
-		else if (telem->command == "move")
-		{
-		    right_frame->f->refresh ();
-		    left_frame->f->refresh ();
-		}
-		string options = telem->options;	// get special options
-		pos = options.find ("rescan");	// when we need to rescan directory after command finish
-		if (pos != string::npos)
-		{
-
-		    fil->refresh ();
-
-		}
-		pos = telem->options.find ("capture");	// when we need to capture data from standard output from executed program
-		if (pos != string::npos)
-		{
-		    telem->pane = new FXMenuPane (this);
-		    FXLabel *lab = new FXLabel (telem->pane, telem->dst.c_str ());
-		    telem->pane->create ();
-		    telem->pane->popup (NULL, this->getX (), this->getY (), lab->getWidth (), lab->getHeight ());
-		}
-		//cleanup
-		delete ((informationpanel *) telem->gui);
-		telem->gui = NULL;
-		infoframe->recalc ();
-
-		//erase from vector and delete telem;   
-		objmanager->thread_vec.erase (iter);
-		delete telem;
-		break;
-	    }
-	}
-    }				//end for
-    getApp ()->addTimeout (this, ID_TIMER, 200);
-    return 1;
-}
-
-
-//when we choose in popup if we want overwrite or skip
-//notify about this filelist plugin using telem
-long MainWindow::onOverwrite (FXObject * sender, FXSelector sel, void *)
-{
-    FXushort id = FXSELID (sel);
-    FXButton *but = (FXButton *) sender;
-    thread_elem *te = (thread_elem *) but->getUserData ();
-    te->mutex.lock ();
-    if (id == ID_OVERWRITE)
-    {
-	te->overwrite = true;
-    }
-
-    else if (id == ID_SKIP)
-    {
-	te->overwrite = false;
-    }
-
-    else if (ID_OVERWRITE_ALL)
-    {
-	te->overwrite = true;
-	te->all = true;
-    }
-
-    else if (id == ID_SKIP_ALL)
-    {
-	te->overwrite = false;
-	te->all = true;
-    }
-    te->pane->hide ();
-    delete te->pane;
-    te->answer = true;
-    te->mutex.unlock ();
-}
-
-
-//NEED TO CHANGE THIS
-long MainWindow::onConfigure (FXObject * sender, FXSelector sel, void *ptr)
-{
-if(!conf) return 0;
-
-    FXMainWindow::onConfigure (sender, sel, ptr);
-    float widthpanel = this->getWidth () * ratio;
-    left->setWidth ((int) widthpanel);
-
-} 
-long MainWindow::onUpdate (FXObject * sender, FXSelector sel, void *ptr)
-{
-if(!conf)return 0;
-
-    FXMainWindow::onUpdate (sender, sel, ptr);
-    float l = left->getWidth ();
-    float r = right->getWidth ();
-    float w = getWidth ();
-    ratio = (float) l / (float) w;
-
-}
-
-//telem is canceled
-long MainWindow::cancel (FXObject * sender, FXSelector, void *)
-{
-    FXButton *but = (FXButton *) sender;
-    thread_elem *te = (thread_elem *) but->getUserData ();
-    te->mutex.lock ();
-    te->cancel = true;
-    te->mutex.unlock ();
-}
-
-
-
-
-//load icon from file and put in the array
-void MainWindow::loadicons (string icondir)
-{
-
- objmanager=objectmanager::instance(getApp());
-   
-
-FXIconSource *source = new FXIconSource (getApp ());
-FXString fil=icondir.c_str();
-FXString name=fil+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/dir/icon").c_str() + ".png";
-objmanager->specialicons[0] =  source->loadIcon (name);
-if(objmanager->specialicons[0])
-objmanager->specialicons[0]->create();
-name=fil+"big_"+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/dir/icon").c_str()+ ".png";
-objmanager->specialicons[1] =  source->loadIcon (name);
-if(objmanager->specialicons[1])
-objmanager->specialicons[1]->create();
-name=fil+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/all/icon").c_str()+ ".png";
-objmanager->specialicons[2] =  source->loadIcon (name);
-if(objmanager->specialicons[2])
-objmanager->specialicons[2]->create();
-name=fil+"big_"+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/all/icon").c_str()+ ".png";
-objmanager->specialicons[3] =  source->loadIcon (name);
-if(objmanager->specialicons[3])
-objmanager->specialicons[3]->create();
-name=fil+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/executable/icon").c_str()+ ".png";
-objmanager->specialicons[4] =  source->loadIcon (name);
-if(objmanager->specialicons[4])
-objmanager->specialicons[4]->create();
-name=fil+conf->readonestring ("/OpenspaceConfig/file_types/COMMON/types/symlink/icon").c_str()+ ".png";
-objmanager->specialicons[5] =  source->loadIcon (name);
-if(objmanager->specialicons[5])
-objmanager->specialicons[5]->create();
-
-
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
- 
-	    dirp = opendir (icondir.c_str ());
-	    
-	    if(dirp)	
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-	 
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-		string name=dp->d_name;
-	
-			//if (name.length () >= 3 && (name.substr (name.length () - 3, 3) == "gif" || name.substr (name.length () - 3, 3) == "png"))
-			{
-		
-		   	 string file = icondir;
-		   	 file.append (name);	
-			string shortname=name.substr (0,name.length () - 4);
-			
-			 FXString fil_name=file.c_str();
-			
-  		    	 objmanager->osicons[shortname] = source->loadIcon (fil_name);
-		
-   			 objmanager->osicons[shortname]->create ();
-		
-	
-			}
-		    
-		}
-	    }
-
-	    closedir (dirp);
-
-   
-}
-
-
-    // read color definied as FF FF FF and return FXColor  
-FXColor readcolor (string col)
-{
-    if (col == "")
-	return FXRGB (0, 0, 0);
-	
-return fxcolorfromname(col.c_str());
-
-}
-
-
-//the same as above but defualt color is white
-FXColor readcolor2 (string col)
-{
-    if (col == "")
-	return FXRGB (255, 255, 255);
-return  fxcolorfromname(col.c_str());
-}
-
-string MainWindow::parseDir (string dir)
-{
-    if (dir == "{homedir}")
-	return FXFile::getHomeDirectory ().text ();
-
-    else
-	return dir;
-}
-
-bool MainWindow::loadMimeSettings (string path, string type)
-{
-
-    string res2 = conf->readonestring (path + "/icon");
-    string colorstr = conf->readonestring (path + "/color");
-    FXColor color = readcolor (colorstr);
-    string backcolorstr = conf->readonestring (path + "/backcolor");
-    FXColor backcolor = readcolor2 (backcolorstr);
-    if(res2!="")
-    objmanager->file_type_settings[type] = new file_type (objmanager->osicons[res2],objmanager->osicons["big_"+res2], color, backcolor);
-    else
-    return false;
-
-}
-
-
-
-
-//-----FRAME---------------------------------------------------------------------------------------------------------------------------         
-Frame::Frame (FXComposite * cp, FXComposite * p, pathtype pt, FXObject * tgt, int position = 0)
-{
-    this->pathdir = pt.dir;
-    this->type = pt.type;
-    string path = pathdir;
-    hf = new FXHorizontalFrame (cp, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    pathdir = path;
-
-//generate_menu(path,tgt);
-    int z = 0;
-    FXButton *prebutton = NULL;
-    FXButton *nextbutton = NULL;
-    
-    objectmanager*objmanager=objectmanager::instance(cp->getApp());
-
-          
-    toleft = new FXButton (hf, "",objmanager->osicons["left"], tgt, MainWindow::ID_TOLEFT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    toleft->setUserData (new box (this, NULL, NULL, NULL));
-    toclose = new FXButton (hf, "", objmanager->osicons["close"], tgt, MainWindow::ID_TOCLOSE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    toclose->setUserData (new box (this, NULL, NULL, NULL));
-    toright = new FXButton (hf, "", objmanager->osicons["right"], tgt, MainWindow::ID_TORIGHT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
-    toright->setUserData (new box (this, NULL, NULL, NULL));
-    if(pt.server!="")
-    {
-    string lab=pt.server+": ";
-    new FXLabel(hf,lab.c_str());
-    }
-
-//new FXLabel (hf," ");
-    if (position != 0)
-    {
-	toleft->hide ();
-	toclose->hide ();
-	toright->hide ();
-    }
-    while (z != -1)
-    {
-	string path_element = "";
-	z = path.find (SEPARATOR, 1);
-	if (z == -1)
-	    path_element.append (path);
-
-	else
-	    path_element.append (path.substr (0, z));
-	path.erase (0, z);
-	FXButton *bt = new FXButton (hf, path_element.c_str (), NULL, tgt,
-				     MainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
-				     0, 0);
-	bt->setBackColor (objmanager->maincolor);
-	if (prebutton != NULL)
-	{
-	    box *boxel = (box *) prebutton->getUserData ();
-	    boxel->nextbutton = bt;
-	}
-
-	else
-	    firstbutton = bt;
-	bt->setUserData (new box (this, prebutton, bt, NULL));
-	prebutton = bt;
-    }
-    
-    frame = new FXVerticalFrame (p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    f = new filelist (frame, pt);
-    if (position == 0)
-    {
-	frame->hide ();
-    }
-}
-
-
-//generate buttons path for given path
-void Frame::generate_menu (string path, FXObject * tgt)
-{
-
-objectmanager*objmanager=objectmanager::instance(hf->getApp());
-
-    FXTRACE ((5, "GENERATE MENU path %s ", path.c_str ()));
-    if (path[0] == '/' && path[1] == '/')
-	path.erase (0, 1);
-    box *boxel = (box *) firstbutton->getUserData ();
-    box *boxbackup = boxel;
-    while (boxel)
-    {
-	box *boxel_del = boxel;
-	if (boxel->nextbutton != NULL)
-	    boxel = (box *) boxel->nextbutton->getUserData ();
-
-	else
-	    boxel = NULL;
-	delete boxel_del->bt;
-	delete boxel_del;
-	boxel_del->bt = NULL;
-	boxel_del = NULL;
-    }
-    this->pathdir = path;
-    int z = 0;
-    FXButton *prebutton = NULL;
-    FXButton *nextbutton = NULL;
-    while (z != -1)
-    {
-	string path_element = "";
-	z = path.find (SEPARATOR, 1);
-	if (z == -1)
-	    path_element.append (path);
-
-	else
-	    path_element.append (path.substr (0, z));
-	path.erase (0, z);
-	FXButton *bt = new FXButton (hf, path_element.c_str (), NULL, tgt,
-				     MainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
-				     0, 0);
-	bt->setBackColor (objmanager->maincolor);
-	bt->create ();
-	if (prebutton != NULL)
-	{
-	    box *boxel = (box *) prebutton->getUserData ();
-	    boxel->nextbutton = bt;
-	}
-
-	else
-	    firstbutton = bt;
-	bt->setUserData (new box (this, prebutton, bt, NULL));
-	prebutton = bt;
-    }
-}

Deleted: trunk/src/mainwindow.h
===================================================================
--- trunk/src/mainwindow.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/mainwindow.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,201 +0,0 @@
-#ifndef MAINWINDOW
-#define MAINWINDOW
-
-#include <map>
-using namespace std;
-
-#include "pathtype.h"
-#include "filelist.h"
-#include "filetype.h"
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-
-//--------------------------------------------------------------------------------------------------------------------------------------------------    
-
-class box;
-class Frame;
-
-
-//the main application window
-
-class MainWindow:public FXMainWindow
-{
-  FXDECLARE (MainWindow) public:
-    enum
-    {
-	ID_DIR = FXMainWindow::ID_LAST,
-	ID_DIRCH,
-	ID_TOLEFT,
-	ID_TOCLOSE,
-	ID_TORIGHT,
-	ID_NEWFRAME,
-	ID_TIMER,
-	ID_CANCEL,
-	ID_COMMANDS_SHOW,
-	ID_NEW_NETWORK,
-	ID_OVERWRITE,
-	ID_OVERWRITE_ALL,
-	ID_SKIP,
-	ID_SKIP_ALL,
-	ID_ABOUT,
-	ID_CONFIGURE,
-	ID_NEW_SEARCH,
-	ID_LAST,
-    };
-
-    MainWindow (FXApp *);
-    virtual ~ MainWindow ();
-    virtual void create ();
-
-
-
-    long MainWindow::onListDirs (FXObject * sender, FXSelector, void *);
-    long MainWindow::onChangeDir (FXObject * sender, FXSelector, void *);
-    long MainWindow::onChangeList (FXObject * sender, FXSelector, void *);
-    long MainWindow::onNewFrame (FXObject * sender, FXSelector, void *);
-    long MainWindow::onNewNetworkFrame (FXObject * sender, FXSelector, void *);
-    long MainWindow::onNewSearchFrame (FXObject * sender, FXSelector, void *);
-    long MainWindow::onNotify (FXObject * sender, FXSelector, void *);
-    long MainWindow::onOpenDir (FXObject * sender, FXSelector, void *);
-    long MainWindow::onTimer (FXObject *, FXSelector, void *);
-    long MainWindow::cancel (FXObject * sender, FXSelector, void *);
-    long MainWindow::update (FXObject * sender, FXSelector, void *);
-    long MainWindow::commandsShow (FXObject * sender, FXSelector, void *);
-    long MainWindow::onListNextDir (FXObject * sender, FXSelector, void *);
-    long MainWindow::onOverwrite (FXObject * sender, FXSelector, void *);
-    long MainWindow::onAbout (FXObject * sender, FXSelector sel, void *);
-    long MainWindow::onOpenConfigure (FXObject * sender, FXSelector sel, void *);
-    long MainWindow::onUpdate (FXObject * sender, FXSelector sel, void *);
-    long MainWindow::onConfigure (FXObject * sender, FXSelector sel, void *);
-
-    int MainWindow::popupDir (filelist * current_filelist, string path, int x, int y);
-
-    string MainWindow::parseDir (string dir);
-    bool MainWindow::loadMimeSettings (string path, string type);
-
-
-
-  private:
-     MainWindow ()
-    {
-    }
-    void MainWindow::loadicons (string dir);
-
-    FXVerticalFrame *leftframe;
-    FXVerticalFrame *rightframe;
-    FXVerticalFrame *infoframe;
-    FXVerticalFrame *controlframe;
-
-    FXVerticalFrame *rightcontrolframe;
-    FXVerticalFrame *leftcontrolframe;
-    FXVerticalFrame *left;
-    FXVerticalFrame *right;
-    FXHorizontalFrame *networkframe, *searchframe;
-    FXTextField *search_path,*search_filefilter,*search_size_greater,*search_size_less;
-
-    FXSplitter *splitter;
-    FXMenuPane *filemenu;
-
-    FXTextField *server;
-    FXTextField *user;
-    FXTextField *password;
-    FXTextField *port;
-
-    Frame *fr;
-
-    Frame *current_frame;
-    Frame *left_frame;
-    Frame *right_frame;
-    FXMenuPane *pane;
-    preferences *pref;
-    float ratio;
-
-
-    FXToolBarShell *dragshell1;	// Shell for floating menubar
-    FXToolBarShell *dragshell2;	// Shell for floating toolbar
-    FXToolBarShell *dragshell3;	// Shell for floating toolbar
-    FXToolBarShell *dragshell4;	// Shell for floating toolbar
-    FXDockSite *topdock;
-    FXDockSite *bottomdock;
-    FXDockSite *leftdock;
-    FXDockSite *rightdock;
-    
-    FXComboBox *filelisttypecombobox;
-    
-objectmanager *objmanager;
-};
-
-
-
-
-
-
-//--------------------------------------------------------------------------------------------------------------------------------------------------
-
-class Frame;
-
-class box
-{
-
-  public:
-
-    Frame * fr;
-    FXButton *prebutton;
-    FXButton *bt;
-    FXButton *nextbutton;
-
-
-     box (Frame * fr, FXButton * prebutton, FXButton * bt, FXButton * nextbutton)
-    {
-	this->bt = bt;
-	this->fr = fr;
-	this->prebutton = prebutton;
-	this->nextbutton = nextbutton;
-    }
-
-};
-
-
-class Frame
-{
-  private:
-	
-  public:
-
-    string pathdir;
-    string type;
-    filelist *f;
-    FXButton *toleft;
-    FXButton *toright;
-    FXButton *toclose;
-    FXButton *firstbutton;
-    
-    FXVerticalFrame * frame;
-    FXHorizontalFrame *hf;
-
-    Frame (FXComposite * cp, FXComposite * p, pathtype pt, FXObject * tgt, int position);
-    void generate_menu (string path, FXObject * tgt);
-
-    ~Frame ()
-    {
-	delete hf;
-	delete f;
-	delete frame;
-    }
-
-
-
-};
-
-
-
-
-
-#endif

Deleted: trunk/src/openspace.cpp
===================================================================
--- trunk/src/openspace.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/openspace.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,63 +0,0 @@
-#include "fx.h"
-#include "config.h"
-#include "mainwindow.h"
-#include <unistd.h>
-
-//-----MAIN--------------------------------------------------------------------------------------- 
-//nothing special here, create and execute main window,
-//creating needed directoris if doesn't exist
-int main (int argc, char **argv)
-{
-
-	for(int i=0;i<argc;i++)
-	{
-		if(!strcmp(argv[i],"-v") || !strcmp(argv[i],"--version") )
-		{
-		fxmessage("\n%s\n",PACKAGE_STRING);
-		return 0;
-		}
-		
-		if(!strcmp(argv[i],"-h") || !strcmp(argv[i],"--help") )
-		{
-		fxmessage("\n-h, --help print this help\n");
-		fxmessage("-v, --version print version\n");
-		return 0;
-		}
-	}
-	
-        string tmpdir="/tmp/openspace";	
-        if(!FXFile::exists(tmpdir.c_str()))
-	{
-	FXFile::createDirectory(tmpdir.c_str(),493);	
-	}
-	
-        string dir = FXFile::getUserDirectory ("").text ();
-        dir=dir +  "/.openspace";
-        string file = dir +  "/openspacerc";
-	
-	if(!FXFile::exists(file.c_str()))
-	{
-	FXFile::createDirectory(dir.c_str(),493);
-	string dir2=dir+"/icons";
-	FXFile::createDirectory(dir2.c_str(),493);	
-	dir+="/plugins";
-	FXFile::createDirectory(dir.c_str(),493);
-	dir2=dir+"/cmddialog";
-	FXFile::createDirectory(dir2.c_str(),493);
-	dir2=dir+"/filelist";
-	FXFile::createDirectory(dir2.c_str(),493);
-	
-		
-	string src=PATH_CFG + string("/openspacerc");
-	FXFile::copy(src.c_str(),file.c_str());
-	}
-    fxTraceLevel = 0;
-    FXApp *application = new FXApp ("openspace", NULL);
-    application->init (argc, argv);
- 
-    new MainWindow (application);
-    application->create ();
-    return application->run ();
-}
-
-//-----MAIN------------------------------------------------------------------------------------------------------------------------------------------       

Deleted: trunk/src/osfile.h
===================================================================
--- trunk/src/osfile.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/osfile.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,38 +0,0 @@
-#ifndef OSFILE
-#define OSFILE
-
-#include <string>
-#include <vector>
-using namespace std;
-
-enum
-{
-    FOLDER = 64,		// Directory item
-    EXECUTABLE = 128,		// Executable item
-    SYMLINK = 256,		// Symbolic linked item
-    CHARDEV = 512,		// Character special item
-    BLOCKDEV = 1024,		// Block special item
-    FIFO = 2048,		// FIFO item
-    SOCK = 4096			// Socket item
-};
-
-
-//class associated with file
-class osfile
-{
-  public:
-    string name;
-    unsigned int type;
-    unsigned long size;
-    vector <string> attrib;
-    string content;
-
-string mode;
-string user;
-string group;
-string date;
-
-
-};
-
-#endif

Deleted: trunk/src/oslistitem.cpp
===================================================================
--- trunk/src/oslistitem.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/oslistitem.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,341 +0,0 @@
-#include "fx.h"
-using namespace FX;
-
-#include "oslistitem.h"
-#include "filelist.h"
-
-//TMP
-#include "sharedobjects.h"
-
-#define SIDE_SPACING             4    // Left or right spacing between items
-#define DETAIL_TEXT_SPACING      2    // Spacing between text and icon in detail icon mode
-#define MINI_TEXT_SPACING        2    // Spacing between text and icon in mini icon mode
-#define BIG_LINE_SPACING         0    // Line spacing in big icon mode
-#define BIG_TEXT_SPACING         0    // Spacing between text and icon in big icon mode
-#define ITEM_SPACE             128    // Default space for item
-
-
-
-FXIMPLEMENT(os_ListItem,FXIconItem,NULL,0)
-
-// Constructor
-
-os_ListItem::os_ListItem(FXIconList *list,osfile osf, FXColor col, FXColor backcol,FXIcon* ic1,FXIcon* ic2):FXIconItem(osf.name.c_str(),ic1,ic2,NULL),osf(osf)
-{
-
-this->list=list;
-color=col;
-backcolor=backcol;
-state|=FXIconItem::DRAGGABLE;
-}
-
-
-// Draw detail
-void os_ListItem::drawDetails(const FXIconList* list,FXDC& dc,FXint x,FXint y,FXint,FXint h) const {
-
-//=============CHANGES==========================================
-	FXString label=osf.name.c_str();
-	label.append("\t");
-		for(int i=0;i<osf.attrib.size();i++)
-		{				
-		label.append(osf.attrib[i].c_str());
-		label.append("\t");			
-		}
-//=============CHANGES==========================================
-
-
-
-  register FXHeader *header=list->getHeader();
-  register FXFont *font=list->getFont();
-  register FXint iw=0,ih=0,tw=0,th=0,yt,beg,end,hi,drw,space,used,dw,xx;
-  if(header->getNumItems()==0) return;
-  if(isSelected()){
-    dc.setForeground(list->getSelBackColor());
-    dc.fillRectangle(x,y,header->getTotalSize(),h);
-    }
-  if(hasFocus()){
-    dc.drawFocusRectangle(x+1,y+1,header->getTotalSize()-2,h-2);
-    }
-  xx=x+SIDE_SPACING/2;
-  if(miniIcon){
-
-    iw=miniIcon->getWidth();
-    ih=miniIcon->getHeight();
-    dc.setClipRectangle(x,y,header->getItemSize(0),h);
-    dc.drawIcon(miniIcon,xx,y+(h-ih)/2);
-    dc.clearClipRectangle();
-    xx+=iw+DETAIL_TEXT_SPACING;
-    }
-  if(!label.empty()){
-    th=font->getFontHeight();
-    dw=font->getTextWidth("...",3);
-    yt=y+(h-th-4)/2;
-    if(!isEnabled())
-      dc.setForeground(makeShadowColor(list->getBackColor()));
-    else if(isSelected())
-      dc.setForeground(list->getSelTextColor());
-    else
-      dc.setForeground(color); //CHANGES dc.setForeground(list->getTextColor());
-    used=iw+DETAIL_TEXT_SPACING+SIDE_SPACING/2;
-    for(hi=beg=0; beg<label.length() && hi<header->getNumItems(); hi++,beg=end+1){
-      space=header->getItemSize(hi)-used;
-      for(end=beg; end<label.length() && label[end]!='\t'; end++);
-      if(end>beg){
-        drw=end-beg;
-        tw=font->getTextWidth(&label[beg],drw);
-        if(tw>space-4){
-          while((tw=font->getTextWidth(&label[beg],drw))+dw>space-4 && drw>1) drw--;
-          dc.setClipRectangle(xx,y,space,h);
-          dc.drawText(xx+2,yt+font->getFontAscent()+2,&label[beg],drw);
-          dc.drawText(xx+tw+2,yt+font->getFontAscent()+2,"...",3);
-          dc.clearClipRectangle();
-          }
-        else{
-          dc.drawText(xx+2,yt+font->getFontAscent()+2,&label[beg],drw);
-          }
-        }
-      xx+=space;
-      used=0;
-      }
-    }
-  }
-  
- 
- void os_ListItem::drawBigIcon(const FXIconList* list,FXDC& dc,FXint x,FXint y,FXint w,FXint h) const {
- 
- 
- //=============CHANGES==========================================
-	FXString label=osf.name.c_str();
-	
-		
-//=============CHANGES==========================================
-   FXFont *font=((filelist*)list)->objmanager->captionfont1;
-   FXFont *font1=((filelist*)list)->objmanager->captionfont2; 
- 
- 
-  register FXint len,dw,s,space,xt,yt,xi,yi;
-  //register FXFont *font=list->getFont();
-  register FXint iw=0,ih=0,tw=0,th=0,ss=0;
-  space=w-SIDE_SPACING;
-  if(!label.empty()){
-    for(len=0; len<label.length() && label[len]!='\t'; len++);
-    tw=4+font->getTextWidth(label.text(),len);
-    
-    
-    
-    
-      if(bigIcon)
-      {
-  	  ih=bigIcon->getHeight();
-	  iw=bigIcon->getWidth();
-	   xi=x+(w-iw)/2;
-      }
-    
-    
-    
-    
-    th=4+font->getFontHeight();
-     //=============CHANGES==========================================    
-      for(int i=0;i<osf.attrib.size();i++)
-		{		
-		th=th+4+font1->getFontHeight();	   
-		}
-  //=============CHANGES==========================================
-    
-    
-    //yt=y+h-th-BIG_LINE_SPACING/2;   
-    yi=y+BIG_LINE_SPACING/2+(h-th-BIG_LINE_SPACING-ss-ih)/2;
-    yt=y;
-    
-    dw=0;
-    if(tw>space){
-      dw=font->getTextWidth("...",3);
-      s=space-dw;
-      while((tw=4+font->getTextWidth(label.text(),len))>s && len>1) --len;
-      if(tw>s) dw=0;
-      }
-    if(tw<=space){         // FIXME as below in drawDetails
-      //xt=x+(w-tw-dw)/2;
-      xt=x+iw;
-      
-      if(isSelected()){
-       // dc.setForeground(list->getSelBackColor());
-        //dc.fillRectangle(xt,yt,tw+dw,th);
-        }
-	dc.setForeground(backcolor);
-	dc.fillRectangle(x,y,200,93);
-	
-	
-      if(!isEnabled())
-        dc.setForeground(makeShadowColor(list->getBackColor()));
-      else if(isSelected())
-        dc.setForeground(color); 
-      else
-	 dc.setForeground(color); 
-	
-	
-      dc.drawText(xt+2-iw,yt+font->getFontAscent()+2,label.text(),len);
-      
-      
-      if(dw) dc.drawText(xt-iw+tw-2,yt+font->getFontAscent()+2,"...",3);
-   //=============CHANGES==========================================    
-    dc.setFont(font1);
-      for(int i=0;i<osf.attrib.size();i++)
-		{				
-		
-		dc.drawText(xt+2,yt+(i+2)*font->getFontAscent()+2,osf.attrib[i].c_str(),osf.attrib[i].length());
-			
-		}
-  //=============CHANGES==========================================
-    dc.setFont(font);   
-      /*if(hasFocus()){
-        dc.drawFocusRectangle(xt+1,yt+1,tw+dw-2,th-2);
-        }*/
-      }
-    ss=0;//BIG_TEXT_SPACING;    // Space between text and icon only added if we have both icon and text
-    }
-  if(bigIcon){
-   
-    //=============CHANGES==========================================    
-    xi=x;
-    //=============CHANGES==========================================    
-    yi=y+BIG_LINE_SPACING/2+(h-th-BIG_LINE_SPACING-ss-ih)/2;
-    if(isSelected()){
-      dc.drawIconShaded(bigIcon,xi,y+4+font->getFontHeight());
-      }
-    else{
-      dc.drawIcon(bigIcon,xi,y+4+font->getFontHeight());
-      }
-     if(osf.type&EXECUTABLE && !(osf.type&FOLDER))
-     {       
-     dc.drawIcon(((filelist*)list)->specialicons[4],xi,y+4+font->getFontHeight());
-     }
-     else if(osf.type&SYMLINK)
-     {
-       dc.drawIcon(((filelist*)list)->specialicons[5],xi,y+4+font->getFontHeight());
-     }
-     
-     if(osf.content!="")
-     {
-     dc.setFont(font1);
-     dc.drawText(xi,y+4+font->getFontHeight()+font->getFontAscent()+2,osf.content.c_str(),10);
-     dc.setFont(font);     
-     }
-      
-    }
-  } 
-  
-
-
-FXint os_ListItem::getHeight(const FXIconList* list) const {
-FXFont *font=((filelist*)list)->objmanager->captionfont1;
-FXFont *font1=((filelist*)list)->objmanager->captionfont2;
-
-  register FXuint options=list->getListStyle();
-  register FXint ih=0,th=0,h=0,firstth=0;
-  if(options&ICONLIST_BIG_ICONS){
-    if(bigIcon) ih=bigIcon->getHeight();
-    if(!label.empty()) th=4+font->getFontHeight();
-    if(ih && th) ih+=BIG_TEXT_SPACING;
-    firstth=th;
-     //=============CHANGES==========================================    
-      for(int i=0;i<osf.attrib.size();i++)
-		{		
-	       th=th+4+font1->getFontHeight();           
-		}
-  //=============CHANGES==========================================
-    
-   	 if(ih>th)
-   	 h=BIG_LINE_SPACING+ih+firstth+4;
-	 else
-	 h=BIG_LINE_SPACING+th;
-	
-    }
-  else if(options&ICONLIST_MINI_ICONS){
-    if(miniIcon) ih=miniIcon->getHeight();
-    if(!label.empty()) th=4+list->getFont()->getFontHeight();
-    h=FXMAX(ih,th);
-    }
-  else{
-    if(miniIcon) ih=miniIcon->getHeight();
-    if(!label.empty()) th=4+list->getFont()->getFontHeight();
-    h=FXMAX(ih,th);
-    }
-
-  return h;
-  }
-
-
-FXint os_ListItem::hitItem(const FXIconList* list,FXint rx,FXint ry,FXint rw,FXint rh) const {
-
-FXFont *font=((filelist*)list)->objmanager->captionfont1;
-FXFont *font1=((filelist*)list)->objmanager->captionfont2;
-
- register FXint iw=0,tw=0,ih=0,th=0,ss=0,ix,iy,tx,ty,w,h,sp,tlen;
-  register FXuint options=list->getListStyle();
-  //register FXFont *font=list->getFont();
-  for(tlen=0; tlen<label.length() && label[tlen]!='\t'; tlen++);
-  if(options&ICONLIST_BIG_ICONS){
-    w=list->getItemSpace();
-    h=list->getItemHeight();
-    sp=w-SIDE_SPACING;
-    if(!label.empty()){
-      tw=4+font->getTextWidth(label.text(),tlen);
-      th=4+font->getFontHeight();
-      if(tw>sp) tw=sp;
-      if(bigIcon) ss=BIG_TEXT_SPACING;
-      }
-    if(bigIcon){
-      iw=bigIcon->getWidth();
-      ih=bigIcon->getHeight();
-      }
-    ty=h-th-BIG_LINE_SPACING/2;
-    iy=4+font->getFontHeight();
-    ix=0;
-    tx=(w-tw)/2;
-    }
-  else if(options&ICONLIST_MINI_ICONS){
-    sp=list->getItemSpace()-SIDE_SPACING;
-    ix=SIDE_SPACING/2;
-    tx=SIDE_SPACING/2;
-    if(miniIcon){
-      iw=miniIcon->getWidth();
-      ih=miniIcon->getHeight();
-      tx+=iw+MINI_TEXT_SPACING;
-      sp=sp-iw-MINI_TEXT_SPACING;
-      }
-    if(!label.empty()){
-      tw=4+font->getTextWidth(label.text(),tlen);
-      th=4+font->getFontHeight();
-      if(tw>sp) tw=sp;
-      }
-    h=list->getItemHeight();
-    iy=(h-ih)/2;
-    ty=(h-th)/2;
-    }
-  else{
-    ix=SIDE_SPACING/2;
-    tx=SIDE_SPACING/2;
-    if(miniIcon){
-      iw=miniIcon->getWidth();
-      ih=miniIcon->getHeight();
-      tx+=iw+DETAIL_TEXT_SPACING;
-      }
-    if(!label.empty()){
-      tw=10000000;
-      th=4+font->getFontHeight();
-      }
-    h=list->getItemHeight();
-    iy=(h-ih)/2;
-    ty=(h-th)/2;
-    }
-
-  // In icon?
-  if(ix<=rx+rw && iy<=ry+rh && rx<ix+iw && ry<iy+ih) return 1;
-
-  // In text?
-  if(tx<=rx+rw && ty<=ry+rh && rx<tx+tw && ry<ty+th) return 2;
-
-  // Outside
-  return 0;
-  }

Deleted: trunk/src/oslistitem.h
===================================================================
--- trunk/src/oslistitem.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/oslistitem.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,36 +0,0 @@
-#ifndef osListItem
-#define osListItem
-
-#include "osfile.h"
-    
-//added some features to standard fxiconitem
-//for example new big icon view
-class os_ListItem:public FXIconItem 
-{
-  FXDECLARE (os_ListItem)  private: protected:void drawDetails (const FXIconList * list, FXDC & dc, FXint x, FXint y, FXint w, FXint h) const;
-    void drawBigIcon (const FXIconList * list, FXDC & dc, FXint x, FXint y, FXint w, FXint h) const;
-    FXint hitItem (const FXIconList * list, FXint rx, FXint ry, FXint rw, FXint rh) const;
-    FXint getHeight (const FXIconList * list) const;
-    
-/*
-  // Overrides the base class version of draw()
- 
-  virtual void drawMiniIcon(const FXIconList* list,FXDC& dc,FXint x,FXint y,FXint w,FXint h) const;
-  virtual void drawBigIcon(const FXIconList* list,FXDC& dc,FXint x,FXint y,FXint w,FXint h) const;
-  virtual FXint hitItem(const FXIconList* list,FXint rx,FXint ry,FXint rw=1,FXint rh=1) const;
-*/ 
-  public:
-	// Constructor
-    os_ListItem (FXIconList * list, osfile osf, FXColor col, FXColor backcol, FXIcon * ic1 = NULL, FXIcon * ic2 = NULL);
-    os_ListItem ()
-    {
-    } 
-    osfile osf;
-    FXColor color;
-    FXColor backcolor;
-    FXIconList * list;
-    
-    
-};
-
-#endif 

Deleted: trunk/src/pathtype.cpp
===================================================================
--- trunk/src/pathtype.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/pathtype.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,9 +0,0 @@
-#include <string>
-using namespace std;
-#include "pathtype.h"
-
-pathtype::pathtype (string dir, string type, string server, string user, string password, string port):
-dir (dir), type (type), server (server), user (user), password (password), port (port)
-{
-
-}

Deleted: trunk/src/pathtype.h
===================================================================
--- trunk/src/pathtype.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/pathtype.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,22 +0,0 @@
-#ifndef PATHTYPE
-#define PATHTYPE
-
-#include <string>
-using namespace std;
-
-//containg informations for remote filelist
-class pathtype
-{
-  public:
-    pathtype (string dir, string type = "local", string server = "", string user = "", string password = "", string port = "");
-
-    string dir;
-
-    string type;
-    string server;
-    string user;
-    string password;
-    string port;
-};
-
-#endif


Property changes on: trunk/src/plugins
___________________________________________________________________
Name: svn:ignore
   - Makefile

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile



Property changes on: trunk/src/plugins/Makefile.am
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/plugins/Makefile.in
===================================================================
--- trunk/src/plugins/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -33,7 +33,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 subdir = src/plugins
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
@@ -41,7 +40,7 @@
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
 SOURCES =
@@ -124,8 +123,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -205,13 +202,7 @@
 #     (which will cause the Makefiles to be regenerated when you run `make');
 # (2) otherwise, pass the desired values on the `make' command line.
 $(RECURSIVE_TARGETS):
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	target=`echo $@ | sed s/-recursive//`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -223,7 +214,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done; \
 	if test "$$dot_seen" = "no"; then \
 	  $(MAKE) $(AM_MAKEFLAGS) "$$target-am" || exit 1; \
@@ -231,13 +222,7 @@
 
 mostlyclean-recursive clean-recursive distclean-recursive \
 maintainer-clean-recursive:
-	@failcom='exit 1'; \
-	for f in x $$MAKEFLAGS; do \
-	  case $$f in \
-	    *=* | --[!k]*);; \
-	    *k*) failcom='fail=yes';; \
-	  esac; \
-	done; \
+	@set fnord $$MAKEFLAGS; amf=$$2; \
 	dot_seen=no; \
 	case "$@" in \
 	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
@@ -258,7 +243,7 @@
 	    local_target="$$target"; \
 	  fi; \
 	  (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) $$local_target) \
-	  || eval $$failcom; \
+	   || case "$$amf" in *=*) exit 1;; *k*) fail=yes;; *) exit 1;; esac; \
 	done && test -z "$$fail"
 tags-recursive:
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -357,17 +342,15 @@
 	    || exit 1; \
 	  fi; \
 	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
+	list='$(SUBDIRS)'; for subdir in $$list; do \
 	  if test "$$subdir" = .; then :; else \
 	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
+	    || mkdir "$(distdir)/$$subdir" \
 	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
 	    (cd $$subdir && \
 	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
+	        top_distdir="../$(top_distdir)" \
+	        distdir="../$(distdir)/$$subdir" \
 	        distdir) \
 	      || exit 1; \
 	  fi; \
@@ -396,7 +379,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"


Property changes on: trunk/src/plugins/Makefile.in
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/src/plugins/cmddialog
___________________________________________________________________
Name: svn:ignore
   - .deps
.libs
Makefile

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Modified: trunk/src/plugins/cmddialog/Makefile.am
===================================================================
--- trunk/src/plugins/cmddialog/Makefile.am	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/Makefile.am	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,27 +1,27 @@
-pkglib_LTLIBRARIES= libaccess.la libmkdir.la librename.la libclone.la libsymlink.la libeditsymlink.la libcompress.la libmd5sum.la
+pkglib_LTLIBRARIES=libOSMkdir.la libOSAccess.la libOSRename.la libOSClone.la libOSSymlink.la libOSEditSymlink.la libOSCompress.la libOSMd5sum.la
 pkglibdir=$(libdir)/openspace/plugins/cmddialog
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 
-libaccess_la_SOURCES =access.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-libaccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSMkdir_la_SOURCES =OSMkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libmkdir_la_SOURCES =mkdir.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-libmkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSAccess_la_SOURCES =OSAccess.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSAccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
 
-librename_la_SOURCES =rename.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-librename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSRename_la_SOURCES =OSRename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSRename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libclone_la_SOURCES =clone.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libclone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSClone_la_SOURCES =OSClone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSClone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libsymlink_la_SOURCES =symlink.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSSymlink_la_SOURCES =OSSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libeditsymlink_la_SOURCES =editsymlink.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libeditsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSEditSymlink_la_SOURCES =OSEditSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSEditSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libcompress_la_SOURCES =compress.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libcompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSCompress_la_SOURCES =OSCompress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSCompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 
-libmd5sum_la_SOURCES =md5sum.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libmd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSMd5sum_la_SOURCES =OSMd5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 

Modified: trunk/src/plugins/cmddialog/Makefile.in
===================================================================
--- trunk/src/plugins/cmddialog/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -14,7 +14,7 @@
 
 @SET_MAKE@
 
-SOURCES = $(libaccess_la_SOURCES) $(libclone_la_SOURCES) $(libcompress_la_SOURCES) $(libeditsymlink_la_SOURCES) $(libmd5sum_la_SOURCES) $(libmkdir_la_SOURCES) $(librename_la_SOURCES) $(libsymlink_la_SOURCES)
+SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) $(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) $(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) $(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -35,7 +35,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 subdir = src/plugins/cmddialog
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
@@ -43,70 +42,78 @@
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
-am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
-am__vpath_adj = case $$p in \
-    $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
-    *) f=$$p;; \
-  esac;
-am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
 am__installdirs = "$(DESTDIR)$(pkglibdir)"
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
-libaccess_la_LIBADD =
-am_libaccess_la_OBJECTS = access.lo thread_elem.lo cmddialog.lo
-libaccess_la_OBJECTS = $(am_libaccess_la_OBJECTS)
-libclone_la_LIBADD =
-am_libclone_la_OBJECTS = clone.lo thread_elem.lo cmddialog.lo
-libclone_la_OBJECTS = $(am_libclone_la_OBJECTS)
-libcompress_la_LIBADD =
-am_libcompress_la_OBJECTS = compress.lo thread_elem.lo cmddialog.lo
-libcompress_la_OBJECTS = $(am_libcompress_la_OBJECTS)
-libeditsymlink_la_LIBADD =
-am_libeditsymlink_la_OBJECTS = editsymlink.lo thread_elem.lo \
-	cmddialog.lo
-libeditsymlink_la_OBJECTS = $(am_libeditsymlink_la_OBJECTS)
-libmd5sum_la_LIBADD =
-am_libmd5sum_la_OBJECTS = md5sum.lo thread_elem.lo cmddialog.lo
-libmd5sum_la_OBJECTS = $(am_libmd5sum_la_OBJECTS)
-libmkdir_la_LIBADD =
-am_libmkdir_la_OBJECTS = mkdir.lo thread_elem.lo cmddialog.lo
-libmkdir_la_OBJECTS = $(am_libmkdir_la_OBJECTS)
-librename_la_LIBADD =
-am_librename_la_OBJECTS = rename.lo thread_elem.lo cmddialog.lo
-librename_la_OBJECTS = $(am_librename_la_OBJECTS)
-libsymlink_la_LIBADD =
-am_libsymlink_la_OBJECTS = symlink.lo thread_elem.lo cmddialog.lo
-libsymlink_la_OBJECTS = $(am_libsymlink_la_OBJECTS)
+libOSAccess_la_LIBADD =
+am_libOSAccess_la_OBJECTS = OSAccess.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSAccess_la_OBJECTS = $(am_libOSAccess_la_OBJECTS)
+libOSClone_la_LIBADD =
+am_libOSClone_la_OBJECTS = OSClone.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSClone_la_OBJECTS = $(am_libOSClone_la_OBJECTS)
+libOSCompress_la_LIBADD =
+am_libOSCompress_la_OBJECTS = OSCompress.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSCompress_la_OBJECTS = $(am_libOSCompress_la_OBJECTS)
+libOSEditSymlink_la_LIBADD =
+am_libOSEditSymlink_la_OBJECTS = OSEditSymlink.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSEditSymlink_la_OBJECTS = $(am_libOSEditSymlink_la_OBJECTS)
+libOSMd5sum_la_LIBADD =
+am_libOSMd5sum_la_OBJECTS = OSMd5sum.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSMd5sum_la_OBJECTS = $(am_libOSMd5sum_la_OBJECTS)
+libOSMkdir_la_LIBADD =
+am_libOSMkdir_la_OBJECTS = OSMkdir.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSMkdir_la_OBJECTS = $(am_libOSMkdir_la_OBJECTS)
+libOSRename_la_LIBADD =
+am_libOSRename_la_OBJECTS = OSRename.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSRename_la_OBJECTS = $(am_libOSRename_la_OBJECTS)
+libOSSymlink_la_LIBADD =
+am_libOSSymlink_la_OBJECTS = OSSymlink.lo OSThreadExec.lo \
+	OSCMDDialogBox.lo
+libOSSymlink_la_OBJECTS = $(am_libOSSymlink_la_OBJECTS)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
+ at AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/OSAccess.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSCMDDialogBox.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSClone.Plo ./$(DEPDIR)/OSCompress.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSEditSymlink.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSMd5sum.Plo ./$(DEPDIR)/OSMkdir.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSRename.Plo ./$(DEPDIR)/OSSymlink.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CXXFLAGS) $(CXXFLAGS)
 CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
+LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
-LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
+LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libaccess_la_SOURCES) $(libclone_la_SOURCES) \
-	$(libcompress_la_SOURCES) $(libeditsymlink_la_SOURCES) \
-	$(libmd5sum_la_SOURCES) $(libmkdir_la_SOURCES) \
-	$(librename_la_SOURCES) $(libsymlink_la_SOURCES)
-DIST_SOURCES = $(libaccess_la_SOURCES) $(libclone_la_SOURCES) \
-	$(libcompress_la_SOURCES) $(libeditsymlink_la_SOURCES) \
-	$(libmd5sum_la_SOURCES) $(libmkdir_la_SOURCES) \
-	$(librename_la_SOURCES) $(libsymlink_la_SOURCES)
+SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) \
+	$(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) \
+	$(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) \
+	$(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
+DIST_SOURCES = $(libOSAccess_la_SOURCES) $(libOSClone_la_SOURCES) \
+	$(libOSCompress_la_SOURCES) $(libOSEditSymlink_la_SOURCES) \
+	$(libOSMd5sum_la_SOURCES) $(libOSMkdir_la_SOURCES) \
+	$(libOSRename_la_SOURCES) $(libOSSymlink_la_SOURCES)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -179,8 +186,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -209,24 +214,24 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-pkglib_LTLIBRARIES = libaccess.la libmkdir.la librename.la libclone.la libsymlink.la libeditsymlink.la libcompress.la libmd5sum.la
+pkglib_LTLIBRARIES = libOSMkdir.la libOSAccess.la libOSRename.la libOSClone.la libOSSymlink.la libOSEditSymlink.la libOSCompress.la libOSMd5sum.la
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
-libaccess_la_SOURCES = access.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-libaccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-libmkdir_la_SOURCES = mkdir.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-libmkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-librename_la_SOURCES = rename.cpp  ../../thread_elem.cpp ../../thread_elem.h ../../cmddialog.cpp ../../cmddialog.h
-librename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-libclone_la_SOURCES = clone.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libclone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-libsymlink_la_SOURCES = symlink.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-libeditsymlink_la_SOURCES = editsymlink.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libeditsymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-libcompress_la_SOURCES = compress.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libcompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
-libmd5sum_la_SOURCES = md5sum.cpp  ../../thread_elem.cpp ../../thread_elem.h  ../../cmddialog.cpp ../../cmddialog.h
-libmd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSMkdir_la_SOURCES = OSMkdir.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMkdir_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSAccess_la_SOURCES = OSAccess.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSAccess_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSRename_la_SOURCES = OSRename.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSRename_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSClone_la_SOURCES = OSClone.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSClone_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSSymlink_la_SOURCES = OSSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSEditSymlink_la_SOURCES = OSEditSymlink.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSEditSymlink_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSCompress_la_SOURCES = OSCompress.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSCompress_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
+libOSMd5sum_la_SOURCES = OSMd5sum.cpp  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSCMDDialogBox.cpp ../../OSCMDDialogBox.h
+libOSMd5sum_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs` 
 all: all-am
 
 .SUFFIXES:
@@ -265,7 +270,7 @@
 	test -z "$(pkglibdir)" || $(mkdir_p) "$(DESTDIR)$(pkglibdir)"
 	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
-	    f=$(am__strip_dir) \
+	    f="`echo $$p | sed -e 's|^.*/||'`"; \
 	    echo " $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(pkglibdir)/$$f'"; \
 	    $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(pkglibdir)/$$f"; \
 	  else :; fi; \
@@ -273,8 +278,8 @@
 
 uninstall-pkglibLTLIBRARIES:
 	@$(NORMAL_UNINSTALL)
-	@set -x; list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
-	  p=$(am__strip_dir) \
+	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
+	    p="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(pkglibdir)/$$p'"; \
 	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(pkglibdir)/$$p"; \
 	done
@@ -287,22 +292,22 @@
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
-libaccess.la: $(libaccess_la_OBJECTS) $(libaccess_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libaccess_la_LDFLAGS) $(libaccess_la_OBJECTS) $(libaccess_la_LIBADD) $(LIBS)
-libclone.la: $(libclone_la_OBJECTS) $(libclone_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libclone_la_LDFLAGS) $(libclone_la_OBJECTS) $(libclone_la_LIBADD) $(LIBS)
-libcompress.la: $(libcompress_la_OBJECTS) $(libcompress_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libcompress_la_LDFLAGS) $(libcompress_la_OBJECTS) $(libcompress_la_LIBADD) $(LIBS)
-libeditsymlink.la: $(libeditsymlink_la_OBJECTS) $(libeditsymlink_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libeditsymlink_la_LDFLAGS) $(libeditsymlink_la_OBJECTS) $(libeditsymlink_la_LIBADD) $(LIBS)
-libmd5sum.la: $(libmd5sum_la_OBJECTS) $(libmd5sum_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libmd5sum_la_LDFLAGS) $(libmd5sum_la_OBJECTS) $(libmd5sum_la_LIBADD) $(LIBS)
-libmkdir.la: $(libmkdir_la_OBJECTS) $(libmkdir_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libmkdir_la_LDFLAGS) $(libmkdir_la_OBJECTS) $(libmkdir_la_LIBADD) $(LIBS)
-librename.la: $(librename_la_OBJECTS) $(librename_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(librename_la_LDFLAGS) $(librename_la_OBJECTS) $(librename_la_LIBADD) $(LIBS)
-libsymlink.la: $(libsymlink_la_OBJECTS) $(libsymlink_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libsymlink_la_LDFLAGS) $(libsymlink_la_OBJECTS) $(libsymlink_la_LIBADD) $(LIBS)
+libOSAccess.la: $(libOSAccess_la_OBJECTS) $(libOSAccess_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSAccess_la_LDFLAGS) $(libOSAccess_la_OBJECTS) $(libOSAccess_la_LIBADD) $(LIBS)
+libOSClone.la: $(libOSClone_la_OBJECTS) $(libOSClone_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSClone_la_LDFLAGS) $(libOSClone_la_OBJECTS) $(libOSClone_la_LIBADD) $(LIBS)
+libOSCompress.la: $(libOSCompress_la_OBJECTS) $(libOSCompress_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSCompress_la_LDFLAGS) $(libOSCompress_la_OBJECTS) $(libOSCompress_la_LIBADD) $(LIBS)
+libOSEditSymlink.la: $(libOSEditSymlink_la_OBJECTS) $(libOSEditSymlink_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSEditSymlink_la_LDFLAGS) $(libOSEditSymlink_la_OBJECTS) $(libOSEditSymlink_la_LIBADD) $(LIBS)
+libOSMd5sum.la: $(libOSMd5sum_la_OBJECTS) $(libOSMd5sum_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSMd5sum_la_LDFLAGS) $(libOSMd5sum_la_OBJECTS) $(libOSMd5sum_la_LIBADD) $(LIBS)
+libOSMkdir.la: $(libOSMkdir_la_OBJECTS) $(libOSMkdir_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSMkdir_la_LDFLAGS) $(libOSMkdir_la_OBJECTS) $(libOSMkdir_la_LIBADD) $(LIBS)
+libOSRename.la: $(libOSRename_la_OBJECTS) $(libOSRename_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSRename_la_LDFLAGS) $(libOSRename_la_OBJECTS) $(libOSRename_la_LIBADD) $(LIBS)
+libOSSymlink.la: $(libOSSymlink_la_OBJECTS) $(libOSSymlink_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSSymlink_la_LDFLAGS) $(libOSSymlink_la_OBJECTS) $(libOSSymlink_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
@@ -310,52 +315,89 @@
 distclean-compile:
 	-rm -f *.tab.c
 
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/access.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/clone.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/cmddialog.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/compress.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/editsymlink.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/md5sum.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/mkdir.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/rename.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/symlink.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/thread_elem.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSAccess.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCMDDialogBox.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSClone.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSCompress.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSEditSymlink.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMd5sum.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMkdir.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSRename.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSSymlink.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Plo at am__quote@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ $<
 
 .cpp.obj:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
 
 .cpp.lo:
 @am__fastdepCXX_TRUE@	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LTCXXCOMPILE) -c -o $@ $<
 
-thread_elem.lo: ../../thread_elem.cpp
- at am__fastdepCXX_TRUE@	if $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT thread_elem.lo -MD -MP -MF "$(DEPDIR)/thread_elem.Tpo" -c -o thread_elem.lo `test -f '../../thread_elem.cpp' || echo '$(srcdir)/'`../../thread_elem.cpp; \
- at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/thread_elem.Tpo" "$(DEPDIR)/thread_elem.Plo"; else rm -f "$(DEPDIR)/thread_elem.Tpo"; exit 1; fi
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../thread_elem.cpp' object='thread_elem.lo' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
- at am__fastdepCXX_FALSE@	$(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o thread_elem.lo `test -f '../../thread_elem.cpp' || echo '$(srcdir)/'`../../thread_elem.cpp
+OSThreadExec.o: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.o -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
 
-cmddialog.lo: ../../cmddialog.cpp
- at am__fastdepCXX_TRUE@	if $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT cmddialog.lo -MD -MP -MF "$(DEPDIR)/cmddialog.Tpo" -c -o cmddialog.lo `test -f '../../cmddialog.cpp' || echo '$(srcdir)/'`../../cmddialog.cpp; \
- at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/cmddialog.Tpo" "$(DEPDIR)/cmddialog.Plo"; else rm -f "$(DEPDIR)/cmddialog.Tpo"; exit 1; fi
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../cmddialog.cpp' object='cmddialog.lo' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
- at am__fastdepCXX_FALSE@	$(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o cmddialog.lo `test -f '../../cmddialog.cpp' || echo '$(srcdir)/'`../../cmddialog.cpp
+OSThreadExec.obj: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.obj -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`
 
+OSThreadExec.lo: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.lo -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Plo"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Plo' tmpdepfile='$(DEPDIR)/OSThreadExec.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
+
+OSCMDDialogBox.o: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.o -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.o `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Po"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Po' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.o `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp
+
+OSCMDDialogBox.obj: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.obj -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.obj `if test -f '../../OSCMDDialogBox.cpp'; then $(CYGPATH_W) '../../OSCMDDialogBox.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSCMDDialogBox.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Po"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Po' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.obj `if test -f '../../OSCMDDialogBox.cpp'; then $(CYGPATH_W) '../../OSCMDDialogBox.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSCMDDialogBox.cpp'; fi`
+
+OSCMDDialogBox.lo: ../../OSCMDDialogBox.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSCMDDialogBox.lo -MD -MP -MF "$(DEPDIR)/OSCMDDialogBox.Tpo" -c -o OSCMDDialogBox.lo `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSCMDDialogBox.Tpo" "$(DEPDIR)/OSCMDDialogBox.Plo"; else rm -f "$(DEPDIR)/OSCMDDialogBox.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSCMDDialogBox.cpp' object='OSCMDDialogBox.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSCMDDialogBox.Plo' tmpdepfile='$(DEPDIR)/OSCMDDialogBox.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSCMDDialogBox.lo `test -f '../../OSCMDDialogBox.cpp' || echo '$(srcdir)/'`../../OSCMDDialogBox.cpp
+
 mostlyclean-libtool:
 	-rm -f *.lo
 
@@ -467,7 +509,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"

Copied: trunk/src/plugins/cmddialog/OSAccess.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSAccess.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSAccess.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSClone.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSClone.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSClone.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSCompress.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSCompress.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSCompress.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSEditSymlink.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSEditSymlink.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSEditSymlink.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSMd5sum.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMd5sum.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSMd5sum.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSMkdir.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSMkdir.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSMkdir.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSRename.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSRename.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSRename.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/cmddialog/OSSymlink.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/cmddialog/OSSymlink.cpp)


Property changes on: trunk/src/plugins/cmddialog/OSSymlink.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/plugins/cmddialog/access.cpp
===================================================================
--- trunk/src/plugins/cmddialog/access.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/access.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,228 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-#include <sys/types.h>
-#include <grp.h>
-#include <pwd.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-
-
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-class access_cmddialog:public cmddialog
-{
-  FXDECLARE (access_cmddialog) protected:
-
-    access_cmddialog (const access_cmddialog &)
-    {
-    }
-
-  private:
-  
-    FXCheckButton *ur;
-    FXCheckButton *uw;
-    FXCheckButton *ux;
-    FXCheckButton *gr;
-    FXCheckButton *gw;
-    FXCheckButton *gx;
-    FXCheckButton *or_;
-    FXCheckButton *ow;
-    FXCheckButton *ox;
-    FXDataTarget radiotarget;
-    FXRadioButton *set;
-    FXRadioButton *clear;
-    FXRadioButton *add;
-    FXint cmd;
-    FXCheckButton *rec;
-    FXCheckButton *dironly;
-    FXComboBox *user;
-    FXComboBox *userbis;
-    FXComboBox *grp;
-    FXTextField *text;
-
-
-
-  public:
-  
-    enum
-    {
-	ID_PRESS = cmddialog::ID_LAST,
-	ID_RUSR,
-	ID_WUSR,
-	ID_XUSR,
-	ID_RGRP,
-	ID_WGRP,
-	ID_XGRP,
-	ID_ROTH,
-	ID_WOTH,
-	ID_XOTH,
-	ID_LAST
-    };
-
-
-
-    
-    access_cmddialog ()
-    {
-    }
-    access_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-    virtual int access_cmddialog::exec (void)
-    {
-
-	unsigned int mode = 0;
-	if (ur->getCheck ())
-	    mode = mode | S_IRUSR;
-	if (uw->getCheck ())
-	    mode = mode | S_IWUSR;
-	if (ux->getCheck ())
-	    mode = mode | S_IXUSR;
-	if (gr->getCheck ())
-	    mode = mode | S_IRGRP;
-	if (gw->getCheck ())
-	    mode = mode | S_IWGRP;
-	if (gx->getCheck ())
-	    mode = mode | S_IXGRP;
-	if (or_->getCheck ())
-	    mode = mode | S_IROTH;
-	if (ow->getCheck ())
-	    mode = mode | S_IWOTH;
-	if (ox->getCheck ())
-	    mode = mode | S_IXOTH;
-
-	bool recursive = false;
-	if (rec->getCheck ())
-	    recursive = true;
-	
-	vector < string >::iterator iter;
-
-    	for (iter = src.begin (); iter != src.end(); iter++)
-   	{
-	
-	    fb->mode (*iter, mode, recursive);
-	   
-	    fb->owner (*iter, user->getText ().text (), recursive);
-	    fb->group (*iter, grp->getText ().text (), recursive);
-	
-	}
-
-    }
-
-
-    long access_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (access_cmddialog) access_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, access_cmddialog::ID_PRESS, access_cmddialog::press),};
-FXIMPLEMENT (access_cmddialog, cmddialog, access_cmddialogMap, ARRAYNUMBER (access_cmddialogMap)) 
-
-access_cmddialog::access_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-   vector < string >::iterator iter;
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-	new FXLabel (contents, iter->c_str ());
-    }
-
-    FXHorizontalFrame *accessframe = new FXHorizontalFrame (contents, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXHorizontalFrame *chmodframe = new FXHorizontalFrame (contents, PACK_UNIFORM_WIDTH | PACK_UNIFORM_HEIGHT | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXGroupBox *group1 = new FXGroupBox (accessframe, "User", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    ur = new FXCheckButton (group1, "Read", this, ID_RUSR);
-    uw = new FXCheckButton (group1, "Write", this, ID_WUSR);
-    ux = new FXCheckButton (group1, "Execute", this, ID_XUSR);
-    FXGroupBox *group2 = new FXGroupBox (accessframe, "Group", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    gr = new FXCheckButton (group2, "Read", this, ID_RGRP);
-    gw = new FXCheckButton (group2, "Write", this, ID_WGRP);
-    gx = new FXCheckButton (group2, "Execute", this, ID_XGRP);
-    FXGroupBox *group3 = new FXGroupBox (accessframe, "Others", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X);
-    or_ = new FXCheckButton (group3, "Read", this, ID_ROTH);
-    ow = new FXCheckButton (group3, "Write", this, ID_WOTH);
-    ox = new FXCheckButton (group3, "Execute", this, ID_XOTH);
-
-    FXGroupBox *group4 = new FXGroupBox (chmodframe, "Options", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-
-    rec = new FXCheckButton (group4, "Recursive folders", NULL, 0);
-
-
-    FXGroupBox *group5 = new FXGroupBox (chmodframe, "Owner", GROUPBOX_TITLE_LEFT | FRAME_GROOVE | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    new FXLabel (group5, "User");
-    user = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    user->setNumVisible (5);
-    new FXLabel (group5, "Group");
-    grp = new FXComboBox (group5, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    grp->setNumVisible (5);
-
-
-    if (fb->mode (src[0]) & S_IRUSR)
-	ur->setCheck ();
-    if (fb->mode (src[0]) & S_IWUSR)
-	uw->setCheck ();
-    if (fb->mode (src[0]) & S_IXUSR)
-	ux->setCheck ();
-    if (fb->mode (src[0]) & S_IRGRP)
-	gr->setCheck ();
-    if (fb->mode (src[0]) & S_IWGRP)
-	gw->setCheck ();
-    if (fb->mode (src[0]) & S_IXGRP)
-	gx->setCheck ();
-
-
-    if (fb->mode (src[0]) & S_IROTH)
-	or_->setCheck ();
-    if (fb->mode (src[0]) & S_IWOTH)
-	ow->setCheck ();
-    if (fb->mode (src[0]) & S_IXOTH)
-	ox->setCheck ();
-
-
-
-    // User names (sorted in ascending order)
-    struct passwd *pwde;
-    while ((pwde = getpwent ()))
-    {
-	user->appendItem (pwde->pw_name);
-
-    }
-    endpwent ();
-    user->setSortFunc (FXList::ascending);
-    user->sortItems ();
-    string own = fb->owner (src[0]);
-    user->setCurrentItem (user->findItem (own.c_str ()));
-
-    // Group names (sorted in ascending order)
-    struct group *grpe;
-    while ((grpe = getgrent ()))
-    {
-	grp->appendItem (grpe->gr_name);
-    }
-    endgrent ();
-    grp->setSortFunc (FXList::ascending);
-    grp->sortItems ();
-    string grou = fb->group (src[0]);
-    grp->setCurrentItem (grp->findItem (grou.c_str ()));
-
-}
-
-long access_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new access_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/clone.cpp
===================================================================
--- trunk/src/plugins/cmddialog/clone.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/clone.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,147 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class clone_cmddialog:public cmddialog
-{
-  FXDECLARE (clone_cmddialog) protected:
-
-    clone_cmddialog (const clone_cmddialog &)
-    {
-    }
-
-  private:
-    vector < FXTextField * >vec;
-    string dir;
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-
-    clone_cmddialog ()
-    {
-    }
-    clone_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int clone_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	    string newname = dir + SEPARATOR + vec[i]->getText ().text ();
-	    string newonlyname= vec[i]->getText ().text ();
-	    
-	    string destdir="/tmp/openspace";
-	    string filename=FXFile::name(iter->c_str()).text();
-	    string dirname=FXFile::directory(iter->c_str()).text();
-	    
-	    thread_elem *el2 = new thread_elem (fb, "copy", "upload", *iter,destdir);
-	    fb->copy (el2);
-	    delete el2;
-	    
-	    	    
-	    
-	    if (fb->rename (destdir+"/"+filename,destdir+"/"+newonlyname) == false)
-	    {
-		error = -1;
-		string err = "can't clone " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	    else
-	    {
-	    
-	    el2 = new thread_elem (fb, "move", "upload", destdir+"/"+newonlyname,dirname);
-	    fb->copy (el2);
-	    delete el2;
-	    
-	    }
-	    
-	    
-	i++;
-	}
-
-
-	return error;
-
-    }
-
-
-    long clone_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (clone_cmddialog) clone_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, clone_cmddialog::ID_ENTER, clone_cmddialog::press),};
-FXIMPLEMENT (clone_cmddialog, cmddialog, clone_cmddialogMap, ARRAYNUMBER (clone_cmddialogMap)) 
-
-clone_cmddialog::clone_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-
-	dir = FXFile::directory (iter->c_str ()).text ();
-
-	FXString name = FXFile::name (iter->c_str ());
-	new FXLabel (contents, name);
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (name);
-	vec.push_back (text);
-
-    }
-
-
-
-}
-
-long clone_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new clone_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/compress.cpp
===================================================================
--- trunk/src/plugins/cmddialog/compress.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/compress.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,119 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class compress_cmddialog:public cmddialog
-{
-  FXDECLARE (compress_cmddialog) protected:
-
-    compress_cmddialog (const compress_cmddialog &)
-    {
-    }
-
-  private:
-   
-    string dir;
-    FXTextField *textfield;
-    FXComboBox* combo;
-
-  public:
-
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-
-       compress_cmddialog ()
-    {
-    }
-    compress_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int compress_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	string file_list;
-	string arch_filename=textfield->getText().text();
-	string type=combo->getText().text();
-	
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-		string sr = (*iter);
-		sr=FXFile::name(sr.c_str()).text();
-		file_list+=" \"" +  sr + "\"";
-	}
-
-	string command;
-	if(type=="tar.bz2")
-	command="tar cjf " + arch_filename +".tar.bz2 "+ file_list;
-	else
-	command="tar czf " + arch_filename +".tar.gz "+ file_list;
-	
-	system(command.c_str());
-
-
-    }
-
-
-    long compress_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (compress_cmddialog) compress_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, compress_cmddialog::ID_ENTER, compress_cmddialog::press),};
-FXIMPLEMENT (compress_cmddialog, cmddialog, compress_cmddialogMap, ARRAYNUMBER (compress_cmddialogMap)) 
-
-compress_cmddialog::compress_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-  new FXLabel(contents,"archive type: ");
-
-    combo = new FXComboBox (contents, 10, NULL, 0, COMBOBOX_NO_REPLACE | FRAME_SUNKEN | FRAME_THICK);
-    combo->setNumVisible (3);
-    combo->appendItem("tar.bz2");
-    combo->appendItem("tar.gz");
-
-	new FXLabel(contents,"archive filename: ");
-	textfield = new FXTextField (contents, 25, this, ID_ENTER);
-	textfield->setFocus ();
-
-
-}
-
-long compress_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new compress_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/editsymlink.cpp
===================================================================
--- trunk/src/plugins/cmddialog/editsymlink.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/editsymlink.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,140 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class editsymlink_cmddialog:public cmddialog
-{
-  FXDECLARE (editsymlink_cmddialog) protected:
-
-    editsymlink_cmddialog (const editsymlink_cmddialog &)
-    {
-    }
-    
-  private:
-   
-    vector < FXTextField * >vec;
-    string dir;
-    FXCheckButton *hardlink;  
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    editsymlink_cmddialog ()
-    {
-    }
-    editsymlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int editsymlink_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	
-	string newname = vec[i]->getText ().text ();
-	delete vec[i];
-	i++;
-	if(newname=="")
-	continue;
-
-	    
-  
-	int error = 0;
-	    vector<string> srcfile;
-	    srcfile.push_back(*iter);
-	    thread_elem *el = new thread_elem (fb, "remove", "",srcfile);
-	    fb->remove(el);
-	
-           bool ret=fb->symlink ( newname,*iter);	
-	
-	    if ( ret== false)
-	    {
-		error = -1;
-		string err = "can't symlink " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	
-	}
-
-
-	return error;
-
-    }
-
-
-
-    long editsymlink_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (editsymlink_cmddialog) editsymlink_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, editsymlink_cmddialog::ID_ENTER, editsymlink_cmddialog::press),};
-FXIMPLEMENT (editsymlink_cmddialog, cmddialog, editsymlink_cmddialogMap, ARRAYNUMBER (editsymlink_cmddialogMap)) 
-
-editsymlink_cmddialog::editsymlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-	string sym=fb->symlink(*iter);
-	if(sym=="")
-	continue;
-
-	new FXLabel(contents,"source: ");
-	new FXLabel (contents, iter->c_str ());
-	new FXLabel(contents,"link: ");
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (sym.c_str());
-	vec.push_back (text);
-
-    }
-
-
-}
-
-long editsymlink_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new editsymlink_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/md5sum.cpp
===================================================================
--- trunk/src/plugins/cmddialog/md5sum.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/md5sum.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,112 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-#include <fstream>
-#include <sstream>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class md5sum_cmddialog:public cmddialog
-{
-  FXDECLARE (md5sum_cmddialog) protected:
-
-    md5sum_cmddialog (const md5sum_cmddialog &)
-    {
-    }
-    
-  private:
-
- 
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    md5sum_cmddialog ()
-    {
-    }
-    md5sum_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int md5sum_cmddialog::exec (void)
-    {
-	
-    }
-
-
-    long md5sum_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (md5sum_cmddialog) md5sum_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, md5sum_cmddialog::ID_ENTER, md5sum_cmddialog::press),};
-FXIMPLEMENT (md5sum_cmddialog, cmddialog, md5sum_cmddialogMap, ARRAYNUMBER (md5sum_cmddialogMap)) 
-
-md5sum_cmddialog::md5sum_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-FILE *pipe;
-char readbuf[1024];
-
-    vector < string >::iterator iter;
-FXPacker *vv = new FXGroupBox (contents, "info", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
-new FXLabel(vv,"MD5SUM additional plugin - Mateusz Dworak - GPL ");
-new FXSeparator(contents);
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-	string cmd="md5sum "+*iter;
-	pipe = popen (cmd.c_str(), "r");
-
-    	if (pipe != NULL)
-   	{
-		string line;
-		while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-		{
-		std::stringstream parser (readbuf);
-		string md5;	
-		parser >> md5;
-		
-		new FXLabel(contents,iter->c_str());
-		FXTextField*textfield = new FXTextField (contents, 31);
-		textfield->setText(md5.c_str());
-		}
-	}
-
-    }
-
-
-
-}
-
-long md5sum_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
- 
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new md5sum_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/mkdir.cpp
===================================================================
--- trunk/src/plugins/cmddialog/mkdir.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/mkdir.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,75 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-class special_cmddialog:public cmddialog
-{
-  FXDECLARE (special_cmddialog) protected:
-
-    special_cmddialog (const special_cmddialog &)
-    {
-    }
-  private:
-  FXTextField *text;
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    special_cmddialog ()
-    {
-    }
-    special_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-    virtual int special_cmddialog::exec (void)
-    {
-	string s = text->getText ().text ();
-	fb->mkdir (s, 493);
-    }
-
-
-    long special_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (special_cmddialog) special_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, special_cmddialog::ID_ENTER, special_cmddialog::press),};
-FXIMPLEMENT (special_cmddialog, cmddialog, special_cmddialogMap, ARRAYNUMBER (special_cmddialogMap)) 
-
-special_cmddialog::special_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    text = new FXTextField (contents, 25, this, ID_ENTER);
-    text->setFocus ();
-
-}
-
-long special_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new special_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/rename.cpp
===================================================================
--- trunk/src/plugins/cmddialog/rename.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/rename.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,124 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class rename_cmddialog:public cmddialog
-{
-  FXDECLARE (rename_cmddialog) protected:
-
-    rename_cmddialog (const rename_cmddialog &)
-    {
-    }
-    
-  private:
-
-    vector < FXTextField * >vec;
-    string dir;  
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    rename_cmddialog ()
-    {
-    }
-    rename_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int rename_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	    string newname = dir + SEPARATOR + vec[i]->getText ().text ();
-	    if (fb->rename (*iter, newname) == false)
-	    {
-		error = -1;
-		string err = "can't rename " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	i++;
-	}
-
-
-	return error;
-
-    }
-
-
-    long rename_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (rename_cmddialog) rename_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, rename_cmddialog::ID_ENTER, rename_cmddialog::press),};
-FXIMPLEMENT (rename_cmddialog, cmddialog, rename_cmddialogMap, ARRAYNUMBER (rename_cmddialogMap)) 
-
-rename_cmddialog::rename_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-
-	dir = FXFile::directory (iter->c_str ()).text ();
-	//fxmessage(dir.c_str());
-	//fxmessage("\n woho");
-	FXString name = FXFile::name (iter->c_str ());
-	new FXLabel (contents, name);
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (name);
-	vec.push_back (text);
-
-    }
-
-
-
-}
-
-long rename_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new rename_cmddialog (w, fb, src);
-}

Deleted: trunk/src/plugins/cmddialog/symlink.cpp
===================================================================
--- trunk/src/plugins/cmddialog/symlink.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/cmddialog/symlink.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,129 +0,0 @@
-#include <fx.h>
-#include "../../cmddialog.h"
-
-#include <string>
-using namespace std;
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-class symlink_cmddialog:public cmddialog
-{
-  FXDECLARE (symlink_cmddialog) protected:
-
-    symlink_cmddialog (const symlink_cmddialog &)
-    {
-    }
-
-  private:
-  
-    vector < FXTextField * >vec;
-    string dir;
-    FXCheckButton *hardlink;
-
-  public:
-
-    enum
-    {
-	ID_ENTER = cmddialog::ID_LAST,
-    };
-
-    symlink_cmddialog ()
-    {
-    }
-    symlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src);
-
-
-    virtual int symlink_cmddialog::exec (void)
-    {
-	int error = 0;
-	vector < string >::iterator iter;
-	int i=0;
-    	for (iter = src.begin (); iter != src.end(); iter++)
-    	{
-	    string newname =  vec[i]->getText ().text ();
-	    
-	    bool ret;
-	    if (hardlink->getCheck ())
-	    	ret=fb->hardlink (*iter, newname);
-	    else
-	        ret=fb->symlink (*iter, newname);	
-			
-	    if ( ret== false)
-	    {
-		error = -1;
-		string err = "can't symlink " + *iter + " to " + newname;
-
-		FXLabel *lab = new FXLabel (contents, err.c_str ());
-		lab->create ();
-		this->layout ();
-		this->resize (this->getWidth (), this->getHeight () + lab->getHeight ());
-
-	    }
-	i++;
-	}
-
-
-	return error;
-
-    }
-
-
-    long symlink_cmddialog::press (FXObject * sender, FXSelector, void *);
-
-};
-
-FXDEFMAP (symlink_cmddialog) symlink_cmddialogMap[] =
-{
-FXMAPFUNC (SEL_COMMAND, symlink_cmddialog::ID_ENTER, symlink_cmddialog::press),};
-FXIMPLEMENT (symlink_cmddialog, cmddialog, symlink_cmddialogMap, ARRAYNUMBER (symlink_cmddialogMap)) 
-
-symlink_cmddialog::symlink_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src):
-cmddialog (w, fb, src)
-{
-
-
-    vector < string >::iterator iter;
-
-    for (iter = src.begin (); iter != src.end(); iter++)
-    {
-  
-
-	new FXLabel(contents,"source: ");
-	new FXLabel (contents, iter->c_str ());
-	new FXLabel(contents,"link: ");
-	FXTextField *text = new FXTextField (contents, 25, this, ID_ENTER);
-	text->setFocus ();
-	text->setText (iter->c_str ());
-	vec.push_back (text);
-
-    }
-
-hardlink = new FXCheckButton (contents, "hardlink");
-
-}
-
-long symlink_cmddialog::press (FXObject * sender, FXSelector, void *)
-{
-
-    FXObject *target = (FXObject *) ok->getTarget ();
-    //target->handle (ok, FXSEL (SEL_COMMAND, ID_COMMAND), NULL);
-
-}
-
-
-EXPORTFUNCTION cmddialog *get_cmddialog (FXWindow * w, filelist_base * fb, vector < string > src)
-{
-    return new symlink_cmddialog (w, fb, src);
-}


Property changes on: trunk/src/plugins/filelist
___________________________________________________________________
Name: svn:ignore
   - .deps
.libs
Makefile

   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Modified: trunk/src/plugins/filelist/Makefile.am
===================================================================
--- trunk/src/plugins/filelist/Makefile.am	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/Makefile.am	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,14 +1,18 @@
-pkglib_LTLIBRARIES= libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES= libOSVfsLocal.la libOSVfsSearch.la libOSVfsArchive.la libOSVfsFtp.la   
 pkglibdir=$(libdir)/openspace/plugins/filelist
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
 
-libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-libfilelistlocal_la_SOURCES =filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h ../../sharedFunctions.cpp ../../sharedFunctions.h 
-libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsearch_la_SOURCES =filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistarchive_la_SOURCES =filelist_archive.cpp filelist_archive.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistftp_la_SOURCES =filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../thread_elem.cpp ../../thread_elem.h ../../configure.h 
+libOSVfsLocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSVfsLocal_la_SOURCES =OSVfsLocal.cpp OSVfsLocal.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+
+libOSVfsSearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsSearch_la_SOURCES =OSVfsSearch.cpp OSVfsSearch.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsArchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsArchive_la_SOURCES =OSVfsArchive.cpp OSVfsArchive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsFtp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsFtp_la_SOURCES =OSVfsFtp.cpp OSVfsFtp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
+
+
+#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+

Modified: trunk/src/plugins/filelist/Makefile.in
===================================================================
--- trunk/src/plugins/filelist/Makefile.in	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/Makefile.in	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.9.5 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005  Free Software Foundation, Inc.
+# 2003, 2004  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -14,7 +14,7 @@
 
 @SET_MAKE@
 
-SOURCES = $(libfilelistarchive_la_SOURCES) $(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) $(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
+SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) $(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -35,7 +35,6 @@
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-build_triplet = @build@
 host_triplet = @host@
 subdir = src/plugins/filelist
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
@@ -43,60 +42,56 @@
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
-mkinstalldirs = $(install_sh) -d
+mkinstalldirs = $(mkdir_p)
 CONFIG_HEADER = $(top_builddir)/src/config.h
 CONFIG_CLEAN_FILES =
-am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
-am__vpath_adj = case $$p in \
-    $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
-    *) f=$$p;; \
-  esac;
-am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
 am__installdirs = "$(DESTDIR)$(pkglibdir)"
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
-libfilelistarchive_la_LIBADD =
-am_libfilelistarchive_la_OBJECTS = filelist_archive.lo thread_elem.lo
-libfilelistarchive_la_OBJECTS = $(am_libfilelistarchive_la_OBJECTS)
-libfilelistftp_la_LIBADD =
-am_libfilelistftp_la_OBJECTS = filelist_ftp.lo pftp.lo thread_elem.lo
-libfilelistftp_la_OBJECTS = $(am_libfilelistftp_la_OBJECTS)
-libfilelistlocal_la_LIBADD =
-am_libfilelistlocal_la_OBJECTS = filelist_local.lo OSFXFile.lo \
-	thread_elem.lo sharedFunctions.lo
-libfilelistlocal_la_OBJECTS = $(am_libfilelistlocal_la_OBJECTS)
-libfilelistsearch_la_LIBADD =
-am_libfilelistsearch_la_OBJECTS = filelist_search.lo OSFXFile.lo \
-	thread_elem.lo
-libfilelistsearch_la_OBJECTS = $(am_libfilelistsearch_la_OBJECTS)
-libfilelistsftp_la_LIBADD =
-am_libfilelistsftp_la_OBJECTS = filelist_sftp.lo thread_elem.lo
-libfilelistsftp_la_OBJECTS = $(am_libfilelistsftp_la_OBJECTS)
+libOSVfsArchive_la_LIBADD =
+am_libOSVfsArchive_la_OBJECTS = OSVfsArchive.lo OSThreadExec.lo
+libOSVfsArchive_la_OBJECTS = $(am_libOSVfsArchive_la_OBJECTS)
+libOSVfsFtp_la_LIBADD =
+am_libOSVfsFtp_la_OBJECTS = OSVfsFtp.lo pftp.lo OSThreadExec.lo
+libOSVfsFtp_la_OBJECTS = $(am_libOSVfsFtp_la_OBJECTS)
+libOSVfsLocal_la_LIBADD =
+am_libOSVfsLocal_la_OBJECTS = OSVfsLocal.lo OSFXFile.lo \
+	OSThreadExec.lo OSUtils.lo
+libOSVfsLocal_la_OBJECTS = $(am_libOSVfsLocal_la_OBJECTS)
+libOSVfsSearch_la_LIBADD =
+am_libOSVfsSearch_la_OBJECTS = OSVfsSearch.lo OSFXFile.lo \
+	OSThreadExec.lo
+libOSVfsSearch_la_OBJECTS = $(am_libOSVfsSearch_la_OBJECTS)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/src
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
+ at AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/OSFXFile.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSThreadExec.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSUtils.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsArchive.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsFtp.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsLocal.Plo \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSVfsSearch.Plo ./$(DEPDIR)/pftp.Plo
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CXXFLAGS) $(CXXFLAGS)
 CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
+LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
 	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
 	$(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
-LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
+LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libfilelistarchive_la_SOURCES) \
-	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
-	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
-DIST_SOURCES = $(libfilelistarchive_la_SOURCES) \
-	$(libfilelistftp_la_SOURCES) $(libfilelistlocal_la_SOURCES) \
-	$(libfilelistsearch_la_SOURCES) $(libfilelistsftp_la_SOURCES)
+SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) \
+	$(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
+DIST_SOURCES = $(libOSVfsArchive_la_SOURCES) $(libOSVfsFtp_la_SOURCES) \
+	$(libOSVfsLocal_la_SOURCES) $(libOSVfsSearch_la_SOURCES)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -169,8 +164,6 @@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
 am__quote = @am__quote@
-am__tar = @am__tar@
-am__untar = @am__untar@
 bindir = @bindir@
 build = @build@
 build_alias = @build_alias@
@@ -199,18 +192,16 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-pkglib_LTLIBRARIES = libfilelistlocal.la  libfilelistsearch.la  libfilelistarchive.la libfilelistftp.la libfilelistsftp.la
+pkglib_LTLIBRARIES = libOSVfsLocal.la libOSVfsSearch.la libOSVfsArchive.la libOSVfsFtp.la   
 INCLUDES = `WANT_FOX="1.4" fox-config --cflags` `xml2-config  --cflags` 
-libfilelistlocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
-libfilelistlocal_la_SOURCES = filelist_local.cpp filelist_local.h OSFXFile.cpp OSFXFile.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h ../../sharedFunctions.cpp ../../sharedFunctions.h 
-libfilelistsearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsearch_la_SOURCES = filelist_search.cpp filelist_search.h OSFXFile.cpp OSFXFile.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistarchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistarchive_la_SOURCES = filelist_archive.cpp filelist_archive.h ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistsftp_la_SOURCES = filelist_sftp.cpp filelist_sftp.h  ../../thread_elem.cpp ../../thread_elem.h  ../../configure.h 
-libfilelistftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
-libfilelistftp_la_SOURCES = filelist_ftp.cpp filelist_ftp.h  pftp.cpp pftp.h  ../../thread_elem.cpp ../../thread_elem.h ../../configure.h 
+libOSVfsLocal_la_LDFLAGS = `WANT_FOX="1.4" fox-config --libs` `xml2-config  --libs`  
+libOSVfsLocal_la_SOURCES = OSVfsLocal.cpp OSVfsLocal.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h ../../OSUtils.cpp ../../OSUtils.h 
+libOSVfsSearch_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsSearch_la_SOURCES = OSVfsSearch.cpp OSVfsSearch.h OSFXFile.cpp OSFXFile.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsArchive_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsArchive_la_SOURCES = OSVfsArchive.cpp OSVfsArchive.h ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
+libOSVfsFtp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+libOSVfsFtp_la_SOURCES = OSVfsFtp.cpp OSVfsFtp.h  pftp.cpp pftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h ../../OSConfigure.h 
 all: all-am
 
 .SUFFIXES:
@@ -249,7 +240,7 @@
 	test -z "$(pkglibdir)" || $(mkdir_p) "$(DESTDIR)$(pkglibdir)"
 	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
-	    f=$(am__strip_dir) \
+	    f="`echo $$p | sed -e 's|^.*/||'`"; \
 	    echo " $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(pkglibdir)/$$f'"; \
 	    $(LIBTOOL) --mode=install $(pkglibLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(pkglibdir)/$$f"; \
 	  else :; fi; \
@@ -257,8 +248,8 @@
 
 uninstall-pkglibLTLIBRARIES:
 	@$(NORMAL_UNINSTALL)
-	@set -x; list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
-	  p=$(am__strip_dir) \
+	@list='$(pkglib_LTLIBRARIES)'; for p in $$list; do \
+	    p="`echo $$p | sed -e 's|^.*/||'`"; \
 	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(pkglibdir)/$$p'"; \
 	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(pkglibdir)/$$p"; \
 	done
@@ -271,16 +262,14 @@
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
-libfilelistarchive.la: $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistarchive_la_LDFLAGS) $(libfilelistarchive_la_OBJECTS) $(libfilelistarchive_la_LIBADD) $(LIBS)
-libfilelistftp.la: $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistftp_la_LDFLAGS) $(libfilelistftp_la_OBJECTS) $(libfilelistftp_la_LIBADD) $(LIBS)
-libfilelistlocal.la: $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistlocal_la_LDFLAGS) $(libfilelistlocal_la_OBJECTS) $(libfilelistlocal_la_LIBADD) $(LIBS)
-libfilelistsearch.la: $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsearch_la_LDFLAGS) $(libfilelistsearch_la_OBJECTS) $(libfilelistsearch_la_LIBADD) $(LIBS)
-libfilelistsftp.la: $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_DEPENDENCIES) 
-	$(CXXLINK) -rpath $(pkglibdir) $(libfilelistsftp_la_LDFLAGS) $(libfilelistsftp_la_OBJECTS) $(libfilelistsftp_la_LIBADD) $(LIBS)
+libOSVfsArchive.la: $(libOSVfsArchive_la_OBJECTS) $(libOSVfsArchive_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsArchive_la_LDFLAGS) $(libOSVfsArchive_la_OBJECTS) $(libOSVfsArchive_la_LIBADD) $(LIBS)
+libOSVfsFtp.la: $(libOSVfsFtp_la_OBJECTS) $(libOSVfsFtp_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsFtp_la_LDFLAGS) $(libOSVfsFtp_la_OBJECTS) $(libOSVfsFtp_la_LIBADD) $(LIBS)
+libOSVfsLocal.la: $(libOSVfsLocal_la_OBJECTS) $(libOSVfsLocal_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsLocal_la_LDFLAGS) $(libOSVfsLocal_la_OBJECTS) $(libOSVfsLocal_la_LIBADD) $(LIBS)
+libOSVfsSearch.la: $(libOSVfsSearch_la_OBJECTS) $(libOSVfsSearch_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(pkglibdir) $(libOSVfsSearch_la_LDFLAGS) $(libOSVfsSearch_la_OBJECTS) $(libOSVfsSearch_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
@@ -289,50 +278,86 @@
 	-rm -f *.tab.c
 
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFXFile.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_archive.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_ftp.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_local.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_search.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/filelist_sftp.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSThreadExec.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSUtils.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsArchive.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsFtp.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsLocal.Plo at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSVfsSearch.Plo at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/pftp.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/sharedFunctions.Plo at am__quote@
- at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/thread_elem.Plo at am__quote@
 
 .cpp.o:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ $<
 
 .cpp.obj:
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
 
 .cpp.lo:
 @am__fastdepCXX_TRUE@	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LTCXXCOMPILE) -c -o $@ $<
 
-thread_elem.lo: ../../thread_elem.cpp
- at am__fastdepCXX_TRUE@	if $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT thread_elem.lo -MD -MP -MF "$(DEPDIR)/thread_elem.Tpo" -c -o thread_elem.lo `test -f '../../thread_elem.cpp' || echo '$(srcdir)/'`../../thread_elem.cpp; \
- at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/thread_elem.Tpo" "$(DEPDIR)/thread_elem.Plo"; else rm -f "$(DEPDIR)/thread_elem.Tpo"; exit 1; fi
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../thread_elem.cpp' object='thread_elem.lo' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
- at am__fastdepCXX_FALSE@	$(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o thread_elem.lo `test -f '../../thread_elem.cpp' || echo '$(srcdir)/'`../../thread_elem.cpp
+OSThreadExec.o: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.o -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.o `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
 
-sharedFunctions.lo: ../../sharedFunctions.cpp
- at am__fastdepCXX_TRUE@	if $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT sharedFunctions.lo -MD -MP -MF "$(DEPDIR)/sharedFunctions.Tpo" -c -o sharedFunctions.lo `test -f '../../sharedFunctions.cpp' || echo '$(srcdir)/'`../../sharedFunctions.cpp; \
- at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/sharedFunctions.Tpo" "$(DEPDIR)/sharedFunctions.Plo"; else rm -f "$(DEPDIR)/sharedFunctions.Tpo"; exit 1; fi
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../sharedFunctions.cpp' object='sharedFunctions.lo' libtool=yes @AMDEPBACKSLASH@
- at AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
- at am__fastdepCXX_FALSE@	$(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o sharedFunctions.lo `test -f '../../sharedFunctions.cpp' || echo '$(srcdir)/'`../../sharedFunctions.cpp
+OSThreadExec.obj: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.obj -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Po"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Po' tmpdepfile='$(DEPDIR)/OSThreadExec.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.obj `if test -f '../../OSThreadExec.cpp'; then $(CYGPATH_W) '../../OSThreadExec.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSThreadExec.cpp'; fi`
 
+OSThreadExec.lo: ../../OSThreadExec.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSThreadExec.lo -MD -MP -MF "$(DEPDIR)/OSThreadExec.Tpo" -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSThreadExec.Tpo" "$(DEPDIR)/OSThreadExec.Plo"; else rm -f "$(DEPDIR)/OSThreadExec.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSThreadExec.cpp' object='OSThreadExec.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSThreadExec.Plo' tmpdepfile='$(DEPDIR)/OSThreadExec.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSThreadExec.lo `test -f '../../OSThreadExec.cpp' || echo '$(srcdir)/'`../../OSThreadExec.cpp
+
+OSUtils.o: ../../OSUtils.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSUtils.o -MD -MP -MF "$(DEPDIR)/OSUtils.Tpo" -c -o OSUtils.o `test -f '../../OSUtils.cpp' || echo '$(srcdir)/'`../../OSUtils.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSUtils.Tpo" "$(DEPDIR)/OSUtils.Po"; else rm -f "$(DEPDIR)/OSUtils.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSUtils.cpp' object='OSUtils.o' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSUtils.Po' tmpdepfile='$(DEPDIR)/OSUtils.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSUtils.o `test -f '../../OSUtils.cpp' || echo '$(srcdir)/'`../../OSUtils.cpp
+
+OSUtils.obj: ../../OSUtils.cpp
+ at am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSUtils.obj -MD -MP -MF "$(DEPDIR)/OSUtils.Tpo" -c -o OSUtils.obj `if test -f '../../OSUtils.cpp'; then $(CYGPATH_W) '../../OSUtils.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSUtils.cpp'; fi`; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSUtils.Tpo" "$(DEPDIR)/OSUtils.Po"; else rm -f "$(DEPDIR)/OSUtils.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSUtils.cpp' object='OSUtils.obj' libtool=no @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSUtils.Po' tmpdepfile='$(DEPDIR)/OSUtils.TPo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSUtils.obj `if test -f '../../OSUtils.cpp'; then $(CYGPATH_W) '../../OSUtils.cpp'; else $(CYGPATH_W) '$(srcdir)/../../OSUtils.cpp'; fi`
+
+OSUtils.lo: ../../OSUtils.cpp
+ at am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -MT OSUtils.lo -MD -MP -MF "$(DEPDIR)/OSUtils.Tpo" -c -o OSUtils.lo `test -f '../../OSUtils.cpp' || echo '$(srcdir)/'`../../OSUtils.cpp; \
+ at am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/OSUtils.Tpo" "$(DEPDIR)/OSUtils.Plo"; else rm -f "$(DEPDIR)/OSUtils.Tpo"; exit 1; fi
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='../../OSUtils.cpp' object='OSUtils.lo' libtool=yes @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/OSUtils.Plo' tmpdepfile='$(DEPDIR)/OSUtils.TPlo' @AMDEPBACKSLASH@
+ at AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+ at am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) -c -o OSUtils.lo `test -f '../../OSUtils.cpp' || echo '$(srcdir)/'`../../OSUtils.cpp
+
 mostlyclean-libtool:
 	-rm -f *.lo
 
@@ -444,7 +469,7 @@
 clean-generic:
 
 distclean-generic:
-	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+	-rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"
@@ -513,6 +538,9 @@
 	tags uninstall uninstall-am uninstall-info-am \
 	uninstall-pkglibLTLIBRARIES
 
+
+#libfilelistsftp_la_LDFLAGS = `WANT_FOX=1.4 fox-config --libs` `xml2-config  --libs`
+#libfilelistsftp_la_SOURCES =filelist_sftp.cpp filelist_sftp.h  ../../OSThreadExec.cpp ../../OSThreadExec.h  ../../OSConfigure.h 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:

Modified: trunk/src/plugins/filelist/OSFXFile.cpp
===================================================================
--- trunk/src/plugins/filelist/OSFXFile.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/OSFXFile.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,6 +1,7 @@
-#include "fx.h"
-#include "../../thread_elem.h"
+
+#include "../../OSThreadExec.h"
 #include "OSFXFile.h"
+#include <fx.h>
 
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -10,8 +11,6 @@
 #include <errno.h>
 
 
-
-
 #define FOX_THREAD_SAFE
 
 struct fxdirent:dirent
@@ -19,8 +18,6 @@
     char buffer[256];
 };
 
-
-
 // Read bytes
 static long fullread (int fd, unsigned char *ptr, long len)
 {
@@ -61,9 +58,8 @@
 }
 
 
-
 // Copy ordinary file
-static FXbool copyfile (const FXString & oldfile, const FXString & newfile, thread_elem * te)
+static FXbool copyfile (const FXString & oldfile, const FXString & newfile, OSThreadExec* te)
 {
     unsigned char buffer[4096];
     struct stat status;
@@ -74,14 +70,10 @@
     {
 	if (::stat (oldfile.text (), &status) == 0)
 	{
-
-
 	    te->act_file_name = oldfile.text ();
 	    te->act_file_size = 1;
 	    te->file_size = status.st_size;
 
-
-
 	    if ((dst = open (newfile.text (), O_WRONLY | O_CREAT | O_TRUNC, status.st_mode)) >= 0)
 	    {
 		while (1)
@@ -92,9 +84,6 @@
 		    if (nread == 0)
 			break;
 
-
-
-
 		    if (te->cancel == true)
 		    {
 			fxmessage ("CANCEL CANCEL CANCEL CANCEL !!!\n\n\n\n\n");
@@ -106,8 +95,6 @@
 		    te->act_file_size += nread;
 		    te->act_total_size += nread;
 
-
-
 		    nwritten = fullwrite (dst, buffer, nread);
 		    if (nwritten < 0)
 			goto err;
@@ -131,11 +118,11 @@
 
 
 // Forward declararion
-static FXbool copyrec (const FXString & oldfile, const FXString & newfile, FXbool overwrite, inodelist * inodes, thread_elem * te);
+static FXbool copyrec (const FXString & oldfile, const FXString & newfile, FXbool overwrite, inodelist * inodes, OSThreadExec* te);
 
 
 // Copy directory
-static FXbool copydir (const FXString & oldfile, const FXString & newfile, FXbool overwrite, struct stat &parentstatus, inodelist * inodes, thread_elem * te)
+static FXbool copydir (const FXString & oldfile, const FXString & newfile, FXbool overwrite, struct stat &parentstatus, inodelist * inodes, OSThreadExec* te)
 {
     FXString oldchild, newchild;
     struct stat status;
@@ -201,11 +188,8 @@
     return TRUE;
 }
 
-
-
-
 // Recursive copy
-static FXbool copyrec (const FXString & oldfile, const FXString & newfile, FXbool overwrite, inodelist * inodes, thread_elem * te)
+static FXbool copyrec (const FXString & oldfile, const FXString & newfile, FXbool overwrite, inodelist * inodes, OSThreadExec* te)
 {
     struct stat status1, status2;
 
@@ -276,16 +260,10 @@
 }
 
 
-
-
-
 //====================================OSFXFile================================================================
 
-
-
-
 // Copy file
-FXbool OSFXFile::copy (const FXString & oldfile, const FXString & newfile, thread_elem * te, FXbool overwrite)
+FXbool OSFXFile::copy (const FXString & oldfile, const FXString & newfile, OSThreadExec* te, FXbool overwrite)
 {
     if (newfile != oldfile)
     {
@@ -301,7 +279,7 @@
 
 
 // Remove file or directory
-FXbool OSFXFile::remove (const FXString & file, thread_elem * te)
+FXbool OSFXFile::remove (const FXString & file, OSThreadExec* te)
 {
 
 
@@ -401,7 +379,7 @@
 
 
 // Rename or move file, or copy and delete old if different file systems
-FXbool OSFXFile::move (const FXString & oldfile, const FXString & newfile, thread_elem * te, FXbool overwrite)
+FXbool OSFXFile::move (const FXString & oldfile, const FXString & newfile, OSThreadExec* te, FXbool overwrite)
 {
 
     if (newfile != oldfile)


Property changes on: trunk/src/plugins/filelist/OSFXFile.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/plugins/filelist/OSFXFile.h
===================================================================
--- trunk/src/plugins/filelist/OSFXFile.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/OSFXFile.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,30 +1,30 @@
 #ifndef OSFXFILE_H
 #define OSFXFILE_H
 
+#include <fx.h>
 
+class OSThreadExec;
+
 /// Declared as "C" so as to not clash tag-names
 extern "C"
 {
     struct stat;
 }
 
-
-
-
 namespace OSFXFile
 {
 
 
 /// Remove file or directory, recursively.
-    FXbool remove (const FXString & file, thread_elem * te);
+    FXbool remove (const FXString & file, OSThreadExec* te);
 
 /// Copy file or directory, recursively
-    FXbool copy (const FXString & srcfile, const FXString & dstfile, thread_elem * te, FXbool overwrite = FALSE);
+    FXbool copy (const FXString & srcfile, const FXString & dstfile, OSThreadExec * te, FXbool overwrite = FALSE);
 
 /// Rename or move file or directory
-    FXbool move (const FXString & srcfile, const FXString & dstfile, thread_elem * te, FXbool overwrite = FALSE);
+    FXbool move (const FXString & srcfile, const FXString & dstfile, OSThreadExec* te, FXbool overwrite = FALSE);
 
 }
 
+#endif
 
-#endif


Property changes on: trunk/src/plugins/filelist/OSFXFile.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsArchive.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.cpp)


Property changes on: trunk/src/plugins/filelist/OSVfsArchive.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsArchive.h (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsArchive.h)


Property changes on: trunk/src/plugins/filelist/OSVfsArchive.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsFtp.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.cpp)


Property changes on: trunk/src/plugins/filelist/OSVfsFtp.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsFtp.h (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsFtp.h)


Property changes on: trunk/src/plugins/filelist/OSVfsFtp.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsLocal.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.cpp)


Property changes on: trunk/src/plugins/filelist/OSVfsLocal.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsLocal.h (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsLocal.h)


Property changes on: trunk/src/plugins/filelist/OSVfsLocal.h
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsSearch.cpp (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.cpp)


Property changes on: trunk/src/plugins/filelist/OSVfsSearch.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/src/plugins/filelist/OSVfsSearch.h (from rev 245, branches/mloskot-style-refactoring/src/plugins/filelist/OSVfsSearch.h)


Property changes on: trunk/src/plugins/filelist/OSVfsSearch.h
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/plugins/filelist/filelist_archive.cpp
===================================================================
--- trunk/src/plugins/filelist/filelist_archive.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_archive.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,395 +0,0 @@
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-#include "filelist_archive.h"
-
-
-vfs filelist_archive::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container("name"));
-	v.information="tar.bz2 and tar.gz archive - default plugin";
-	v.version="1";
-	v.type="vfs";
-return v;	
-	
-}
-
-
-int filelist_archive::osopendir (string dir)
-{
-
-this->dir=dir;
-iter=files.begin();
-}
-osfile filelist_archive::osreaddir (void)
-{
-
-osfile os_file;
-
-while(iter!=files.end())
-{
-os_file.name=*iter;
-	string modfile=os_file.name.substr(0,os_file.name.length () - 1);
-	
-	string::size_type pos=modfile.rfind("/");
-	if (pos != string::npos)
-	{
-		string dirf="/"+os_file.name.substr(0,pos);
-		
-		
-		if(dirf!=dir)
-		{
-		iter++;
-		continue;
-		}
-		else
-		os_file.name=os_file.name.substr(pos+1);
-		
-		
-		
-	}
-	else if(dir!="/")
-	{
-	iter++;
-	continue;
-	}
-
-	    os_file.type = 0;
-	    os_file.size = 300;
-	  
-	    
-	    string s = os_file.name.substr (os_file.name.length () - 1, 1);
-
-	    if (s == "/")
-	    {
-	        os_file.name = os_file.name.substr (0,os_file.name.length () - 1);
-		os_file.type = FOLDER;
-	    }
-	    else
-		os_file.type = 0;
-	    
-	    iter++;
-	  
-	    return os_file;
-}		    
-
-
-    
-    os_file.name = "";
-    return os_file;
-
-}
-int filelist_archive::mkdir (string dir, int mode)
-{
-}
-int filelist_archive::copy (thread_elem * te)
-{
-filesoperation("copy",te);
-}
-
-int filelist_archive::move (thread_elem * te)
-{
-filesoperation("move",te);
-}
-int filelist_archive::remove (thread_elem * te)
-{
-filesoperation("remove",te);
-}
-
-int filelist_archive::filesoperation(string typeoperation,thread_elem * te)
-{
-
- vector < string >::iterator iter;
- 
-	string::size_type pos = te->options.find ("upload");
-	if (pos != string::npos && typeoperation!="remove")
-	{
-		
-		string file_list;
-		vector <string> file_list_vec;
-   		 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   		 {
-			string sr = (*iter);
-			file_list_vec.push_back(sr);
-			sr=sr.substr(1,sr.length()-1);
-			file_list+=" \"" +  sr + "\"";
-			
-			
-		 }	
-			if(dir=="/")
-			{
-			string command="cd " +te->dst +" && tar xf" + type + " " + archive_filename + " " + file_list;
-			system(command.c_str());
-			
-			}
-			else
-			{
-			
-			string tmpdir;
-			string destdir;
-			tmpdir=FXFile::time ("%S%H%M%d%m%y", FXFile::now()).text ();
-			destdir=string("/tmp/openspace/tmp") + tmpdir;
-			FXFile::createDirectory(destdir.c_str(),0);
-			
-			
-			string command="cd " +destdir +" && tar xf" + type + " " + archive_filename + " " + file_list;
-			system(command.c_str());
-			
-				for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   				{	
-				string sr = (*iter);
-				sr=sr.substr(1,sr.length()-1);
-				string tmpfile=destdir+"/"+sr;
-				string d=te->dst.c_str() + string("/")+FXFile::name(iter->c_str()).text();
-				FXFile::move(tmpfile.c_str(),d.c_str());				
-				}	
-			FXFile::remove(destdir.c_str());	
-			}
-		
-		if(typeoperation=="move")
-		{
-		
-		thread_elem *el2 = new thread_elem (this, "remove", "", file_list_vec);
-		this->remove(el2);
-		delete el2;
-		
-		}
-		
-		
-	}
-	else //download
-	{
-		string decompress,compress,archive_filename_decompressed;
-		if(type=="z")
-		{
-			decompress="gunzip";
-			compress="gzip";
-			archive_filename_decompressed=archive_filename.substr(0,archive_filename.length()-3);
-		}
-		else //bzip2
-		{
-			decompress="bunzip2";
-			compress="bzip2";
-			archive_filename_decompressed=archive_filename.substr(0,archive_filename.length()-4);
-		}
-		
-		string command=decompress + " " + archive_filename;
-		system(command.c_str());
-		
-		if(typeoperation=="remove")
-		{
-			string file_list;
-		
-   			 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   			 {
-			string sr = (*iter);
-			sr=sr.substr(1,sr.length()-1);
-			file_list+=" \"" +  sr + "\"";	
-			
-			vector <string>::iterator searchit=find(files.begin(), files.end(), sr);
-				if (files.end()!=searchit)// Search the list.
-					{
-					files.erase(searchit);	
-					}
-					
-			 }	
-			command="tar --delete -f " + archive_filename_decompressed + " " +file_list;
-		
-			system(command.c_str());
-		
-		}
-		else
-		{
-		
-			 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   			 {
-			 string file;
-			 string sr = (*iter);
-			 string dir=FXFile::directory(sr.c_str()).text();
-			 
-
-			 
-			 
-				if(this->dir=="/")
-				{
-				file=FXFile::name(sr.c_str()).text();
-				
-					if (files.end()==find(files.begin(), files.end(), file))// Search the list.
-					{
-					string dirtest=dir+"/"+FXFile::name(file.c_str()).text();
-					
-					
-						
-						if(FXFile::isDirectory(dirtest.c_str()))						
-						files.push_back(file+"/");
-						else
-						files.push_back(file);	
-					}
-					else	
-					{
-					command="cd " +dir + " && tar --delete -f " + archive_filename_decompressed + " " +file;
-					
-					system(command.c_str());
-					}
-				
-				command="cd " +dir + " && tar rf " + archive_filename_decompressed + " " +file;
-				system(command.c_str());
-				
-				}
-				else
-				{
-			 			
-				string reldir=this->dir.substr(1,this->dir.length()-1);
-				file=reldir +"/"+ FXFile::name(sr.c_str()).text();	
-				
-				string tmpdir;
-				string destdir;
-				tmpdir=FXFile::time ("%S%H%M%d%m%y", FXFile::now()).text ();
-				destdir=string("/tmp/openspace/tmp") + tmpdir;
-			
-				FXFile::createDirectory(destdir.c_str(),0);
-				command="cd "+destdir + " && mkdir -p " + reldir;
-				system(command.c_str());
-				string d=destdir+"/" + reldir + "/" + FXFile::name(sr.c_str()).text();
-				
-				if(typeoperation=="copy")
-				FXFile::copy(sr.c_str(),d.c_str());
-				else if(typeoperation=="move")
-				{
-				
-				FXFile::move(sr.c_str(),d.c_str());
-				}
-
-				
-				
-					if (files.end()==find(files.begin(), files.end(), file))// Search the list.
-					{
-					string dirtest=dir+"/"+FXFile::name(file.c_str()).text();
-					
-					
-						
-						if(FXFile::isDirectory(dirtest.c_str()))						
-						files.push_back(file+"/");
-						else
-						files.push_back(file);	
-					}
-					else
-					{	
-					command="cd " +destdir + " && tar --delete -f " + archive_filename_decompressed + " " +file;
-					
-					system(command.c_str());
-					}
-				
-				command="cd " + destdir + " && tar rf " + archive_filename_decompressed + " " +file;
-				system(command.c_str());
-				
-				
-	
-				FXFile::remove(destdir.c_str());
-				
-				}
-				
-							
-		 	}
-		}	
-		command=compress + " " + archive_filename_decompressed;
-		system(command.c_str());
-		
-			
-	}
-	
-te->end=true;
-
-
-}
-
-
-int filelist_archive::rename (string orgname, string newname)
-{
-}
-int filelist_archive::init (vector < string > *vector_name, pathtype pt, configure * conf)
-{
-archive_filename = pt.server;
-
-
-string  command;
-
-if ((archive_filename.length () >= 6 && archive_filename.substr (archive_filename.length () - 6, 6) == "tar.gz") ||(archive_filename.length () >= 3 && archive_filename.substr (archive_filename.length () - 3, 3) == "tgz"))
-type="z";
-else
-type="j";
-
-command="tar tf" + type + " " + archive_filename;
-
-
-pipe = popen(command.c_str(), "r");
-
-if (pipe != NULL)
-    {
-	string line;
-	while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-	{
-
-
-	    string path = readbuf;
-	    path = path.substr (0, path.length () - 1);
-	    files.push_back(path);
-	   
-	}
-
-	pclose (pipe);
-    }
-    
-iter=files.begin();
-
-}
-int filelist_archive::mode (string file)
-{
-}
-string filelist_archive::owner (string file)
-{
-return "";
-}
-string filelist_archive::group (string file)
-{
-return "";
-}
-bool filelist_archive::mode (string file, unsigned int, bool recursive)
-{
-}
-bool filelist_archive::owner (string file, string, bool recursive)
-{
-}
-bool filelist_archive::group (string file, string, bool recursive)
-{
-}
-string filelist_archive::info (void)
-{
-return "";
-}
-void filelist_archive::totalsize (string path, unsigned long &size)
-{
-}
-string filelist_archive::symlink (string path)
-{
-return "";
-}
-bool filelist_archive::symlink (string src, string dst)
-{
-}
-bool filelist_archive::hardlink (string src, string dst)
-{
-}
-
-int filelist_archive::quit (void)
-{
-}
-EXPORTFUNCTION filelist_base *get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_archive ();
-}

Deleted: trunk/src/plugins/filelist/filelist_archive.h
===================================================================
--- trunk/src/plugins/filelist/filelist_archive.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_archive.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,40 +0,0 @@
-#ifndef FILELIST_archive
-#define FILELIST_archive
-#include "../../filelist_base.h"
-class filelist_archive:public filelist_base
-{
- 
-private:  
-    string archive_filename;
-    FILE *pipe;
-    char readbuf[1024];
-    vector < string > files;
-    vector < string >::iterator iter;
-    string dir;
-    string type;
- public:    
-    int filelist_archive::osopendir (string dir);
-    osfile filelist_archive::osreaddir (void);
-    int filelist_archive::mkdir (string dir, int mode = 0);
-    int filelist_archive::copy (thread_elem * te);
-    int filelist_archive::move (thread_elem * te);
-    int filelist_archive::remove (thread_elem * te);
-    int filelist_archive::rename (string orgname, string newname);
-    int filelist_archive::init (vector < string > *vector_name, pathtype pt, configure * conf);
-    int filelist_archive::mode (string file);
-    string filelist_archive::owner (string file);
-    string filelist_archive::group (string file);
-    bool filelist_archive::mode (string file, unsigned int, bool recursive);
-    bool filelist_archive::owner (string file, string, bool recursive);
-    bool filelist_archive::group (string file, string, bool recursive);
-    string filelist_archive::info (void);
-    void filelist_archive::totalsize (string path, unsigned long &size);
-    string filelist_archive::symlink (string path);
-    bool filelist_archive::symlink (string src, string dst);
-    bool filelist_archive::hardlink (string src, string dst);
-    vfs filelist_archive::setup (void);
-    int filelist_archive::quit (void);
-    
-    int filelist_archive::filesoperation(string type,thread_elem * te);
-};
-#endif

Deleted: trunk/src/plugins/filelist/filelist_ftp.cpp
===================================================================
--- trunk/src/plugins/filelist/filelist_ftp.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_ftp.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,739 +0,0 @@
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-#include "filelist_ftp.h"
-
-#include <sstream>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <sys/types.h>
-#include <dirent.h>
-
-    SimpleLogger::SimpleLogger()
-    {
-    te=NULL;
-    }
-    
-    void SimpleLogger::start(uint32_t bytes, const FXString & name,uint32_t size)
-    {
-    	if(te!=NULL && name!="")
-   	{
-		te->act_file_size=0;
-		te->act_file_name = name.text ();
-		if(size!=0)
-		te->file_size = size;
-	}
-    }
-    bool SimpleLogger::update(uint32_t bytes, const FXString & s)
-    {
-     if(te!=NULL)
-     {
-	te->act_file_size+=bytes;	
-	te->act_total_size+=bytes;
-	
-	if(te->cancel==true)
-	return false;
-     }	
-    return true;
-    }
-    void SimpleLogger::end(uint32_t bytes, const FXString & )
-    {
-
-    }
-
-    void SimpleLogger::choke()
-    {
-
-    }
-
-    void SimpleLogger::error(int error)
-    {
-
-    }
-
-    void SimpleLogger::logLine(FXString & line)
-    {
-     fxmessage("LOG=%s\n",line.text());
-    }
-    void SimpleLogger::error(FXString & error)
-    {
-     fxmessage("ERROR=%s\n",error.text());
-    }
-
-vfs filelist_ftp::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container("name"));
-	v.vfsheaders.push_back(vfsheader_container("size","size"));
-	v.vfsheaders.push_back(vfsheader_container("owner"));
-	v.vfsheaders.push_back(vfsheader_container("group"));
-	v.information="FTP - default plugin";
-	v.version="1";
-	v.type="network";
-return v;	
-	
-}
-
-
-int filelist_ftp::priv_osopendir (string dir,string prefix,map <string,osfile> & filesMap,map <string,osfile>::iterator & iter)
-{
-
-filesMap.clear();
-
-
-	FXString di=dir.c_str();	
-	pftp->setDir(di);
-	FXString di2;
-	pftp->pwd(di2);
-
-	if(FXFile::name(di)!=FXFile::name(di2) || di2=="")
-	return -1;
-
-
-	
-    FXMemoryStream str;
-    str.open(FXStreamSave, NULL);
-
-
-    pftp->list(str);
-
-    // nil terminate the buffer
-    FXuchar nil = 0;
-    str.save(&nil, 1);
-
-    // and get it
-    FXuchar* buffer;
-    unsigned long sp;
-    str.takeBuffer(buffer, sp);
-
-    char * ptr = reinterpret_cast<char *>(buffer);
-    char * next = strchr(ptr, '\n');
-    char * start = ptr;
-
-
-    //get attributes # user group size date =(3 or 4? fields) name
-    while(next && (ptr-start < (int)sp))
-    {
-
-        next[0] = 0;
-        if(next[-1] == '\r')
-            next[-1] = 0;
-
-        // Some FTP servers send other lines than raw directory
-        if(ptr[0] != 'd' && ptr[0] != '-')
-        {
-            ptr = next+1;
-            next = strchr(ptr, '\n');
-            continue;
-        }
-
-
-
-       osfile os_file;
-       os_file.type=0;
-       if(ptr[0]=='d')
-           os_file.type = os_file.type | FOLDER; 
-       else	   
-           os_file.type=0;
-
-std::stringstream parser (ptr);
-std::string field;
-
-   string user;
-   string group;
-   string size;
-   string date;
-   string attrib;
-   string name;
-   
-parser>>attrib; 
-
-attrib=attrib.substr(1,attrib.length()-1);
-
-parser>>field;
-parser>>user;
-parser>>group;
-parser>>size;
-os_file.size=atoi(size.c_str());
-
-
-parser>>date;
-parser>>date;
-parser>>date;
-
-
-os_file.user=user;
-os_file.group=group;
-os_file.mode=attrib;
-
-
-
-string n;
-while(parser>>n)
-{
-if(name!="")
-name=name+" "+n;
-else
-name=n;
-}
- 
-        os_file.name = prefix+name;
-	
-
-if(prefix=="")
-{	
-	
-	
-    for (int i = 0; i < fieldsnum - 1; i++)
-    {
-
-	if (fields[i + 1] == "size")
-	    os_file.attrib.push_back(size);
-	else if (fields[i + 1] == "owner")
-	   os_file.attrib.push_back(user);
-	else if (fields[i + 1] == "group")
-	   os_file.attrib.push_back(group);
-        else if (fields[i + 1] == "mode")
-        os_file.attrib.push_back(attrib);
-
-
-    }
-	
-}	
-filesMap[os_file.name]=os_file;	
-	
-	
-	
-	if(prefix!="")
-	{
-	filesMapGlobal[os_file.name]=os_file;
-	}
-        ptr = next+1;
-        next = strchr(ptr, '\n');
-    }
- FXFREE(&buffer);
-
-iter=filesMap.begin();
-
-}
-
-
-
-int filelist_ftp::osopendir (string dir)
-{
-
-
-this->dir=dir;
-
-return priv_osopendir(dir,"",filesMap,iter);
- 
-
-
-}
-
-osfile filelist_ftp::priv_osreaddir (map <string,osfile> & filesMap,map <string,osfile>::iterator & iter)
-{
-osfile os_file;
-
-if(iter!=filesMap.end())
-{
-	  os_file=iter->second;
-	   
-	    iter++;
-	    return os_file;
-}		    
-
-
-    
-    os_file.name = "";
-    return os_file;
-
-}
-
-
-osfile filelist_ftp::osreaddir (void)
-{
-
-  return priv_osreaddir(filesMap,iter);  
-}
-int filelist_ftp::mkdir (string dir, int mode)
-{
-	pftp->mkDir(dir.c_str());
-}
-
-
-static const int BUCKETSIZE = 128;
-struct Bucket {
-    uint8_t bucket[BUCKETSIZE];
-};
-
-
-
-
-
-
-
-
-void filelist_ftp::local_totalsize (string path, unsigned long &size)
-{
-
-    if (FXFile::isDirectory (path.c_str ()))
-    {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
-
-
-	dirp = opendir (path.c_str ());
-
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-	    {
-
-		string file = path;
-		file.append (dp->d_name);
-#ifndef WIN32
-		lstat (file.c_str (), &status);
-#else
-		stat (file.c_str (), &status);
-#endif
-		if (S_ISDIR (status.st_mode))
-		{
-		    size = size + (unsigned int) status.st_size;
-		    file.append ("/");
-		    totalsize (file, size);
-
-		}
-		else
-		{
-		    size = size + status.st_size;
-		}
-	    }
-	}
-
-	closedir (dirp);
-    }
-    else
-    {
-	size += FXFile::size (path.c_str ());
-
-    }
-
-}
-
-
-
-
-
-
-
-int filelist_ftp::copy (thread_elem * te)
-{
- log->te=te;
-  unsigned long size = 0;
-    
-    string::size_type pos = te->options.find ("upload");
-	if (pos == string::npos)
-	{
-	
-	string dir_copy=this->dir;
-	
-	 vector < string >::iterator iter;
-	 
-	 for (iter = te->src.begin (); iter != te->src.end(); iter++)
-   	 {
-	 string sr = (*iter);
-	 if (FXFile::isDirectory (sr.c_str ()))
-	    sr.append ("/");
-	 local_totalsize (sr, size);
-	 }
-
-	te->total_size = size; 
-	 
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-	
-        FXString file=iter->c_str();	
-	goLocalRecursive(file.text(),"",te);
-	pftp->setDir(dir_copy.c_str());
-	
-    }
-	this->dir=dir_copy;
-	
-	}
-	else 
-	{
-
-
-
-getRecursiveFiles(te->src,size);
-
-te->total_size = size; 
-for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-    {   
-    if(te->cancel==true)
-    break;  
-   	
-	if(iterGlobal->second.type&FOLDER)
-	{
-	
-	string filename=te->dst+"/"+iterGlobal->first;
-	FXFile::createDirectory(filename.c_str(),str_mode_int(iterGlobal->second.mode));
-	
-	}
-	else
-	{
-	string filename=te->dst+"/"+iterGlobal->first;
-	FXFile::createDirectory(FXFile::directory(filename.c_str()),str_mode_int(iterGlobal->second.mode));
-	te->file_size = iterGlobal->second.size;
-	
-	pftp->download(iterGlobal->first.c_str(),filename.c_str(),false);
-	
-	FXFile::mode(filename.c_str(),str_mode_int(iterGlobal->second.mode));
-	}
-	te->act_file_name=iterGlobal->first;
-	if( iterGlobal == filesMapGlobal.begin())break;
-	
-    }
-
-
-	
-
-   
-	}		
- log->te=NULL;   
-}
-
-
-void filelist_ftp::goLocalRecursive (string path,string prefix,thread_elem *te)
-{
-
-    if(te->cancel==true)
-    return; 
-
-    if (FXFile::isDirectory (path.c_str ()))
-    {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
-
-     prefix=prefix+ FXFile::name(path.c_str()).text();
-     string fulldir=this->dir+"/"+prefix;
-     
-     pftp->mkDir(fulldir.c_str());
-     this->mode (fulldir,FXFile::mode(path.c_str()),false);
-     pftp->setDir(fulldir.c_str()); 
-
-	dirp = opendir (path.c_str ());
-
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-	    {
-
-		string file = path+"/";
-		file.append (dp->d_name);
-		goLocalRecursive(file,prefix+"/",te);
-	    }
-	}
-
-	closedir (dirp);
-    }
-    else
-    {
-    string pre=this->dir+"/"+prefix.substr(0,prefix.length()-1);
-    if(this->dir!=pre)
-    {
-     pftp->setDir(pre.c_str()); 
-     this->dir=pre;
-    }
-  
-		FXString fil=path.c_str();
-		pftp->upload(fil,0,false);
-		this->mode (path,FXFile::mode(fil),false);   
-		 
-
-    }
-
-}
-
-
-
-
-
-
-
-
-int filelist_ftp::move (thread_elem * te)
-{
-}
-
-
-void filelist_ftp::gorecursive(string file,unsigned long &size)
-{
-
-
-		map <string,osfile> filesMap;
-		map <string,osfile>::iterator iter;
-		
-	   	if(priv_osopendir(file,file+"/",filesMap,iter)!=-1)
-		{
-		
-		 while (1)
-   		 {	
-		 osfile os_file = priv_osreaddir (filesMap,iter);
-		 	if (os_file.name == "")
-	   		break;
-			
-			if(os_file.type&FOLDER)
-			{
-			gorecursive(os_file.name,size);
-			}
-			else
-			size = size + os_file.size;
-		 }
-
-	    }
-
-
-}
-
-void filelist_ftp::getRecursiveFiles(vector < string >src,unsigned long &size)
-{
-
-filesMapGlobal.clear();
-
-
-    vector < string >::iterator iter_files;
-
-    for (iter_files = src.begin (); iter_files != src.end(); iter_files++)
-    {     
-
-    string name=FXFile::name(iter_files->c_str()).text();
-    	osfile os_file;
-	os_file.name=name;
-	os_file.type=filesMap[name].type;
-	os_file.size=filesMap[name].size;
-	os_file.mode=filesMap[name].mode;
-	os_file.group=filesMap[name].user;
-	os_file.user=filesMap[name].group;
-	filesMapGlobal[name]=os_file;
-
-    }
-
-
-   for (iterGlobal=filesMapGlobal.begin();iterGlobal!=filesMapGlobal.end(); iterGlobal++)
-   {
-
-   
-        if(iterGlobal->second.type&FOLDER)
-	{
- 	gorecursive(iterGlobal->first,size);
-	FXString di=this->dir.c_str();
-	pftp->setDir(di);
-	}
-	else
-	size = size + iterGlobal->second.size;
-
-   }
-}
-
-int filelist_ftp::remove (thread_elem * te)
-{
-unsigned long size;
-getRecursiveFiles(te->src,size);
-
-for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-    {     
-  
-	
-	if(iterGlobal->second.type&FOLDER)
-	pftp->rmDir(iterGlobal->first.c_str());
-	else
-	pftp->del(iterGlobal->first.c_str());
-	
-	te->act_file_name=iterGlobal->first;
-	if( iterGlobal == filesMapGlobal.begin())break;
-	
-    }
-
-
-
-}
-int filelist_ftp::rename (string orgname, string newname)
-{
-
-FXString tmp;
-pftp->sendCmd("RNFR ", FXFile::name(orgname.c_str()), tmp);
-pftp->sendCmd("RNTO ", FXFile::name(newname.c_str()), tmp);
-
-}
-int filelist_ftp::init (vector < string > *vector_name, pathtype pt, configure * conf)
-{
-
-    fieldsnum = vector_name->size ();
-    fields = (*vector_name);
-
-log=new SimpleLogger;
-pftp=new PFTP(pt.server.c_str(),pt.user.c_str(),pt.password.c_str(),"",log);
-
-	if(pftp->isConnected() && getinitialdir()!="")
-        {	
-
-	}
-	else return -1;
-}
-
-int filelist_ftp::str_mode_int(string per)
-{
-unsigned int mode = 0;
-	if (per[0]=='r')
-	    mode = mode | S_IRUSR;
-	if (per[1]=='w')
-	    mode = mode | S_IWUSR;
-	if (per[2]=='x')
-	    mode = mode | S_IXUSR;
-	if (per[3]=='r')
-	    mode = mode | S_IRGRP;
-	if (per[4]=='w')
-	    mode = mode | S_IWGRP;
-	if (per[5]=='x')
-	    mode = mode | S_IXGRP;
-	if (per[6]=='r')
-	    mode = mode | S_IROTH;
-	if (per[7]=='w')
-	    mode = mode | S_IWOTH;
-	if (per[8]=='x')
-	    mode = mode | S_IXOTH;
-return mode;
-}
-
-int filelist_ftp::mode (string file)
-{
-
-string per=filesMap[FXFile::name(file.c_str()).text()].mode;
-
-return str_mode_int(per);
-
-}
-string filelist_ftp::owner (string file)
-{
-return filesMap[FXFile::name(file.c_str()).text()].user; 
-}
-string filelist_ftp::group (string file)
-{
-return filesMap[FXFile::name(file.c_str()).text()].group;
-}
-bool filelist_ftp::mode (string file, unsigned int per, bool recursive)
-{
-
-unsigned int mode=per;
-
-int x=((mode & S_IRUSR) | (mode & S_IWUSR) | (mode & S_IXUSR))/64;
-int y=((mode & S_IRGRP) | (mode & S_IWGRP) | (mode & S_IXGRP))/8;
-int z=((mode & S_IROTH) | (mode & S_IWOTH) | (mode & S_IXOTH));	
-
-file=FXFile::name(file.c_str()).text();
-
-FXString tmp;
-char chstr[20];
-sprintf (chstr, "%d%d%d", x,y,z);
-
-	if(recursive==false)
-	{
-	string cmd="CHMOD "+string(chstr)+" "+ file;
-	pftp->sendCmd("SITE ",cmd.c_str(),tmp );
-	}
-	else
-	{
-	unsigned long size;
-	vector < string >src;
-	src.push_back(file);
-	getRecursiveFiles(src,size);
-
-		for (iterGlobal=--filesMapGlobal.end();; iterGlobal--)
-  		  {     
-   			
-			
-			string cmd="CHMOD "+string(chstr)+" "+ iterGlobal->first;
-			pftp->sendCmd("SITE ",cmd.c_str(),tmp );
-			
-			
-			if( iterGlobal == filesMapGlobal.begin())break;
-	
-   		  }
-
-	
-	}
-
-
-
-}
-bool filelist_ftp::owner (string file, string, bool recursive)
-{
-}
-bool filelist_ftp::group (string file, string, bool recursive)
-{
-}
-string filelist_ftp::info (void)
-{
-return "";
-}
-void filelist_ftp::totalsize (string path, unsigned long &size)
-{
-size=0;
-	
-	string file=FXFile::name(path.c_str()).text();
-	if(file=="")
-	file=FXFile::name(path.substr(0,path.length()-1).c_str()).text();
-	
-	
-
-	if(filesMap[file].type&FOLDER)
-	{
-	vector < string >src;
-	src.push_back(file);
-	getRecursiveFiles(src,size);
-	}
-	else
-	size=filesMap[file].size;
-
-
-	
-}
-string filelist_ftp::symlink (string path)
-{
-return "";
-}
-bool filelist_ftp::symlink (string src, string dst)
-{
-}
-bool filelist_ftp::hardlink (string src, string dst)
-{
-}
-
-int filelist_ftp::quit (void)
-{
-pftp->logout();
-}
-
-string filelist_ftp::getinitialdir(void)
-{
-	FXString base;
-	pftp->pwd(base);
-
-return base.text();
-}
-
-
-
-EXPORTFUNCTION filelist_base *get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_ftp ();
-}

Deleted: trunk/src/plugins/filelist/filelist_ftp.h
===================================================================
--- trunk/src/plugins/filelist/filelist_ftp.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_ftp.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,79 +0,0 @@
-#ifndef FILELIST_ftp
-#define FILELIST_ftp
-#include "../../filelist_base.h"
-#include "pftp.h"
-#include <map>
-
-
-
-class SimpleLogger : public Logger 
-{
-public:
-    thread_elem *te;
-    
-    SimpleLogger::SimpleLogger();
-    void SimpleLogger::start(uint32_t bytes, const FXString & name,uint32_t size);
-    bool SimpleLogger::update(uint32_t bytes, const FXString & s);
-    void SimpleLogger::end(uint32_t bytes, const FXString & );
-    void SimpleLogger::choke();
-    void SimpleLogger::error(int error);
-    void SimpleLogger::logLine(FXString & line);
-    void SimpleLogger::error(FXString & error);
-
-};
-
-
-class filelist_ftp:public filelist_base
-{
-
-private:
-
-PFTP *pftp;
-SimpleLogger *log;
-string dir;
-
-
-map <string,osfile> filesMap;
-map <string,osfile>::iterator iter;
-
-map <string,osfile> filesMapGlobal;
-map <string,osfile>::iterator iterGlobal;
-
-    int fieldsnum;
-    vector < string > fields;
-
-    int filelist_ftp::priv_osopendir (string dir,string prefix,map <string,osfile> & filesMap,map <string,osfile>::iterator & iter);
-    void filelist_ftp::gorecursive(string file,unsigned long &size);
-    osfile filelist_ftp::priv_osreaddir (map <string,osfile> & filesMap,map <string,osfile>::iterator & iter2);
-    void filelist_ftp::getRecursiveFiles(vector < string >src,unsigned long &size);
-    void filelist_ftp::goLocalRecursive (string path,string prefix,thread_elem *te);
-    void filelist_ftp::local_totalsize (string path, unsigned long &size);
-    int filelist_ftp::str_mode_int(string per);
-
-  public:
-    int filelist_ftp::osopendir (string dir);
-    osfile filelist_ftp::osreaddir (void);
-    int filelist_ftp::mkdir (string dir, int mode = 0);
-    int filelist_ftp::copy (thread_elem * te);
-    int filelist_ftp::move (thread_elem * te);
-    int filelist_ftp::remove (thread_elem * te);
-    int filelist_ftp::rename (string orgname, string newname);
-    int filelist_ftp::init (vector < string > *vector_name, pathtype pt, configure * conf);
-    int filelist_ftp::mode (string file);
-    string filelist_ftp::owner (string file);
-    string filelist_ftp::group (string file);
-    bool filelist_ftp::mode (string file, unsigned int, bool recursive);
-    bool filelist_ftp::owner (string file, string, bool recursive);
-    bool filelist_ftp::group (string file, string, bool recursive);
-    string filelist_ftp::info (void);
-    void filelist_ftp::totalsize (string path, unsigned long &size);
-    string filelist_ftp::symlink (string path);
-    bool filelist_ftp::symlink (string src, string dst);
-    bool filelist_ftp::hardlink (string src, string dst);
-    vfs filelist_ftp::setup (void);
-    int filelist_ftp::quit (void);
-    string filelist_ftp::getinitialdir(void);
-    
-    
-};
-#endif

Deleted: trunk/src/plugins/filelist/filelist_local.cpp
===================================================================
--- trunk/src/plugins/filelist/filelist_local.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_local.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,611 +0,0 @@
-
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-
-#include <fx.h>
-#include <errno.h>
-#include "filelist_local.h"
-#include "../../sharedFunctions.h"
-#include "OSFXFile.h"
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
-
-#include <fstream>
-#include <sstream>
-#include <sys/mount.h>
-
-#include <sys/types.h>
-#include <pwd.h>
-#include <grp.h>
-
-
-vector < string > name;
-
-
-vfs filelist_local::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container("name"));
-	v.vfsheaders.push_back(vfsheader_container("size","size"));
-	v.vfsheaders.push_back(vfsheader_container("owner"));
-	v.vfsheaders.push_back(vfsheader_container("group"));
-	v.vfsheaders.push_back(vfsheader_container("accessed","date"));
-	v.vfsheaders.push_back(vfsheader_container("modified","date"));
-	v.information="Local file list - default plugin";
-	v.version="1";
-	
-return v;	
-	
-}
-
-int filelist_local::init (vector < string > *vector_name,pathtype pt, configure * conf)
-{
-
-    fieldsnum = vector_name->size ();
-    fields = (*vector_name);
-
-    return 0;
-}
-
-
-osfile filelist_local::osreaddir ()
-{
-
-    osfile os_file;
-    if (dp == NULL)
-    {
-	os_file.name = "";
-	return os_file;
-    }
-    if ((dirrec = readdir (dp)) == NULL)
-    {
-	closedir (dp);
-	os_file.name = "";
-	return os_file;
-    }
-
-    os_file.name = dirrec->d_name;
-    os_file.type = 0;
-
-    os_file.size = FXFile::size (os_file.name.c_str ());
-
-    if (stat (dirrec->d_name, &status) != -1)
-    {
-
-	struct stat status2;
-	if (lstat (dirrec->d_name, &status2) != -1)
-	{
-	    if (S_ISLNK (status2.st_mode))
-	    {
-		os_file.type = os_file.type | SYMLINK;
-	    }
-
-	}
-
-
-	if (S_ISDIR (status.st_mode))
-	{
-	    os_file.type = os_file.type | FOLDER;
-	}
-	else
-	{
-	    /*
-	       char line[20];
-	       FILE *fr;    
-	       fr = fopen (dirrec->d_name, "rt"); 
-	       fgets(line, sizeof(line), fr);   
-	       fclose(fr);  
-	       string con=line;
-
-	       os_file.content=con.substr(0,con.size()-1);
-	     */
-	}
-
-
-
-
-	if (S_ISCHR (status.st_mode))
-	    os_file.type = os_file.type | CHARDEV;
-
-	if (S_ISBLK (status.st_mode))
-	    os_file.type = os_file.type | BLOCKDEV;
-
-	if (access (dirrec->d_name, X_OK) == 0)
-	    os_file.type = os_file.type | EXECUTABLE;
-    }
-
-
-
-
-
-    for (int i = 0; i < fieldsnum - 1; i++)
-    {
-
-	if (fields[i + 1] == "size")
-	    os_file.attrib.push_back(numtostring (os_file.size));
-	else if (fields[i + 1] == "owner")
-	   os_file.attrib.push_back(FXFile::owner (os_file.name.c_str ()).text ());
-	else if (fields[i + 1] == "group")
-	   os_file.attrib.push_back(FXFile::group (os_file.name.c_str ()).text ());
-	else if (fields[i + 1] == "accessed")
-	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::accessed (os_file.name.c_str ())).text ());
-	else if (fields[i + 1] == "created")
-	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::created (os_file.name.c_str ())).text ()); 
-	else if (fields[i + 1] == "modified")
- 	    os_file.attrib.push_back(FXFile::time ("%H:%M %d/%m/%y", FXFile::modified (os_file.name.c_str ())).text ());       
-	else if (fields[i + 1] == "mode")
-	{
-
-	    struct stat info;
-	    string str = "---------";
-	    if (lstat (os_file.name.c_str (), &info) == 0)
-	    {
-
-		(info.st_mode & S_IRUSR) ? str[0] = 'r' : str[0] = '-';
-		(info.st_mode & S_IWUSR) ? str[1] = 'w' : str[1] = '-';
-		(info.st_mode & S_IXUSR) ? str[2] = 'x' : str[2] = '-';
-		(info.st_mode & S_IRGRP) ? str[3] = 'r' : str[3] = '-';
-		(info.st_mode & S_IWGRP) ? str[4] = 'w' : str[4] = '-';
-		(info.st_mode & S_IXGRP) ? str[5] = 'x' : str[5] = '-';
-		(info.st_mode & S_IROTH) ? str[6] = 'r' : str[6] = '-';
-		(info.st_mode & S_IWOTH) ? str[7] = 'w' : str[7] = '-';
-		(info.st_mode & S_IXOTH) ? str[8] = 'x' : str[8] = '-';
-
-	    }
-
-
-	    os_file.attrib.push_back(str);
-
-	}
-
-    }
-
-
-
-    return os_file;
-
-
-}
-
-
-int filelist_local::osopendir (string dir)
-{
-    this->dir = dir;
-
-#ifndef WIN32
-    std::string line;
-    std::ifstream infile ("/etc/fstab");
-
-    while (std::getline (infile, line))
-    {
-
-	std::stringstream parser (line);
-	std::string command;
-	std::string field;
-	string partition;
-	parser >> partition;
-
-	string type;
-
-	if (partition[0] != '#')
-	{
-
-	    parser >> command;
-
-	    if (command == dir)
-	    {
-
-		parser >> type;
-		parser >> field;
-		string::size_type pos = field.find ("noauto", 0);
-		if (pos != string::npos)
-		{
-
-		    if (mount (partition.c_str (), command.c_str (), type.c_str (), MS_RDONLY, "") == 0)
-			FXTRACE ((5, "MOUNT\n"));
-
-		}
-	    }
-
-	}
-    }
-
-#endif
-
-    dp = opendir (dir.c_str ());
-    if (dp == NULL)
-	return -1;
-
-    chdir (dir.c_str ());
-
-
-}
-
-int filelist_local::mkdir (string dir, int mode)
-{
-    FXTRACE ((5, "MKDIR\n"));
-    string d = this->dir + SEPARATOR + dir;
-
-    return FXFile::createDirectory (d.c_str (), mode);
-    return 0;
-}
-
-int filelist_local::copy (thread_elem * te)
-{
-    copymove (te, true);
-}
-
-int filelist_local::move (thread_elem * te)
-{
-    copymove (te, false);
-}
-
-
-int filelist_local::remove (thread_elem * te)
-{
-
-    bool canc = false;
-
-    vector < string >::iterator iter;
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-  
-	if (!canc)
-	{
-
-	    string sr = (*iter);
-	    if (FXFile::isDirectory (sr.c_str ()))
-		sr.append (SEPARATOR);
-	    FXTRACE ((5, "REMOVE: %s", sr.c_str ()));
-
-	    if (OSFXFile::remove (sr.c_str (), te) == FALSE)
-		canc = true;
-		
-	}
-
-
-    }
-    if(canc)
-    {
-    te->error=true;
-    te->msg="operation failed";
-    }
-    
-
-
-}
-
-int filelist_local::rename (string orgname, string newname)
-{
-
-    FXString newfile = newname.c_str ();
-    FXString oldfile = orgname.c_str ();
-
-#ifndef WIN32
-    if (!FXFile::exists (oldfile))
-	return false;
-    if (FXFile::exists (newfile))
-    {
-	return false;
-
-    }
-
-    if (::rename (oldfile.text (), newfile.text ()) == 0)
-	return true;
-    if (errno != EXDEV)
-	return false;
-	
-#else
-    if (!FXFile::exists (oldfile))
-	return false;
-    if (FXFile::exists (newfile))
-    {
-	return false;
-
-    }
-
-    if (::MoveFile (oldfile.text (), newfile.text ()) != 0)
-	return true;
-#endif
-}
-
-
-int filelist_local::copymove (thread_elem * te, bool copy)
-{
-
-    unsigned long size = 0;
-
- 
-     vector < string >::iterator iter;
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-	string sr = (*iter);
-	if (FXFile::isDirectory (sr.c_str ()))
-	    sr.append (SEPARATOR);
-	totalsize (sr, size);
-
-    }
-
-    te->total_size = size;
-
-    bool canc = false;
-
-
-
-    for (iter = te->src.begin (); iter != te->src.end(); iter++)
-    {
-	if (!canc)
-	{
-	    string ds = te->dst;
-	    ds.append (SEPARATOR);
-	    ds.append (FXFile::name (iter->c_str ()).text ());
-
-
-	    string sr = (*iter);
-	    if (FXFile::isDirectory (sr.c_str ()))
-		sr.append (SEPARATOR);
-
-
-
-	    if (copy)
-	    {
-		if (OSFXFile::copy (sr.c_str (), ds.c_str (), te) == FALSE)
-		    canc = true;
-	    }
-	    else
-	    {
-		FXTRACE ((5, "MOVE;]"));
-		if (OSFXFile::move (sr.c_str (), ds.c_str (), te) == FALSE)
-		    canc = true;
-	    }
-
-	}
-
-    }
-    if(canc)
-    {
-    te->error=true;
-    te->msg="operation failed";
-    }
-
-}
-
-
-
-void filelist_local::totalsize (string path, unsigned long &size)
-{
-
-    if (FXFile::isDirectory (path.c_str ()))
-    {
-	struct stat status;
-	struct dirent *dp;
-	DIR *dirp;
-
-
-	dirp = opendir (path.c_str ());
-
-	while ((dp = readdir (dirp)) != NULL)
-	{
-	    if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-	    {
-
-		string file = path;
-		file.append (dp->d_name);
-#ifndef WIN32
-		lstat (file.c_str (), &status);
-#else
-		stat (file.c_str (), &status);
-#endif
-		if (S_ISDIR (status.st_mode))
-		{
-		    size = size + (unsigned int) status.st_size;
-		    file.append ("/");
-		    totalsize (file, size);
-
-		}
-		else
-		{
-		    size = size + status.st_size;
-		}
-	    }
-	}
-
-	closedir (dirp);
-    }
-    else
-    {
-	size += FXFile::size (path.c_str ());
-
-    }
-
-}
-
-string filelist_local::info (void)
-{
-    return "";
-}
-
-
-int filelist_local::mode (string file)
-{
-    struct stat status;
-    return !file.empty () && (::stat (file.c_str (), &status) == 0) ? status.st_mode : 0;
-}
-
-bool filelist_local::mode (string file, unsigned int mod, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-	return FXFile::mode (file.c_str (), mod);
-    }
-    else
-    {
-	FXFile::mode (file.c_str (), mod);
-	string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    string file = path;
-		    file.append (dp->d_name);
-		    mode (file, mod, true);
-
-		}
-	    }
-
-	    closedir (dirp);
-	}
-
-
-    }
-}
-
-string filelist_local::owner (string file)
-{
-    return FXFile::owner (file.c_str ()).text ();
-}
-string filelist_local::group (string file)
-{
-    return FXFile::group (file.c_str ()).text ();
-}
-
-bool filelist_local::owner (string file, string ownername, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-
-
-	passwd *p = getpwnam (ownername.c_str ());
-	return chown (file.c_str (), p->pw_uid, -1);
-
-    }
-    else
-    {
-	passwd *p = getpwnam (ownername.c_str ());
-	chown (file.c_str (), p->pw_uid, -1);
-
-	string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    string file = path;
-		    file.append (dp->d_name);
-		    owner (file, ownername, true);
-
-		}
-	    }
-
-	    closedir (dirp);
-	}
-
-
-    }
-}
-
-bool filelist_local::group (string file, string groupname, bool recursive)
-{
-    FXTRACE ((5, "MODE"));
-    if (!recursive)
-    {
-	::group * grp = getgrnam (groupname.c_str ());
-	return chown (file.c_str (), -1, grp->gr_gid);
-
-
-    }
-    else
-    {
-	::group * grp = getgrnam (groupname.c_str ());
-	chown (file.c_str (), -1, grp->gr_gid);
-	string path = file + SEPARATOR;
-
-	if (FXFile::isDirectory (path.c_str ()))
-	{
-
-	    struct stat status;
-	    struct dirent *dp;
-	    DIR *dirp;
-
-
-	    dirp = opendir (path.c_str ());
-
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-
-		    string file = path;
-		    file.append (dp->d_name);
-		    group (file, groupname, true);
-
-		}
-	    }
-
-	    closedir (dirp);
-	}
-
-
-    }
-}
-
-string filelist_local::symlink (string path)
-{
-    return FXFile::symlink (path.c_str ()).text ();
-}
-bool filelist_local::symlink (string src, string dst)
-{
-    return FXFile::symlink (src.c_str (), dst.c_str ());
-}
-bool filelist_local::hardlink (string src, string dst)
-{
-    return FXFile::link (src.c_str (), dst.c_str ());
-}
-
-
-int filelist_local::quit (void)
-{
-    return 0;
-}
-
-EXPORTFUNCTION filelist_base *get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN LOAD\n"));
-    return new filelist_local ();
-}

Deleted: trunk/src/plugins/filelist/filelist_local.h
===================================================================
--- trunk/src/plugins/filelist/filelist_local.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_local.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,56 +0,0 @@
-#ifndef FILELIST_LOCAL
-#define FILELIST_LOCAL
-
-#include"../../filelist_base.h"
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <dirent.h>
-#include <unistd.h>
-
-
-
-
-class filelist_local:public filelist_base
-{
-
-private:
-
-    DIR *dp;
-    dirent *dirrec;
-    struct stat status;
-    string dir;
-    string display_size;
-    int fieldsnum;
-     vector < string > fields;
-
-int copymove (thread_elem * te, bool copy = true);
-
-  public:
-
-    int osopendir (string dir);
-    osfile osreaddir (void);
-    int mkdir (string dir, int mode);
-    int copy (thread_elem * te);
-    int move (thread_elem * te);
-    int remove (thread_elem * te);
-    int rename (string orgname, string newname);
-    int init (vector < string > *vector_name, pathtype pt, configure * conf);
-    int mode (string file);
-    string owner (string file);
-    string group (string file);
-    bool mode (string file, unsigned int, bool recursive = false);
-    bool owner (string file, string ownername, bool recursive = false);
-    bool group (string file, string groupname, bool recursive = false);
-    string info (void);
-    int quit (void);
-    string symlink (string path);
-    bool symlink (string src, string dst);
-    bool hardlink (string src, string dst);
-    vfs setup (void);
-    void totalsize (string path, unsigned long &size);
-    
-};
-
-
-#endif

Modified: trunk/src/plugins/filelist/filelist_scp.cpp
===================================================================
--- trunk/src/plugins/filelist/filelist_scp.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_scp.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -7,7 +7,7 @@
 
 #include <fx.h>
 #include "filelist_scp.h"
-#include "../../sharedobjects.h"
+#include "../../OSObjectManager.h"
 
 
 #include <fstream>


Property changes on: trunk/src/plugins/filelist/filelist_scp.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/plugins/filelist/filelist_scp.h
===================================================================
--- trunk/src/plugins/filelist/filelist_scp.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_scp.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,7 +1,7 @@
 #ifndef FILELIST_SCP
 #define FILELIST_SCP
 
-#include"../../filelist_base.h"
+#include"../../OSVirtualFileSystemBase.h"
 
 #include <stdio.h>
 
@@ -12,49 +12,44 @@
 #include <iostream>
 
 
-
-
 class filelist_scp:public filelist_base
 {
-    string dir;
-    string display_size;
-    int fieldsnum;
-    string *fields;
+  string dir;
+  string display_size;
+  int fieldsnum;
+  string *fields;
 
+  int p[2];
+  int o[2];
 
-    int p[2];
-    int o[2];
+  char readbuffer[20];
 
-    char readbuffer[20];
+  int nbytes;
+  int end;
+  string prompt;
 
-    int nbytes;
+public:
 
-    int end;
+  int osopendir (string dir);
+  osfile osreaddir (void);
+  int mkdir (string dir, int mode);
+  int copy (thread_elem * te);
+  int move (thread_elem * te);
+  int remove (thread_elem * te);
+  int rename (string orgname, string newname);
+  int init (string ** name, unsigned int **type, unsigned int **width,
+	    pathtype pt, configure * conf);
+  unsigned int mode (string file);
+  bool mode (string file, unsigned int, bool recursive = false);
+  string info (void);
+  int quit (void);
 
-    string prompt;
+  void totalsize (string path, unsigned long &size);
+  int copymove (thread_elem * te, bool copy = true);
 
+  bool getprompt (void);
 
-  public:
 
-    int osopendir (string dir);
-    osfile osreaddir (void);
-    int mkdir (string dir, int mode);
-    int copy (thread_elem * te);
-    int move (thread_elem * te);
-    int remove (thread_elem * te);
-    int rename (string orgname, string newname);
-    int init (string ** name, unsigned int **type, unsigned int **width, pathtype pt, configure * conf);
-    unsigned int mode (string file);
-    bool mode (string file, unsigned int, bool recursive = false);
-    string info (void);
-    int quit (void);
-
-    void totalsize (string path, unsigned long &size);
-    int copymove (thread_elem * te, bool copy = true);
-
-    bool getprompt (void);
-
-
 };
 
 


Property changes on: trunk/src/plugins/filelist/filelist_scp.h
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/plugins/filelist/filelist_search.cpp
===================================================================
--- trunk/src/plugins/filelist/filelist_search.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_search.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,180 +0,0 @@
-#ifdef WIN32
-#define EXPORTFUNCTION extern "C" __declspec(dllexport)
-#else
-#define EXPORTFUNCTION extern "C"
-#endif
-#include "filelist_search.h"
-
-vfs filelist_search::setup (void)
-{
-	vfs v;
-	
-	v.vfsheaders.push_back(vfsheader_container("name"));
-	v.information="search vfs - default plugin";
-	v.version="1";
-	v.type="search";
-return v;	
-	
-}
-
-
-int filelist_search::osopendir (string dir)
-{
-
-  iter=files.begin(); 
-
-}
-osfile filelist_search::osreaddir (void)
-{
-    osfile os_file;
-
-if(iter!=files.end())
-{
-
-	    os_file.type = 0;
-	    os_file.name = *iter;
-	    os_file.size = 300;
-	
-	    iter++;
-	 
-	    return os_file;
-}		    
-
-
-    
-    os_file.name = "";
-    return os_file;
-    
-
-
-}
-int filelist_search::mkdir (string dir, int mode)
-{
-}
-int filelist_search::copy (thread_elem * te)
-{
-
-	string::size_type pos = te->options.find ("download");
-	if (pos == string::npos) //upload only supported
-	{
-	return fil_local->copy(te);
-	}
-	else
-	{
-	 te->error=true;
-         te->msg="operation not allowed";
-	}
-
-}
-int filelist_search::move (thread_elem * te)
-{
-
-	string::size_type pos = te->options.find ("download");
-	if (pos == string::npos) //upload only supported
-	{
-	return fil_local->move(te);
-	}
-	else
-	{
-	 te->error=true;
-         te->msg="operation not allowed";
-	}
-
-}
-int filelist_search::remove (thread_elem * te)
-{
-return fil_local->remove(te);
-}
-int filelist_search::rename (string orgname, string newname)
-{
-
-	int ret=fil_local->rename(orgname,newname);
-	if(ret)
-	{
-		vector < string >::iterator iter = find(files.begin(), files.end(), orgname.substr(1,orgname.length()-1)); // Search the list.
-		if (iter != files.end())
-		{
-  		(*iter)=newname.substr(1,newname.length()-1);
-		}
-	}
-
-	return ret;
-}
-int filelist_search::init (vector < string > *vector_name, pathtype pt, configure * conf)
-{
-
-
-fil_local=new filelist_local();
-
-
-    pipe = popen (pt.server.c_str(), "r");
-
-    if (pipe != NULL)
-    {
-	string line;
-	while (fgets (readbuf, sizeof (readbuf), pipe) != NULL)
-	{
-
-
-	    string path = readbuf;
-	    path = path.substr (1, path.length () - 2);
-	    files.push_back(path);
-	   
-	}
-
-	pclose (pipe);
-    }
-    
-iter=files.begin();
-    
-
-}
-int filelist_search::mode (string file)
-{
-return fil_local->mode(file);
-}
-string filelist_search::owner (string file)
-{
-return fil_local->owner(file);
-}
-string filelist_search::group (string file)
-{
-return fil_local->group(file);
-}
-bool filelist_search::mode (string file, unsigned int mod, bool recursive)
-{
-return fil_local->mode(file,mod,recursive);
-}
-bool filelist_search::owner (string file, string ow, bool recursive)
-{
-return fil_local->owner(file,ow,recursive);
-}
-bool filelist_search::group (string file, string gr, bool recursive)
-{
-return fil_local->group(file,gr,recursive);
-}
-string filelist_search::info (void)
-{
-return "";
-}
-void filelist_search::totalsize (string path, unsigned long &size)
-{
-}
-string filelist_search::symlink (string path)
-{
-}
-bool filelist_search::symlink (string src, string dst)
-{
-}
-bool filelist_search::hardlink (string src, string dst)
-{
-}
-
-int filelist_search::quit (void)
-{
-}
-EXPORTFUNCTION filelist_base *get_filelist (void)
-{
-    FXTRACE ((5, "PLUGIN SEARCH LOAD\n"));
-    return new filelist_search ();
-}

Deleted: trunk/src/plugins/filelist/filelist_search.h
===================================================================
--- trunk/src/plugins/filelist/filelist_search.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_search.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,42 +0,0 @@
-#ifndef FILELIST_search
-#define FILELIST_search
-#include "../../filelist_base.h"
-#include "filelist_local.h"
-
-class filelist_search:public filelist_base
-{
-  
-private:
-  
-  FILE *pipe;
-  char readbuf[1024];
-  vector < string > files;
-  vector < string >::iterator iter;
-
-  filelist_local *fil_local;
-  
-public:
-  
-    int filelist_search::osopendir (string dir);
-    osfile filelist_search::osreaddir (void);
-    int filelist_search::mkdir (string dir, int mode = 0);
-    int filelist_search::copy (thread_elem * te);
-    int filelist_search::move (thread_elem * te);
-    int filelist_search::remove (thread_elem * te);
-    int filelist_search::rename (string orgname, string newname);
-    int filelist_search::init (vector < string > *vector_name, pathtype pt, configure * conf);
-    int filelist_search::mode (string file);
-    string filelist_search::owner (string file);
-    string filelist_search::group (string file);
-    bool filelist_search::mode (string file, unsigned int, bool recursive);
-    bool filelist_search::owner (string file, string, bool recursive);
-    bool filelist_search::group (string file, string, bool recursive);
-    string filelist_search::info (void);
-    void filelist_search::totalsize (string path, unsigned long &size);
-    string filelist_search::symlink (string path);
-    bool filelist_search::symlink (string src, string dst);
-    bool filelist_search::hardlink (string src, string dst);
-    vfs filelist_search::setup (void);
-    int filelist_search::quit (void);
-};
-#endif


Property changes on: trunk/src/plugins/filelist/filelist_sftp.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/plugins/filelist/filelist_sftp.h
===================================================================
--- trunk/src/plugins/filelist/filelist_sftp.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/filelist_sftp.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,6 +1,6 @@
 #ifndef FILELIST_sftp
 #define FILELIST_sftp
-#include "../../filelist_base.h"
+#include "../../OSVirtualFileSystemBase.h"
 class filelist_sftp:public filelist_base
 {
     string dir;  


Property changes on: trunk/src/plugins/filelist/filelist_sftp.h
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/src/plugins/filelist/pftp.cpp
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/src/plugins/filelist/pftp.h
===================================================================
--- trunk/src/plugins/filelist/pftp.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/plugins/filelist/pftp.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,5 +1,5 @@
 /* pftp.h : passive-capable FTP class.
-   Copyright 2002 Mr. Tines <Tines at RavnaAndTines.com>
+  Copyright 2002 Mr. Tines <Tines at RavnaAndTines.com>
 
 This program is free software; you can redistribute it and/or modify it
 under the terms of the GNU Library General Public License as published by the
@@ -27,7 +27,8 @@
 #endif
 
 
-namespace FX {
+namespace FX
+{
     class FXString;
     class FXMemoryStream;
 }
@@ -55,45 +56,61 @@
 
 #define PASSIVE_FTP_PRODUCT_VERSION "1.7.1955.38236"
 
-class Logger {
+/**
+ * Logger class.
+ * 
+ * @todo Add virtual destructor - this class is a base class!
+ */
+class Logger
+{
 public:
-    virtual void start(uint32_t bytes, const FXString & name,uint32_t size=0) = 0;
-    virtual bool update(uint32_t bytes, const FXString & name) = 0;
-    virtual void end(uint32_t bytes, const FXString & name) = 0;
-    virtual void error(int error) = 0;
-    virtual void error(FXString & error) = 0;
+    virtual void start( uint32_t bytes, const FXString & name, uint32_t size = 0 ) = 0;
+    virtual bool update( uint32_t bytes, const FXString & name ) = 0;
+    virtual void end( uint32_t bytes, const FXString & name ) = 0;
+    virtual void error( int error ) = 0;
+    virtual void error( FXString & error ) = 0;
     virtual void choke() = 0;
-    virtual void logLine(FXString & line) = 0;
+    virtual void logLine( FXString & line ) = 0;
 };
 
-class PFTP 
+/**
+ * FTP class.
+ */
+class PFTP
 {
 public:
-    PFTP(const FXString & server, const FXString & user, const FXString & pass, const FXString & proxy, Logger * feedback);
+    
+    /**
+     * Constructor.
+     */
+    PFTP( const FXString& server, const FXString& user, const FXString& pass, const FXString& proxy, Logger* feedback );
 
+    /**
+     * Destructor.
+     */
+    ~PFTP( void );
+    
     // need to provide a feedback callback
-    void download(const FXString & file,FXString dst, bool asc=false);
-    void upload(const FXString & file, int throttle, bool asc=false);
+    void download( const FXString & file, FXString dst, bool asc = false );
+    void upload( const FXString & file, int throttle, bool asc = false );
 
-    void setDir(const FXString & dir);
-    void mkDir(const FXString & dir);
-    void del(const FXString & file);
-    void rmDir(const FXString & dir);
-    void pwd(FXString & dir);
-    void list(FXMemoryStream & stream);
-    void nlist(FXMemoryStream & stream);
-    void logout(void);
+    void setDir( const FXString & dir );
+    void mkDir( const FXString & dir );
+    void del( const FXString & file );
+    void rmDir( const FXString & dir );
+    void pwd( FXString & dir );
+    void list( FXMemoryStream & stream );
+    void nlist( FXMemoryStream & stream );
+    void logout( void );
 
     bool isConnected() const;
 
-    ~PFTP();
+    void sendCmd( const FXString cmd, const FXString & value, FXString & response );
 
-void sendCmd(const FXString cmd, const FXString & value, FXString & response);
-
-
 private:
 
-    enum {
+    enum
+    {
         CNTRL_PORT = 21,
         BUCKET = 4096
     };
@@ -103,32 +120,30 @@
     SOCKET dsock;
 
     bool pauser;  // it's a hack. We're going to
-          // stall (refuse further requests) till we get a reply back
-          // from server for the current request.
+    // stall (refuse further requests) till we get a reply back
+    // from server for the current request.
 
-    char lineBuffer[BUCKET];
+    char lineBuffer[ BUCKET ];
     int buffered;
-	char * proxyServer;
-	int proxyPort;
+    char * proxyServer;
+    int proxyPort;
 
 
-    int connect(const FXString & server);
-    void getAsBytes(const FXString & file, SOCKET sock, FXMemoryStream & buffer);
-    void login(const FXString & user, const FXString & pass);
-    void setTransferType(bool asc);
+    int connect( const FXString & server );
+    void getAsBytes( const FXString & file, SOCKET sock, FXMemoryStream & buffer );
+    void login( const FXString & user, const FXString & pass );
+    void setTransferType( bool asc );
 
-    void getDataSock(void);
-    
-    void responseHandler(const FXString & cmd, FXString & result);
+    void getDataSock( void );
 
+    void responseHandler( const FXString & cmd, FXString & result );
+
     // responseParser: check first digit of first line of response
     // and take action based on it; set up to read an extra line
     // if the response starts with "1"
-    bool responseParser(const FXString & resp);
-    void readLine(FXString & line, bool pureFTP=true);
+    bool responseParser( const FXString & resp );
+    void readLine( FXString & line, bool pureFTP = true );
 
-
 };
 
 #endif
-


Property changes on: trunk/src/plugins/filelist/pftp.h
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/src/preferences.cpp
===================================================================
--- trunk/src/preferences.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/preferences.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,2158 +0,0 @@
-#include "fx.h"
-#include "preferences.h"
-#include "MimeType.h"
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <dirent.h>
-#include <stdlib.h>
-
-#include "FXDLL.h"
-#include "filelist_base.h"
-#include <fstream>
-#include <sstream>
-#include "config.h"
-
-FXDEFMAP (preferences) preferencesMap[] =
-{
-    //________Message_Type_____________________ID____________Message_Handler_______  
-	//FXMAPFUNC (SEL_COMMAND, preferences::ID_SAVE, preferences::onSave),
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_COMMAND_CHANGE, preferences::onCommandChange),
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_FILETYPE_CHANGE, preferences::onFileTypeChange), 
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_SHUTTER_CHANGE, preferences::onShutterChange),	
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_TOOLBAR_CHANGE, preferences::onToolbarChange),
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_VFS_CHANGE, preferences::onVfsChange),	
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_NEW_COMMAND, preferences::onNewCommand), 
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_REMOVE_COMMAND, preferences::onRemoveCommand),
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_NEW_SHUTTER, preferences::onNewShutter), 
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_REMOVE_SHUTTER, preferences::onRemoveShutter),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_MIME_APP, preferences::ID_MIME_APP_AUTO, preferences::onOpenMimeApp),
-	FXMAPFUNC (SEL_COMMAND, preferences::ID_ADD_FILETYPE, preferences::onAddFiletype),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_CHOOSE_COLOR,preferences::ID_CHOOSE_BACKCOLOR, preferences::onChooseColor),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_ADD_COMMAND_ADDITIONAL,preferences::ID_DEL_COMMAND_ADDITIONAL, preferences::onAdditionalCommandChange),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_ADD_BUTTON_COMMAND,preferences::ID_DEL_BUTTON_COMMAND, preferences::onAddButtonCommand),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_ADD_SHUTTER_COMMAND,preferences::ID_DEL_SHUTTER_COMMAND, preferences::onAddShutterCommand),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_ADD_HEADER,preferences::ID_DEL_HEADER, preferences::onAddHeader),
-	FXMAPFUNC(SEL_CLOSE,0,preferences::close),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_DOWNLOAD_INSTALL_CMD_PLUGIN,preferences::ID_DOWNLOAD_INSTALL_VFS_PLUGIN, preferences::downloadInstallPlugin),
-	FXMAPFUNCS (SEL_COMMAND, preferences::ID_UPDATE_CMD_PLUGIN_LIST,preferences::ID_UPDATE_VFS_PLUGIN_LIST, preferences::updatePluginList),
-	FXMAPFUNC(SEL_COMMAND,preferences::ID_COLORS,preferences::onColorChanged),
-	FXMAPFUNC(SEL_CHANGED,preferences::ID_COLORS,preferences::onColorChanged),
-	FXMAPFUNCS(SEL_COMMAND,preferences::ID_CHOOSE_FONT,preferences::ID_CHOOSE_CAPTIONFONT3,preferences::onChooseFont),
-	FXMAPFUNC(SEL_COMMAND,preferences::ID_UPDATE_WINDOW_SIZE,preferences::updateWindowSize),
-	FXMAPFUNCS(SEL_COMMAND,preferences::ID_UP_BUTTON_COMMAND,preferences::ID_DOWN_SHUTTER_COMMAND,preferences::onUpDown),
-	FXMAPFUNCS(SEL_COMMAND,preferences::ID_UP_VFS_HEADER,preferences::ID_DOWN_VFS_HEADER,preferences::onUpDownVfsHeader),
-	FXMAPFUNCS(SEL_COMMAND,preferences::ID_UP_COMMAND,preferences::ID_DOWN_COMMAND,preferences::onUpDownCommand),
-
-	
-	
-	
-};
-
-
-FXIMPLEMENT (preferences, FXDialogBox, preferencesMap, ARRAYNUMBER (preferencesMap))
-
-long preferences::onUpDownCommand(FXObject * sender, FXSelector sel, void *)
-{
-if(additionalCommands->getNumItems ()==0)
-return 0;
-
-FXushort id=FXSELID(sel);
-	if(id==ID_UP_COMMAND)
-	{
-		if(additionalCommands->getCurrentItem()!=0)
-		additionalCommands->moveItem(additionalCommands->getCurrentItem()-1,additionalCommands->getCurrentItem());
-	}
-	else
-	{
-		if(additionalCommands->getCurrentItem()!=additionalCommands->getNumItems ()-1)
-		additionalCommands->moveItem(additionalCommands->getCurrentItem()+1,additionalCommands->getCurrentItem());
-	}
-
-filetype_container *ct_prev=&filetypesMap[currentFileType];
-ct_prev->commands.clear();
-
-	for (int i = 0; i < additionalCommands->getNumItems (); i++)
-	{
-	ct_prev->commands.push_back(additionalCommands->getItemText(i).text());
-	}
-
-
-
-}
-
-long preferences::onUpDownVfsHeader(FXObject * sender, FXSelector sel, void *)
-{
-
-if(headersList->getNumItems ()==0)
-return 0;
-
-	FXushort id=FXSELID(sel);
-	if(id==ID_UP_VFS_HEADER)
-	{
-		if(headersList->getCurrentItem()!=0)
-		headersList->moveItem(headersList->getCurrentItem()-1,headersList->getCurrentItem());
-	}
-	else
-	{
-		if(headersList->getCurrentItem()!=headersList->getNumItems ()-1)
-		headersList->moveItem(headersList->getCurrentItem()+1,headersList->getCurrentItem());
-	}
-
-this->onVfsChange(NULL,0,NULL);
-
-}
-
-long preferences::onUpDown(FXObject * sender, FXSelector sel, void *)
-{
-
-
-
-
-FXList*updownlist;
-FXListBox * box;
-bool up;
-
-FXushort id=FXSELID(sel);
-if(id==ID_UP_BUTTON_COMMAND)
-{
-updownlist=buttonsList;
-box=toolbarList;
-up=true;
-}
-else if(id==ID_DOWN_BUTTON_COMMAND)
-{
-updownlist=buttonsList;
-box=toolbarList;
-up=false;
-}
-else if(id==ID_UP_SHUTTER_COMMAND)
-{
-updownlist=shutterCommands;
-box=shutterList;
-up=true;
-}
-else if(id==ID_DOWN_SHUTTER_COMMAND)
-{
-updownlist=shutterCommands;
-box=shutterList;
-up=false;
-}
-
-if(updownlist->getNumItems ()==0)
-return 0;
-
-	if(up)
-	{
-		if(updownlist->getCurrentItem()!=0)
-		updownlist->moveItem(updownlist->getCurrentItem()-1,updownlist->getCurrentItem());
-	}
-	else
-	{
-		if(updownlist->getCurrentItem()!=updownlist->getNumItems ()-1)
-		updownlist->moveItem(updownlist->getCurrentItem()+1,updownlist->getCurrentItem());
-	}
-
-string actual_box=box->getItem(box->getCurrentItem()).text();
-
-if(id==ID_UP_BUTTON_COMMAND || id==ID_DOWN_BUTTON_COMMAND )
-{
-	vector <toolbar_container>::iterator iter;	
-	for(iter=toolbarVector.begin();iter!=toolbarVector.end(); iter++)
-		{
-			if(iter->toolbar==actual_box)
-			{
-			toolbarVector.erase(iter);
-			iter=toolbarVector.begin();
-			}
-		}
-			
-	for (int i = 0; i < updownlist->getNumItems (); i++)
-	{
-	string cmd=updownlist->getItem(i)->getText().text();
-	toolbarVector.push_back(toolbar_container(actual_box,cmd));
-	}
-}	
-else if(id==ID_DOWN_SHUTTER_COMMAND || id==ID_UP_SHUTTER_COMMAND )
-{
-	vector <shutter_container>::iterator iter;	
-	for(iter=shutterVector.begin();iter!=shutterVector.end(); iter++)
-		{
-			if(iter->shutter==actual_box)
-			{
-			shutterVector.erase(iter);
-			iter=shutterVector.begin();
-			}
-		}
-			
-	for (int i = 0; i < updownlist->getNumItems (); i++)
-	{
-	string cmd=updownlist->getItem(i)->getText().text();
-	shutterVector.push_back(shutter_container(actual_box,cmd));
-	}
-}	
-	
-}
-
-
-long preferences::updateWindowSize(FXObject * sender, FXSelector sel, void *)
-{
-mainwindow_width->setValue(getOwner ()->getWidth());
-mainwindow_height->setValue(getOwner ()->getHeight());
-}
-
-preferences::preferences (FXWindow * owner):FXDialogBox (owner, "Preferences", DECOR_ALL, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4)
-{
-
-objmanager=objectmanager::instance(getApp());
-  getApp()->getNormalFont()->create();
-  FXFontDesc fontdescription;
-  getApp()->getNormalFont()->getFontDesc(fontdescription);
-
-  font[0] = new FXFont(getApp(),fontdescription);
-  font[0]->create();
-  objmanager->captionfont1->getFontDesc(fontdescription);
-  font[1]= new FXFont(getApp(),fontdescription);
-  font[1]->create();
-  objmanager->captionfont2->getFontDesc(fontdescription);
-  font[2]= new FXFont(getApp(),fontdescription);
-  font[2]->create();
-   objmanager->captionfont3->getFontDesc(fontdescription);
-  font[3]= new FXFont(getApp(),fontdescription);
-  font[3]->create();
-  
-  typingSpeed =getApp()->getTypingSpeed();
-  clickSpeed  =getApp()->getClickSpeed();
-  scrollSpeed =getApp()->getScrollSpeed();
-  scrollDelay =getApp()->getScrollDelay();
-  blinkSpeed  =getApp()->getBlinkSpeed();
-  animSpeed   =getApp()->getAnimSpeed();
-  menuPause   =getApp()->getMenuPause();
-  tooltipPause=getApp()->getTooltipPause();
-  tooltipTime =getApp()->getTooltipTime();
-  dragDelta   =getApp()->getDragDelta();
-  wheelLines  =getApp()->getWheelLines();
-
-
-  target_typingspeed.connect(typingSpeed);
-  target_clickspeed.connect(clickSpeed);
-  target_scrollspeed.connect(scrollSpeed);
-  target_scrolldelay.connect(scrollDelay);
-  target_blinkspeed.connect(blinkSpeed);
-  target_animspeed.connect(animSpeed);
-  target_menupause.connect(menuPause);
-  target_tooltippause.connect(tooltipPause);
-  target_tooltiptime.connect(tooltipTime);
-  target_dragdelta.connect(dragDelta);
-  target_wheellines.connect(wheelLines);
-
-   tooltip = new FXToolTip(getApp());
-
-  /// Retrieve Current Color Settings
-  hilite  = getApp()->getHiliteColor();
-  shadow  = getApp()->getShadowColor();  
-  base    = getApp()->getBaseColor();
-  back    = getApp()->getBackColor();
-  border  = getApp()->getBorderColor();
-  fore    = getApp()->getForeColor();
-  selfore = getApp()->getSelforeColor();
-  selback = getApp()->getSelbackColor();
-  tipfore = getApp()->getTipforeColor();
-  tipback = getApp()->getTipbackColor();
-  menufore= getApp()->getSelMenuTextColor();
-  menuback= getApp()->getSelMenuBackColor();
-  main=fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/main").c_str());
-  
-  target_base.connect(base);
-  target_back.connect(back);
-  target_border.connect(border);
-  target_fore.connect(fore);
-  target_hilite.connect(hilite);
-  target_shadow.connect(shadow);
-  target_selfore.connect(selfore);
-  target_selback.connect(selback);
-  target_tipfore.connect(tipfore);
-  target_tipback.connect(tipback);
-  target_menufore.connect(menufore);
-  target_menuback.connect(menuback);  
-  target_main.connect(main);
-
-  target_base.setTarget(this);
-  target_back.setTarget(this);
-  target_border.setTarget(this);
-  target_fore.setTarget(this);
-  target_hilite.setTarget(this);
-  target_shadow.setTarget(this);
-  target_selfore.setTarget(this);
-  target_selback.setTarget(this);
-  target_tipfore.setTarget(this);
-  target_tipback.setTarget(this);
-  target_menufore.setTarget(this);
-  target_menuback.setTarget(this);
-  target_main.setTarget(this);
-
-  target_base.setSelector(ID_COLORS);
-  target_back.setSelector(ID_COLORS);
-  target_border.setSelector(ID_COLORS);
-  target_fore.setSelector(ID_COLORS);
-  target_hilite.setSelector(ID_COLORS);
-  target_shadow.setSelector(ID_COLORS);
-  target_selfore.setSelector(ID_COLORS);
-  target_selback.setSelector(ID_COLORS);
-  target_tipfore.setSelector(ID_COLORS);
-  target_tipback.setSelector(ID_COLORS);
-  target_menufore.setSelector(ID_COLORS);
-  target_menuback.setSelector(ID_COLORS);
-  target_main.setSelector(ID_COLORS);
-
-    mimeapp=NULL;
-    saveconfiguration=true;
-
-    
-    colordlg=new FXColorDialog(this,"Color Dialog");
-    
-    FXVerticalFrame *vertical = new FXVerticalFrame (this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXHorizontalFrame *horizontal = new FXHorizontalFrame (vertical, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-    FXVerticalFrame *buttons = new FXVerticalFrame (horizontal, LAYOUT_LEFT | LAYOUT_FILL_Y | FRAME_SUNKEN | PACK_UNIFORM_WIDTH | LAYOUT_FIX_HEIGHT, 0, 0, 0, 500, 0, 0, 0, 0, 0, 0);
-    FXSwitcher *switcher = new FXSwitcher (horizontal, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0);
-
-
-    FXVerticalFrame *mainpane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-
-    new FXButton (buttons, "Main Settings", NULL, switcher, FXSwitcher::ID_OPEN_FIRST, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-    new FXLabel (mainpane, "Let program to autoconfigure file type associacion settings");
-    FXHorizontalFrame *hoz1 = new FXHorizontalFrame (mainpane, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXButton (hoz1, "Semi-Auto configure", NULL, this, preferences::ID_MIME_APP);
-    new FXButton (hoz1, "Full-Auto configure", NULL, this, preferences::ID_MIME_APP_AUTO);
-    new	FXSeparator(mainpane);
-    
-
-    
-    FXHorizontalFrame *hoz2 = new FXHorizontalFrame (mainpane, LAYOUT_FILL_X);
-    new FXLabel (hoz2, "width:");
-    mainwindow_width=new FXSpinner(hoz2,4);
-    mainwindow_width->setRange(1,2000);
-    mainwindow_width->setIncrement(1);
-    mainwindow_width->setValue(atoi(conf->readonestring ("/OpenspaceConfig/mainwindow/width").c_str ()));
-    new FXLabel (hoz2, "height:");
-    mainwindow_height=new FXSpinner(hoz2,4);
-    mainwindow_height->setRange(1,2000);
-    mainwindow_height->setIncrement(1);
-    mainwindow_height->setValue(atoi(conf->readonestring ("/OpenspaceConfig/mainwindow/height").c_str ()));
-    
-    new FXButton (hoz2, "get current openspace size", NULL, this, preferences:: ID_UPDATE_WINDOW_SIZE);
-   
-    new	FXSeparator(mainpane);
-    
-    new FXLabel (mainpane, "left directory:");
-    leftdir = new FXTextField (mainpane, 50);
-    leftdir->setText(conf->readonestring ("/OpenspaceConfig/leftdir/dir").c_str ());
-
-    new FXLabel (mainpane, "right directory (in single directory window mode this is default window):");
-    rightdir = new FXTextField (mainpane, 50);
-    rightdir->setText(conf->readonestring ("/OpenspaceConfig/rightdir/dir").c_str ());
-    
-    new FXLabel (mainpane, "default new opened directory:");
-    defaultdir = new FXTextField (mainpane, 50);
-    defaultdir->setText(conf->readonestring ("/OpenspaceConfig/defaultdir/dir").c_str ());
-    
-    new	FXSeparator(mainpane);
-    
-    new FXLabel (mainpane, "maximum size of image file for generating thumbnails (in Bytes)");
-    
-    thumbsize=new FXSpinner(mainpane,8);
-    thumbsize->setRange(0,10000000);
-    thumbsize->setIncrement(1000);
-    thumbsize->setValue(atoi(conf->readonestring ("/OpenspaceConfig/filelist/local/thumbs/size").c_str ()));
-    
-    new FXLabel (mainpane, "icons theme:");
-    iconsTheme=new FXListBox (mainpane);
-    iconsTheme->setNumVisible(5);
-
-    new FXLabel (mainpane, "openspace placement on startup");
-    placement=new FXListBox (mainpane);
-    placement->setNumVisible(2);
-    placement->appendItem("centered");
-    placement->appendItem("cursor");
-
- string iconsdir=conf->readonestring ("/OpenspaceConfig/path") +"/icons";
-	    struct dirent *dp;
-	    DIR *dirp;
-dirp = opendir (iconsdir.c_str ());
-	    if(dirp)
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-		string name=dp->d_name;
-		iconsTheme->appendItem(name.c_str());   
-		}
-	    }
-	    closedir (dirp);
-iconsdir=FXFile::getUserDirectory ("").text () +string("/.openspace/icons");
-
-dirp = opendir (iconsdir.c_str ());
-	    if(dirp)
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-		string name=dp->d_name;
-		iconsTheme->appendItem(name.c_str());   
-		}
-	    }
-	    closedir (dirp);
-
-iconsTheme->setCurrentItem(iconsTheme->findItem(conf->readonestring ("/OpenspaceConfig/icons_theme").c_str()));
-
-
-
-
-//======================================================BUTTONS===========================================================
-
- FXVerticalFrame *buttonsPane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-   
-    new FXButton (buttons, "Menu and Buttons Settings", NULL, switcher, FXSwitcher::ID_OPEN_SECOND, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
- new FXLabel (buttonsPane, "Buttons in configurable toolbox:", NULL, LAYOUT_LEFT);
-
-	toolbarList=new FXListBox (buttonsPane, this, ID_TOOLBAR_CHANGE);
-        toolbarList->setNumVisible(10);
-
-FXHorizontalFrame *hfx = new FXHorizontalFrame (buttonsPane,LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-
-	buttonsList=new FXList (hfx,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	buttonsList->setNumVisible(5);
-
- 	new FXLabel(hfx," ");
-	new FXArrowButton(hfx,this,ID_UP_BUTTON_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-	new FXArrowButton(hfx,this,ID_DOWN_BUTTON_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_DOWN);   
-	       	
-	     if(conf->openxpath("/OpenspaceConfig/toolbars")!=-1)
-	       {
-	       string commandstr;
-	      	 while(conf->getnextnode(commandstr))
-	      	 {     	 
-	     	 toolbarList->appendItem(commandstr.c_str());
-		 buttonsList->clearItems();
-		 
-		 configure conflocal=*conf;		 
-		 
-		  if(conflocal.openxpath("/OpenspaceConfig/toolbars/"+commandstr+"/command")!=-1)
-	     	  {
-	      	 string commandstr2;
-	      		 while(conflocal.getnextstring(commandstr2))
-	      		 {     	 
-			 string icon=conflocal.readonestring ("/OpenspaceConfig/commands/" + commandstr2 + "/icon");
-	     		 buttonsList->appendItem(commandstr2.c_str(),objmanager->osicons[icon]);
-			 toolbarVector.push_back(toolbar_container(commandstr,commandstr2));
-			 }
-	     	  }
-		 
-		 
-	     	 }
-	       }	  
-toolbarList->setCurrentItem (toolbarList->getNumItems () - 1);	       
-	        
-	FXHorizontalFrame *buttonsHframe = new FXHorizontalFrame (buttonsPane, LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);  
-
-	new FXLabel(buttonsHframe," ");
-	new FXLabel(buttonsHframe," ");
-	new FXArrowButton(buttonsHframe,this,ID_ADD_BUTTON_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-	new FXArrowButton(buttonsHframe,this,ID_DEL_BUTTON_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_DOWN);
-	
-	
-	new FXLabel (buttonsPane, "All available commands:", NULL, LAYOUT_LEFT);
-	
-	additionalCommandsAvailableForButtons=new FXList (buttonsPane,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	additionalCommandsAvailableForButtons->setNumVisible(8);
-	additionalCommandsAvailableForButtons->appendItem("SEPARATOR");
-FXHorizontalFrame *buttonsHframe2 = new FXHorizontalFrame (buttonsPane, LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);  
-
-	new FXLabel(buttonsHframe2," ");
-	new FXLabel(buttonsHframe2," ");
-new FXArrowButton(buttonsHframe2,this,ID_DEL_SHUTTER_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-new FXArrowButton(buttonsHframe2,this,ID_ADD_SHUTTER_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_DOWN);
-new FXLabel (buttonsPane, "Shutter:", NULL, LAYOUT_LEFT);
-
-
-       shutterList=new FXListBox (buttonsPane, this, ID_SHUTTER_CHANGE);
-       shutterList->setNumVisible(10);
-
-	hfx = new FXHorizontalFrame (buttonsPane,LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-
-
-	shutterCommands=new FXList (hfx,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	shutterCommands->setNumVisible(5);
-
- 	new FXLabel(hfx," ");
-	  
-	new FXArrowButton(hfx,this,ID_UP_SHUTTER_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-	new FXArrowButton(hfx,this,ID_DOWN_SHUTTER_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_DOWN);   
-
-
-	new FXSeparator(buttonsPane);
-	FXHorizontalFrame *hfr=new FXHorizontalFrame (buttonsPane, LAYOUT_FILL_X | LAYOUT_FILL_Y);
-	new FXButton (hfr, "Remove shutter", NULL, this, ID_REMOVE_SHUTTER, FRAME_RAISED | ICON_ABOVE_TEXT );
-	new FXButton (hfr, "New shutter", NULL, this, ID_NEW_SHUTTER, FRAME_RAISED | ICON_ABOVE_TEXT);
-	newShutterEdit = new FXTextField (hfr, 20);
-
-
- if(conf->openxpath("/OpenspaceConfig/shutter")!=-1)
-	       {
-	       string commandstr;
-	      	 while(conf->getnextnode(commandstr))
-	      	 {     	 
-	     	 shutterList->appendItem(commandstr.c_str());
-		 shutterCommands->clearItems();
-		 
-		 configure conflocal=*conf;		 
-		 
-		  if(conflocal.openxpath("/OpenspaceConfig/shutter/"+commandstr+"/command")!=-1)
-	     	  {
-	      	 string commandstr2;
-	      		 while(conflocal.getnextstring(commandstr2))
-	      		 {     	 
-	     		 shutterCommands->appendItem(commandstr2.c_str());
-			 shutterVector.push_back(shutter_container(commandstr,commandstr2));
-			 }
-	     	  }
-		 
-		 
-	     	 }
-	       }	
-	       
-shutterList->setCurrentItem (shutterList->getNumItems () - 1);
-
-
-//======================================================COMMANDS===========================================================
-
-
-    FXVerticalFrame *commandPluginsPane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    
-    new FXButton (buttons, "Command plugins Settings", NULL, switcher, FXSwitcher::ID_OPEN_THIRD, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
- new FXLabel (commandPluginsPane, "installed plugins");
-commandPluginsList=new FXListBox (commandPluginsPane, this, ID_COMMANDPLUGIN_CHANGE);
-commandPluginsList->setNumVisible(30);
-
-
-FXPacker *vv = new FXGroupBox (commandPluginsPane, "available plugins - download from internet", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
-
-hfr=new FXHorizontalFrame (vv, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-availableCommandPluginsList=new FXListBox (hfr);
-availableCommandPluginsList->setNumVisible(30);
-new FXButton (hfr, "Download and Install", NULL, this, ID_DOWNLOAD_INSTALL_CMD_PLUGIN, FRAME_RAISED | ICON_ABOVE_TEXT );
-new FXButton (vv, "Update available plugins list", NULL, this, ID_UPDATE_CMD_PLUGIN_LIST, FRAME_RAISED | ICON_ABOVE_TEXT );
-
-
-
-string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/cmddialog";
-
-
-
-
-	    dirp = opendir (plugin_path.c_str ());
-	    if(dirp)
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-		string name=dp->d_name;
-			if(name.substr(name.length()-3,3)==".so")
-			{
-			name=name.substr(0,name.length()-3);
-			name=name.substr(3,name.length()-3);
-			commandPluginsList->appendItem(name.c_str());
-			}
-			
-		    
-		}
-	    }
-
-	closedir (dirp);
-
-plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/cmddialog");
-	
-	dirp = opendir (plugin_path.c_str ());
-	    if(dirp)
-	    while ((dp = readdir (dirp)) != NULL)
-	    {
-		if (dp->d_name[0] != '.' || (dp->d_name[1] != '\0' && (dp->d_name[1] != '.' || dp->d_name[2] != '\0')))
-		{
-		string name=dp->d_name;
-			if(name.substr(name.length()-3,3)==".so")
-			{
-			name=name.substr(0,name.length()-3);
-			name=name.substr(3,name.length()-3);
-			commandPluginsList->appendItem(name.c_str());
-			}
-			
-		    
-		}
-	    }
-
-	    closedir (dirp);
-
-    
-
-
-
-
-    commandsPane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXLabel (commandsPane, "Commands settings", NULL, LAYOUT_LEFT);
-
-    new FXButton (buttons, "Commands Settings", NULL, switcher, FXSwitcher::ID_OPEN_FOURTH, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
-    commandsCombo=new FXListBox (commandsPane, this, ID_COMMAND_CHANGE);
-    new FXLabel (commandsPane, "icon: ", NULL, LAYOUT_LEFT);
-    iconsList=new FXListBox (commandsPane);
-    commandsCombo->setNumVisible(30);
-    iconsList->setNumVisible(30);
-    new FXLabel (commandsPane, "exec: ", NULL, LAYOUT_LEFT);
-    commandsTextfield = new FXTextField (commandsPane, 20);
-    
-    
-    
-    new FXLabel (commandsPane, "shortuct mask: ", NULL, LAYOUT_LEFT);
-    shortcutMaskList=new FXListBox (commandsPane);
-    shortcutMaskList->setNumVisible(3);
-    shortcutMaskList->appendItem("");
-    shortcutMaskList->appendItem("control");
-    shortcutMaskList->appendItem("alt");
-    
-    
-    new FXLabel (commandsPane, "shortuct: ", NULL, LAYOUT_LEFT);
-    shortcutList=new FXListBox (commandsPane);
-    shortcutList->setNumVisible(30);
-    
-    
-   	map<string,unsigned int>::iterator s_iter;
-	
-	shortcutList->appendItem("");
-	for(s_iter=objmanager->key_map.begin();s_iter!=objmanager->key_map.end();s_iter++)
-	{
-	shortcutList->appendItem(s_iter->first.c_str());
-	}
-	
-    new FXLabel (commandsPane, "text: ", NULL, LAYOUT_LEFT);
-    commandsTextfieldText = new FXTextField (commandsPane, 20);
-    commandsType=new FXLabel (commandsPane, "", NULL, LAYOUT_LEFT);
-    
-    
-    vv = new FXGroupBox (commandsPane, "Options", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0);
-    commandsRescan = new FXCheckButton (vv, "rescan", NULL, 0, JUSTIFY_LEFT | JUSTIFY_TOP | ICON_BEFORE_TEXT | LAYOUT_SIDE_TOP);
-    commandsCapture = new FXCheckButton (vv, "capture", NULL, 0, JUSTIFY_LEFT | JUSTIFY_TOP | ICON_BEFORE_TEXT | LAYOUT_SIDE_TOP);
-   
-
-    if (conf->openxpath ("/OpenspaceConfig/commands") != -1)
-    {
-	
-
-
-command_container *ctlast;
-string res;
-	while (conf->getnextnode (res))
-	{
-		
-	    command_container ct;
-	    ctlast=&ct;
-	    commandsCombo->appendItem(res.c_str (),objmanager->osicons["execute"]);
-	    ct.name = res;
-	    configure conflocal = *conf;
-	    ct.exec = conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/exec");
-	    
-	    string options = conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/options");
-
-	    string::size_type pos = options.find ("capture");
-	    if (pos != string::npos)
-		ct.capture=true;
-	    else
-		ct.capture=false;
-
-
-	    pos = options.find ("rescan");
-	    if (pos != string::npos)
-		ct.rescan=true;
-	    else
-		ct.rescan=false;
-		
-		ct.text=conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/text");
-		ct.icon=conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/icon");
-		ct.type=conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/type");
-		ct.key=conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/key");
-		ct.key_mask=conflocal.readonestring ("/OpenspaceConfig/commands/" + res + "/key_mask");
-		
-	    commandsMap[ct.name]=ct;
-
-	}
-
-	    commandsRescan->setCheck(ctlast->rescan);
-	    commandsCapture->setCheck(ctlast->capture);
-	    commandsTextfield->setText (ctlast->exec.c_str ());
-            commandsCombo->setCurrentItem (commandsCombo->getNumItems () - 1);
-	    currentCommandName=ctlast->name;
-	    
-	    string str;
-	    if(ctlast->type=="")
-	    str="command type: EXTERNAL";
-	    else
-	    str="command type: " + ctlast->type;
-	    
-	    commandsType->setText(str.c_str());
-	    string shorticonname;
-	    
-	    
-	
-	   map < string, FXIcon * >::iterator iter;
-	   
-    iconsList->appendItem("",NULL);
-    for (iter = objmanager->osicons.begin (); iter != objmanager->osicons.end (); iter++)
-    {
-	FXIcon *icon = iter->second;
-	if(icon!=NULL)
-	iconsList->appendItem(iter->first.c_str(),icon);
-    }	
-	if(ctlast->icon!="")
-	iconsList->setCurrentItem(iconsList->findItem(ctlast->icon.c_str()));
-	
-	if(ctlast->key!="")
-	shortcutList->setCurrentItem(shortcutList->findItem(ctlast->key.c_str()));
-
-	if(ctlast->key_mask!="")
-	shortcutMaskList->setCurrentItem(shortcutMaskList->findItem(ctlast->key_mask.c_str()));
-	
-	
-	
-	new FXSeparator(commandsPane);
-	FXHorizontalFrame *hfr=new FXHorizontalFrame (commandsPane, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	removeCommandButton=new FXButton (hfr, "Remove", NULL, this, ID_REMOVE_COMMAND, FRAME_RAISED | ICON_ABOVE_TEXT );
-	new FXButton (hfr, "New Command", NULL, this, ID_NEW_COMMAND, FRAME_RAISED | ICON_ABOVE_TEXT);
-	newCommandEdit = new FXTextField (hfr, 20);
-
-	if(ctlast->type=="INTERNAL" || ctlast->type=="PLUGIN")
-	{
-	commandsTextfield->disable();
-	commandsRescan->disable();
-	commandsCapture->disable();
-	removeCommandButton->disable();
-	}
-
-    }
-
-
-    filetypePane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    
-    new FXButton (buttons, "File types Settings", NULL, switcher, FXSwitcher::ID_OPEN_FIFTH, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
-
-
-    if (conf->openxpath ("/OpenspaceConfig/file_types") != -1)
-    {
-	filetype_container *ctlast;
-	new FXLabel(filetypePane,"File Type:");
-	fileTypeList=new FXListBox (filetypePane, this, ID_FILETYPE_CHANGE);
-	fileTypeList->setNumVisible(30);
-	
-	
-	FXGroupBox *filetypeGroup=new FXGroupBox(filetypePane,"commands",GROUPBOX_TITLE_CENTER|FRAME_RIDGE|LAYOUT_FILL_X);
-	
-	
-	new FXLabel(filetypeGroup,"default command:");
-	fileTypeDefaultBox = new FXListBox (filetypeGroup);
-	fileTypeDefaultBox->setNumVisible(30);
-	
-	
-	
-	FXHorizontalFrame* hzframe=new FXHorizontalFrame (filetypeGroup, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	FXVerticalFrame* vframe0=new FXVerticalFrame (hzframe, LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe0,"additional commands:");
-        additionalCommands=new FXList (vframe0,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	additionalCommands->setNumVisible(5);
-	FXVerticalFrame* vframe=new FXVerticalFrame (hzframe, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe,"\n");
-	new FXArrowButton(vframe,this,ID_UP_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-	new FXArrowButton(vframe,this,ID_DOWN_COMMAND,FRAME_RAISED|FRAME_THICK|ARROW_DOWN); 
-	new FXArrowButton(vframe,this,ID_ADD_COMMAND_ADDITIONAL,FRAME_RAISED|FRAME_THICK|ARROW_LEFT);
-	new FXArrowButton(vframe,this,ID_DEL_COMMAND_ADDITIONAL,FRAME_RAISED|FRAME_THICK|ARROW_RIGHT);
-	FXVerticalFrame* vframe1=new FXVerticalFrame (hzframe, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe1,"all available commands:");
-	additionalCommandsAvailable=new FXList (vframe1,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	additionalCommandsAvailable->setNumVisible(5);
-
-	filetypeGroup=new FXGroupBox(filetypePane,"colors and icon",GROUPBOX_TITLE_CENTER|FRAME_RIDGE|LAYOUT_FILL_X);
-	FXHorizontalFrame* hf0=new FXHorizontalFrame (filetypeGroup, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 10, 10);
-	
-	iconsList2=new FXListBox (hf0);
-        iconsList2->setNumVisible(30);
-	//new FXLabel(hf0,"  ");
-	vframe1=new FXVerticalFrame (hf0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe1,"text color:");
-	colorbutton=new FXButton(vframe1,"Color",NULL,this,ID_CHOOSE_COLOR);
-	vframe1=new FXVerticalFrame (hf0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe1,"back color:");
-	backcolorbutton=new FXButton(vframe1,"Back Color",NULL,this,ID_CHOOSE_BACKCOLOR);
-	
-	
-	
-	filetypeGroup=new FXGroupBox(filetypePane,"add new file type",GROUPBOX_TITLE_CENTER|FRAME_RIDGE|LAYOUT_FILL_X);
-	
-	allMime=new FXComboBox (filetypeGroup,60);
-	allMime->setNumVisible(30);
-	new FXButton (filetypeGroup, "Add", NULL, this, preferences::ID_ADD_FILETYPE);
-	
-	MimeType::__initialize();
-	map<string,string>::iterator iter0;
-	for(iter0=MimeType::mimeMap.begin();iter0!=MimeType::mimeMap.end();iter0++)
-	{
-		if(allMime->findItem(xml2mime(iter0->second).c_str())==-1)
-		{	
-		allMime->appendItem(xml2mime(iter0->second).c_str());
-		}
-	}
-	
-
-	
-
-	string res;
-	while (conf->getnextnode (res))
-	{
-
-	
-	    configure conflocal = *conf;
-	   if(conflocal.openxpath ("/OpenspaceConfig/file_types/"+res+"/types") != -1)
-	   {
-	   string res2;
-	    while (conflocal.getnextnode (res2))
-		{
-	 	 
-			
-			 filetype_container ct;
-			 ct.load( res+"/"+res2);
-			 fileTypeList->appendItem(xml2mime(ct.name).c_str (),objmanager->osicons["unknown"]);	    
-	   		 
-	   		 
-			 filetypesMap[ct.name]=ct;  
-			
-		}
-		
-	   }	
-	    filetype_container ct;
-	    ct.load( res);
-	    ctlast=&ct;
-	    fileTypeList->appendItem(xml2mime(ct.name) .c_str (),objmanager->osicons["unknown"]);	    
-	    
-	  
-	filetypesMap[ct.name]=ct;
-	}
-
-	filetypestring = ctlast->name;
-
-	 map < string, FXIcon * >::iterator iter2;
-	 iconsList2->appendItem("",NULL);
-    	for (iter2 = objmanager->osicons.begin (); iter2 != objmanager->osicons.end (); iter2++)
-    	{
-	FXIcon *icon = iter2->second;
-	if(icon!=NULL && (iter2->first.length()<4 || iter2->first.substr(0,4)!="big_"))
-	iconsList2->appendItem(iter2->first.c_str(),icon);
-    	}	
-	if(ctlast->icon!="")
-	iconsList2->setCurrentItem(iconsList2->findItem(ctlast->icon.c_str()));
-	
-
-	
-	fileTypeDefaultBox->appendItem ("",objmanager->osicons["execute"]);
-	
-	if (conf->openxpath ("/OpenspaceConfig/commands") != -1)
-	{
-	string command;
-	    while (conf->getnextnode (command))
-	    {
-		
-		fileTypeDefaultBox->appendItem (command.c_str (),objmanager->osicons["execute"]);
-		string icon=conf->readonestring ("/OpenspaceConfig/commands/" + command+ "/icon");
-		additionalCommandsAvailable->appendItem (command.c_str ());
-		additionalCommandsAvailableForButtons->appendItem (command.c_str (),objmanager->osicons[icon]);
-	    }
-	}
-	
-	vector<string>::iterator iter;
-	if(ctlast->commands.size()>0)
-	for(iter=ctlast->commands.begin();iter!=ctlast->commands.end();iter++)
-	{
-	additionalCommands->appendItem(iter->c_str());
-	
-	}
-	                         
-	       
-	
-	fileTypeList->setCurrentItem (fileTypeList->getNumItems () - 1);
-	fileTypeDefaultBox->setCurrentItem(fileTypeDefaultBox->findItem(ctlast->command.c_str()));
-	
-        setAllColor(colorbutton,readcolor(ctlast->color));
-	setAllColor(backcolorbutton,readcolor2(ctlast->backcolor));
-	
-    }
-
-//====================================================LOOK AND FEEL============================================================
-
-  new FXButton (buttons, "Look and feel", NULL, switcher, FXSwitcher::ID_OPEN_SIXTH, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
-  FXVerticalFrame *vframe = new FXVerticalFrame(switcher,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,0,0,0,0,0,0);
-
-  FXHorizontalFrame *hframe = new FXHorizontalFrame(vframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,0,0,0,0,0,0);
-  new FXSeparator(vframe,SEPARATOR_GROOVE|LAYOUT_FILL_X);
-
-
-  frame  = new FXVerticalFrame(hframe,LAYOUT_FILL_Y,0,0,0,0,0,0,0,0,0,0);
-  new FXSeparator(hframe,SEPARATOR_GROOVE|LAYOUT_FILL_Y);
-
-
-
-  FXMatrix* matrix = new FXMatrix(frame,2,LAYOUT_FILL_Y|MATRIX_BY_COLUMNS,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,1,1);
-
-  FXColorWell *colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_base,FXDataTarget::ID_VALUE);
-  FXLabel *label	  = new FXLabel(matrix,"Base Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_border,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Border Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_fore,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Text Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_back,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Background Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_selfore,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Selected Text Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_selback,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Selected Background Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_menufore,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Selected Menu Text Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_menuback,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Selected Menu Background Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_tipfore,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Tip Text Color");
-
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_tipback,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Tip Background Color");
-  
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_shadow,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Shadow Color");
-  
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_hilite,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Hilite Color");
-  
-  colorwell = new FXColorWell(matrix,FXRGB(0,0,255),&target_main,FXDataTarget::ID_VALUE);
-  label	  = new FXLabel(matrix,"Main Color");
-
-  frame = new FXVerticalFrame(hframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,0,0);
-
-  tabbook = new FXTabBook(frame,NULL,0,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,0,0,0,0);
-  tabitem  = new FXTabItem(tabbook," Item 1 ");
-  tabframe = new FXVerticalFrame(tabbook,LAYOUT_FILL_X|LAYOUT_FILL_Y|FRAME_THICK|FRAME_RAISED);
-
-  labeltextframe1 = new FXHorizontalFrame(tabframe,LAYOUT_FILL_X);
-  label1 = new FXLabel(labeltextframe1,"Label with Text",NULL);
-  textfield1 = new FXTextField(labeltextframe1,30,NULL,0,LAYOUT_FILL_X|FRAME_THICK|FRAME_SUNKEN);
-  textfield1->setText("Select this text, to see the selected colors");
-
-  labeltextframe2 = new FXHorizontalFrame(tabframe,LAYOUT_FILL_X);
-  textframe1 = new FXHorizontalFrame(labeltextframe2,LAYOUT_FILL_X|FRAME_THICK|FRAME_SUNKEN,0,0,0,0,2,2,2,2,0,0);
-  label3 = new FXLabel(textframe1,"Selected Text (with focus)",NULL,LAYOUT_FILL_X,0,0,0,0,1,1,1,1);
-  textframe2 = new FXHorizontalFrame(labeltextframe2,LAYOUT_FILL_X|FRAME_THICK|FRAME_SUNKEN,0,0,0,0,2,2,2,2,0,0);
-  label4 = new FXLabel(textframe2,"Selected Text (no focus)",NULL,LAYOUT_FILL_X,0,0,0,0,1,1,1,1);
-
-  sep1 = new FXSeparator(tabframe,LAYOUT_FILL_X|SEPARATOR_LINE);
-
-  tabsubframe = new FXHorizontalFrame(tabframe,LAYOUT_FILL_X|LAYOUT_FILL_Y);
-
-  grpbox1 = new FXGroupBox(tabsubframe,"MenuPane",FRAME_GROOVE|LAYOUT_FILL_Y|LAYOUT_FILL_X);
-
-  menuframe = new FXVerticalFrame(grpbox1,FRAME_RAISED|FRAME_THICK|LAYOUT_CENTER_X|LAYOUT_CENTER_Y,0,0,0,0,0,0,0,0,0,0);
-  menulabels[0]=new FXLabel(menuframe,"&Open",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-  menulabels[1]=new FXLabel(menuframe,"S&ave",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-  sep2 = new FXSeparator(menuframe,LAYOUT_FILL_X|SEPARATOR_GROOVE);
-  menulabels[2]=new FXLabel(menuframe,"I&mport",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-  menulabels[4]=new FXLabel(menuframe,"Selected Menu Entry",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-  menulabels[3]=new FXLabel(menuframe,"Print",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-  sep3 = new FXSeparator(menuframe,LAYOUT_FILL_X|SEPARATOR_GROOVE);
-  menulabels[5]=new FXLabel(menuframe,"&Quit",NULL,LABEL_NORMAL,0,0,0,0,16,4);
-
-  grpbox2 = new FXGroupBox(tabsubframe,"Tooltips",FRAME_GROOVE|LAYOUT_FILL_Y|LAYOUT_FILL_X);
-
-  label2 = new FXLabel(grpbox2,"Sample Tooltip",NULL,FRAME_LINE|LAYOUT_CENTER_X);
-  label5 = new FXLabel(grpbox2,"Multiline Sample\n Tooltip",NULL,FRAME_LINE|LAYOUT_CENTER_X);
-
-  hframe = new FXHorizontalFrame(vframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING);
-
-  new FXLabel(hframe,"Normal Font: ",NULL,LAYOUT_CENTER_Y);
-  fontbutton[0] = new FXButton(hframe," ",NULL,this,ID_CHOOSE_FONT,LAYOUT_CENTER_Y|FRAME_RAISED|JUSTIFY_CENTER_X|JUSTIFY_CENTER_Y|LAYOUT_FILL_X);
-  
-  hframe = new FXHorizontalFrame(vframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING);
-  new FXLabel(hframe,"Caption1 Font: ",NULL,LAYOUT_CENTER_Y);
-  fontbutton[1] = new FXButton(hframe," ",NULL,this,ID_CHOOSE_CAPTIONFONT1,LAYOUT_CENTER_Y|FRAME_RAISED|JUSTIFY_CENTER_X|JUSTIFY_CENTER_Y|LAYOUT_FILL_X);
-  
-  hframe = new FXHorizontalFrame(vframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING);
-  new FXLabel(hframe,"Caption2 Font: ",NULL,LAYOUT_CENTER_Y);
-  fontbutton[2] = new FXButton(hframe," ",NULL,this,ID_CHOOSE_CAPTIONFONT2,LAYOUT_CENTER_Y|FRAME_RAISED|JUSTIFY_CENTER_X|JUSTIFY_CENTER_Y|LAYOUT_FILL_X);
-  
-  hframe = new FXHorizontalFrame(vframe,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING);
-  new FXLabel(hframe,"Caption3 Font: ",NULL,LAYOUT_CENTER_Y);
-  fontbutton[3] = new FXButton(hframe," ",NULL,this,ID_CHOOSE_CAPTIONFONT3,LAYOUT_CENTER_Y|FRAME_RAISED|JUSTIFY_CENTER_X|JUSTIFY_CENTER_Y|LAYOUT_FILL_X);
-
-//====================================================SPEED AND DELAYS============================================================
-
-
-
-  new FXButton (buttons, "Speed and delays", NULL, switcher, FXSwitcher::ID_OPEN_SEVENTH, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
-
-  hframe = new FXHorizontalFrame(switcher,LAYOUT_FILL_X|LAYOUT_FILL_Y,0,0,0,0,0,0,0,0,0,0);
-
-  matrix = new FXMatrix(hframe,3,LAYOUT_FILL_Y|MATRIX_BY_COLUMNS,0,0,0,0,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING,DEFAULT_SPACING);
-
-  const FXuint spinnerstyle=FRAME_SUNKEN|FRAME_THICK;
-
-  new FXLabel(matrix,"Typing Speed\t\tTyping Speed",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  FXSpinner *spinner=new FXSpinner(matrix,4,&target_typingspeed,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(500);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-
-  new FXLabel(matrix,"Double Click Speed\t\tDouble Click Speed",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_clickspeed,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(100);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Scroll Speed\t\tScroll Speed",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_scrollspeed,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(10);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Scroll Delay\t\tScroll Delay",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_scrolldelay,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(100);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Cursor Blink Speed\t\tCursor Blink Speed",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_blinkspeed,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(100);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Animation Speed\t\tAnimation Speed",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  new FXSpinner(matrix,4,&target_animspeed,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(1);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Cascade Menu Popup Delay\t\tAmount of delay before cascading menu is shown",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_menupause,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(100);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Tooltip Popup Delay\t\tAmount of Delay before tooltip is shown ",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_tooltippause,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(100);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Tooltip Time\t\tTime that tooltips are shown",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_tooltiptime,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(500);
-  new FXLabel(matrix,"ms",NULL,LAYOUT_CENTER_Y);
-
-  new FXLabel(matrix,"Drag Delta\t\tMinimum distance considered a mouse move",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_dragdelta,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,9999);
-  spinner->setIncrement(1);
-  new FXFrame(matrix,FRAME_NONE);
-
-  new FXLabel(matrix,"Wheel Lines",NULL,LAYOUT_RIGHT|LAYOUT_CENTER_Y);
-  spinner=new FXSpinner(matrix,4,&target_wheellines,FXDataTarget::ID_VALUE,spinnerstyle);
-  spinner->setRange(1,100);
-
-
-//====================================================VFS============================================================
-
-
-    vfsPane = new FXVerticalFrame (switcher, LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-    new FXLabel (vfsPane, "VFS settings", NULL, LAYOUT_LEFT);
-
-    new FXButton (buttons, "Virtual File System Settings", NULL, switcher, FXSwitcher::ID_OPEN_EIGHTH, FRAME_RAISED | ICON_ABOVE_TEXT | LAYOUT_FILL_Y);
-
-    
-    
-        vfsList=new FXListBox (vfsPane, this, ID_VFS_CHANGE);
-        vfsList->setNumVisible(10);
-        
-	    
-    
-        FXHorizontalFrame *hzframe=new FXHorizontalFrame (vfsPane, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	FXVerticalFrame *vframe0=new FXVerticalFrame (hzframe, LAYOUT_FILL_X, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe0,"visible headers:");
-        headersList=new FXList (vframe0,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	headersList->setNumVisible(5);
-	vframe=new FXVerticalFrame (hzframe, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe,"\n");
-	new FXArrowButton(vframe,this,ID_UP_VFS_HEADER,FRAME_RAISED|FRAME_THICK|ARROW_UP);
-	new FXArrowButton(vframe,this,ID_DOWN_VFS_HEADER,FRAME_RAISED|FRAME_THICK|ARROW_DOWN); 
-	new FXArrowButton(vframe,this,ID_ADD_HEADER,FRAME_RAISED|FRAME_THICK|ARROW_LEFT);
-	new FXArrowButton(vframe,this,ID_DEL_HEADER,FRAME_RAISED|FRAME_THICK|ARROW_RIGHT);
-	
-	
-	
-	FXVerticalFrame *vframe1=new FXVerticalFrame (hzframe, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-	new FXLabel(vframe1,"all available headers:");
-	availableHeadersList=new FXList (vframe1,NULL, 0,LIST_NORMAL| LAYOUT_FIX_WIDTH, 0, 0,250);
-	availableHeadersList->setNumVisible(5);
-
- new FXLabel(vfsPane,""); 
- new FXSeparator(vfsPane);
- new FXLabel(vfsPane,"");
-
-vv = new FXGroupBox (vfsPane, "available plugins - download from internet", LAYOUT_SIDE_TOP | FRAME_GROOVE | LAYOUT_FILL_X, 0, 0, 0, 0); 
-
-hfr=new FXHorizontalFrame (vv, LAYOUT_FILL_X , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
-availableVfsPluginsList=new FXListBox (hfr);
-availableVfsPluginsList->setNumVisible(30);
-new FXButton (hfr, "Download and Install", NULL, this, ID_DOWNLOAD_INSTALL_VFS_PLUGIN, FRAME_RAISED | ICON_ABOVE_TEXT );
-new FXButton (vv, "Update available plugins list", NULL, this, ID_UPDATE_VFS_PLUGIN_LIST, FRAME_RAISED | ICON_ABOVE_TEXT );  
-  
-    
-    
-    if (conf->openxpath ("/OpenspaceConfig/filelist") != -1)
-	{
-	string command;
-	    while (conf->getnextnode (command))
-	    {
-	    vfsList->appendItem(command.c_str());
-	    }
-	}    
-    
-actualvfs="";
-       
-	this->onVfsChange(NULL,0,NULL);
-
-setupColors();
-setupFont(0);
-setupFont(1);
-setupFont(2);
-setupFont(3);
-}
-
-long preferences::onVfsChange (FXObject * sender, FXSelector sel, void *)
-{
-
-if(actualvfs!="")//not first run, save
-{
-conf->removestring ("/OpenspaceConfig/filelist/"+actualvfs+"/headers");
-conf->addstring("/OpenspaceConfig/filelist/"+actualvfs,"headers","");
-
-for (int c = 0; c < headersList->getNumItems (); c++)
-	    {
-		
-		string cmd= headersList->getItemText (c).text ();
-		conf->addstring("/OpenspaceConfig/filelist/"+actualvfs+"/headers","header",cmd);  
-	    }	
-
-
-}
-
-actualvfs=vfsList->getItem(vfsList->getCurrentItem()).text();
-availableHeadersList->clearItems();
-if (conf->openxpath ("/OpenspaceConfig/filelist/"+actualvfs+"/properties") != -1)
-	{
-	string command;
-	    while (conf->getnextnode (command))
-	    {
-	    	if(command!="name")
-		availableHeadersList->appendItem (command.c_str ());
-	    }
-	}
-headersList->clearItems();
-if (conf->openxpath ("/OpenspaceConfig/filelist/"+actualvfs+"/headers/header") != -1)
-	{
-	string command;
-	    while (conf->getnextstring (command))
-	    {
-		headersList->appendItem (command.c_str ());
-	    }
-	}
-
-
-
-}
-
-long preferences::onAddButtonCommand (FXObject * sender, FXSelector sel, void *)
-{
-
-FXushort id=FXSELID(sel);
-string actual_toolbar=toolbarList->getItem(toolbarList->getCurrentItem()).text();
-
-	if(id==ID_ADD_BUTTON_COMMAND)
-	{
-	
-	
-	string cmd=additionalCommandsAvailableForButtons->getItemText(additionalCommandsAvailableForButtons->getCurrentItem()).text();
-	toolbarVector.push_back(toolbar_container(actual_toolbar,cmd));
-	buttonsList->appendItem(cmd.c_str());
-	}
-	else
-	{
-	
-	string cmd=buttonsList->getItemText(buttonsList->getCurrentItem()).text();
-	buttonsList->removeItem(buttonsList->getCurrentItem());
-	
-	vector <toolbar_container>::iterator iter;
-	
-	for(iter=toolbarVector.begin();iter!=toolbarVector.end(); iter++)
-		{
-			if(iter->command==cmd && iter->toolbar==actual_toolbar)
-			{
-			toolbarVector.erase(iter);
-			break;
-			}
-		}
-			
-	}
-
-
-}
-
-long preferences::onAddHeader (FXObject * sender, FXSelector sel, void *)
-{
-
-FXushort id=FXSELID(sel);
-
-	if(id==ID_ADD_HEADER)
-	{
-	headersList->appendItem(availableHeadersList->getItemText(availableHeadersList->getCurrentItem()));
-	}
-	else
-	{
-	headersList->removeItem(headersList->getCurrentItem());
-	}
-
-
-
-}
-
-long preferences::onAddShutterCommand (FXObject * sender, FXSelector sel, void *)
-{
-
-FXushort id=FXSELID(sel);
-string actual_shutter=shutterList->getItem(shutterList->getCurrentItem()).text();
-
-	if(id==ID_ADD_SHUTTER_COMMAND)
-	{
-	
-	
-	string cmd=additionalCommandsAvailableForButtons->getItemText(additionalCommandsAvailableForButtons->getCurrentItem()).text();
-		if(cmd!="SEPARATOR")
-		{
-		shutterVector.push_back(shutter_container(actual_shutter,cmd));
-		shutterCommands->appendItem(cmd.c_str());
-		}
-	}
-	else
-	{
-	
-	string cmd=shutterCommands->getItemText(shutterCommands->getCurrentItem()).text();
-	shutterCommands->removeItem(shutterCommands->getCurrentItem());
-	
-	vector <shutter_container>::iterator iter;
-	
-	for(iter=shutterVector.begin();iter!=shutterVector.end(); iter++)
-		{
-			if(iter->command==cmd && iter->shutter==actual_shutter)
-			{
-			shutterVector.erase(iter);
-			break;
-			}
-		}
-			
-	}
-
-
-
-}
-
-
-void preferences::setAllColor(FXButton* button,FXColor color)
-{
- button->setBaseColor(color);
- button->setBorderColor(color);
- button->setShadowColor(color);
- button->setHiliteColor(color);
- button->setTextColor(color);
- button->setBackColor(color);
-}
-
- long preferences::onChooseColor (FXObject * sender, FXSelector sel, void *)
- {
-
- if(!colordlg->execute())
-return 0;
-
-  
- FXColor color=colordlg->getRGBA();
- FXushort id=FXSELID(sel);
- if(id==ID_CHOOSE_COLOR)
- setAllColor(colorbutton,color);
- else
- setAllColor(backcolorbutton,color);
- 
-
- }	
-
-long preferences::onAddFiletype (FXObject * sender, FXSelector sel, void *)
-{
-string mime=allMime->getText().text();
-
-filetype_container ct=filetypesMap[mime];
-    if(ct.name!="") // already exists
-    return 0;
-  
-  ct.name=mime;  
-  filetypesMap[mime]=ct;    
-
-fileTypeList->appendItem(ct.name.c_str (),objmanager->osicons["unknown"]);  
-this->onFileTypeChange(NULL,0,NULL);  
-}
-
-preferences::~preferences ()
-{
-}
-
-long preferences::save (void)
-{
-    FXTRACE ((5, "save\n"));
-    
-    this->onCommandChange(NULL,0,NULL);
-    this->onFileTypeChange(NULL,0,NULL);
-    this->onVfsChange(NULL,0,NULL);
-
-    map < string, command_container >::iterator iter;
-
-    for (iter = commandsMap.begin (); iter != commandsMap.end (); iter++)
-    {
-	command_container ct = iter->second;	
-	ct.save();		 
-    }
-
-map < string, filetype_container >::iterator iter2;
-
-    for (iter2 = filetypesMap.begin (); iter2 != filetypesMap.end (); iter2++)
-    {
-	filetype_container ct = iter2->second;
-	ct.save();
-    }
-
-
-
-conf->removestring ("/OpenspaceConfig/button_commands");
-conf->addstring("/OpenspaceConfig","button_commands","");
-
-for (int c = 0; c < buttonsList->getNumItems (); c++)
-	    {		
-		  string cmd= buttonsList->getItemText (c).text ();
-		  conf->addstring("/OpenspaceConfig/button_commands","command",cmd);
-	    }
-
-
-conf->removestring ("/OpenspaceConfig/shutter");
-conf->addstring("/OpenspaceConfig","shutter","");
-
-vector <shutter_container>::iterator shutter_iter;
-	
-	for(shutter_iter=shutterVector.begin();shutter_iter!=shutterVector.end(); shutter_iter++)
-		{
-		string res;
-			if(!conf->readonestring("/OpenspaceConfig/shutter/"+shutter_iter->shutter,res))
-			conf->addstring("/OpenspaceConfig/shutter",shutter_iter->shutter,"");
-				
-			conf->addstring("/OpenspaceConfig/shutter/"+shutter_iter->shutter,"command",shutter_iter->command);
-	
-		}
-
-conf->removestring ("/OpenspaceConfig/toolbars");
-conf->addstring("/OpenspaceConfig","toolbars","");
-
-vector <toolbar_container>::iterator toolbar_iter;
-	
-	for(toolbar_iter=toolbarVector.begin();toolbar_iter!=toolbarVector.end(); toolbar_iter++)
-		{
-		string res;
-			if(!conf->readonestring("/OpenspaceConfig/toolbars/"+toolbar_iter->toolbar,res))
-			conf->addstring("/OpenspaceConfig/toolbars",toolbar_iter->toolbar,"");
-				
-			conf->addstring("/OpenspaceConfig/toolbars/"+toolbar_iter->toolbar,"command",toolbar_iter->command);
-	
-		}
-
-conf->saveonestring ("/OpenspaceConfig/mainwindow/width", ntos(mainwindow_width->getValue()));
-conf->saveonestring ("/OpenspaceConfig/mainwindow/height",ntos(mainwindow_height->getValue()));
-
-conf->saveonestring ("/OpenspaceConfig/leftdir/dir",leftdir->getText().text());
-conf->saveonestring ("/OpenspaceConfig/rightdir/dir",rightdir->getText().text());
-conf->saveonestring ("/OpenspaceConfig/defaultdir/dir",defaultdir->getText().text());
-conf->saveonestring ("/OpenspaceConfig/filelist/local/thumbs/size",ntos(thumbsize->getValue()));
-conf->saveonestring ("/OpenspaceConfig/icons_theme",iconsTheme->getItem(iconsTheme->getCurrentItem()).text());
-
-
-conf->saveonestring ("/OpenspaceConfig/speed_delay/typing_speed",ntos(typingSpeed));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/click_speed",ntos(clickSpeed));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/scroll_speed",ntos(scrollSpeed));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/scroll_delay",ntos(scrollDelay));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/blink_speed",ntos(blinkSpeed));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/anim_speed",ntos(animSpeed));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/menu_pause",ntos(menuPause));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/tooltip_pause",ntos(tooltipPause));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/tooltip_time",ntos(tooltipTime));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/drag_delta",ntos(dragDelta));
-conf->saveonestring ("/OpenspaceConfig/speed_delay/wheel_lines",ntos(wheelLines));
-
-FXchar buffer[60];
-conf->saveonestring ("/OpenspaceConfig/colors/base",fxnamefromcolor(buffer,base));
-conf->saveonestring ("/OpenspaceConfig/colors/fore",fxnamefromcolor(buffer,fore));
-conf->saveonestring ("/OpenspaceConfig/colors/hilite",fxnamefromcolor(buffer,hilite));
-conf->saveonestring ("/OpenspaceConfig/colors/shadow",fxnamefromcolor(buffer,shadow));
-conf->saveonestring ("/OpenspaceConfig/colors/selfore",fxnamefromcolor(buffer,selfore));
-conf->saveonestring ("/OpenspaceConfig/colors/selback",fxnamefromcolor(buffer,selback));
-conf->saveonestring ("/OpenspaceConfig/colors/tipfore",fxnamefromcolor(buffer,tipfore));
-conf->saveonestring ("/OpenspaceConfig/colors/tipback",fxnamefromcolor(buffer,tipback));
-conf->saveonestring ("/OpenspaceConfig/colors/selmenutext",fxnamefromcolor(buffer,menufore));
-conf->saveonestring ("/OpenspaceConfig/colors/selmenuback",fxnamefromcolor(buffer,menuback));   
-conf->saveonestring ("/OpenspaceConfig/colors/main",fxnamefromcolor(buffer,main));   
-
-FXString fontspec=font[0]->getFont();
-conf->saveonestring ("/OpenspaceConfig/fonts/normalfont",fontspec.text());  
-
-fontspec=font[1]->getFont();
-conf->saveonestring ("/OpenspaceConfig/fonts/captionfont1",fontspec.text());  
-
-fontspec=font[2]->getFont();
-conf->saveonestring ("/OpenspaceConfig/fonts/captionfont2",fontspec.text());  
-
-fontspec=font[3]->getFont();
-conf->saveonestring ("/OpenspaceConfig/fonts/captionfont3",fontspec.text());  
-
-
-conf->saveonestring ("/OpenspaceConfig/position",placement->getItem (placement->getCurrentItem()).text());
-
-}
-
-long preferences::onCommandChange (FXObject * sender, FXSelector sel, void *)
-{
-
-command_container *ct_prev=&commandsMap[currentCommandName];
-ct_prev->exec=commandsTextfield->getText().text();
-ct_prev->capture=commandsCapture->getCheck();
-ct_prev->rescan=commandsRescan->getCheck();
-ct_prev->text=commandsTextfieldText->getText().text();
-ct_prev->icon=iconsList->getItem(iconsList->getCurrentItem()).text();
-ct_prev->key=shortcutList->getItem(shortcutList->getCurrentItem()).text();
-ct_prev->key_mask=shortcutMaskList->getItem(shortcutMaskList->getCurrentItem()).text();
-
-command_container ct=commandsMap[commandsCombo->getItem (commandsCombo->getCurrentItem ()).text ()];
-
-commandsRescan->setCheck(ct.rescan);
-commandsCapture->setCheck(ct.capture);
-commandsTextfield->setText (ct.exec.c_str ());
-commandsTextfieldText->setText (ct.text.c_str ());
-           
-	    string str;
-	    if(ct.type=="")
-	    str="command type: EXTERNAL";
-	    else
-	    str="command type: " + ct.type;
-	    
-	    commandsType->setText(str.c_str());
-
-
-	if(ct.type=="INTERNAL" || ct.type=="PLUGIN")
-	{
-	commandsTextfield->disable();
-	commandsRescan->disable();
-	commandsCapture->disable();
-	removeCommandButton->disable();
-	}
-	else
-	{
-	commandsTextfield->enable();
-	commandsRescan->enable();
-	commandsCapture->enable();
-	removeCommandButton->enable();
-	}
-iconsList->setCurrentItem(iconsList->findItem(ct.icon.c_str()));
-shortcutList->setCurrentItem(shortcutList->findItem(ct.key.c_str()));
-shortcutMaskList->setCurrentItem(shortcutMaskList->findItem(ct.key_mask.c_str()));
-
-
-currentCommandName=ct.name;
-
-}
-
-
-long preferences::onFileTypeChange (FXObject * sender, FXSelector sel, void *)
-{
-
-filetype_container *ct_prev=&filetypesMap[currentFileType];
-ct_prev->command=fileTypeDefaultBox->getItem(fileTypeDefaultBox->getCurrentItem()).text();
-
-ct_prev->commands.clear();
-for(int i=0;i<additionalCommands->getNumItems ();i++)
-	{
-	ct_prev->commands.push_back(additionalCommands->getItemText(i).text());
-	}
-
-FXchar buffer[60];
-fxnamefromcolor(buffer,colorbutton->getBackColor());
-
-ct_prev->color=buffer;
-
-fxnamefromcolor(buffer,backcolorbutton->getBackColor());
-
-ct_prev->backcolor=buffer;
-ct_prev->icon=iconsList2->getItem(iconsList2->getCurrentItem()).text();
-
-filetype_container ct=filetypesMap[mime2xml(fileTypeList->getItem (fileTypeList->getCurrentItem ()).text ())];
-fileTypeDefaultBox->setCurrentItem(fileTypeDefaultBox->findItem(ct.command.c_str()));
-additionalCommands->clearItems();
-
-iconsList2->setCurrentItem(iconsList2->findItem(ct.icon.c_str()));
-
-vector<string>::iterator iter;
-	for(iter=ct.commands.begin();iter!=ct.commands.end();iter++)
-	{
-	additionalCommands->appendItem(iter->c_str());
-	}
-
- setAllColor(colorbutton,readcolor(ct.color));
- setAllColor(backcolorbutton,readcolor2(ct.backcolor));
-	
-
-currentFileType=ct.name;
-
-}
-
-long preferences::onShutterChange (FXObject * sender, FXSelector sel, void *)
-{
-string actual_shutter=shutterList->getItem(shutterList->getCurrentItem()).text();
-shutterCommands->clearItems();
-vector <shutter_container>::iterator iter;
-	for(iter=shutterVector.begin();iter!=shutterVector.end();iter++)
-	{
-		if(iter->shutter==actual_shutter)
-	shutterCommands->appendItem(iter->command.c_str());
-	}
-
-}
-
-long preferences::onToolbarChange (FXObject * sender, FXSelector sel, void *)
-{
-string actual_toolbar=toolbarList->getItem(toolbarList->getCurrentItem()).text();
-buttonsList->clearItems();
-vector <toolbar_container>::iterator iter;
-	for(iter=toolbarVector.begin();iter!=toolbarVector.end();iter++)
-	{
-		if(iter->toolbar==actual_toolbar)
-		{
-		string icon=conf->readonestring ("/OpenspaceConfig/commands/" + iter->command + "/icon");
-		buttonsList->appendItem(iter->command.c_str(),objmanager->osicons[icon] );
-		}
-	}
-
-}
-
-
-bool preferences::validateName(string name)
-{
-	if(name=="")return false;
-
-	int p,k;
-	FXRex identifier("[0-9a-zA-Z]*");
-        identifier.match(name.c_str(),name.size(),&p,&k);
-	
-
-	if(k!=name.size())
-	{
-	FXMessageBox error (this, "error", "Incorrect characters in name", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER);
-	error.execute();
-	return false;
-	}
-	else
-	{
-	return true;
-	}
-    
-	
-}
-
-long preferences::onNewShutter (FXObject * sender, FXSelector sel, void *)
-{
-string shutter_name = newShutterEdit->getText ().text ();
-    if(!validateName(shutter_name))
-    return 0;
-
-shutterList->appendItem(shutter_name.c_str());
-
-}
-
-long preferences::onRemoveShutter (FXObject * sender, FXSelector sel, void *)
-{
-
-    string shutter =  shutterList->getItem (shutterList->getCurrentItem ()).text ();
-    int cur=shutterList->getCurrentItem ();
-    shutterList->setCurrentItem (0);
-    shutterList->removeItem (cur);    
-    this->onShutterChange(NULL,0,NULL);
-    
-    
-       string res = "/OpenspaceConfig/shutter/"+shutter;
-       conf->removestring (res);
-
-
-vector <shutter_container>::iterator shutter_iter;
-	
-	for(shutter_iter=shutterVector.begin();shutter_iter!=shutterVector.end(); shutter_iter++)
-		{
-			if(shutter_iter->shutter==shutter)
-			{
-				shutterVector.erase(shutter_iter);
-			break;
-			}
-		}
-
-
-}
-
-
-long preferences::onNewCommand (FXObject * sender, FXSelector sel, void *)
-{
-
-    string command_name = newCommandEdit->getText ().text ();
-    if(!validateName(command_name))
-    return 0;
-    
-    command_container ct=commandsMap[command_name];
-    if(ct.name!="") // already exists
-    return 0;
-    
-    ct.name=command_name;
-    ct.rescan=false;
-    ct.capture=false;
-    commandsCombo->appendItem(ct.name.c_str());
-    commandsMap[command_name]=ct;   
-    commandsCombo->setCurrentItem (commandsCombo->getNumItems () - 1);
-    this->onCommandChange(NULL,0,NULL);
-    
-    fileTypeDefaultBox->appendItem(ct.name.c_str());
-    additionalCommandsAvailable->appendItem(ct.name.c_str());
-    additionalCommandsAvailableForButtons->appendItem(ct.name.c_str());
-
-
-}
-
-long preferences::onRemoveCommand (FXObject * sender, FXSelector sel, void *)
-{
-
-    string command =  commandsCombo->getItem (commandsCombo->getCurrentItem ()).text ();
-    int cur=commandsCombo->getCurrentItem ();
-    commandsCombo->setCurrentItem (0);
-    commandsCombo->removeItem (cur);    
-    this->onCommandChange(NULL,0,NULL);
-    
-    
-       string res = "/OpenspaceConfig/commands/"+command;
-       conf->removestring (res);
-
-
-}
-
-long preferences:: onAdditionalCommandChange( FXObject * sender, FXSelector sel, void *)
-{
-FXushort id=FXSELID(sel);
-filetype_container *ct_prev=&filetypesMap[currentFileType];
-	if(id==ID_ADD_COMMAND_ADDITIONAL)
-	{
-	ct_prev->commands.push_back(additionalCommandsAvailable->getItemText(additionalCommandsAvailable->getCurrentItem()).text());
-	additionalCommands->appendItem(additionalCommandsAvailable->getItemText(additionalCommandsAvailable->getCurrentItem()));
-	}
-	else
-	{
-		vector <string>::iterator iter = find(ct_prev->commands.begin(), ct_prev->commands.end(),additionalCommands->getItemText( additionalCommands->getCurrentItem()).text());
-		if(iter != ct_prev->commands.end())
-		{
-		ct_prev->commands.erase(iter);
-		}
-	additionalCommands->removeItem(additionalCommands->getCurrentItem());
-	
-	
-
-
-	
-	}
-
-}
-
-long preferences::onOpenMimeApp (FXObject * sender, FXSelector sel, void *)
-{
-if(mimeapp==NULL)
-{
-mimeapp=new MimeApp(this);
-
-
-FXushort id=FXSELID(sel);
-
-	if(id==ID_MIME_APP_AUTO)
-	{	
-	mimeapp->doAutomaticConfiguration();
-	}
-	else
-	{
-	mimeapp->create();
-	mimeapp->execute (PLACEMENT_OWNER);
-	}
-
-
-saveconfiguration=false;
-this->handle (this, FXSEL (SEL_CLOSE, 0), NULL);
-}
-
-   
-	
-}
-
-long preferences::onColorChanged(FXObject*,FXSelector,void*)
-{
-  setupColors();
-  return 1;
-}
-
-
-void preferences::setupColors()
-{
-  //shadow = makeShadowColor(base);
-  //hilite = makeHiliteColor(base);
-
-  tabitem->setBorderColor(border);
-  tabitem->setBaseColor(base);
-  tabitem->setBackColor(base);
-  tabitem->setTextColor(fore);
-  tabitem->setShadowColor(shadow);
-  tabitem->setHiliteColor(hilite);
-
-  tabframe->setBorderColor(border);
-  tabframe->setBaseColor(base);
-  tabframe->setBackColor(base);
-  tabframe->setShadowColor(shadow);
-  tabframe->setHiliteColor(hilite);
-
-
-  tabsubframe->setBorderColor(border);
-  tabsubframe->setBaseColor(base);
-  tabsubframe->setBackColor(base);
-  tabsubframe->setShadowColor(shadow);
-  tabsubframe->setHiliteColor(hilite);
-
-  menuframe->setBorderColor(border);
-  menuframe->setBaseColor(base);
-  menuframe->setBackColor(base);
-  menuframe->setShadowColor(shadow);
-  menuframe->setHiliteColor(hilite);
-
-  grpbox1->setBorderColor(border);
-  grpbox1->setBaseColor(base);
-  grpbox1->setBackColor(base);
-  grpbox1->setShadowColor(shadow);
-  grpbox1->setHiliteColor(hilite);
-  grpbox1->setTextColor(fore);
-
-  grpbox2->setBorderColor(border);
-  grpbox2->setBaseColor(base);
-  grpbox2->setBackColor(base);
-  grpbox2->setShadowColor(shadow);
-  grpbox2->setHiliteColor(hilite);
-  grpbox2->setTextColor(fore);
-
-  sep1->setBorderColor(border);
-  sep1->setBaseColor(base);
-  sep1->setBackColor(base);
-  sep1->setShadowColor(shadow);
-  sep1->setHiliteColor(hilite);
-
-  sep2->setBorderColor(border);
-  sep2->setBaseColor(base);
-  sep2->setBackColor(base);
-  sep2->setShadowColor(shadow);
-  sep2->setHiliteColor(hilite);
-
-  sep3->setBorderColor(border);
-  sep3->setBaseColor(base);
-  sep3->setBackColor(base);
-  sep3->setShadowColor(shadow);
-  sep3->setHiliteColor(hilite);
-
-  labeltextframe1->setBorderColor(border);
-  labeltextframe1->setBaseColor(base);
-  labeltextframe1->setBackColor(base);
-  labeltextframe1->setShadowColor(shadow);
-  labeltextframe1->setHiliteColor(hilite);
-
-
-  labeltextframe2->setBorderColor(border);
-  labeltextframe2->setBaseColor(base);
-  labeltextframe2->setBackColor(base);
-  labeltextframe2->setShadowColor(shadow);
-  labeltextframe2->setHiliteColor(hilite);
-
-  label1->setBorderColor(border);
-  label1->setBaseColor(base);
-  label1->setBackColor(base);
-  label1->setTextColor(fore);
-  label1->setShadowColor(shadow);
-  label1->setHiliteColor(hilite);
-
-  label2->setBorderColor(tipfore);
-  label2->setBaseColor(tipback);
-  label2->setBackColor(tipback);
-  label2->setTextColor(tipfore);
-  label2->setShadowColor(shadow);
-  label2->setHiliteColor(hilite);
-
-  label3->setBorderColor(border);
-  label3->setBaseColor(base);
-  label3->setBackColor(selback);
-  label3->setTextColor(selfore);
-  label3->setShadowColor(shadow);
-  label3->setHiliteColor(hilite);
-
-  label4->setBorderColor(border);
-  label4->setBaseColor(base);
-  label4->setBackColor(base);
-  label4->setTextColor(fore);
-  label4->setShadowColor(shadow);
-  label4->setHiliteColor(hilite);
-
-  label5->setBorderColor(tipfore);
-  label5->setBaseColor(tipback);
-  label5->setBackColor(tipback);
-  label5->setTextColor(tipfore);
-  label5->setShadowColor(shadow);
-  label5->setHiliteColor(hilite);
-
-  for (int i=0;i<6;i++)
-  {
-    menulabels[i]->setBorderColor(border);
-    menulabels[i]->setBaseColor(base);
-    menulabels[i]->setBackColor(base);
-    menulabels[i]->setTextColor(fore);
-    menulabels[i]->setShadowColor(shadow);
-    menulabels[i]->setHiliteColor(hilite);
-  }
-
-  menulabels[4]->setBorderColor(border);
-  menulabels[4]->setBaseColor(menuback);
-  menulabels[4]->setBackColor(menuback);
-  menulabels[4]->setTextColor(menufore);
-  menulabels[4]->setShadowColor(shadow);
-  menulabels[4]->setHiliteColor(hilite);
-
-  textframe1->setBorderColor(border);
-  textframe1->setBaseColor(base);
-  textframe1->setBackColor(back);
-  textframe1->setShadowColor(shadow);
-  textframe1->setHiliteColor(hilite);
-
-  textframe2->setBorderColor(border);
-  textframe2->setBaseColor(base);
-  textframe2->setBackColor(back);
-  textframe2->setShadowColor(shadow);
-  textframe2->setHiliteColor(hilite);
-
-  textfield1->setBorderColor(border);
-  textfield1->setBackColor(back);
-  textfield1->setBaseColor(base);
-  textfield1->setTextColor(fore);
-  textfield1->setSelTextColor(selfore);
-  textfield1->setSelBackColor(selback);
-  textfield1->setCursorColor(fore);
-  textfield1->setShadowColor(shadow);
-  textfield1->setHiliteColor(hilite);
-
-  tooltip->setTextColor(tipfore);
-  tooltip->setBackColor(tipback);
-  }
-
-static FXString weightToString(FXuint weight){
-  switch(weight){
-    case FONTWEIGHT_THIN      : return "thin"; break;
-    case FONTWEIGHT_EXTRALIGHT: return "extralight"; break;
-    case FONTWEIGHT_LIGHT     : return "light"; break;
-    case FONTWEIGHT_NORMAL    : return "normal"; break;
-    case FONTWEIGHT_MEDIUM    : return "medium"; break;
-    case FONTWEIGHT_DEMIBOLD  : return "demibold"; break;
-    case FONTWEIGHT_BOLD      : return "bold"; break;
-    case FONTWEIGHT_EXTRABOLD : return "extrabold"; break;
-    case FONTWEIGHT_HEAVY     : return "heavy"; break;
-    default: return ""; break;
-    }
-  return "";
-  }
-
-static FXString slantToString(FXuint slant){
-  switch(slant){
-    case FONTSLANT_REGULAR : return "regular"; break;
-    case FONTSLANT_ITALIC : return "italic"; break;
-    case FONTSLANT_OBLIQUE : return "oblique"; break;
-    case FONTSLANT_REVERSE_ITALIC : return "reverse italic"; break;
-    case FONTSLANT_REVERSE_OBLIQUE : return "reverse oblique"; break;
-    default : return ""; break;
-    }
-  return "";
-  }
-
-void preferences::setupFont(int nr)
-{
-  
-
-
-   FXString fontname = font[nr]->getActualName() +", " + FXStringVal(font[nr]->getSize()/10);
-  if(font[nr]->getWeight()!=0 && font[nr]->getWeight()!=FONTWEIGHT_NORMAL){
-    fontname += ", " + weightToString(font[nr]->getWeight());
-    }
-  if (font[nr]->getSlant()!=0 && font[nr]->getSlant()!=FONTSLANT_REGULAR){
-    fontname += ", " + slantToString(font[nr]->getSlant());
-    }
- 
- 	if(nr==0)
-	{
-	
- 	 tabitem->setFont(font[nr]);
- 	 label1->setFont(font[nr]);
- 	 label2->setFont(font[nr]);
- 	 label3->setFont(font[nr]);
- 	 label4->setFont(font[nr]);
- 	 label5->setFont(font[nr]);
-
- 	 menulabels[0]->setFont(font[nr]);
- 	 menulabels[1]->setFont(font[nr]);
- 	 menulabels[2]->setFont(font[nr]);
- 	 menulabels[3]->setFont(font[nr]);
- 	 menulabels[4]->setFont(font[nr]);
- 	 menulabels[5]->setFont(font[nr]);
-
-  	textfield1->setFont(font[nr]);
- 	
-  	}
- 	
-	
-	fontbutton[nr]->setText(fontname);
-
-  
-  }
-
-long preferences::onChooseFont(FXObject*,FXSelector sel,void*)
-{
-
-FXushort id=FXSELID(sel);
-int nr=id-ID_CHOOSE_FONT;
-
-
-  FXFontDialog dialog(this,"Select Font");
-  FXFontDesc fontdescription;
-  font[nr]->getFontDesc(fontdescription);
-  strncpy(fontdescription.face,font[nr]->getActualName().text(),sizeof(fontdescription.face));
-  dialog.setFontSelection(fontdescription);
-  if(dialog.execute(PLACEMENT_SCREEN))
-  {
-    FXFont *oldfont=font[nr];
-    dialog.getFontSelection(fontdescription);
-    
-
- 	font[nr]=new FXFont(getApp(),fontdescription);
-	font[nr]->create();
-      
-    setupFont(nr);
-    delete oldfont;
-    
-    }
-  return 1;
-}
-
-long preferences::close (FXObject * sender, FXSelector sel, void *ptr)
-{
-
-if(saveconfiguration)
-this->save();
-
-FXMessageBox about (this, "restart", "restart openspace to apply changes", NULL, MBOX_OK | DECOR_ALL);
-about.execute ();
-
-FXDialogBox::onCmdAccept(sender,sel,ptr);
-
-}
-
-
-long preferences::downloadInstallPlugin (FXObject * sender, FXSelector sel, void *)
-{
-FXushort id=FXSELID(sel);
-string file;
-
-	if(id==ID_DOWNLOAD_INSTALL_CMD_PLUGIN)
-	file=string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/cmddialog/commandPluginsList.txt";
-	else
-	file=string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/filelist/vfsPluginsList.txt";
-	
-	if(FXFile::exists(file.c_str()))
-	{
-	
-	std::string line;
-   	std::ifstream infile (file.c_str());
-
-  		  while (std::getline (infile, line))
-   		 {
-		string name;
-		string download;
-		std::stringstream parser (line);	
-		parser >> name;
-		parser >> download;
-		
-		if(id==ID_DOWNLOAD_INSTALL_CMD_PLUGIN)
-			if(name==availableCommandPluginsList->getItem(availableCommandPluginsList->getCurrentItem()).text())
-			{
-				if(name=="")
-				return 0;
-				
-			string cmd="cd "+ string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/cmddialog/ && wget -N --connect-timeout=5  "+ download;
-			system(cmd.c_str());
-
-			
-			 command_container ct=commandsMap[name];
-   			 if(ct.name!="") // already exists
-   			 return 0;
-    
-   			  ct.name=name;
-  			  ct.rescan=false;
-  			  ct.capture=false;
-			  ct.type="PLUGIN";
-   			  commandsCombo->appendItem(ct.name.c_str());
-    			  commandsMap[name]=ct;   
- 		          commandsCombo->setCurrentItem (commandsCombo->getNumItems () - 1);
-   			  this->onCommandChange(NULL,0,NULL);
-    
-  			  fileTypeDefaultBox->appendItem(ct.name.c_str());
-  			  additionalCommands->appendItem(ct.name.c_str());
-			
-			break;
-			}
-		else
-			if(name==availableVfsPluginsList->getItem(availableVfsPluginsList->getCurrentItem()).text())
-			{
-				if(name=="")
-				return 0;
-			
-			string cmd="cd "+ string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/filelist/ && wget -N --connect-timeout=5  "+ download;
-			system(cmd.c_str());
-
-			string plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libfilelist")+ name+".so";
-
-    
-   			 	void *dllhandle = fxdllOpen (plugin_path.c_str ());
-    				if (dllhandle)
-    				{
-	
-				filelist_base *(*gg) (void);
-				gg = (filelist_base * (*)(void)) fxdllSymbol (dllhandle, "get_filelist");
-				filelist_base *fb = gg ();	
-				
-				vfs v=fb->setup();
-				
-				conf->removestring ("/OpenspaceConfig/filelist/"+name);
-				conf->addstring("/OpenspaceConfig/filelist",name,"");
-				conf->addstring("/OpenspaceConfig/filelist/"+name,"type",v.type);
-				conf->addstring("/OpenspaceConfig/filelist/"+name,"properties","");
-				
-				
-				
-				vector <vfsheader_container>::iterator iter;
-				
-					for(iter=v.vfsheaders.begin();iter!=v.vfsheaders.end();iter++)
-					{
-					conf->addstring("/OpenspaceConfig/filelist/"+name+"/properties",iter->name,"");
-					conf->addstring("/OpenspaceConfig/filelist/"+name+"/properties/"+ iter->name,"width",iter->width);
-					conf->addstring("/OpenspaceConfig/filelist/"+name+"/properties/"+ iter->name,"type",iter->type);
-					}
-				vfsList->appendItem(name.c_str());
-			
-				}
-
-			}	
-			
-		
-		}
-	}
-
-
-}
-long preferences::updatePluginList (FXObject * sender, FXSelector sel, void *)
-{
-string cmd;
-
-FXushort id=FXSELID(sel);
-
-	if(id==ID_UPDATE_CMD_PLUGIN_LIST)
-	cmd="cd "+ string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/cmddialog/ && wget -N http://openspace.linux.pl/files/"+string(PACKAGE_VERSION)+"/x86/commandPluginsList.txt";
-	else
-	cmd="cd "+ string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/filelist/ && wget -N http://openspace.linux.pl/files/"+string(PACKAGE_VERSION)+"/x86/vfsPluginsList.txt";
-	
-	
-system(cmd.c_str());
-string file;
-	if(id==ID_UPDATE_CMD_PLUGIN_LIST)
-	file=string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/cmddialog/commandPluginsList.txt";
-	else
-	file=string(FXFile::getUserDirectory ("").text ()) +"/.openspace/plugins/filelist/vfsPluginsList.txt";
-	
-	
-	if(FXFile::exists(file.c_str()))
-	{
-	
-	std::string line;
-   	std::ifstream infile (file.c_str());
-
-  		while (std::getline (infile, line))
-   		{
-		string name;
-		string download;
-		std::stringstream parser (line);	
-		parser >> name;
-		parser >> download;
-			if(id==ID_UPDATE_CMD_PLUGIN_LIST)
-			{
-			availableCommandPluginsList->clearItems();
-			availableCommandPluginsList->appendItem(name.c_str());
-			}
-			else
-			{
-			availableVfsPluginsList->clearItems();
-			availableVfsPluginsList->appendItem(name.c_str());
-			}
-		}
-	}
-
-}
-

Deleted: trunk/src/preferences.h
===================================================================
--- trunk/src/preferences.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/preferences.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,278 +0,0 @@
-#ifndef PREFERENCES_H
-#define PREFERENCES_H
-#include "sharedobjects.h"
-#include "sharedFunctions.h"
-#include "MimeApp.h"
-#include "CommandsFileTypesContainers.h"
-#include <vector>
-#include <string>
-#include <map>
-using namespace std;
-class shutter_container
-{
-public:
-string shutter;
-string command;
-shutter_container(string s,string c):shutter(s),command(c){}
-};
-
-class toolbar_container
-{
-public:
-string toolbar;
-string command;
-toolbar_container(string s,string c):toolbar(s),command(c){}
-};
-
-//preferences window, this is one of the most important things to be extended
-class preferences:public FXDialogBox
-{
-  FXDECLARE (preferences) protected:
-
-  private:
-    preferences ()
-    {
-    }
-
-    string actualvfs;
-
-    bool saveconfiguration;
-    FXSpinner* mainwindow_width;
-    FXSpinner* mainwindow_height;
-    FXTextField *leftdir,*rightdir,*defaultdir;
-    FXTextField *font1,*font2,*font3;
-    FXTextField *newCommandEdit;
-    FXTextField *newShutterEdit;
-    FXSpinner *thumbsize;
-    FXListBox *commandsCombo;
-    FXListBox *shortcutList;	
-    FXListBox *shortcutMaskList;
-    FXListBox *iconsList,*iconsList2;
-    FXVerticalFrame *commandsPane;
-    FXTextField *commandsTextfield;
-    FXTextField *commandsTextfieldText;
-    FXCheckButton *commandsRescan;
-    FXCheckButton *commandsCapture;
-    FXLabel *commandsType;
-    FXLabel *commandsIcon;
-    FXListBox *iconsTheme;
-    FXButton *removeCommandButton;
-    FXVerticalFrame *vfsPane;
-    FXListBox *vfsList;
-    FXList*headersList,*availableHeadersList;
-    FXListBox *placement;
-    
-    FXList *additionalCommands,*additionalCommandsAvailable,*additionalCommandsAvailableForButtons;
-    FXList *shutterCommands;
-    
-    string currentCommandName;
-    string currentFileType;
-    objectmanager* objmanager;
-    
-    FXVerticalFrame *frame;
-    
-    FXComboBox *allMime;
-    FXButton *colorbutton;
-    FXButton *backcolorbutton;
-    
-    FXListBox *shutterList;
-    FXListBox *toolbarList;
-    FXListBox *fileTypeList;
-    FXListBox *fileTypeDefaultBox;
-    string filetypestring;
-
-    MimeApp *mimeapp;
-    FXColorDialog *colordlg;
-
-    FXListBox *commandPluginsList,*availableCommandPluginsList;
-    FXListBox * availableVfsPluginsList;
-    FXList*buttonsList;
-
-    map <string, command_container > commandsMap;
-    map <string, filetype_container> filetypesMap;   
-  
-    vector <shutter_container> shutterVector;
-    vector <toolbar_container> toolbarVector;
-    
-    
-    FXVerticalFrame *filetypePane;
-    
-    bool preferences::validateName(string name);
-    void preferences::setAllColor(FXButton* button,FXColor color);
-
-  FXColor base;
-  FXColor border;
-  FXColor back;
-  FXColor fore;
-  FXColor selback;
-  FXColor selfore;
-  FXColor tipback;
-  FXColor tipfore;
-  FXColor menuback;
-  FXColor menufore;
-  FXColor hilite;
-  FXColor shadow;
-  FXColor main;
-
-  FXToolTip         *tooltip;
-  FXTabBook         *tabbook;
-  FXTabItem         *tabitem;
-  FXVerticalFrame   *tabframe;
-  FXVerticalFrame   *mainframe;
-  FXVerticalFrame   *menuframe;
-  FXHorizontalFrame *labeltextframe1;
-  FXHorizontalFrame *labeltextframe2;
-  FXHorizontalFrame *textframe1;
-  FXHorizontalFrame *textframe2;
-  FXHorizontalFrame *tabsubframe;
-  FXGroupBox        *grpbox1;
-  FXGroupBox        *grpbox2;
-  FXLabel           *label1;
-  FXLabel           *label2;
-  FXLabel           *label3;
-  FXLabel           *label4;
-  FXLabel           *label5;
-  FXLabel           *menulabels[6];
-  FXTextField       *textfield1;
-  FXButton          *button1;
-  FXButton          *fontbutton[4];
-  FXSeparator       *sep1;
-  FXSeparator       *sep2;
-  FXSeparator       *sep3;
- 
- 
-private:
-
-  FXFont           *font[4];
-
-  FXuint            typingSpeed;
-  FXuint            clickSpeed;
-  FXuint            scrollSpeed;
-  FXuint            scrollDelay;
-  FXuint            blinkSpeed;
-  FXuint            animSpeed;
-  FXuint            menuPause;
-  FXuint            tooltipPause;
-  FXuint            tooltipTime;
-  FXint             dragDelta;
-  FXint             wheelLines;
-
-
-private:
-
-  FXDataTarget      target_base;
-  FXDataTarget      target_back;
-  FXDataTarget      target_border;
-  FXDataTarget      target_fore;
-  FXDataTarget      target_hilite;
-  FXDataTarget      target_shadow;
-  FXDataTarget      target_selfore;
-  FXDataTarget      target_selback;
-  FXDataTarget      target_tipfore;
-  FXDataTarget      target_tipback;
-  FXDataTarget      target_menufore;
-  FXDataTarget      target_menuback;
-    
-  FXDataTarget      target_main;
-
-  FXDataTarget      target_typingspeed;
-  FXDataTarget      target_clickspeed;
-  FXDataTarget      target_scrollspeed;
-  FXDataTarget      target_scrolldelay;
-  FXDataTarget      target_blinkspeed;
-  FXDataTarget      target_animspeed;
-  FXDataTarget      target_menupause;
-  FXDataTarget      target_tooltippause;
-  FXDataTarget      target_tooltiptime;
-  FXDataTarget      target_dragdelta;
-  FXDataTarget      target_wheellines;
-  
- 
-
-    
-    public:
-    
-    enum
-    {
-	ID_SAVE = FXDialogBox::ID_LAST,
-	ID_COMMAND_CHANGE,
-	ID_FILETYPE_CHANGE,
-	ID_VFS_CHANGE,
-	ID_NEW_COMMAND,
-	ID_NEW_FILETYPE,
-	ID_NEW_SHUTTER,
-	ID_REMOVE_SHUTTER,
-	ID_REMOVE_COMMAND,
-	ID_MIME_APP,
-	ID_MIME_APP_AUTO,
-	ID_ADD_COMMAND_ADDITIONAL,
-	ID_DEL_COMMAND_ADDITIONAL,
-	ID_ADD_FILETYPE,
-	ID_CHOOSE_COLOR,
-	ID_CHOOSE_BACKCOLOR,
-	ID_COMMANDPLUGIN_CHANGE,
-	ID_ADD_BUTTON_COMMAND,
-	ID_DEL_BUTTON_COMMAND,
-	ID_ADD_SHUTTER_COMMAND,
-	ID_DEL_SHUTTER_COMMAND,
-	ID_ADD_HEADER,
-	ID_DEL_HEADER,
-	ID_SHUTTER_CHANGE,
-	ID_TOOLBAR_CHANGE,
-	ID_DOWNLOAD_INSTALL_CMD_PLUGIN,
-	ID_DOWNLOAD_INSTALL_VFS_PLUGIN,
-	ID_UPDATE_CMD_PLUGIN_LIST,
-	ID_UPDATE_VFS_PLUGIN_LIST,
-	ID_COLORS,
-	ID_CHOOSE_FONT,
-	ID_CHOOSE_CAPTIONFONT1,
-	ID_CHOOSE_CAPTIONFONT2,
-	ID_CHOOSE_CAPTIONFONT3,
-	ID_UPDATE_WINDOW_SIZE,
-	ID_UP_BUTTON_COMMAND,
-	ID_DOWN_BUTTON_COMMAND,
-	ID_UP_SHUTTER_COMMAND,
-	ID_DOWN_SHUTTER_COMMAND,
-	ID_UP_VFS_HEADER,
-	ID_DOWN_VFS_HEADER,
-	ID_UP_COMMAND,
-	ID_DOWN_COMMAND,
-	ID_LAST,
-    };
-
-    preferences (FXWindow * owner);
-
-    long preferences::save (void);
-    long preferences::onCommandChange (FXObject * sender, FXSelector sel, void *);
-    long preferences::onFileTypeChange (FXObject * sender, FXSelector sel, void *);
-    long preferences::onShutterChange (FXObject * sender, FXSelector sel, void *);
-    long preferences::onToolbarChange (FXObject * sender, FXSelector sel, void *);
-    long preferences::onNewCommand (FXObject * sender, FXSelector sel, void *);
-    long preferences::onRemoveCommand (FXObject * sender, FXSelector sel, void *);
-    long preferences::onNewShutter (FXObject * sender, FXSelector sel, void *);
-    long preferences::onRemoveShutter (FXObject * sender, FXSelector sel, void *);
-    long preferences::onOpenMimeApp (FXObject * sender, FXSelector sel, void *);
-    long preferences::onAdditionalCommandChange( FXObject * sender, FXSelector sel, void *);
-    long preferences::onAddFiletype (FXObject * sender, FXSelector sel, void *);
-    long preferences::onChooseColor (FXObject * sender, FXSelector sel, void *);
-    long preferences::onAddButtonCommand (FXObject * sender, FXSelector sel, void *);
-    long preferences::onAddShutterCommand (FXObject * sender, FXSelector sel, void *);
-    long preferences::close (FXObject * sender, FXSelector sel, void *);
-    long preferences::downloadInstallPlugin (FXObject * sender, FXSelector sel, void *);
-    long preferences::updatePluginList (FXObject * sender, FXSelector sel, void *);
-    long preferences::onVfsChange (FXObject * sender, FXSelector sel, void *);
-    long preferences::onAddHeader (FXObject * sender, FXSelector sel, void *);
-    long preferences::onColorChanged(FXObject*,FXSelector,void*);
-    long preferences::onChooseFont(FXObject*,FXSelector,void*);
-    long preferences::updateWindowSize(FXObject * sender, FXSelector sel, void *);
-    long preferences::onUpDown(FXObject * sender, FXSelector sel, void *);
-    long preferences::onUpDownVfsHeader(FXObject * sender, FXSelector sel, void *);
-    long preferences::onUpDownCommand(FXObject * sender, FXSelector sel, void *);
-
-    
-    void preferences::setupColors(void);
-    void preferences::setupFont(int nr);
-    virtual ~ preferences ();
-};
-
-#endif

Deleted: trunk/src/sharedFunctions.cpp
===================================================================
--- trunk/src/sharedFunctions.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/sharedFunctions.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,58 +0,0 @@
-#include "sharedFunctions.h"
-
-//number to string in human readable units
-string numtostring (unsigned long k)
-{
-
-
-    string metric ("B");
-    if (k > 1024)
-    {
-	k /= 1024;
-	metric = "KB";
-	if (k > 1024)
-	{
-	    k /= 1024;
-	    metric = "MB";
-	}
-    }
-
-    char chstr[20];
-    sprintf (chstr, "%d", k);
-
-    string retstrin = string (chstr) + " " + metric;
-
-    return retstrin;
-}
-
-//number to string
-string ntos (unsigned long k)
-{
-    char chstr[20];
-    sprintf (chstr, "%d", k);
-    return chstr;
-}
-
-string mime2xml(string str)
-{
-	for(int i=0;str[i]!= '\0';i++)
-	{
-	 	if(str[i]=='+')
-		str[i]='P';
-	}
-
-
-return str;
-}
-
-string xml2mime(string str)
-{
-	for(int i=0;str[i]!= '\0';i++)
-	{
-	 	if(str[i]=='P')
-		str[i]='+';
-	}
-
-
-return str;
-}

Deleted: trunk/src/sharedFunctions.h
===================================================================
--- trunk/src/sharedFunctions.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/sharedFunctions.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,13 +0,0 @@
-#ifndef SHAREDFUNCTIONS_H
-#define SHAREDFUNCTIONS_HS
-
-#include <string>
-using namespace std;
-
-//some global functions ;p
-string ntos (unsigned long k);
-string numtostring (unsigned long k);
-string mime2xml(string str);
-string xml2mime(string str);
-
-#endif

Deleted: trunk/src/sharedobjects.cpp
===================================================================
--- trunk/src/sharedobjects.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/sharedobjects.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,102 +0,0 @@
-#include "sharedobjects.h"
-
-objectmanager* objectmanager::pinstance = 0;// initialize pointer
-
-objectmanager* objectmanager::instance (FXApp *app) 
-{
-    if (pinstance == 0)  // is it the first call?
-    {  
-        pinstance = new objectmanager(app); // create sole instance
-
-    }
-    return pinstance; // address of sole instance
-}
-objectmanager::objectmanager(FXApp *app) 
-{ 
-    //... perform necessary instance initializations 
-    
-
-    captionfont1 = new FXFont(app,conf->readonestring ("/OpenspaceConfig/fonts/captionfont1").c_str());
-    captionfont1->create ();
-
-    captionfont2 = new FXFont(app,conf->readonestring ("/OpenspaceConfig/fonts/captionfont2").c_str());
-    captionfont2->create ();
-
-    captionfont3 = new FXFont(app,conf->readonestring ("/OpenspaceConfig/fonts/captionfont3").c_str());
-    captionfont3->create ();
-
-    maincolor=fxcolorfromname(conf->readonestring ("/OpenspaceConfig/colors/main").c_str());
-    
-  key_map["a"]                             = 0x0061;
-  key_map["b"]                             = 0x0062;
-  key_map["c"]                             = 0x0063;
-  key_map["d"]                             = 0x0064;
-  key_map["e"]                             = 0x0065;
-  key_map["f"]                             = 0x0066;
-  key_map["g"]                             = 0x0067;
-  key_map["h"]                             = 0x0068;
-  key_map["i"]                             = 0x0069;
-  key_map["j"]                             = 0x006A;
-  key_map["k"]                             = 0x006B;
-  key_map["l"]                             = 0x006C;
-  key_map["m"]                             = 0x006D;
-  key_map["n"]                             = 0x006E;
-  key_map["o"]                             = 0x006F;
-  key_map["p"]                             = 0x0070;
-  key_map["q"]                             = 0x0071;
-  key_map["r"]                             = 0x0072;
-  key_map["s"]                             = 0x0073;
-  key_map["t"]                             = 0x0074;
-  key_map["u"]                             = 0x0075;
-  key_map["v"]                             = 0x0076;
-  key_map["w"]                             = 0x0077;
-  key_map["x"]                             = 0x0078;
-  key_map["y"]                             = 0x0079;
-  key_map["z"]                             = 0x007A;
-  
-  
-  
-  key_map["0"]                             = 0x0030;
-  key_map["1"]                             = 0x0031;
-  key_map["2"]                             = 0x0032;
-  key_map["3"]                             = 0x0033;
-  key_map["4"]                             = 0x0034;
-  key_map["5"]                             = 0x0035;
-  key_map["6"]                             = 0x0036;
-  key_map["7"]                             = 0x0037;
-  key_map["8"]                             = 0x0038;
-  key_map["9"]                             = 0x0039;
-  
-  
-  key_map["BackSpace"]                     = 0xFF08;
-  key_map["Tab"]                           = 0xFF09;
-  key_map["Linefeed"]                      = 0xFF0A;
-  key_map["Clear"]                         = 0xFF0B;
-  key_map["Return"]                        = 0xFF0D;
-  key_map["Pause"]                         = 0xFF13;
-  key_map["Scroll_Lock"]                   = 0xFF14;
-  key_map["Sys_Req"]                       = 0xFF15;
-  key_map["Escape"]                        = 0xFF1B;
-  key_map["Delete"]                        = 0xFFFF;
-  key_map["Multi_key"]                     = 0xFF20;
-  
-  
-  key_map["F1"]                            = 0xFFBE;
-  key_map["F2"]                            = 0xFFBF;
-  key_map["F3"]                            = 0xFFC0;
-  key_map["F4"]                            = 0xFFC1;
-  key_map["F5"]                            = 0xFFC2;
-  key_map["F6"]                            = 0xFFC3;
-  key_map["F7"]                            = 0xFFC4;
-  key_map["F8"]                            = 0xFFC5;
-  key_map["F9"]                            = 0xFFC6;
-  key_map["F10"]                           = 0xFFC7;
-  key_map["F11"]                           = 0xFFC8;
-  key_map["F12"]                           = 0xFFC9;
-  
-  
-  key_map["Space"]                         = 0x0020;
-    
-}
-
-

Deleted: trunk/src/sharedobjects.h
===================================================================
--- trunk/src/sharedobjects.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/sharedobjects.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,42 +0,0 @@
-#ifndef sharedobjects
-#define sharedobjects
-
-#include "configure.h"
-#include "fx.h"
-#include "filetype.h"
-#include "thread_elem.h"
-#include <map>
-using namespace std;
-
-extern configure *conf;
-
-FXColor readcolor (string col);
-FXColor readcolor2 (string col);
-
-class objectmanager 
-{
-  public:
-      static objectmanager* instance(FXApp *app);
-       FXFont *captionfont1, *captionfont2, *captionfont3;
-       FXApp *app;
-       vector < thread_elem * >thread_vec;
-       map < string, file_type * >file_type_settings;
-       map < string, FXIcon * >osicons;
-       FXIcon *specialicons[30];
-       map < string, unsigned int >key_map;
-       FXColor maincolor;
-      
-      
-      
-  protected:
-      objectmanager(FXApp *app);
-      objectmanager(const objectmanager&);
-      objectmanager& operator= (const objectmanager&);
-  private:
-      static objectmanager* pinstance;
-};
-
-
-
-
-#endif

Deleted: trunk/src/shutter.cpp
===================================================================
--- trunk/src/shutter.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/shutter.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,96 +0,0 @@
-#include "fx.h"
-#include "shutter.h"
-
-
-FXDEFMAP (shutter) shutterMap[] =
-{
-FXMAPFUNC (SEL_MOUSEWHEEL, 0, shutter::onMouseWheel), 
-FXMAPFUNC (SEL_COMMAND, shutter::ID_OPEN_SHUTTERITEM, shutter::onOpenItem),};
-
-FXIMPLEMENT (shutter, FXShutter, shutterMap, ARRAYNUMBER (shutterMap))
-//-----SHUTTER------------------------------------------------------------------------------------------------------------------------------------------
-shutter::shutter (FXComposite * p, FXWindow * x):
-FXShutter (p, x, 6667, FRAME_NONE | LAYOUT_FILL_Y | LAYOUT_FILL_X | LAYOUT_TOP | LAYOUT_LEFT | LAYOUT_FIX_WIDTH, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0)
-{
-    setLayoutHints (FRAME_NONE | LAYOUT_FILL_Y | LAYOUT_FILL_X | LAYOUT_TOP | LAYOUT_LEFT);
-
-}
-
-
-//----------------------------------------------------
-
-
-long shutter::onMouseWheel (FXObject * sender, FXSelector, void *ptr)
-{
-
-    FXEvent *event = (FXEvent *) ptr;
-
-
-    int x;
-    if (event->code < 0)
-    {
-	x = getCurrent () + 1;
-	if (x > numChildren () - 1)
-	    x = 0;
-	setCurrent (x);
-    }
-
-    if (event->code > 0)
-    {
-	x = getCurrent () - 1;
-	if (x == -1)
-	    x = numChildren () - 1;
-	setCurrent (x);
-    }
-
-
-    FXMenuPane *menu = (FXMenuPane *) this->getParent ();
-    menu->resize (90, getheight ());
-
-
-    return 1;
-}
-
-//----------------------------------------------------
-
-long shutter::onOpenItem (FXObject * sender, FXSelector sel, void *ptr)
-{
-    FXShutter::onOpenItem (sender, sel, ptr);
-
-
-    FXMenuPane *menu = (FXMenuPane *) ((FXWindow *) sender)->getParent ()->getParent ();
-    menu->resize (90, getheight ());
-
-    return 1;
-}
-
-int shutter::getheight ()
-{
-    int height_size = 0;
-    FXShutterItem *test = (FXShutterItem *) this->getFirst ();
-    int x = getCurrent ();
-    int zz = 0;
-
-    while (test)
-    {
-	if (zz == x)
-	{
-	    FXWindow *wind = test->getContent ()->getFirst ();
-
-	    while (wind)
-	    {
-		height_size += wind->getDefaultHeight ();
-		wind = wind->getNext ();
-	    }
-
-	}
-	test = (FXShutterItem *) test->getNext ();
-	zz++;
-    }
-    if (this->getFirst () != NULL)
-	height_size += (((FXShutterItem *) this->getFirst ())->getButton ()->getDefaultHeight () + 2) * zz - 1;
-    return height_size;
-}
-
-
-//-----SHUTTER------------------------------------------------------------------------------------------------------------------------------------------

Deleted: trunk/src/shutter.h
===================================================================
--- trunk/src/shutter.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/shutter.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,22 +0,0 @@
-#ifndef SHUTTER
-#define SHUTTER
-
-//this is used in filelist popup, this scrolling popup
-class shutter:public FXShutter
-{
-    FXDECLARE (shutter) 
-    friend class FXShutterItem;
-  public:
-     shutter (FXComposite * p, FXWindow * x);
-     shutter ()
-    {
-    }
-    long onMouseWheel (FXObject *, FXSelector, void *);
-    long onOpenItem (FXObject *, FXSelector, void *);
-
-    int getheight (void);
-
-};
-
-
-#endif

Deleted: trunk/src/thread_elem.cpp
===================================================================
--- trunk/src/thread_elem.cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/thread_elem.cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,63 +0,0 @@
-#include "thread_elem.h"
-
-
-thread_elem::thread_elem (void *fb, string command, string options, vector<string> src, string dst)
-{
-    
-
-    this->command = command;
-    this->src = src;
-    this->dst = dst;
-    this->fb = fb;
-    this->options = options;
-
-    init(); 
-
-}
-
-thread_elem::thread_elem (void *fb, string command, string options, string src, string dst)
-{
-    
-    vector<string> src2;
-    src2.push_back(src);
-    
-    this->command = command;
-    this->src = src2;
-    this->dst = dst;
-    this->fb = fb;
-    this->options = options;
-
-    init(); 
-
-}
-
-
-thread_elem::thread_elem ()
-{
-    gui = NULL;
-}
-
-void thread_elem::init(void)
-{
-    str1 = "start";
-    gui = NULL;
-    
-    act_total_size = 0;
-    total_size = 1;
-    file_size = 1;
-    act_file_size = 0;
-
-    tim = new time_t;
-    time (tim);
-
-    end = false;
-    question = false;
-    answer = false;
-    overwrite = false;
-    cancel = false;
-    all = false;
-    error = false;
-
-    act_file_name = "";
-    msg="operation failed";
-}

Deleted: trunk/src/thread_elem.h
===================================================================
--- trunk/src/thread_elem.h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/src/thread_elem.h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,60 +0,0 @@
-#ifndef THREAD_ELEM
-#define THREAD_ELEM
-
-#include <fx.h>
-#include <string>
-#include <vector>
-using namespace std;
-
-#include <time.h>
-
-
-//to execute something as thread you have to create object of this class
-//it is used to send information beetwen main program and threads
-class thread_elem
-{
-  public:
-
-    thread_elem ();
-    thread_elem (void *fb, string command, string options, vector<string> src=vector<string>(), string dst = "");
-    thread_elem (void *fb, string command, string options,string src, string dst = "");
-    void thread_elem::init(void);
-
-    FXMutex mutex;
-    void *gui;
-    void *fb;
-    void *filel;
-
-    string command;
-    vector<string> src;
-    string dst;
-    string options;
-    string msg;
-    int p[2];
-    time_t *tim;
-
-    string str1;
-    string str2;
-    string str3;
-
-    unsigned long total_size;
-    unsigned long act_total_size;
-
-    unsigned long file_size;
-    unsigned long act_file_size;
-
-    string act_file_name;
-
-    bool cancel;
-    bool end;
-    bool question;
-    bool answer;
-    bool overwrite;
-    bool all;
-    bool error;
-    pthread_t pid;
-    FXMenuPane *pane;
-
-};
-
-#endif

Copied: trunk/svnignore (from rev 245, branches/mloskot-style-refactoring/svnignore)

Copied: trunk/templates (from rev 245, branches/mloskot-style-refactoring/templates)


Property changes on: trunk/templates
___________________________________________________________________
Name: svn:ignore
   + *~
*.cache
*LOG
*log
*.kdev*
*.lo
*.loT
*.o
*.status
*.swp
.deps
.libs
libtool
openspacerc
tags
Doxyfile
Makefile


Deleted: trunk/templates/cpp
===================================================================
--- branches/mloskot-style-refactoring/templates/cpp	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/templates/cpp	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,27 +0,0 @@
-// $Id$
-/////////////////////////////////////////////////////////////////////////////
-// This file is part of OpenSpace project.
-//
-// OpenSpace is free software; you can redistribute it and/or modify
-// it under the terms of the GNU General Public License as published by
-// the Free Software Foundation; either version 2 of the License, or
-// (at your option) any later version.
-// 
-// OpenSpace is distributed in the hope that it will be useful,
-// but WITHOUT ANY WARRANTY; without even the implied warranty of
-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-// GNU General Public License for more details.
-//
-// You should have received a copy of the GNU General Public License
-// along with OpenSpace; if not, write to the Free Software
-// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-/////////////////////////////////////////////////////////////////////////////
-//
-// C++ Implementation: $MODULE$
-//
-// Author: $AUTHOR$ <$EMAIL$>, (C) $YEAR$
-//
-// Description: 
-//
-/////////////////////////////////////////////////////////////////////////////
-

Copied: trunk/templates/cpp (from rev 245, branches/mloskot-style-refactoring/templates/cpp)

Deleted: trunk/templates/h
===================================================================
--- branches/mloskot-style-refactoring/templates/h	2006-02-12 13:43:28 UTC (rev 245)
+++ trunk/templates/h	2006-02-12 15:36:06 UTC (rev 246)
@@ -1,26 +0,0 @@
-// $Id$
-/////////////////////////////////////////////////////////////////////////////
-// This file is part of OpenSpace project.
-//
-// OpenSpace is free software; you can redistribute it and/or modify
-// it under the terms of the GNU General Public License as published by
-// the Free Software Foundation; either version 2 of the License, or
-// (at your option) any later version.
-//
-// OpenSpace is distributed in the hope that it will be useful,
-// but WITHOUT ANY WARRANTY; without even the implied warranty of
-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-// GNU General Public License for more details.
-//
-// You should have received a copy of the GNU General Public License
-// along with OpenSpace; if not, write to the Free Software
-// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-/////////////////////////////////////////////////////////////////////////////
-//
-// C++ Interface: $MODULE$
-//
-// Author: $AUTHOR$ <$EMAIL$>, (C) $YEAR$
-//
-// Description: 
-//
-/////////////////////////////////////////////////////////////////////////////

Copied: trunk/templates/h (from rev 245, branches/mloskot-style-refactoring/templates/h)



From compbatant at berlios.de  Sun Feb 12 17:42:49 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 17:42:49 +0100
Subject: [Openspace-svn] r247 - trunk/src
Message-ID: <200602121642.k1CGgnbD004769@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 17:42:45 +0100 (Sun, 12 Feb 2006)
New Revision: 247

Modified:
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring


Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 15:36:06 UTC (rev 246)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 16:42:45 UTC (rev 247)
@@ -482,7 +482,7 @@
     current_path.append ( mc->getText ().text () );
     current_frame->f->path = current_path;
     current_frame->f->opendir ( current_path );
-    current_frame->generate_menu ( current_path, this );
+    current_frame->generateMenu ( current_path, this );
     popupDir ( current_frame->f, current_path, x, y );
 }
 
@@ -501,28 +501,6 @@
         }
     }
 
-    /*
-     
-        if(current_filelist->fb->osopendir(path)==-1)
-        {
-        return 0;
-        }
-     
-     
-     
-     
-     
-        while(1)
-        {
-        osfile os_file=current_filelist->fb->osreaddir();
-            if(os_file.name=="")
-            break;
-        
-            if(os_file.type&FOLDER && os_file.name!="." && os_file.name!="..")
-            vec.push_back (os_file.name);       
-        }
-     
-    */
     unsigned int indx;
     if ( vec.size () > 0 )
     {
@@ -587,7 +565,7 @@
     FXButton * bt = ( FXButton * ) sender;
     box *boxel = ( box * ) bt->getUserData ();
     FXushort id = FXSELID ( sel );
-    int pos = -1;
+
     if ( id == ID_TOCLOSE )
     {
         bool canclose = true;
@@ -603,80 +581,44 @@
         }
         if ( canclose )
         {
-
-            boxel->fr->f->fb->quit ();
-            delete boxel->fr->hf;
-            delete boxel->fr->f->toolbar;
-            delete boxel->fr->f->toolbar2;
-            delete boxel->fr->frame;
+            delete boxel->fr;
             sender = NULL;
-
         }
         else
         {
             FXMessageBox about ( this, "error", "There are some processes connected with this filelist,\n finish them all and then you can close this filelist\n(this behavior will change in the next release of program)", NULL, MBOX_OK | DECOR_TITLE | DECOR_BORDER );
             about.execute ();
-
         }
-
-        return 1;
-
     }
-
     else
     {
-        if ( id == ID_TORIGHT )
-        {
-            pos = 1;
-        }
-
         if ( left_frame->f->getWidth() == 0 )
-            pos = 1;
+            id = ID_TORIGHT;
 
         if ( right_frame->f->getWidth() == 0 )
-            pos = -1;
+            id = ID_TOLEFT;
+	    	    
+		if ( id == ID_TOLEFT )
+   		{
+        	boxel->fr->moveToFront( leftcontrolframe, leftframe );
+        	left_frame->moveToBack(controlframe);
+       	 	left_frame = boxel->fr;
+    		}	
+    		else
+    		{
+        	boxel->fr->moveToFront( rightcontrolframe, rightframe );
+        	right_frame->moveToBack(controlframe);
+        	right_frame = boxel->fr;
+   		}
+    
+    	left_frame->f->filelist_opposite = right_frame->f;
+    	right_frame->f->filelist_opposite = left_frame->f;
+    	boxel->fr->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
 
-
+    	rightframe->recalc ();
+    	leftframe->recalc ();	    
     }
-    if ( pos == -1 )
-    {
-        boxel->fr->frame->reparent ( leftframe );
-        boxel->fr->hf->reparent ( leftcontrolframe );
-        left_frame->hf->reparent ( controlframe );
-        left_frame->f->toolbar->hide();
-        left_frame->f->toolbar2->hide();
-        left_frame->toleft->show ();
-        left_frame->toright->show ();
-        left_frame->toclose->show ();
-        left_frame->frame->hide ();
-        left_frame = boxel->fr;
-        left_frame->frame->show ();
-
-    }
-
-    else
-    {
-        boxel->fr->frame->reparent ( rightframe );
-        boxel->fr->hf->reparent ( rightcontrolframe );
-        right_frame->hf->reparent ( controlframe );
-        right_frame->f->toolbar->hide();
-        right_frame->f->toolbar2->hide();
-        right_frame->toleft->show ();
-        right_frame->toright->show ();
-        right_frame->toclose->show ();
-        right_frame->frame->hide ();
-        right_frame = boxel->fr;
-        right_frame->frame->show ();
-    }
-    left_frame->f->filelist_opposite = right_frame->f;
-    right_frame->f->filelist_opposite = left_frame->f;
-    boxel->fr->toleft->hide ();
-    boxel->fr->toright->hide ();
-    boxel->fr->toclose->hide ();
-    boxel->fr->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
-
-    rightframe->recalc ();
-    leftframe->recalc ();
+   
 }
 
 
@@ -703,31 +645,17 @@
 
         else
             fr = new Frame ( rightcontrolframe, rightframe, pt, this, -1 );
+	    
         if ( left_frame->f->active )
         {
-            left_frame->hf->reparent ( controlframe );
-            left_frame->toleft->show ();
-            left_frame->toright->show ();
-            left_frame->toclose->show ();
-            left_frame->frame->hide ();
-            left_frame->f->toolbar->hide();
-            left_frame->f->toolbar2->hide();
+ 	    left_frame->moveToBack(controlframe);
             left_frame = fr;
-
         }
 
         else
         {
-            right_frame->hf->reparent ( controlframe );
-            right_frame->toleft->show ();
-            right_frame->toright->show ();
-            right_frame->toclose->show ();
-            right_frame->frame->hide ();
-            right_frame->f->toolbar->hide();
-            right_frame->f->toolbar2->hide();
+            right_frame->moveToBack(controlframe);
             right_frame = fr;
-
-
         }
         controlframe->recalc ();
         fr->frame->create ();
@@ -751,10 +679,10 @@
     else if ( id == 666 )       //directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
     {
         if ( left_frame->f->active )
-            left_frame->generate_menu ( left_frame->f->path, this );
+            left_frame->generateMenu( left_frame->f->path, this );
 
         else
-            right_frame->generate_menu ( right_frame->f->path, this );
+            right_frame->generateMenu ( right_frame->f->path, this );
     }
 
     else if ( id == 668 )
@@ -801,7 +729,7 @@
         path = "/";
     boxbackup->fr->f->path = path;
     boxbackup->fr->f->opendir ( path );
-    boxbackup->fr->generate_menu ( path, this );
+    boxbackup->fr->generateMenu( path, this );
 }
 
 
@@ -952,9 +880,9 @@
                     if ( fil->init () != false )
                     {
                         if ( left_frame->f->active )
-                            left_frame->generate_menu ( fil->path, this );
+                            left_frame->generateMenu( fil->path, this );
                         else
-                            right_frame->generate_menu ( fil->path, this );
+                            right_frame->generateMenu( fil->path, this );
                     }
                     else
                     {
@@ -1051,7 +979,6 @@
     te->mutex.unlock ();
 }
 
-
 //NEED TO CHANGE THIS
 long OSMainWindow::onConfigure ( FXObject * sender, FXSelector sel, void *ptr )
 {
@@ -1071,7 +998,6 @@
     float r = right->getWidth ();
     float w = getWidth ();
     ratio = ( float ) l / ( float ) w;
-
 }
 
 //telem is canceled
@@ -1085,15 +1011,11 @@
 }
 
 
-
-
 //load icon from file and put in the array
 void OSMainWindow::loadicons ( string icondir )
 {
-
     objmanager = OSObjectManager::instance( getApp() );
 
-
     FXIconSource *source = new FXIconSource ( getApp () );
     FXString fil = icondir.c_str();
     FXString name = fil + conf->readonestring ( "/OpenspaceConfig/file_types/COMMON/types/dir/icon" ).c_str() + ".png";
@@ -1121,7 +1043,6 @@
     if ( objmanager->specialicons[ 5 ] )
         objmanager->specialicons[ 5 ] ->create();
 
-
     struct stat status;
     struct dirent *dp;
     DIR *dirp;
@@ -1138,26 +1059,18 @@
 
                 //if (name.length () >= 3 && (name.substr (name.length () - 3, 3) == "gif" || name.substr (name.length () - 3, 3) == "png"))
                 {
-
                     string file = icondir;
                     file.append ( name );
                     string shortname = name.substr ( 0, name.length () - 4 );
-
                     FXString fil_name = file.c_str();
-
                     objmanager->osicons[ shortname ] = source->loadIcon ( fil_name );
-
                     objmanager->osicons[ shortname ] ->create ();
-
-
                 }
 
             }
         }
 
     closedir ( dirp );
-
-
 }
 
 
@@ -1204,9 +1117,6 @@
 
 }
 
-
-
-
 //-----FRAME---------------------------------------------------------------------------------------------------------------------------
 Frame::Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position = 0 )
 {
@@ -1242,7 +1152,7 @@
         toright->hide ();
     }
    
-    generate_menu(pathdir,tgt);
+    generateMenu(pathdir,tgt);
 
     frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
     f = new OSFileList ( frame, pt );
@@ -1254,7 +1164,7 @@
 
 
 //generate buttons path for given path
-void Frame::generate_menu ( string path, FXObject * tgt )
+void Frame::generateMenu ( string path, FXObject * tgt )
 {
 
     OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
@@ -1315,3 +1225,35 @@
         prebutton = bt;
     }
 }
+
+
+Frame::~Frame ()
+{
+	    f->fb->quit ();
+    	    delete hf;
+            delete f->toolbar;
+            delete f->toolbar2;
+            delete frame;
+}
+
+
+void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer)
+{
+	hf->reparent ( controlframeContainer );
+	frame->reparent ( frameContainer );
+	toleft->hide ();
+        toright->hide ();
+        toclose->hide ();
+	frame->show ();
+        
+}
+void Frame::moveToBack(FXComposite * controlframeContainer)
+{
+	hf->reparent ( controlframeContainer );
+        f->toolbar->hide();
+        f->toolbar2->hide();
+        toleft->show ();
+        toright->show ();
+        toclose->show ();
+        frame->hide ();
+}

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 15:36:06 UTC (rev 246)
+++ trunk/src/OSMainWindow.h	2006-02-12 16:42:45 UTC (rev 247)
@@ -181,14 +181,11 @@
     FXHorizontalFrame *hf;
 
     Frame (FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position);
-    void generate_menu (string path, FXObject * tgt);
+    void generateMenu (string path, FXObject * tgt);
+    void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer);
+    void Frame::moveToBack(FXComposite * controlframeContainer);
+    ~Frame ();
 
-    ~Frame ()
-    {
-	delete hf;
-	delete f;
-	delete frame;
-    }
 
 
 



From compbatant at berlios.de  Sun Feb 12 18:22:25 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 18:22:25 +0100
Subject: [Openspace-svn] r248 - trunk/src
Message-ID: <200602121722.k1CHMP0e015703@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 18:22:22 +0100 (Sun, 12 Feb 2006)
New Revision: 248

Modified:
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring


Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 16:42:45 UTC (rev 247)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 17:22:22 UTC (rev 248)
@@ -600,23 +600,17 @@
 	    	    
 		if ( id == ID_TOLEFT )
    		{
-        	boxel->fr->moveToFront( leftcontrolframe, leftframe );
+        	boxel->fr->moveToFront( leftcontrolframe, leftframe,right_frame );
         	left_frame->moveToBack(controlframe);
        	 	left_frame = boxel->fr;
     		}	
     		else
     		{
-        	boxel->fr->moveToFront( rightcontrolframe, rightframe );
+        	boxel->fr->moveToFront( rightcontrolframe, rightframe,left_frame );
         	right_frame->moveToBack(controlframe);
         	right_frame = boxel->fr;
    		}
-    
-    	left_frame->f->filelist_opposite = right_frame->f;
-    	right_frame->f->filelist_opposite = left_frame->f;
-    	boxel->fr->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
-
-    	rightframe->recalc ();
-    	leftframe->recalc ();	    
+   
     }
    
 }
@@ -1166,7 +1160,6 @@
 //generate buttons path for given path
 void Frame::generateMenu ( string path, FXObject * tgt )
 {
-
     OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
 
     if (path.length()>1 && path[ 0 ] == '/' && path[ 1 ] == '/' )
@@ -1221,6 +1214,7 @@
 
         else
             firstbutton = bt;
+	    
         bt->setUserData ( new box ( this, prebutton, bt, NULL ) );
         prebutton = bt;
     }
@@ -1237,14 +1231,19 @@
 }
 
 
-void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer)
+void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite)
 {
 	hf->reparent ( controlframeContainer );
 	frame->reparent ( frameContainer );
 	toleft->hide ();
         toright->hide ();
         toclose->hide ();
-	frame->show ();
+	frame->show ();	
+	
+    	frameOpposite->f->filelist_opposite = f;
+    	f->filelist_opposite = frameOpposite->f;    	
+	f->handle ( frameContainer, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );	
+	frameContainer->recalc();
         
 }
 void Frame::moveToBack(FXComposite * controlframeContainer)

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 16:42:45 UTC (rev 247)
+++ trunk/src/OSMainWindow.h	2006-02-12 17:22:22 UTC (rev 248)
@@ -182,7 +182,7 @@
 
     Frame (FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position);
     void generateMenu (string path, FXObject * tgt);
-    void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer);
+    void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite);
     void Frame::moveToBack(FXComposite * controlframeContainer);
     ~Frame ();
 



From compbatant at berlios.de  Sun Feb 12 19:34:56 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 19:34:56 +0100
Subject: [Openspace-svn] r249 - trunk/src
Message-ID: <200602121834.k1CIYuTr026006@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 19:34:35 +0100 (Sun, 12 Feb 2006)
New Revision: 249

Modified:
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring in progress


Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 17:22:22 UTC (rev 248)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 18:34:35 UTC (rev 249)
@@ -185,22 +185,19 @@
             string dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/leftdir/dir" ) );
             string type = conf->readonestring ( "/OpenspaceConfig/leftdir/type" );
             OSPathType pt ( dir, type );
-            left_frame = new Frame ( leftcontrolframe, leftframe, pt, this, -1 );
-            left_frame->f->toolbar->dock( topdock );
-            left_frame->f->toolbar->hide();
-            left_frame->f->toolbar2->dock( rightdock );
-            left_frame->f->toolbar2->hide();
+            left_frame = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+	    	   
+         
 
             dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
             type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
             OSPathType pt2 ( dir, type );
-            right_frame = new Frame ( rightcontrolframe, rightframe, pt2, this, -1 );
+            right_frame = new Frame (controlframe, rightframe, pt2, this,topdock,rightdock);
 
-            right_frame->f->toolbar->dock( topdock );
-            right_frame->f->toolbar2->dock( rightdock );
-
-            left_frame->f->filelist_opposite = right_frame->f;
-            right_frame->f->filelist_opposite = left_frame->f;
+          
+	    left_frame->moveToFront(leftcontrolframe,leftframe,right_frame);
+	    right_frame->moveToFront(rightcontrolframe,rightframe,left_frame);
+	    
             infoframe = new FXVerticalFrame ( ff, LAYOUT_FILL_X );
             networkframe = NULL;
             searchframe = NULL;
@@ -325,19 +322,11 @@
         controlframe->recalc ();
     }
     OSPathType pt ( dir, type, str_server, str_user, str_pass, str_port );
-    Frame *fr = new Frame ( controlframe, leftframe, pt, this, 0 );
+    Frame *fr = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+    fr->create ();
 
-    fr->frame->create ();
-    fr->hf->create ();
-    fr->f->toolbar->dock( topdock );
-    fr->f->toolbar->hide();
-    fr->f->toolbar2->dock( rightdock );
-    fr->f->toolbar2->hide();
-
-
     this->handle ( fr->toleft, FXSEL ( SEL_LEFTBUTTONRELEASE, ID_TOLEFT ), NULL );
 
-    controlframe->recalc ();
 }
 
 
@@ -634,40 +623,25 @@
         type = "archive";
         OSPathType pt ( dir, type, str_server );
         Frame *fr;
-        if ( left_frame->f->active )
-            fr = new Frame ( leftcontrolframe, leftframe, pt, this, -1 );
+	
+        fr = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+	fr->create ();
 
-        else
-            fr = new Frame ( rightcontrolframe, rightframe, pt, this, -1 );
 	    
         if ( left_frame->f->active )
         {
  	    left_frame->moveToBack(controlframe);
             left_frame = fr;
+	    fr->moveToFront( leftcontrolframe, leftframe,right_frame );
         }
-
         else
         {
             right_frame->moveToBack(controlframe);
             right_frame = fr;
+	    fr->moveToFront( rightcontrolframe, rightframe,left_frame );
         }
-        controlframe->recalc ();
-        fr->frame->create ();
-        fr->hf->create ();
-        fr->frame->show ();
-        fr->f->toolbar->dock( topdock );
-        fr->f->toolbar2->dock( rightdock );
 
-        left_frame->f->filelist_opposite = right_frame->f;
-        right_frame->f->filelist_opposite = left_frame->f;
-
-        if ( left_frame->f->active )
-            left_frame->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
-        else
-            right_frame->f->handle ( this, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );
-
-        rightframe->recalc ();
-        leftframe->recalc ();
+	
     }
 
     else if ( id == 666 )       //directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
@@ -1112,7 +1086,7 @@
 }
 
 //-----FRAME---------------------------------------------------------------------------------------------------------------------------
-Frame::Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position = 0 )
+Frame::Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2)
 {
     this->pathdir = pt.dir;
     this->type = pt.type;
@@ -1121,6 +1095,8 @@
     pathdir = path;
     firstbutton=NULL;
     
+    this->dock1=dock1;
+    this->dock2=dock2;
     
     FXButton *prebutton = NULL;
     FXButton *nextbutton = NULL;
@@ -1139,24 +1115,23 @@
         new FXLabel( hf, lab.c_str() );
     }
 
-    if ( position != 0 )
-    {
-        toleft->hide ();
-        toclose->hide ();
-        toright->hide ();
-    }
    
     generateMenu(pathdir,tgt);
 
     frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
     f = new OSFileList ( frame, pt );
-    if ( position == 0 )
-    {
-        frame->hide ();
-    }
+  
+
 }
 
+void Frame::create(void)
+{
+    frame->create ();
+    hf->create ();
+}
 
+
+
 //generate buttons path for given path
 void Frame::generateMenu ( string path, FXObject * tgt )
 {
@@ -1231,7 +1206,7 @@
 }
 
 
-void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite)
+void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite)  
 {
 	hf->reparent ( controlframeContainer );
 	frame->reparent ( frameContainer );
@@ -1241,7 +1216,13 @@
 	frame->show ();	
 	
     	frameOpposite->f->filelist_opposite = f;
-    	f->filelist_opposite = frameOpposite->f;    	
+    	f->filelist_opposite = frameOpposite->f;    
+	f->toolbar->dock(dock1);
+  	f->toolbar2->dock(dock2);
+
+        f->toolbar->show();        
+        f->toolbar2->show();
+		
 	f->handle ( frameContainer, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );	
 	frameContainer->recalc();
         
@@ -1255,4 +1236,8 @@
         toright->show ();
         toclose->show ();
         frame->hide ();
+	f->toolbar->hide();        
+        f->toolbar2->hide();
+	
+	controlframeContainer->recalc ();
 }

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 17:22:22 UTC (rev 248)
+++ trunk/src/OSMainWindow.h	2006-02-12 18:34:35 UTC (rev 249)
@@ -167,6 +167,8 @@
 {
   private:
 	
+	FXDockSite* dock1;
+	FXDockSite* dock2;
   public:
 
     string pathdir;
@@ -180,11 +182,12 @@
     FXVerticalFrame * frame;
     FXHorizontalFrame *hf;
 
-    Frame (FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt, int position);
+    Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2);
     void generateMenu (string path, FXObject * tgt);
     void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite);
     void Frame::moveToBack(FXComposite * controlframeContainer);
     ~Frame ();
+    void create(void);
 
 
 



From compbatant at berlios.de  Sun Feb 12 21:59:39 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 21:59:39 +0100
Subject: [Openspace-svn] r250 - trunk/src
Message-ID: <200602122059.k1CKxdan015150@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 21:59:31 +0100 (Sun, 12 Feb 2006)
New Revision: 250

Modified:
   trunk/src/Makefile
   trunk/src/Makefile.am
   trunk/src/Makefile.in
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
   trunk/src/OSObjectManager.h
Log:
refactoring


Modified: trunk/src/Makefile
===================================================================
--- trunk/src/Makefile	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/Makefile	2006-02-12 20:59:31 UTC (rev 250)
@@ -60,7 +60,8 @@
 	OSMainWindow.$(OBJEXT) OSMimeApp.$(OBJEXT) \
 	OSMimeType.$(OBJEXT) OSObjectManager.$(OBJEXT) \
 	OSPathType.$(OBJEXT) OSPreferences.$(OBJEXT) \
-	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT)
+	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT) \
+	OSFrame.$(OBJEXT)
 openspace_OBJECTS = $(am_openspace_OBJECTS)
 openspace_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I.
@@ -74,7 +75,7 @@
 	./$(DEPDIR)/OSFileTypeInfo.Po \
 	./$(DEPDIR)/OSFileTypeSymbol.Po \
 	./$(DEPDIR)/OSFirstRunDialogBox.Po \
-	./$(DEPDIR)/OSInfoPanel.Po \
+	./$(DEPDIR)/OSFrame.Po ./$(DEPDIR)/OSInfoPanel.Po \
 	./$(DEPDIR)/OSMainWindow.Po \
 	./$(DEPDIR)/OSMimeApp.Po ./$(DEPDIR)/OSMimeType.Po \
 	./$(DEPDIR)/OSObjectManager.Po \
@@ -216,7 +217,8 @@
 	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
 	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
 	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
-	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFrame.h OSFrame.cpp
 
 SUBDIRS = plugins
 INCLUDES = -I$(top_srcdir)/src `WANT_FOX="1.4" fox-config --cflags`  `xml2-config  --cflags`  \
@@ -324,6 +326,7 @@
 include ./$(DEPDIR)/OSFileTypeInfo.Po
 include ./$(DEPDIR)/OSFileTypeSymbol.Po
 include ./$(DEPDIR)/OSFirstRunDialogBox.Po
+include ./$(DEPDIR)/OSFrame.Po
 include ./$(DEPDIR)/OSInfoPanel.Po
 include ./$(DEPDIR)/OSMainWindow.Po
 include ./$(DEPDIR)/OSMimeApp.Po

Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/Makefile.am	2006-02-12 20:59:31 UTC (rev 250)
@@ -8,7 +8,8 @@
 	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
 	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
 	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
-	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFrame.h OSFrame.cpp
 
 SUBDIRS = plugins
 

Modified: trunk/src/Makefile.in
===================================================================
--- trunk/src/Makefile.in	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/Makefile.in	2006-02-12 20:59:31 UTC (rev 250)
@@ -60,7 +60,8 @@
 	OSMainWindow.$(OBJEXT) OSMimeApp.$(OBJEXT) \
 	OSMimeType.$(OBJEXT) OSObjectManager.$(OBJEXT) \
 	OSPathType.$(OBJEXT) OSPreferences.$(OBJEXT) \
-	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT)
+	OSShutter.$(OBJEXT) OSThreadExec.$(OBJEXT) OSUtils.$(OBJEXT) \
+	OSFrame.$(OBJEXT)
 openspace_OBJECTS = $(am_openspace_OBJECTS)
 openspace_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I.
@@ -74,7 +75,7 @@
 @AMDEP_TRUE@	./$(DEPDIR)/OSFileTypeInfo.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/OSFileTypeSymbol.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/OSFirstRunDialogBox.Po \
- at AMDEP_TRUE@	./$(DEPDIR)/OSInfoPanel.Po \
+ at AMDEP_TRUE@	./$(DEPDIR)/OSFrame.Po ./$(DEPDIR)/OSInfoPanel.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/OSMainWindow.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/OSMimeApp.Po ./$(DEPDIR)/OSMimeType.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/OSObjectManager.Po \
@@ -216,7 +217,8 @@
 	OSMimeApp.cpp OSMimeApp.h OSMimeType.cpp OSMimeType.h OSObjectManager.cpp \
 	OSObjectManager.h OSPathType.cpp OSPathType.h OSPreferences.cpp OSPreferences.h \
 	OSShutter.cpp OSShutter.h OSThreadExec.cpp OSThreadExec.h OSUtils.cpp OSUtils.h \
-	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h
+	OSVirtualFileSystemBase.h OSVirtualFileSystemHeader.h OSVirtualFileSystemInfo.h \
+	OSFrame.h OSFrame.cpp
 
 SUBDIRS = plugins
 INCLUDES = -I$(top_srcdir)/src `WANT_FOX="1.4" fox-config --cflags`  `xml2-config  --cflags`  \
@@ -324,6 +326,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileTypeInfo.Po at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFileTypeSymbol.Po at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFirstRunDialogBox.Po at am__quote@
+ at AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSFrame.Po at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSInfoPanel.Po at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMainWindow.Po at am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote at ./$(DEPDIR)/OSMimeApp.Po at am__quote@

Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 20:59:31 UTC (rev 250)
@@ -1,13 +1,6 @@
 #include "config.h"
-#include <string>
-#include <vector>
-#include <map>
-using namespace std;
 
-#include "fx.h" 
-// #include "FXPNGIcon.h"
 #include "OSThreadExec.h"
-#include "OSFileList.h"
 #include "OSObjectManager.h"
 #include "OSMainWindow.h"
 #include "OSInfoPanel.h"
@@ -21,20 +14,13 @@
 #include <unistd.h>
 #include <dirent.h>
 
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else /*  */
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif /*  */
+
 using namespace FX;
 FXDEFMAP ( OSMainWindow ) OSMainWindowMap[] =
     {
 
         //________Message_Type_____________________ID____________Message_Handler_______
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_DIRCH, OSMainWindow::onChangeDir ),
-        // FXMAPFUNC(SEL_ENTER, OSMainWindow::ID_DIRCH,   OSMainWindow::onListNextDir),
-        // FXMAPFUNC(SEL_LEAVE, OSMainWindow::ID_DIRCH,   OSMainWindow::onListNextDir),
         FXMAPFUNC ( SEL_RIGHTBUTTONRELEASE, OSMainWindow::ID_DIR, OSMainWindow::onListDirs ),
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_DIR, OSMainWindow::onOpenDir ),
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_CONFIGURE, OSMainWindow::onOpenConfigure ),
@@ -185,14 +171,14 @@
             string dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/leftdir/dir" ) );
             string type = conf->readonestring ( "/OpenspaceConfig/leftdir/type" );
             OSPathType pt ( dir, type );
-            left_frame = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+            left_frame = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
 	    	   
          
 
             dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
             type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
             OSPathType pt2 ( dir, type );
-            right_frame = new Frame (controlframe, rightframe, pt2, this,topdock,rightdock);
+            right_frame = new OSFrame (controlframe, rightframe, pt2, this,topdock,rightdock);
 
           
 	    left_frame->moveToFront(leftcontrolframe,leftframe,right_frame);
@@ -322,7 +308,7 @@
         controlframe->recalc ();
     }
     OSPathType pt ( dir, type, str_server, str_user, str_pass, str_port );
-    Frame *fr = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+    OSFrame *fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
     fr->create ();
 
     this->handle ( fr->toleft, FXSEL ( SEL_LEFTBUTTONRELEASE, ID_TOLEFT ), NULL );
@@ -622,9 +608,9 @@
         dir = "/";
         type = "archive";
         OSPathType pt ( dir, type, str_server );
-        Frame *fr;
+        OSFrame *fr;
 	
-        fr = new Frame ( controlframe, leftframe, pt, this,topdock,rightdock);
+        fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
 	fr->create ();
 
 	    
@@ -1085,159 +1071,3 @@
 
 }
 
-//-----FRAME---------------------------------------------------------------------------------------------------------------------------
-Frame::Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2)
-{
-    this->pathdir = pt.dir;
-    this->type = pt.type;
-    string path = pathdir;
-    hf = new FXHorizontalFrame ( cp, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
-    pathdir = path;
-    firstbutton=NULL;
-    
-    this->dock1=dock1;
-    this->dock2=dock2;
-    
-    FXButton *prebutton = NULL;
-    FXButton *nextbutton = NULL;
-
-    OSObjectManager*objmanager = OSObjectManager::instance( cp->getApp() );
-
-    toleft = new FXButton ( hf, "", objmanager->osicons[ "left" ], tgt, OSMainWindow::ID_TOLEFT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
-    toleft->setUserData ( new box ( this, NULL, NULL, NULL ) );
-    toclose = new FXButton ( hf, "", objmanager->osicons[ "close" ], tgt, OSMainWindow::ID_TOCLOSE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
-    toclose->setUserData ( new box ( this, NULL, NULL, NULL ) );
-    toright = new FXButton ( hf, "", objmanager->osicons[ "right" ], tgt, OSMainWindow::ID_TORIGHT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
-    toright->setUserData ( new box ( this, NULL, NULL, NULL ) );
-    if ( pt.server != "" )
-    {
-        string lab = pt.server + ": ";
-        new FXLabel( hf, lab.c_str() );
-    }
-
-   
-    generateMenu(pathdir,tgt);
-
-    frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
-    f = new OSFileList ( frame, pt );
-  
-
-}
-
-void Frame::create(void)
-{
-    frame->create ();
-    hf->create ();
-}
-
-
-
-//generate buttons path for given path
-void Frame::generateMenu ( string path, FXObject * tgt )
-{
-    OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
-
-    if (path.length()>1 && path[ 0 ] == '/' && path[ 1 ] == '/' )
-        path.erase ( 0, 1 );
-	
-    	if(firstbutton!=NULL)
-	{	
-    	box *boxel = ( box * ) firstbutton->getUserData ();
-    	box *boxbackup = boxel;
-    		while ( boxel )
-    		{
-        		box * boxel_del = boxel;
-       			if ( boxel->nextbutton != NULL )
-            		boxel = ( box * ) boxel->nextbutton->getUserData ();
-        		else
-            		boxel = NULL;
-			
-       		delete boxel_del->bt;
-        	delete boxel_del;
-       		boxel_del->bt = NULL;
-        	boxel_del = NULL;
-    		}
-    	}
-	
-    this->pathdir = path;
-    int z = 0;
-    FXButton *prebutton = NULL;
-    FXButton *nextbutton = NULL;
-    while ( z != -1 )
-    {
-        string path_element = "";
-        z = path.find ( SEPARATOR, 1 );
-        if ( z == -1 )
-            path_element.append ( path );
-
-        else
-            path_element.append ( path.substr ( 0, z ) );
-        path.erase ( 0, z );
-        FXButton *bt = new FXButton ( hf, path_element.c_str (), NULL, tgt,
-                                      OSMainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
-                                      0, 0 );
-        bt->setBackColor ( objmanager->maincolor );
-	
-	if(firstbutton!=NULL)
-        bt->create ();
-	
-        if ( prebutton != NULL )
-        {
-            box * boxel = ( box * ) prebutton->getUserData ();
-            boxel->nextbutton = bt;
-        }
-
-        else
-            firstbutton = bt;
-	    
-        bt->setUserData ( new box ( this, prebutton, bt, NULL ) );
-        prebutton = bt;
-    }
-}
-
-
-Frame::~Frame ()
-{
-	    f->fb->quit ();
-    	    delete hf;
-            delete f->toolbar;
-            delete f->toolbar2;
-            delete frame;
-}
-
-
-void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite)  
-{
-	hf->reparent ( controlframeContainer );
-	frame->reparent ( frameContainer );
-	toleft->hide ();
-        toright->hide ();
-        toclose->hide ();
-	frame->show ();	
-	
-    	frameOpposite->f->filelist_opposite = f;
-    	f->filelist_opposite = frameOpposite->f;    
-	f->toolbar->dock(dock1);
-  	f->toolbar2->dock(dock2);
-
-        f->toolbar->show();        
-        f->toolbar2->show();
-		
-	f->handle ( frameContainer, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );	
-	frameContainer->recalc();
-        
-}
-void Frame::moveToBack(FXComposite * controlframeContainer)
-{
-	hf->reparent ( controlframeContainer );
-        f->toolbar->hide();
-        f->toolbar2->hide();
-        toleft->show ();
-        toright->show ();
-        toclose->show ();
-        frame->hide ();
-	f->toolbar->hide();        
-        f->toolbar2->hide();
-	
-	controlframeContainer->recalc ();
-}

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/OSMainWindow.h	2006-02-12 20:59:31 UTC (rev 250)
@@ -1,28 +1,20 @@
 #ifndef MAINWINDOW
 #define MAINWINDOW
 
+#include <string>
+#include <vector>
 #include <map>
-using namespace std;
 
+#include "fx.h" 
+
+#include "OSFrame.h"
 #include "OSPathType.h"
 #include "OSFileList.h"
 #include "OSFileTypeSymbol.h"
 
+using namespace std;
 
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
-#endif
 
-
-//--------------------------------------------------------------------------------------------------------------------------------------------------    
-
-class box;
-class Frame;
-
-
 //the main application window
 
 class OSMainWindow:public FXMainWindow
@@ -108,11 +100,9 @@
     FXTextField *password;
     FXTextField *port;
 
-    Frame *fr;
-
-    Frame *current_frame;
-    Frame *left_frame;
-    Frame *right_frame;
+    OSFrame *current_frame;
+    OSFrame *left_frame;
+    OSFrame *right_frame;
     FXMenuPane *pane;
     OSPreferences *pref;
     float ratio;
@@ -137,65 +127,4 @@
 
 
 
-//--------------------------------------------------------------------------------------------------------------------------------------------------
-
-class Frame;
-
-class box
-{
-
-  public:
-
-    Frame * fr;
-    FXButton *prebutton;
-    FXButton *bt;
-    FXButton *nextbutton;
-
-
-     box (Frame * fr, FXButton * prebutton, FXButton * bt, FXButton * nextbutton)
-    {
-	this->bt = bt;
-	this->fr = fr;
-	this->prebutton = prebutton;
-	this->nextbutton = nextbutton;
-    }
-
-};
-
-
-class Frame
-{
-  private:
-	
-	FXDockSite* dock1;
-	FXDockSite* dock2;
-  public:
-
-    string pathdir;
-    string type;
-    OSFileList *f;
-    FXButton *toleft;
-    FXButton *toright;
-    FXButton *toclose;
-    FXButton *firstbutton;
-    
-    FXVerticalFrame * frame;
-    FXHorizontalFrame *hf;
-
-    Frame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2);
-    void generateMenu (string path, FXObject * tgt);
-    void Frame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,Frame * frameOpposite);
-    void Frame::moveToBack(FXComposite * controlframeContainer);
-    ~Frame ();
-    void create(void);
-
-
-
-
-};
-
-
-
-
-
 #endif

Modified: trunk/src/OSObjectManager.h
===================================================================
--- trunk/src/OSObjectManager.h	2006-02-12 18:34:35 UTC (rev 249)
+++ trunk/src/OSObjectManager.h	2006-02-12 20:59:31 UTC (rev 250)
@@ -34,6 +34,14 @@
 #include <fx.h>
 #include <map>
 
+#ifdef WIN32
+#define SEPARATOR "\\"
+#else
+#include <dlfcn.h>
+#define SEPARATOR "/"
+#endif
+
+
 using namespace std;
 
 extern OSConfigure *conf;



From compbatant at berlios.de  Sun Feb 12 23:21:06 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sun, 12 Feb 2006 23:21:06 +0100
Subject: [Openspace-svn] r251 - trunk/src
Message-ID: <200602122221.k1CML63e020081@sheep.berlios.de>

Author: compbatant
Date: 2006-02-12 23:21:00 +0100 (Sun, 12 Feb 2006)
New Revision: 251

Modified:
   trunk/src/OSFileList.cpp
   trunk/src/OSFileList.h
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring


Modified: trunk/src/OSFileList.cpp
===================================================================
--- trunk/src/OSFileList.cpp	2006-02-12 20:59:31 UTC (rev 250)
+++ trunk/src/OSFileList.cpp	2006-02-12 22:21:00 UTC (rev 251)
@@ -369,10 +369,9 @@
 
 OSFileList::~OSFileList ()
 {
-    
 
+    fb->quit ();
 
-
     delete sortpop;
     FXTRACE ((5, "destruct\n"));
 
@@ -424,7 +423,7 @@
     
     }
     
-    return opendir (this->path);
+    return openDir (this->path);
     
 
 }
@@ -644,7 +643,7 @@
 }
 
 //opendir
-bool OSFileList::opendir (string dir)
+bool OSFileList::openDir (string dir)
 {
 
 
@@ -655,7 +654,9 @@
     if (fb->osopendir (dir) == -1)
     {
     return false;
-    }   
+    }
+path=dir;    
+       
 clearItems ();
 
 
@@ -1080,10 +1081,8 @@
 
     if (command == "other")
     {
-        path = filelist_opposite->path;
-        //label->setText(path.c_str());
-        notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-        opendir (filelist_opposite->path);
+        openDir (filelist_opposite->path);
+	notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
     }
     else if (command == "copy" || command == "move" || command == "remove")
     {
@@ -1139,8 +1138,7 @@
     }    
     else if (command == "home")
     {
-         opendir(FXFile::getHomeDirectory ().text ());
-         path=FXFile::getHomeDirectory ().text ();
+         openDir(FXFile::getHomeDirectory ().text ());
          notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
     } 
     else if (command == "dirup")
@@ -1260,8 +1258,7 @@
        }
        else if(command == "goto_dir")
        {
-    opendir (textfield->getText ().text ());
-    path = textfield->getText ().text ();
+    openDir (textfield->getText ().text ());
     notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
        }
        else if (command == "get_dir")
@@ -1382,11 +1379,9 @@
     ;
     //label->setText(path.c_str());
     
-    if(opendir (dir))
+    if(openDir (dir))
     {
-    path = dir;
     notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-    
     }  
     }
     else
@@ -1421,9 +1416,8 @@
 
    string pathnew = FXFile::upLevel (path.c_str ()).text ();
     
-    if(opendir (pathnew));
+    if(openDir (pathnew));
     {
-    this->path = pathnew;
     notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
     
     }
@@ -1733,7 +1727,7 @@
 {
     if (processing)
     return;
-    opendir (path);
+    openDir (path);
 }
 
 //----------------------------------------------------   

Modified: trunk/src/OSFileList.h
===================================================================
--- trunk/src/OSFileList.h	2006-02-12 20:59:31 UTC (rev 250)
+++ trunk/src/OSFileList.h	2006-02-12 22:21:00 UTC (rev 251)
@@ -44,7 +44,7 @@
 
 private:
 
-
+    string path;
     string previous_path;
     string type;
     OSPathType *pt;
@@ -91,20 +91,20 @@
     FXString dragfiles;     // Dragged files
 
     void dropData ( bool clipboard );
-    void OSFileList::selectitem ( void );
-    void OSFileList::start_thread ( OSThreadExec * te );
+    void selectitem ( void );
+    void start_thread ( OSThreadExec * te );
 
-    void OSFileList::copymoveremove ( string com_name );
-    static void *OSFileList::thread_func ( void *data );
+    void copymoveremove ( string com_name );
+    static void *thread_func ( void *data );
     static FXint cmp ( const FXIconItem * a, const FXIconItem * b );
 
 
     string returnpath( string dirname );
-    string OSFileList::getdefaultcommand ( string name );
-    string OSFileList::resolvecommand( string command, string name );
-    int OSFileList::runCommand( string name );
-    static string OSFileList::getfiletype ( string name );
-    long OSFileList::setKeys ( void );
+    string getdefaultcommand ( string name );
+    string resolvecommand( string command, string name );
+    int runCommand( string name );
+    static string getfiletype ( string name );
+    long setKeys ( void );
 
 public:
 
@@ -120,7 +120,7 @@
     FXIcon **specialicons;
     FXToolBar *toolbar, *toolbar2;
 
-    string path;
+    
     bool active;
     OSVirtualFileSystemBase * fb;
     OSFileList *filelist_opposite;
@@ -138,7 +138,8 @@
 
     void OSFileList::refresh ( void );
     bool OSFileList::init ( void );
-    bool OSFileList::opendir ( string dir );
+    bool OSFileList::openDir ( string dir );
+    string OSFileList::getDir (  ){return path;}
 
     long OSFileList::setFocus ( FXObject * obj, FXSelector sel, void *ptr );
     long OSFileList::lostFocus ( FXObject * obj, FXSelector sel, void *ptr );

Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 20:59:31 UTC (rev 250)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 22:21:00 UTC (rev 251)
@@ -123,9 +123,12 @@
                 }
             }
 
+    	    if ( conf->readonestring ( "/OpenspaceConfig/panels" ) == "single" )
+                ratio = 0;
+            else
+                ratio = 1.0 / 2.0;
 
 
-
             topdock = new FXDockSite ( this, LAYOUT_SIDE_TOP | LAYOUT_FILL_X );
             bottomdock = new FXDockSite ( this, LAYOUT_SIDE_BOTTOM | LAYOUT_FILL_X );
             leftdock = new FXDockSite ( this, LAYOUT_SIDE_LEFT | LAYOUT_FILL_Y );
@@ -137,24 +140,18 @@
             FXToolBar *toolbar = new FXToolBar ( topdock, dragshell1, LAYOUT_DOCK_NEXT | LAYOUT_SIDE_TOP | FRAME_RAISED );
             new FXToolBarGrip ( toolbar, toolbar, FXToolBar::ID_TOOLBARGRIP, TOOLBARGRIP_SINGLE );
 
-
-
-
             FXVerticalFrame *ff = new FXVerticalFrame ( this, LAYOUT_FILL_X | LAYOUT_FILL_Y );
             controlframe = new FXVerticalFrame ( ff, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
             splitter = new FXSplitter ( ff, LAYOUT_FILL_X | SPLITTER_TRACKING | LAYOUT_FILL_Y );
             left = new FXVerticalFrame ( splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0 );
             right = new FXVerticalFrame ( splitter, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_NONE, 0, 0, w / 2, 0, 0, 0, 0 );
-            if ( conf->readonestring ( "/OpenspaceConfig/panels" ) == "single" )
-                ratio = 0;
-
-            else
-                ratio = 1.0 / 2.0;
+	    
+     		
             leftcontrolframe = new FXVerticalFrame ( left, LAYOUT_FILL_X );
             leftframe = new FXVerticalFrame ( left, LAYOUT_FILL_X | LAYOUT_FILL_Y );
             rightcontrolframe = new FXVerticalFrame ( right, LAYOUT_FILL_X );
             rightframe = new FXVerticalFrame ( right, LAYOUT_FILL_X | LAYOUT_FILL_Y );
-            //   FXHorizontalFrame * buttonsframe = new FXHorizontalFrame (toolbar, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
+
             new FXButton ( toolbar, "\thide/show copy/move progress", objmanager->osicons[ "plus" ], this, OSMainWindow::ID_COMMANDS_SHOW, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
             new FXButton ( toolbar, "\topen new panel", objmanager->osicons[ "directory" ], this, OSMainWindow::ID_NEWFRAME, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
             new FXButton ( toolbar, "\tconnect", objmanager->osicons[ "network" ], this, OSMainWindow::ID_NEW_NETWORK, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
@@ -174,7 +171,6 @@
             left_frame = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
 	    	   
          
-
             dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
             type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
             OSPathType pt2 ( dir, type );
@@ -264,11 +260,9 @@
     else
     {
 
-
         if ( networkframe == NULL )  //search
         {
 
-
             string s_size_greater = search_size_greater->getText().text();
             string s_size_less = search_size_less->getText().text();
             string s_dir = search_path->getText().text();
@@ -376,9 +370,9 @@
         new FXLabel ( searchframe, "path: " );
         search_path = new FXTextField ( searchframe, 20 );
         if ( left_frame->f->active )
-            search_path->setText( left_frame->f->path.c_str() );
+            search_path->setText( left_frame->getDir().c_str() );
         else
-            search_path->setText( right_frame->f->path.c_str() );
+            search_path->setText( right_frame->getDir().c_str() );
         new FXLabel ( searchframe, "size" );
         new FXLabel ( searchframe, "greater than(KB):" );
         search_size_greater = new FXTextField ( searchframe, 10 );
@@ -441,22 +435,21 @@
 //executed when we change directory clicking directory name in popoup window
 long OSMainWindow::onChangeDir ( FXObject * sender, FXSelector, void *ptr )
 {
-    OSFileList * fil = current_frame->f;
-    FXTRACE ( ( 5, "CHANGE DIR\n", fil->path.c_str () ) );
+
     FXMenuCommand *mc = ( FXMenuCommand * ) sender;
     FXEvent *event = ( FXEvent * ) ptr;
     FXWindow *win = ( FXWindow * ) mc->getParent ();
     int x = win->getX ();
     int y = win->getY ();
-    string p = fil->path;
-    string current_path = p;
+ 
+    string current_path = current_frame->getDir();
 
     if ( current_path != "/" )
         current_path.append ( SEPARATOR );
 
     current_path.append ( mc->getText ().text () );
-    current_frame->f->path = current_path;
-    current_frame->f->opendir ( current_path );
+    current_frame->openDir( current_path );
+
     current_frame->generateMenu ( current_path, this );
     popupDir ( current_frame->f, current_path, x, y );
 }
@@ -526,14 +519,46 @@
         path.append ( boxel->bt->getText ().text () );
         boxel = ( box * ) boxel->nextbutton->getUserData ();
     }
-    current_frame->f->path = path;
-    current_frame->f->opendir ( path );
+    current_frame->openDir ( path );
     FXEvent *event = ( FXEvent * ) ptr;
     int x = event->root_x;
     int y = event->root_y;
     popupDir ( current_frame->f, path, x, y );
 }
 
+
+
+//pressed button in path
+long OSMainWindow::onOpenDir ( FXObject * sender, FXSelector, void *ptr )
+{
+    FXTRACE ( ( 5, "OPEN DIR\n" ) );
+    FXButton *bt = ( FXButton * ) sender;
+    box *boxel = ( box * ) bt->getUserData ();
+    box *boxbackup = boxel;
+    if ( boxel->fr != right_frame && boxel->fr != left_frame )
+        return 0;
+    string path = "";
+    while ( boxel->prebutton != NULL )
+    {
+        boxel = ( box * ) boxel->prebutton->getUserData ();
+    }
+    while ( boxel != NULL )
+    {
+        if ( boxel == boxbackup )
+        {
+            break;
+        }
+        path.append ( boxel->bt->getText ().text () );
+        boxel = ( box * ) boxel->nextbutton->getUserData ();
+    }
+    if ( path == "" )
+        path = "/";
+
+    boxbackup->fr->openDir ( path );
+    boxbackup->fr->generateMenu( path, this );
+}
+
+
 //change position or close frame
 long OSMainWindow::onChangeList ( FXObject * sender, FXSelector sel, void *ptr )
 {
@@ -567,10 +592,10 @@
     }
     else
     {
-        if ( left_frame->f->getWidth() == 0 )
+        if ( leftframe->getWidth() == 0 )
             id = ID_TORIGHT;
 
-        if ( right_frame->f->getWidth() == 0 )
+        if ( rightframe->getWidth() == 0 )
             id = ID_TOLEFT;
 	    	    
 		if ( id == ID_TOLEFT )
@@ -633,10 +658,10 @@
     else if ( id == 666 )       //directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
     {
         if ( left_frame->f->active )
-            left_frame->generateMenu( left_frame->f->path, this );
+            left_frame->generateMenu( left_frame->getDir(), this );
 
         else
-            right_frame->generateMenu ( right_frame->f->path, this );
+            right_frame->generateMenu ( right_frame->getDir(), this );
     }
 
     else if ( id == 668 )
@@ -656,35 +681,6 @@
 }
 
 
-//pressed button in path
-long OSMainWindow::onOpenDir ( FXObject * sender, FXSelector, void *ptr )
-{
-    FXTRACE ( ( 5, "OPEN DIR\n" ) );
-    FXButton *bt = ( FXButton * ) sender;
-    box *boxel = ( box * ) bt->getUserData ();
-    box *boxbackup = boxel;
-    if ( boxel->fr != right_frame && boxel->fr != left_frame )
-        return 0;
-    string path = "";
-    while ( boxel->prebutton != NULL )
-    {
-        boxel = ( box * ) boxel->prebutton->getUserData ();
-    }
-    while ( boxel != NULL )
-    {
-        if ( boxel == boxbackup )
-        {
-            break;
-        }
-        path.append ( boxel->bt->getText ().text () );
-        boxel = ( box * ) boxel->nextbutton->getUserData ();
-    }
-    if ( path == "" )
-        path = "/";
-    boxbackup->fr->f->path = path;
-    boxbackup->fr->f->opendir ( path );
-    boxbackup->fr->generateMenu( path, this );
-}
 
 
 //executed cyclically to update informations about progress of copying/moving/deleteing files
@@ -834,9 +830,9 @@
                     if ( fil->init () != false )
                     {
                         if ( left_frame->f->active )
-                            left_frame->generateMenu( fil->path, this );
+                            left_frame->generateMenu( fil->getDir(), this );
                         else
-                            right_frame->generateMenu( fil->path, this );
+                            right_frame->generateMenu( fil->getDir(), this );
                     }
                     else
                     {

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 20:59:31 UTC (rev 250)
+++ trunk/src/OSMainWindow.h	2006-02-12 22:21:00 UTC (rev 251)
@@ -46,8 +46,6 @@
     virtual ~ OSMainWindow ();
     virtual void create ();
 
-
-
     long OSMainWindow::onListDirs (FXObject * sender, FXSelector, void *);
     long OSMainWindow::onChangeDir (FXObject * sender, FXSelector, void *);
     long OSMainWindow::onChangeList (FXObject * sender, FXSelector, void *);
@@ -67,19 +65,17 @@
     long OSMainWindow::onUpdate (FXObject * sender, FXSelector sel, void *);
     long OSMainWindow::onConfigure (FXObject * sender, FXSelector sel, void *);
 
-    int OSMainWindow::popupDir (OSFileList * current_filelist, string path, int x, int y);
 
-    string OSMainWindow::parseDir (string dir);
-    bool OSMainWindow::loadMimeSettings (string path, string type);
-
-
-
   private:
-     OSMainWindow ()
+    OSMainWindow ()
     {
     }
+    
     void OSMainWindow::loadicons (string dir);
-
+    int OSMainWindow::popupDir (OSFileList * current_filelist, string path, int x, int y);
+    string OSMainWindow::parseDir (string dir);
+    bool OSMainWindow::loadMimeSettings (string path, string type);
+    
     FXVerticalFrame *leftframe;
     FXVerticalFrame *rightframe;
     FXVerticalFrame *infoframe;
@@ -108,23 +104,18 @@
     float ratio;
 
 
-    FXToolBarShell *dragshell1;	// Shell for floating menubar
-    FXToolBarShell *dragshell2;	// Shell for floating toolbar
-    FXToolBarShell *dragshell3;	// Shell for floating toolbar
-    FXToolBarShell *dragshell4;	// Shell for floating toolbar
+    FXToolBarShell *dragshell1;	
+    FXToolBarShell *dragshell2;	
+    FXToolBarShell *dragshell3;
+    FXToolBarShell *dragshell4;
     FXDockSite *topdock;
     FXDockSite *bottomdock;
     FXDockSite *leftdock;
     FXDockSite *rightdock;
     
-    FXComboBox *filelisttypecombobox;
-    
-OSObjectManager *objmanager;
+    FXComboBox *filelisttypecombobox;    
+    OSObjectManager *objmanager;
 };
 
 
-
-
-
-
 #endif



From compbatant at berlios.de  Mon Feb 13 00:49:12 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Mon, 13 Feb 2006 00:49:12 +0100
Subject: [Openspace-svn] r252 - trunk/src
Message-ID: <200602122349.k1CNnCtk017528@sheep.berlios.de>

Author: compbatant
Date: 2006-02-13 00:48:56 +0100 (Mon, 13 Feb 2006)
New Revision: 252

Added:
   trunk/src/OSFileListController.h
   trunk/src/OSFrame.cpp
   trunk/src/OSFrame.h
Modified:
   trunk/src/OSFileList.cpp
   trunk/src/OSFileList.h
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring :]


Modified: trunk/src/OSFileList.cpp
===================================================================
--- trunk/src/OSFileList.cpp	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSFileList.cpp	2006-02-12 23:48:56 UTC (rev 252)
@@ -110,7 +110,7 @@
 
 
 
-OSFileList::OSFileList (FXComposite * p, OSPathType pt):
+OSFileList::OSFileList (FXComposite * p, OSPathType pt,long id,OSFileListController* controller):
 FXIconList (p, this, ID_ICO, LAYOUT_FILL_X | LAYOUT_FILL_Y | ICONLIST_EXTENDEDSELECT | ICONLIST_COLUMNS)
 {
 objmanager=OSObjectManager::instance(getApp());
@@ -126,6 +126,7 @@
 FXScrollArea::horizontal->setHiliteColor(FXRGB(255, 255, 255));
 FXScrollArea::horizontal->setBorderColor(FXRGB(255, 255, 255));
 FXScrollArea::horizontal->setBackColor(objmanager->maincolor);
+this->id=id;
 
     flags |= FLAG_ENABLED | FLAG_DROPTARGET;
     popupmenu = NULL;
@@ -171,6 +172,8 @@
 
 
     notifyparent = getShell ();
+    
+    this->controller=controller;
 
     active = false;
 
@@ -656,7 +659,8 @@
     return false;
     }
 path=dir;    
-       
+controller->dirChange(id);  
+    
 clearItems ();
 
 
@@ -1082,7 +1086,6 @@
     if (command == "other")
     {
         openDir (filelist_opposite->path);
-	notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
     }
     else if (command == "copy" || command == "move" || command == "remove")
     {
@@ -1139,7 +1142,6 @@
     else if (command == "home")
     {
          openDir(FXFile::getHomeDirectory ().text ());
-         notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
     } 
     else if (command == "dirup")
     {
@@ -1258,8 +1260,7 @@
        }
        else if(command == "goto_dir")
        {
-    openDir (textfield->getText ().text ());
-    notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
+   	 openDir (textfield->getText ().text ());
        }
        else if (command == "get_dir")
        {
@@ -1379,10 +1380,8 @@
     ;
     //label->setText(path.c_str());
     
-    if(openDir (dir))
-    {
-    notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-    }  
+    openDir (dir);
+  
     }
     else
     {    
@@ -1416,11 +1415,8 @@
 
    string pathnew = FXFile::upLevel (path.c_str ()).text ();
     
-    if(openDir (pathnew));
-    {
-    notifyparent->handle (this, FXSEL (SEL_COMMAND, 666), NULL);
-    
-    }
+    openDir (pathnew);
+
 }
 
 

Modified: trunk/src/OSFileList.h
===================================================================
--- trunk/src/OSFileList.h	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSFileList.h	2006-02-12 23:48:56 UTC (rev 252)
@@ -35,7 +35,9 @@
 #include <string>
 #include <map>
 #include "OSPreferences.h"
+#include "OSFileListController.h"
 
+
 //OSFileList
 class OSFileList: public FXIconList
 {
@@ -48,6 +50,9 @@
     string previous_path;
     string type;
     OSPathType *pt;
+    long id;
+    
+    OSFileListController *controller;  
 
     FXWindow *notifyparent;
     FXLabel *label;
@@ -112,7 +117,7 @@
     virtual ~OSFileList( void );
 
     //==============================================
-    OSFileList ( FXComposite * p, OSPathType pt );
+    OSFileList ( FXComposite * p, OSPathType pt ,long id,OSFileListController* controller);
     //==============================================
 
 

Added: trunk/src/OSFileListController.h
===================================================================
--- trunk/src/OSFileListController.h	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSFileListController.h	2006-02-12 23:48:56 UTC (rev 252)
@@ -0,0 +1,13 @@
+#ifndef __OSFILELISTCONTROLLER_H__
+#define __OSFILELISTCONTROLLER_H__
+
+class OSFileListController
+{
+public:
+	virtual void dirChange(long id)=0;
+	virtual void getFocus(long id)=0;
+
+};
+
+
+#endif

Added: trunk/src/OSFrame.cpp
===================================================================
--- trunk/src/OSFrame.cpp	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSFrame.cpp	2006-02-12 23:48:56 UTC (rev 252)
@@ -0,0 +1,171 @@
+#include "OSFrame.h" 
+#include "OSMainWindow.h" 
+
+OSFrame::OSFrame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2,long id,OSFileListController* controller)
+{
+    this->pathdir = pt.dir;
+    this->type = pt.type;
+    this->id=id;
+    string path = pathdir;
+    hf = new FXHorizontalFrame ( cp, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
+    pathdir = path;
+    firstbutton=NULL;
+    
+    this->dock1=dock1;
+    this->dock2=dock2;
+    
+    FXButton *prebutton = NULL;
+    FXButton *nextbutton = NULL;
+
+    OSObjectManager*objmanager = OSObjectManager::instance( cp->getApp() );
+
+    toleft = new FXButton ( hf, "", objmanager->osicons[ "left" ], tgt, OSMainWindow::ID_TOLEFT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toleft->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    toclose = new FXButton ( hf, "", objmanager->osicons[ "close" ], tgt, OSMainWindow::ID_TOCLOSE, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toclose->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    toright = new FXButton ( hf, "", objmanager->osicons[ "right" ], tgt, OSMainWindow::ID_TORIGHT, FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
+    toright->setUserData ( new box ( this, NULL, NULL, NULL ) );
+    if ( pt.server != "" )
+    {
+        string lab = pt.server + ": ";
+        new FXLabel( hf, lab.c_str() );
+    }
+
+   
+    generateMenu(pathdir,tgt);
+
+    frame = new FXVerticalFrame ( p, LAYOUT_FILL_X | LAYOUT_FILL_Y | FRAME_SUNKEN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );
+    f = new OSFileList ( frame, pt, id, controller );
+  
+
+}
+
+void OSFrame::create(void)
+{
+    frame->create ();
+    hf->create ();
+}
+
+
+
+//generate buttons path for given path
+void OSFrame::generateMenu ( string path, FXObject * tgt )
+{
+    OSObjectManager * objmanager = OSObjectManager::instance( hf->getApp() );
+
+    if (path.length()>1 && path[ 0 ] == '/' && path[ 1 ] == '/' )
+        path.erase ( 0, 1 );
+	
+    	if(firstbutton!=NULL)
+	{	
+    	box *boxel = ( box * ) firstbutton->getUserData ();
+    	box *boxbackup = boxel;
+    		while ( boxel )
+    		{
+        		box * boxel_del = boxel;
+       			if ( boxel->nextbutton != NULL )
+            		boxel = ( box * ) boxel->nextbutton->getUserData ();
+        		else
+            		boxel = NULL;
+			
+       		delete boxel_del->bt;
+        	delete boxel_del;
+       		boxel_del->bt = NULL;
+        	boxel_del = NULL;
+    		}
+    	}
+	
+    this->pathdir = path;
+    int z = 0;
+    FXButton *prebutton = NULL;
+    FXButton *nextbutton = NULL;
+    while ( z != -1 )
+    {
+        string path_element = "";
+        z = path.find ( SEPARATOR, 1 );
+        if ( z == -1 )
+            path_element.append ( path );
+
+        else
+            path_element.append ( path.substr ( 0, z ) );
+        path.erase ( 0, z );
+        FXButton *bt = new FXButton ( hf, path_element.c_str (), NULL, tgt,
+                                      OSMainWindow::ID_DIR, FRAME_THICK, 0, 0, 0, 0, 0, 0,
+                                      0, 0 );
+        bt->setBackColor ( objmanager->maincolor );
+	
+	if(firstbutton!=NULL)
+        bt->create ();
+	
+        if ( prebutton != NULL )
+        {
+            box * boxel = ( box * ) prebutton->getUserData ();
+            boxel->nextbutton = bt;
+        }
+
+        else
+            firstbutton = bt;
+	    
+        bt->setUserData ( new box ( this, prebutton, bt, NULL ) );
+        prebutton = bt;
+    }
+}
+
+
+OSFrame::~OSFrame ()
+{
+	    
+    	    delete hf;
+            delete f;
+            delete frame;
+}
+
+bool OSFrame::openDir(string dir)
+{
+	return f->openDir(dir);
+}
+
+
+string OSFrame::getDir(void)
+{
+	return f->getDir();
+}
+
+
+void OSFrame::moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,OSFrame * frameOpposite)  
+{
+	hf->reparent ( controlframeContainer );
+	frame->reparent ( frameContainer );
+	toleft->hide ();
+        toright->hide ();
+        toclose->hide ();
+	frame->show ();	
+	
+    	frameOpposite->f->filelist_opposite = f;
+	
+    	f->filelist_opposite = frameOpposite->f;    
+	f->toolbar->dock(dock1);
+  	f->toolbar2->dock(dock2);
+        f->toolbar->show();        
+        f->toolbar2->show();		
+	f->handle ( frameContainer, FXSEL ( SEL_FOCUSIN, OSFileList::ID_ICO ), NULL );	
+	
+	frameContainer->recalc();
+        
+}
+void OSFrame::moveToBack(FXComposite * controlframeContainer)
+{
+	hf->reparent ( controlframeContainer );
+	
+        f->toolbar->hide();
+        f->toolbar2->hide();
+	
+        toleft->show ();
+        toright->show ();
+        toclose->show ();
+        frame->hide ();
+
+	
+	controlframeContainer->recalc ();
+}
+

Added: trunk/src/OSFrame.h
===================================================================
--- trunk/src/OSFrame.h	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSFrame.h	2006-02-12 23:48:56 UTC (rev 252)
@@ -0,0 +1,70 @@
+#ifndef OSFRAME
+#define OSFRAME
+
+#include <string>
+#include "fx.h" 
+
+#include "OSFileList.h"
+
+using namespace std;
+
+class OSFrame;
+
+class box
+{
+
+  public:
+
+    OSFrame * fr;
+    FXButton *prebutton;
+    FXButton *bt;
+    FXButton *nextbutton;
+    
+
+     box (OSFrame * fr, FXButton * prebutton, FXButton * bt, FXButton * nextbutton)
+    {
+	this->bt = bt;
+	this->fr = fr;
+	this->prebutton = prebutton;
+	this->nextbutton = nextbutton;
+    }
+
+};
+
+
+class OSFrame
+{
+  private:
+	
+	FXDockSite* dock1;
+	FXDockSite* dock2;
+  public:
+
+    long id;
+    string pathdir;
+    string type;
+    OSFileList *f;
+    FXButton *toleft;
+    FXButton *toright;
+    FXButton *toclose;
+    FXButton *firstbutton;
+    
+    FXVerticalFrame * frame;
+    FXHorizontalFrame *hf;
+
+    OSFrame ( FXComposite * cp, FXComposite * p, OSPathType pt, FXObject * tgt,FXDockSite* dock1,FXDockSite* dock2,long id,OSFileListController* controller);
+    void generateMenu (string path, FXObject * tgt);
+    void moveToFront(FXComposite * controlframeContainer,FXComposite * frameContainer,OSFrame * frameOpposite);
+    void moveToBack(FXComposite * controlframeContainer);
+    bool openDir(string dir);
+    string getDir(void);
+    
+    ~OSFrame ();
+    void create(void);
+
+
+
+
+};
+
+#endif

Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSMainWindow.cpp	2006-02-12 23:48:56 UTC (rev 252)
@@ -57,6 +57,7 @@
             pane = NULL;
             filemenu = NULL;
             pref = NULL;
+	    lastId=0;
 
             string fontdesc = conf->readonestring ( "/OpenspaceConfig/fonts/normalfont" );
             FXFont *font = new FXFont( getApp(), fontdesc.c_str() );
@@ -168,13 +169,13 @@
             string dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/leftdir/dir" ) );
             string type = conf->readonestring ( "/OpenspaceConfig/leftdir/type" );
             OSPathType pt ( dir, type );
-            left_frame = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
+            left_frame = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
 	    	   
          
             dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
             type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
             OSPathType pt2 ( dir, type );
-            right_frame = new OSFrame (controlframe, rightframe, pt2, this,topdock,rightdock);
+            right_frame = new OSFrame (controlframe, rightframe, pt2, this,topdock,rightdock,lastId++,this);
 
           
 	    left_frame->moveToFront(leftcontrolframe,leftframe,right_frame);
@@ -302,7 +303,7 @@
         controlframe->recalc ();
     }
     OSPathType pt ( dir, type, str_server, str_user, str_pass, str_port );
-    OSFrame *fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
+    OSFrame *fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
     fr->create ();
 
     this->handle ( fr->toleft, FXSEL ( SEL_LEFTBUTTONRELEASE, ID_TOLEFT ), NULL );
@@ -635,7 +636,7 @@
         OSPathType pt ( dir, type, str_server );
         OSFrame *fr;
 	
-        fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock);
+        fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
 	fr->create ();
 
 	    
@@ -655,15 +656,6 @@
 	
     }
 
-    else if ( id == 666 )       //directory change, for example user clicked double on direcotry, or clicked with 3rd button to go to parent dir
-    {
-        if ( left_frame->f->active )
-            left_frame->generateMenu( left_frame->getDir(), this );
-
-        else
-            right_frame->generateMenu ( right_frame->getDir(), this );
-    }
-
     else if ( id == 668 )
     {
         if ( left->getWidth () == 0 || right->getWidth () == 0 )
@@ -1067,3 +1059,18 @@
 
 }
 
+
+void OSMainWindow::dirChange(long id)
+{
+
+	if(left_frame->id==id)	
+	left_frame->generateMenu( left_frame->getDir(), this );
+	else
+	right_frame->generateMenu( right_frame->getDir(), this );
+
+}
+
+void OSMainWindow::getFocus(long id)
+{
+
+}

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 22:21:00 UTC (rev 251)
+++ trunk/src/OSMainWindow.h	2006-02-12 23:48:56 UTC (rev 252)
@@ -11,13 +11,13 @@
 #include "OSPathType.h"
 #include "OSFileList.h"
 #include "OSFileTypeSymbol.h"
-
+#include "OSFileListController.h"
 using namespace std;
 
 
 //the main application window
 
-class OSMainWindow:public FXMainWindow
+class OSMainWindow:public FXMainWindow, public OSFileListController
 {
   FXDECLARE (OSMainWindow) public:
     enum
@@ -65,7 +65,10 @@
     long OSMainWindow::onUpdate (FXObject * sender, FXSelector sel, void *);
     long OSMainWindow::onConfigure (FXObject * sender, FXSelector sel, void *);
 
+    void dirChange(long id);
+    void getFocus(long id);
 
+
   private:
     OSMainWindow ()
     {
@@ -102,6 +105,8 @@
     FXMenuPane *pane;
     OSPreferences *pref;
     float ratio;
+    
+    long lastId;
 
 
     FXToolBarShell *dragshell1;	



From compbatant at berlios.de  Mon Feb 13 14:17:50 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Mon, 13 Feb 2006 14:17:50 +0100
Subject: [Openspace-svn] r253 - trunk/src
Message-ID: <200602131317.k1DDHoji011643@sheep.berlios.de>

Author: compbatant
Date: 2006-02-13 14:17:30 +0100 (Mon, 13 Feb 2006)
New Revision: 253

Modified:
   trunk/src/OSFileList.cpp
   trunk/src/OSFileListController.h
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
Log:
refactoring


Modified: trunk/src/OSFileList.cpp
===================================================================
--- trunk/src/OSFileList.cpp	2006-02-12 23:48:56 UTC (rev 252)
+++ trunk/src/OSFileList.cpp	2006-02-13 13:17:30 UTC (rev 253)
@@ -800,9 +800,10 @@
 long OSFileList::setFocus (FXObject * obj, FXSelector sel, void *ptr)
 {
 
-setKeys();
+    setKeys();
     active = true;
     filelist_opposite->active = false;
+    controller->getFocus(id);
     filelist_opposite->toolbar->hide();
     filelist_opposite->toolbar2->hide();        
     toolbar->show();
@@ -1014,8 +1015,7 @@
     if (command_type == "VFS")  //internal command, open new window for virtual file system
     {
         int c = getCurrentItem ();
-        string *file = new string (returnpath(getItemText (c).text ()));
-        notifyparent->handle (this, FXSEL (SEL_COMMAND, 667), (void *) file);
+	controller->openVfs(id,returnpath(getItemText (c).text ()));
         return 0;
     }
     else if (command_type == "EXTERNAL" || command_type=="")
@@ -1233,7 +1233,8 @@
          {
             conf->saveonestring ("/OpenspaceConfig/panels", "double");
          }
-     notifyparent->handle (this, FXSEL (SEL_COMMAND, 668), NULL);
+     
+         controller->splitFileList(id);
     
     }
     else if(command == "filter_files")

Modified: trunk/src/OSFileListController.h
===================================================================
--- trunk/src/OSFileListController.h	2006-02-12 23:48:56 UTC (rev 252)
+++ trunk/src/OSFileListController.h	2006-02-13 13:17:30 UTC (rev 253)
@@ -6,6 +6,8 @@
 public:
 	virtual void dirChange(long id)=0;
 	virtual void getFocus(long id)=0;
+	virtual void splitFileList(long id)=0;
+	virtual void openVfs(long id,string file)=0;
 
 };
 

Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-12 23:48:56 UTC (rev 252)
+++ trunk/src/OSMainWindow.cpp	2006-02-13 13:17:30 UTC (rev 253)
@@ -30,7 +30,6 @@
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEWFRAME, OSMainWindow::onNewFrame ),
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEW_NETWORK, OSMainWindow::onNewNetworkFrame ),
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_NEW_SEARCH, OSMainWindow::onNewSearchFrame ),
-        FXMAPFUNCS ( SEL_COMMAND, 666, 668, OSMainWindow::onNotify ),
         FXMAPFUNC ( SEL_TIMEOUT, OSMainWindow::ID_TIMER, OSMainWindow::onTimer ),
         FXMAPFUNC ( SEL_COMMAND, OSMainWindow::ID_COMMANDS_SHOW, OSMainWindow::commandsShow ),
         FXMAPFUNC ( SEL_CONFIGURE, 0, OSMainWindow::onConfigure ),
@@ -370,10 +369,9 @@
         searchframe = new FXHorizontalFrame ( controlframe, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0 );
         new FXLabel ( searchframe, "path: " );
         search_path = new FXTextField ( searchframe, 20 );
-        if ( left_frame->f->active )
-            search_path->setText( left_frame->getDir().c_str() );
-        else
-            search_path->setText( right_frame->getDir().c_str() );
+ 
+        search_path->setText( current_frame->getDir().c_str() );
+ 
         new FXLabel ( searchframe, "size" );
         new FXLabel ( searchframe, "greater than(KB):" );
         search_size_greater = new FXTextField ( searchframe, 10 );
@@ -617,64 +615,6 @@
 }
 
 
-//notify from filelist
-long OSMainWindow::onNotify ( FXObject * sender, FXSelector sel, void *ptr )
-{
-    FXTRACE ( ( 5, "NOTIFY\n" ) );
-    FXushort id = FXSELID ( sel );
-    if ( id == 667 )
-    {
-        string * file_ptr = ( string * ) ptr;
-        string file = *file_ptr;
-        FXTRACE ( ( 5, "change to directory %s\n", file.c_str () ) );
-        delete file_ptr;
-        string dir;
-        string type;
-        string str_server = file;
-        dir = "/";
-        type = "archive";
-        OSPathType pt ( dir, type, str_server );
-        OSFrame *fr;
-	
-        fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
-	fr->create ();
-
-	    
-        if ( left_frame->f->active )
-        {
- 	    left_frame->moveToBack(controlframe);
-            left_frame = fr;
-	    fr->moveToFront( leftcontrolframe, leftframe,right_frame );
-        }
-        else
-        {
-            right_frame->moveToBack(controlframe);
-            right_frame = fr;
-	    fr->moveToFront( rightcontrolframe, rightframe,left_frame );
-        }
-
-	
-    }
-
-    else if ( id == 668 )
-    {
-        if ( left->getWidth () == 0 || right->getWidth () == 0 )
-            left->setWidth ( getWidth () / 2 );
-
-        else
-        {
-            if ( left_frame->f == ( OSFileList * ) sender )
-                left->setWidth ( right->getWidth () + left->getWidth () );
-
-            else
-                left->setWidth ( 0 );
-        }
-    }
-}
-
-
-
-
 //executed cyclically to update informations about progress of copying/moving/deleteing files
 //using vector of special objects OSThreadExec to read from them information and to write request
 //for example stoping copying.
@@ -821,10 +761,7 @@
                     FXTRACE ( ( 5, "INIT \n" ) );
                     if ( fil->init () != false )
                     {
-                        if ( left_frame->f->active )
-                            left_frame->generateMenu( fil->getDir(), this );
-                        else
-                            right_frame->generateMenu( fil->getDir(), this );
+                    current_frame->generateMenu( fil->getDir(), this );   
                     }
                     else
                     {
@@ -1072,5 +1009,58 @@
 
 void OSMainWindow::getFocus(long id)
 {
+	if(left_frame->id==id)	
+		current_frame=left_frame;
+	else
+		current_frame=right_frame;	
 
 }
+
+void OSMainWindow::splitFileList(long id)
+{
+
+ if ( left->getWidth () == 0 || right->getWidth () == 0 )
+            left->setWidth ( getWidth () / 2 );
+
+        else
+        {
+            if ( left_frame->id == id )
+                left->setWidth ( right->getWidth () + left->getWidth () );
+
+            else
+                left->setWidth ( 0 );
+        }
+}	
+
+void OSMainWindow::openVfs(long id,string file)
+{
+
+        FXTRACE ( ( 5, "change to directory %s\n", file.c_str () ) );
+
+        string dir;
+        string type;
+        string str_server = file;
+        dir = "/";
+        type = "archive";
+        OSPathType pt ( dir, type, str_server );
+        OSFrame *fr;
+	
+        fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
+	fr->create ();
+
+	    
+        if ( left_frame==current_frame)
+        {
+ 	    left_frame->moveToBack(controlframe);
+            left_frame = fr;
+	    fr->moveToFront( leftcontrolframe, leftframe,right_frame );
+        }
+        else
+        {
+            right_frame->moveToBack(controlframe);
+            right_frame = fr;
+	    fr->moveToFront( rightcontrolframe, rightframe,left_frame );
+        }
+	
+}
+	

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-12 23:48:56 UTC (rev 252)
+++ trunk/src/OSMainWindow.h	2006-02-13 13:17:30 UTC (rev 253)
@@ -65,10 +65,12 @@
     long OSMainWindow::onUpdate (FXObject * sender, FXSelector sel, void *);
     long OSMainWindow::onConfigure (FXObject * sender, FXSelector sel, void *);
 
+
     void dirChange(long id);
     void getFocus(long id);
+    void splitFileList(long id);
+    void openVfs(long id,string file);
 
-
   private:
     OSMainWindow ()
     {



From compbatant at berlios.de  Fri Feb 17 23:33:36 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Fri, 17 Feb 2006 23:33:36 +0100
Subject: [Openspace-svn] r254 - trunk/src
Message-ID: <200602172233.k1HMXaFm002490@sheep.berlios.de>

Author: compbatant
Date: 2006-02-17 23:33:34 +0100 (Fri, 17 Feb 2006)
New Revision: 254

Modified:
   trunk/src/OSFileList.cpp
   trunk/src/OSFrame.cpp
Log:
seg fault usuniety przy zamykaniu okien


Modified: trunk/src/OSFileList.cpp
===================================================================
--- trunk/src/OSFileList.cpp	2006-02-13 13:17:30 UTC (rev 253)
+++ trunk/src/OSFileList.cpp	2006-02-17 22:33:34 UTC (rev 254)
@@ -374,7 +374,6 @@
 {
 
     fb->quit ();
-
     delete sortpop;
     FXTRACE ((5, "destruct\n"));
 

Modified: trunk/src/OSFrame.cpp
===================================================================
--- trunk/src/OSFrame.cpp	2006-02-13 13:17:30 UTC (rev 253)
+++ trunk/src/OSFrame.cpp	2006-02-17 22:33:34 UTC (rev 254)
@@ -116,8 +116,9 @@
 {
 	    
     	    delete hf;
-            delete f;
-            delete frame;
+	    delete f->toolbar;
+	    delete f->toolbar2;
+	    delete frame;
 }
 
 bool OSFrame::openDir(string dir)



From compbatant at berlios.de  Sat Feb 18 18:08:31 2006
From: compbatant at berlios.de (compbatant at berlios.de)
Date: Sat, 18 Feb 2006 18:08:31 +0100
Subject: [Openspace-svn] r255 - in trunk/src: . plugins/filelist
Message-ID: <200602181708.k1IH8VEt029684@sheep.berlios.de>

Author: compbatant
Date: 2006-02-18 18:08:23 +0100 (Sat, 18 Feb 2006)
New Revision: 255

Modified:
   trunk/src/OSFileList.cpp
   trunk/src/OSFileList.h
   trunk/src/OSMainWindow.cpp
   trunk/src/OSMainWindow.h
   trunk/src/OSThreadExec.cpp
   trunk/src/OSThreadExec.h
   trunk/src/OSVirtualFileSystemBase.h
   trunk/src/plugins/filelist/OSVfsArchive.cpp
   trunk/src/plugins/filelist/OSVfsArchive.h
   trunk/src/plugins/filelist/OSVfsFtp.cpp
   trunk/src/plugins/filelist/OSVfsFtp.h
   trunk/src/plugins/filelist/OSVfsLocal.cpp
   trunk/src/plugins/filelist/OSVfsLocal.h
   trunk/src/plugins/filelist/OSVfsSearch.cpp
   trunk/src/plugins/filelist/OSVfsSearch.h
Log:
refactoring


Modified: trunk/src/OSFileList.cpp
===================================================================
--- trunk/src/OSFileList.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSFileList.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -25,41 +25,35 @@
 //
 /////////////////////////////////////////////////////////////////////////////
 
-#include "OSFileList.h"
 
+
 #include <string>
 #include <map>
 #include <vector>
 #include <list>
 
-
-#include "OSMimeType.h"
-
-#include "OSPathType.h"
 #include "fx.h"
-#include "OSFile.h"
 #include "FXDLL.h"
-#include "OSCMDDialogBox.h"
-#include <fcntl.h>
-#include <sys/vfs.h>
 #include <fxkeys.h>
 
+#include "OSFileList.h"
+#include "OSMimeType.h"
+#include "OSFile.h"
+#include "OSObjectManager.h"
+#include "OSFileListItem.h"
+#include "OSShutter.h"
+#include "OSUtils.h"
 
+#include <fcntl.h>
+#include <sys/vfs.h>
 #include <time.h>
+#include <sys/mount.h>
 
 
-#include "OSObjectManager.h"
 
-#include "OSFileListItem.h"
-#include "OSShutter.h"
-
-#ifdef WIN32
-#define SEPARATOR "\\"
-#else
-#include <dlfcn.h>
-#define SEPARATOR "/"
+#ifndef WIN32
+	#include <dlfcn.h>
 #endif
-#include <sys/mount.h>
 
 
 #ifndef PATH_LIBDIR
@@ -90,8 +84,6 @@
     FXMAPFUNC (SEL_DND_REQUEST, 0, OSFileList::onDNDRequest),
     FXMAPFUNC (SEL_BEGINDRAG, 0, OSFileList::onBeginDrag),
     FXMAPFUNC (SEL_ENDDRAG, 0, OSFileList::onEndDrag),
-    //FXMAPFUNC (SEL_CLIPBOARD_LOST, 0, OSFileList::onClipboardLost), 
-    //FXMAPFUNC (SEL_CLIPBOARD_GAINED, 0, OSFileList::onClipboardGained), 
     FXMAPFUNC (SEL_CLIPBOARD_REQUEST, 0, OSFileList::onClipboardRequest),
         
     };
@@ -101,15 +93,10 @@
      bool OSFileList::strcase = false;
 
 
-
-
 //-----FILELIST----------------------------------------------------------------------------------------------------------------------------------------- 
 
 
 
-
-
-
 OSFileList::OSFileList (FXComposite * p, OSPathType pt,long id,OSFileListController* controller):
 FXIconList (p, this, ID_ICO, LAYOUT_FILL_X | LAYOUT_FILL_Y | ICONLIST_EXTENDEDSELECT | ICONLIST_COLUMNS)
 {
@@ -261,24 +248,12 @@
     transform (firstLetter.begin(),firstLetter.end(), firstLetter.begin(), ::toupper);
 
     string pluginName="libOSVfs"+firstLetter+this->type.substr(1,this->type.length()-1);
+    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/filelist/" +pluginName + ".so";
 
-    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/filelist/" +pluginName;
 
-
-#ifdef WIN32
-    plugin_path += ".dll";
-#else
-    plugin_path += ".so";
-#endif
-
     if(!FXFile::exists(plugin_path.c_str()))
     {
-    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libVfs")+ pluginName;
-    #ifdef WIN32
-    plugin_path += ".dll";
-    #else
-    plugin_path += ".so";
-    #endif
+    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/filelist/libVfs")+ pluginName + ".so";
     }
 
     void *dllhandle = fxdllOpen (plugin_path.c_str ());
@@ -292,11 +267,8 @@
     FXIconListSortFunc sortfunc = OSFileList::cmp;
     setSortFunc (sortfunc);
 
-//label=new FXLabel (p,this->path.c_str());
     info = new FXLabel (p, fb->info ().c_str ());
-    
 
-    //bottomframe = new FXHorizontalFrame (toolbar, LAYOUT_FILL_X | FRAME_THICK, 0, 0, 0, 0, 0, 0, 0, 0);
     textfield = new FXTextField (toolbar, 30, this, OSFileList::ID_TEXTFIELD_RUN);
 
     dial = NULL;
@@ -353,7 +325,7 @@
     if (1)
     {
         processing = true;
-        OSThreadExec *el = new OSThreadExec ((void*)fb, string("init"), string("none"));
+        OSThreadExec *el = new OSThreadExec (fb, string("init"), string("none"));
         start_thread (el);
     }
     else
@@ -387,7 +359,7 @@
 
 
     if (!processing)
-    fb->init (&vector_name,*pt, conf);
+    fb->init (id, &vector_name,*pt, conf);
 
     for (int i = 0; i < vector_name.size (); i++)
     {
@@ -657,10 +629,10 @@
     {
     return false;
     }
-path=dir;    
-controller->dirChange(id);  
+	path=dir;    
+	controller->dirChange(id);  
     
-clearItems ();
+	clearItems ();
 
 
     for (int indx = 0; indx < icon_vec.size (); indx++)
@@ -988,7 +960,7 @@
     else if (el->command == "init")
     {
 
-    fb->init (&filel->vector_name, (*(filel->pt)), conf);
+    fb->init (filel->id, &filel->vector_name, (*(filel->pt)), conf);
 
     }
 
@@ -1260,28 +1232,25 @@
        }
        else if(command == "goto_dir")
        {
-   	 openDir (textfield->getText ().text ());
+           openDir (textfield->getText ().text ());
        }
        else if (command == "get_dir")
        {
-    textfield->setText (path.c_str ());
+           textfield->setText (path.c_str ());
        }
        else if(command=="show_hide_hidden_files")
        {
-       show_hidden_files=!show_hidden_files;
-       refresh();
+           show_hidden_files=!show_hidden_files;
+           refresh();
        
          if(show_hidden_files)
-     conf->saveonestring ("/OpenspaceConfig/show_hidden_files","true");
-     else
-     conf->saveonestring ("/OpenspaceConfig/show_hidden_files","false");
+         conf->saveonestring ("/OpenspaceConfig/show_hidden_files","true");
+         else
+         conf->saveonestring ("/OpenspaceConfig/show_hidden_files","false");
        
        }
 
     
-    
-    
-    
     }
 
     else if (command_type == "PLUGIN")
@@ -1290,21 +1259,11 @@
 
 
 
-    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/cmddialog/lib" + command;
-#ifdef WIN32
-    plugin_path += ".dll";
-#else
-    plugin_path += ".so";
-#endif
+    string plugin_path = string(PATH_LIBDIR) + "/openspace/plugins/cmddialog/lib" + command + ".so";
 
     if(!FXFile::exists(plugin_path.c_str()))
     {
-    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/cmddialog")+"/lib" + command;
-    #ifdef WIN32
-    plugin_path += ".dll";
-    #else
-    plugin_path += ".so";
-    #endif
+    plugin_path = FXFile::getUserDirectory ("").text ()+string("/.openspace/plugins/cmddialog")+"/lib" + command + ".so";
     }
 
 

Modified: trunk/src/OSFileList.h
===================================================================
--- trunk/src/OSFileList.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSFileList.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -27,15 +27,17 @@
 #ifndef __FILELIST_H__
 #define __FILELIST_H__
 
+
+#include <string>
+#include <map>
+
 #include "OSVirtualFileSystemBase.h"
 #include "OSPathType.h"
 #include "OSThreadExec.h"
 #include "OSFileTypeSymbol.h"
 #include "OSCMDDialogBox.h"
-#include <string>
-#include <map>
-#include "OSPreferences.h"
 #include "OSFileListController.h"
+#include "OSObjectManager.h"
 
 
 //OSFileList

Modified: trunk/src/OSMainWindow.cpp
===================================================================
--- trunk/src/OSMainWindow.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSMainWindow.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -169,13 +169,14 @@
             string type = conf->readonestring ( "/OpenspaceConfig/leftdir/type" );
             OSPathType pt ( dir, type );
             left_frame = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
+	    OSFrameMap[lastId]=left_frame;
 	    	   
          
             dir = parseDir ( conf->readonestring ( "/OpenspaceConfig/rightdir/dir" ) );
             type = conf->readonestring ( "/OpenspaceConfig/rightdir/type" );
             OSPathType pt2 ( dir, type );
             right_frame = new OSFrame (controlframe, rightframe, pt2, this,topdock,rightdock,lastId++,this);
-
+	    OSFrameMap[lastId]=right_frame;
           
 	    left_frame->moveToFront(leftcontrolframe,leftframe,right_frame);
 	    right_frame->moveToFront(rightcontrolframe,rightframe,left_frame);
@@ -303,6 +304,7 @@
     }
     OSPathType pt ( dir, type, str_server, str_user, str_pass, str_port );
     OSFrame *fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
+    OSFrameMap[lastId]=fr;
     fr->create ();
 
     this->handle ( fr->toleft, FXSEL ( SEL_LEFTBUTTONRELEASE, ID_TOLEFT ), NULL );
@@ -573,7 +575,7 @@
         for ( iter = objmanager->thread_vec.begin (); iter != objmanager->thread_vec.end (); iter++ )
         {
             OSThreadExec *telem = *iter;
-            if ( telem->fb == boxel->fr->f->fb )
+            if ( telem->id == boxel->fr->id )
             {
                 canclose = false;
             }
@@ -1046,6 +1048,7 @@
         OSFrame *fr;
 	
         fr = new OSFrame ( controlframe, leftframe, pt, this,topdock,rightdock,lastId++,this);
+	OSFrameMap[lastId]=fr;
 	fr->create ();
 
 	    

Modified: trunk/src/OSMainWindow.h
===================================================================
--- trunk/src/OSMainWindow.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSMainWindow.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -12,6 +12,7 @@
 #include "OSFileList.h"
 #include "OSFileTypeSymbol.h"
 #include "OSFileListController.h"
+#include "OSPreferences.h"
 using namespace std;
 
 
@@ -122,6 +123,8 @@
     
     FXComboBox *filelisttypecombobox;    
     OSObjectManager *objmanager;
+    
+    std::map <long, OSFrame*> OSFrameMap;
 };
 
 

Modified: trunk/src/OSThreadExec.cpp
===================================================================
--- trunk/src/OSThreadExec.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSThreadExec.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -34,7 +34,7 @@
     gui = NULL;
 }
 
-OSThreadExec::OSThreadExec( void *fb, std::string command, std::string options, std::string src, std::string dst )
+OSThreadExec::OSThreadExec(OSVirtualFileSystemBase *fb, std::string command, std::string options, std::string src, std::string dst )
 {
     std::vector<std::string> src2;
     src2.push_back( src );
@@ -44,18 +44,22 @@
     this->dst = dst;
     this->fb = fb;
     this->options = options;
+    this->id=fb->id;
 
+
+
     init();
 
 }
 
-OSThreadExec::OSThreadExec( void *fb, std::string command, std::string options, std::vector<std::string> src, std::string dst )
+OSThreadExec::OSThreadExec(OSVirtualFileSystemBase *fb, std::string command, std::string options, std::vector<std::string> src, std::string dst )
 {
     this->command = command;
     this->src = src;
     this->dst = dst;
     this->fb = fb;
     this->options = options;
+    this->id=fb->id;
 
     init();
 }

Modified: trunk/src/OSThreadExec.h
===================================================================
--- trunk/src/OSThreadExec.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSThreadExec.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -28,6 +28,7 @@
 #define THREAD_ELEM
 
 #include <fx.h>
+#include "OSVirtualFileSystemBase.h"
 #include <string>
 #include <vector>
 #include <ctime>
@@ -57,7 +58,7 @@
      * @param src
      * @param dst
      */
-    OSThreadExec( void* fb, std::string command, std::string options, std::string src, std::string dst = "" );
+    OSThreadExec(OSVirtualFileSystemBase * fb, std::string command, std::string options, std::string src, std::string dst = "" );
     
     /**
      * Constructor.
@@ -67,7 +68,7 @@
      * @param src
      * @param dst
      */
-    OSThreadExec( void* fb, std::string command, std::string options, std::vector<std::string> src = std::vector<std::string>(), std::string dst = "" );
+    OSThreadExec(OSVirtualFileSystemBase * fb, std::string command, std::string options, std::vector<std::string> src = std::vector<std::string>(), std::string dst = "" );
     
     /**
      * Initializes thread procedure object.
@@ -76,8 +77,8 @@
 
     FXMutex mutex;
     void *gui;
-    void *fb;
     void *filel;
+    OSVirtualFileSystemBase *fb;
 
     std::string command;
     std::vector<std::string> src;
@@ -108,7 +109,9 @@
     bool error;
     pthread_t pid;
     FXMenuPane *pane;
+    long id;
 
+
 };
 
 #endif

Modified: trunk/src/OSVirtualFileSystemBase.h
===================================================================
--- trunk/src/OSVirtualFileSystemBase.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/OSVirtualFileSystemBase.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -49,6 +49,8 @@
 class OSVirtualFileSystemBase
 {
 public:
+    long id;
+    
     virtual int osopendir( std::string dir ) = 0;
     virtual OSFile osreaddir( void ) = 0;
     virtual int mkdir( std::string dir, int mode = 0 ) = 0;
@@ -56,7 +58,7 @@
     virtual int move( OSThreadExec* te ) = 0;
     virtual int remove( OSThreadExec* te ) = 0;
     virtual int rename( std::string orgname, std::string newname ) = 0;
-    virtual int init( std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf ) = 0;
+    virtual int init( long id,std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf ) = 0;
     virtual int mode( std::string file ) = 0;
     virtual std::string owner( std::string file ) = 0;
     virtual std::string group( std::string file ) = 0;

Modified: trunk/src/plugins/filelist/OSVfsArchive.cpp
===================================================================
--- trunk/src/plugins/filelist/OSVfsArchive.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsArchive.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -312,11 +312,11 @@
 int OSVfsArchive::rename (string orgname, string newname)
 {
 }
-int OSVfsArchive::init (vector < string > *vector_name, OSPathType pt, OSConfigure * conf)
+int OSVfsArchive::init (long id,vector < string > *vector_name, OSPathType pt, OSConfigure * conf)
 {
 archive_filename = pt.server;
+this->id=id;
 
-
 string  command;
 
 if ((archive_filename.length () >= 6 && archive_filename.substr (archive_filename.length () - 6, 6) == "tar.gz") ||(archive_filename.length () >= 3 && archive_filename.substr (archive_filename.length () - 3, 3) == "tgz"))

Modified: trunk/src/plugins/filelist/OSVfsArchive.h
===================================================================
--- trunk/src/plugins/filelist/OSVfsArchive.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsArchive.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -39,7 +39,7 @@
     int move (OSThreadExec* te);
     int remove (OSThreadExec* te);
     int rename (std::string orgname, std::string newname);
-    int init (std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf);
+    int init (long id, std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf);
     int mode (std::string file);
     std::string owner (std::string file);
     std::string group (std::string file);

Modified: trunk/src/plugins/filelist/OSVfsFtp.cpp
===================================================================
--- trunk/src/plugins/filelist/OSVfsFtp.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsFtp.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -608,9 +608,9 @@
     pftp->sendCmd( "RNTO ", FXFile::name( newname.c_str() ), tmp );
 
 }
-int OSVfsFtp::init ( std::vector < std::string > *vector_name, OSPathType pt, OSConfigure * conf )
+int OSVfsFtp::init (long id, std::vector < std::string > *vector_name, OSPathType pt, OSConfigure * conf )
 {
-
+    this->id=id;
     fieldsnum = vector_name->size ();
     fields = ( *vector_name );
 

Modified: trunk/src/plugins/filelist/OSVfsFtp.h
===================================================================
--- trunk/src/plugins/filelist/OSVfsFtp.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsFtp.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -107,7 +107,7 @@
     int move( OSThreadExec * te );
     int remove( OSThreadExec * te );
     int rename( std::string orgname, std::string newname );
-    int init( std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf );
+    int init( long id, std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf );
     int mode( std::string file );
     std::string owner( std::string file );
     std::string group( std::string file );

Modified: trunk/src/plugins/filelist/OSVfsLocal.cpp
===================================================================
--- trunk/src/plugins/filelist/OSVfsLocal.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsLocal.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -50,9 +50,9 @@
     return v;	
 }
 
-int OSVfsLocal::init (std::vector<std::string> *vector_name, OSPathType pt, OSConfigure * conf)
+int OSVfsLocal::init (long id, std::vector<std::string> *vector_name, OSPathType pt, OSConfigure * conf)
 {
-
+    this->id=id;
     fieldsnum = vector_name->size ();
     fields = (*vector_name);
 

Modified: trunk/src/plugins/filelist/OSVfsLocal.h
===================================================================
--- trunk/src/plugins/filelist/OSVfsLocal.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsLocal.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -69,7 +69,7 @@
     int move ( OSThreadExec * te );
     int remove ( OSThreadExec * te );
     int rename ( std::string orgname, std::string newname );
-    int init ( std::vector<std::string> *vector_name, OSPathType pt, OSConfigure* conf );
+    int init ( long id, std::vector<std::string> *vector_name, OSPathType pt, OSConfigure* conf );
     int mode ( std::string file );
     std::string owner ( std::string file );
     std::string group ( std::string file );

Modified: trunk/src/plugins/filelist/OSVfsSearch.cpp
===================================================================
--- trunk/src/plugins/filelist/OSVfsSearch.cpp	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsSearch.cpp	2006-02-18 17:08:23 UTC (rev 255)
@@ -111,10 +111,10 @@
 
 	return ret;
 }
-int OSVfsSearch::init(std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf)
+int OSVfsSearch::init(long id, std::vector<std::string>* vector_name, OSPathType pt, OSConfigure* conf)
 {
     fil_local=new OSVfsLocal();
-
+    this->id=id;
     pipe = popen (pt.server.c_str(), "r");
 
     if (pipe != NULL)

Modified: trunk/src/plugins/filelist/OSVfsSearch.h
===================================================================
--- trunk/src/plugins/filelist/OSVfsSearch.h	2006-02-17 22:33:34 UTC (rev 254)
+++ trunk/src/plugins/filelist/OSVfsSearch.h	2006-02-18 17:08:23 UTC (rev 255)
@@ -38,7 +38,7 @@
     int move (OSThreadExec * te);
     int remove (OSThreadExec * te);
     int rename (std::string orgname, std::string newname);
-    int init (std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf);
+    int init (long id, std::vector<std::string>* vector_name, OSPathType pt, OSConfigure * conf);
     int mode (std::string file);
     std::string owner (std::string file);
     std::string group (std::string file);



